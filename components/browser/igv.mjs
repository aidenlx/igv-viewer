/* eslint-disable */
/* esm.sh - esbuild bundle(igv@2.15.13) es2022 production */
const __Process$ = process
const __Buffer$ = Buffer
var __global$ = globalThis || (typeof window !== "undefined" ? window : self);
var zi=[],Ye=window.document,p0=Object.getPrototypeOf,Bi=zi.slice,pp=zi.concat,tc=zi.push,ms=zi.indexOf,pa={},gp=pa.toString,bs=pa.hasOwnProperty,mp=bs.toString,g0=mp.call(Object),lt={},Ze=function(e){return typeof e=="function"&&typeof e.nodeType!="number"},Sn=function(e){return e!=null&&e===e.window},m0={type:!0,src:!0,noModule:!0};function bp(i,e,t){e=e||Ye;var n,s=e.createElement("script");if(s.text=i,t)for(n in m0)t[n]&&(s[n]=t[n]);e.head.appendChild(s).parentNode.removeChild(s)}function In(i){return i==null?i+"":typeof i=="object"||typeof i=="function"?pa[gp.call(i)]||"object":typeof i}var wp="3.3.1 -ajax,-ajax/jsonp,-ajax/load,-ajax/parseXML,-ajax/script,-ajax/var/location,-ajax/var/nonce,-ajax/var/rquery,-ajax/xhr,-manipulation/_evalUrl,-event/ajax,-effects,-effects/Tween,-effects/animatedSelector",B=function(i,e){return new B.fn.init(i,e)},b0=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;B.fn=B.prototype={jquery:wp,constructor:B,length:0,toArray:function(){return Bi.call(this)},get:function(i){return i==null?Bi.call(this):i<0?this[i+this.length]:this[i]},pushStack:function(i){var e=B.merge(this.constructor(),i);return e.prevObject=this,e},each:function(i){return B.each(this,i)},map:function(i){return this.pushStack(B.map(this,function(e,t){return i.call(e,t,e)}))},slice:function(){return this.pushStack(Bi.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var e=this.length,t=+i+(i<0?e:0);return this.pushStack(t>=0&&t<e?[this[t]]:[])},end:function(){return this.prevObject||this.constructor()},push:tc,sort:zi.sort,splice:zi.splice};B.extend=B.fn.extend=function(){var i,e,t,n,s,r,a=arguments[0]||{},o=1,l=arguments.length,c=!1;for(typeof a=="boolean"&&(c=a,a=arguments[o]||{},o++),typeof a!="object"&&!Ze(a)&&(a={}),o===l&&(a=this,o--);o<l;o++)if((i=arguments[o])!=null)for(e in i)t=a[e],n=i[e],a!==n&&(c&&n&&(B.isPlainObject(n)||(s=Array.isArray(n)))?(s?(s=!1,r=t&&Array.isArray(t)?t:[]):r=t&&B.isPlainObject(t)?t:{},a[e]=B.extend(c,r,n)):n!==void 0&&(a[e]=n));return a};B.extend({expando:"jQuery"+(wp+Math.random()).replace(/\D/g,""),isReady:!0,error:function(i){throw new Error(i)},noop:function(){},isPlainObject:function(i){var e,t;return!i||gp.call(i)!=="[object Object]"?!1:(e=p0(i),e?(t=bs.call(e,"constructor")&&e.constructor,typeof t=="function"&&mp.call(t)===g0):!0)},isEmptyObject:function(i){var e;for(e in i)return!1;return!0},globalEval:function(i){bp(i)},each:function(i,e){var t,n=0;if(Ta(i))for(t=i.length;n<t&&e.call(i[n],n,i[n])!==!1;n++);else for(n in i)if(e.call(i[n],n,i[n])===!1)break;return i},trim:function(i){return i==null?"":(i+"").replace(b0,"")},makeArray:function(i,e){var t=e||[];return i!=null&&(Ta(Object(i))?B.merge(t,typeof i=="string"?[i]:i):tc.call(t,i)),t},inArray:function(i,e,t){return e==null?-1:ms.call(e,i,t)},merge:function(i,e){for(var t=+e.length,n=0,s=i.length;n<t;n++)i[s++]=e[n];return i.length=s,i},grep:function(i,e,t){for(var n,s=[],r=0,a=i.length,o=!t;r<a;r++)n=!e(i[r],r),n!==o&&s.push(i[r]);return s},map:function(i,e,t){var n,s,r=0,a=[];if(Ta(i))for(n=i.length;r<n;r++)s=e(i[r],r,t),s!=null&&a.push(s);else for(r in i)s=e(i[r],r,t),s!=null&&a.push(s);return pp.apply([],a)},guid:1,support:lt});typeof Symbol=="function"&&(B.fn[Symbol.iterator]=zi[Symbol.iterator]);B.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(i,e){pa["[object "+e+"]"]=e.toLowerCase()});function Ta(i){var e=!!i&&"length"in i&&i.length,t=In(i);return Ze(i)||Sn(i)?!1:t==="array"||e===0||typeof e=="number"&&e>0&&e-1 in i}var Qi=function(i){var e,t,n,s,r,a,o,l,c,h,d,f,u,g,_,b,w,p,m,v="sizzle"+1*new Date,x=i.document,R=0,M=0,C=z(),L=z(),y=z(),E=function($,Y){return $===Y&&(d=!0),0},k={}.hasOwnProperty,A=[],I=A.pop,F=A.push,X=A.push,U=A.slice,V=function($,Y){for(var ee=0,oe=$.length;ee<oe;ee++)if($[ee]===Y)return ee;return-1},q="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",S="[\\x20\\t\\r\\n\\f]",P="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",H="\\["+S+"*("+P+")(?:"+S+"*([*^$|!~]?=)"+S+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+P+"))|)"+S+"*\\]",D=":("+P+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+H+")*)|.*)\\)|)",O=new RegExp(S+"+","g"),W=new RegExp("^"+S+"+|((?:^|[^\\\\])(?:\\\\.)*)"+S+"+$","g"),j=new RegExp("^"+S+"*,"+S+"*"),G=new RegExp("^"+S+"*([>+~]|"+S+")"+S+"*"),Z=new RegExp("="+S+`*([^\\]'"]*?)`+S+"*\\]","g"),te=new RegExp(D),se=new RegExp("^"+P+"$"),re={ID:new RegExp("^#("+P+")"),CLASS:new RegExp("^\\.("+P+")"),TAG:new RegExp("^("+P+"|[*])"),ATTR:new RegExp("^"+H),PSEUDO:new RegExp("^"+D),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+S+"*(even|odd|(([+-]|)(\\d*)n|)"+S+"*(?:([+-]|)"+S+"*(\\d+)|))"+S+"*\\)|)","i"),bool:new RegExp("^(?:"+q+")$","i"),needsContext:new RegExp("^"+S+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+S+"*((?:-\\d)?\\d*)"+S+"*\\)|)(?=[^-]|$)","i")},ae=/^(?:input|select|textarea|button)$/i,me=/^h\d$/i,ue=/^[^{]+\{\s*\[native \w/,Se=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,_e=/[+~]/,ge=new RegExp("\\\\([\\da-f]{1,6}"+S+"?|("+S+")|.)","ig"),ke=function($,Y,ee){var oe="0x"+Y-65536;return oe!==oe||ee?Y:oe<0?String.fromCharCode(oe+65536):String.fromCharCode(oe>>10|55296,oe&1023|56320)},Te=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,Fe=function($,Y){return Y?$==="\0"?"\uFFFD":$.slice(0,-1)+"\\"+$.charCodeAt($.length-1).toString(16)+" ":"\\"+$},Ie=function(){f()},T=rn(function($){return $.disabled===!0&&("form"in $||"label"in $)},{dir:"parentNode",next:"legend"});try{X.apply(A=U.call(x.childNodes),x.childNodes),A[x.childNodes.length].nodeType}catch{X={apply:A.length?function(Y,ee){F.apply(Y,U.call(ee))}:function(Y,ee){for(var oe=Y.length,ne=0;Y[oe++]=ee[ne++];);Y.length=oe-1}}}function N($,Y,ee,oe){var ne,le,fe,we,ve,Le,Re,Ne=Y&&Y.ownerDocument,Ue=Y?Y.nodeType:9;if(ee=ee||[],typeof $!="string"||!$||Ue!==1&&Ue!==9&&Ue!==11)return ee;if(!oe&&((Y?Y.ownerDocument||Y:x)!==u&&f(Y),Y=Y||u,_)){if(Ue!==11&&(ve=Se.exec($)))if(ne=ve[1]){if(Ue===9)if(fe=Y.getElementById(ne)){if(fe.id===ne)return ee.push(fe),ee}else return ee;else if(Ne&&(fe=Ne.getElementById(ne))&&m(Y,fe)&&fe.id===ne)return ee.push(fe),ee}else{if(ve[2])return X.apply(ee,Y.getElementsByTagName($)),ee;if((ne=ve[3])&&t.getElementsByClassName&&Y.getElementsByClassName)return X.apply(ee,Y.getElementsByClassName(ne)),ee}if(t.qsa&&!y[$+" "]&&(!b||!b.test($))){if(Ue!==1)Ne=Y,Re=$;else if(Y.nodeName.toLowerCase()!=="object"){for((we=Y.getAttribute("id"))?we=we.replace(Te,Fe):Y.setAttribute("id",we=v),Le=a($),le=Le.length;le--;)Le[le]="#"+we+" "+wi(Le[le]);Re=Le.join(","),Ne=_e.test($)&&Pe(Y.parentNode)||Y}if(Re)try{return X.apply(ee,Ne.querySelectorAll(Re)),ee}catch{}finally{we===v&&Y.removeAttribute("id")}}}return l($.replace(W,"$1"),Y,ee,oe)}function z(){var $=[];function Y(ee,oe){return $.push(ee+" ")>n.cacheLength&&delete Y[$.shift()],Y[ee+" "]=oe}return Y}function Q($){return $[v]=!0,$}function K($){var Y=u.createElement("fieldset");try{return!!$(Y)}catch{return!1}finally{Y.parentNode&&Y.parentNode.removeChild(Y),Y=null}}function ie($,Y){var ee=Y&&$,oe=ee&&$.nodeType===1&&Y.nodeType===1&&$.sourceIndex-Y.sourceIndex;if(oe)return oe;if(ee){for(;ee=ee.nextSibling;)if(ee===Y)return-1}return $?1:-1}function ce($){return function(Y){var ee=Y.nodeName.toLowerCase();return ee==="input"&&Y.type===$}}function Me($){return function(Y){var ee=Y.nodeName.toLowerCase();return(ee==="input"||ee==="button")&&Y.type===$}}function Be($){return function(Y){return"form"in Y?Y.parentNode&&Y.disabled===!1?"label"in Y?"label"in Y.parentNode?Y.parentNode.disabled===$:Y.disabled===$:Y.isDisabled===$||Y.isDisabled!==!$&&T(Y)===$:Y.disabled===$:"label"in Y?Y.disabled===$:!1}}function He($){return Q(function(Y){return Y=+Y,Q(function(ee,oe){for(var ne,le=$([],ee.length,Y),fe=le.length;fe--;)ee[ne=le[fe]]&&(ee[ne]=!(oe[ne]=ee[ne]))})})}function Pe($){return $&&typeof $.getElementsByTagName<"u"&&$}t=N.support={},r=N.isXML=function($){var Y=$&&($.ownerDocument||$).documentElement;return Y?Y.nodeName!=="HTML":!1},f=N.setDocument=function($){var Y,ee,oe=$?$.ownerDocument||$:x;return oe===u||oe.nodeType!==9||!oe.documentElement||(u=oe,g=u.documentElement,_=!r(u),x!==u&&(ee=u.defaultView)&&ee.top!==ee&&(ee.addEventListener?ee.addEventListener("unload",Ie,!1):ee.attachEvent&&ee.attachEvent("onunload",Ie)),t.attributes=K(function(ne){return ne.className="i",!ne.getAttribute("className")}),t.getElementsByTagName=K(function(ne){return ne.appendChild(u.createComment("")),!ne.getElementsByTagName("*").length}),t.getElementsByClassName=ue.test(u.getElementsByClassName),t.getById=K(function(ne){return g.appendChild(ne).id=v,!u.getElementsByName||!u.getElementsByName(v).length}),t.getById?(n.filter.ID=function(ne){var le=ne.replace(ge,ke);return function(fe){return fe.getAttribute("id")===le}},n.find.ID=function(ne,le){if(typeof le.getElementById<"u"&&_){var fe=le.getElementById(ne);return fe?[fe]:[]}}):(n.filter.ID=function(ne){var le=ne.replace(ge,ke);return function(fe){var we=typeof fe.getAttributeNode<"u"&&fe.getAttributeNode("id");return we&&we.value===le}},n.find.ID=function(ne,le){if(typeof le.getElementById<"u"&&_){var fe,we,ve,Le=le.getElementById(ne);if(Le){if(fe=Le.getAttributeNode("id"),fe&&fe.value===ne)return[Le];for(ve=le.getElementsByName(ne),we=0;Le=ve[we++];)if(fe=Le.getAttributeNode("id"),fe&&fe.value===ne)return[Le]}return[]}}),n.find.TAG=t.getElementsByTagName?function(ne,le){if(typeof le.getElementsByTagName<"u")return le.getElementsByTagName(ne);if(t.qsa)return le.querySelectorAll(ne)}:function(ne,le){var fe,we=[],ve=0,Le=le.getElementsByTagName(ne);if(ne==="*"){for(;fe=Le[ve++];)fe.nodeType===1&&we.push(fe);return we}return Le},n.find.CLASS=t.getElementsByClassName&&function(ne,le){if(typeof le.getElementsByClassName<"u"&&_)return le.getElementsByClassName(ne)},w=[],b=[],(t.qsa=ue.test(u.querySelectorAll))&&(K(function(ne){g.appendChild(ne).innerHTML="<a id='"+v+"'></a><select id='"+v+"-\r\\' msallowcapture=''><option selected=''></option></select>",ne.querySelectorAll("[msallowcapture^='']").length&&b.push("[*^$]="+S+`*(?:''|"")`),ne.querySelectorAll("[selected]").length||b.push("\\["+S+"*(?:value|"+q+")"),ne.querySelectorAll("[id~="+v+"-]").length||b.push("~="),ne.querySelectorAll(":checked").length||b.push(":checked"),ne.querySelectorAll("a#"+v+"+*").length||b.push(".#.+[+~]")}),K(function(ne){ne.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var le=u.createElement("input");le.setAttribute("type","hidden"),ne.appendChild(le).setAttribute("name","D"),ne.querySelectorAll("[name=d]").length&&b.push("name"+S+"*[*^$|!~]?="),ne.querySelectorAll(":enabled").length!==2&&b.push(":enabled",":disabled"),g.appendChild(ne).disabled=!0,ne.querySelectorAll(":disabled").length!==2&&b.push(":enabled",":disabled"),ne.querySelectorAll("*,:x"),b.push(",.*:")})),(t.matchesSelector=ue.test(p=g.matches||g.webkitMatchesSelector||g.mozMatchesSelector||g.oMatchesSelector||g.msMatchesSelector))&&K(function(ne){t.disconnectedMatch=p.call(ne,"*"),p.call(ne,"[s!='']:x"),w.push("!=",D)}),b=b.length&&new RegExp(b.join("|")),w=w.length&&new RegExp(w.join("|")),Y=ue.test(g.compareDocumentPosition),m=Y||ue.test(g.contains)?function(ne,le){var fe=ne.nodeType===9?ne.documentElement:ne,we=le&&le.parentNode;return ne===we||!!(we&&we.nodeType===1&&(fe.contains?fe.contains(we):ne.compareDocumentPosition&&ne.compareDocumentPosition(we)&16))}:function(ne,le){if(le){for(;le=le.parentNode;)if(le===ne)return!0}return!1},E=Y?function(ne,le){if(ne===le)return d=!0,0;var fe=!ne.compareDocumentPosition-!le.compareDocumentPosition;return fe||(fe=(ne.ownerDocument||ne)===(le.ownerDocument||le)?ne.compareDocumentPosition(le):1,fe&1||!t.sortDetached&&le.compareDocumentPosition(ne)===fe?ne===u||ne.ownerDocument===x&&m(x,ne)?-1:le===u||le.ownerDocument===x&&m(x,le)?1:h?V(h,ne)-V(h,le):0:fe&4?-1:1)}:function(ne,le){if(ne===le)return d=!0,0;var fe,we=0,ve=ne.parentNode,Le=le.parentNode,Re=[ne],Ne=[le];if(!ve||!Le)return ne===u?-1:le===u?1:ve?-1:Le?1:h?V(h,ne)-V(h,le):0;if(ve===Le)return ie(ne,le);for(fe=ne;fe=fe.parentNode;)Re.unshift(fe);for(fe=le;fe=fe.parentNode;)Ne.unshift(fe);for(;Re[we]===Ne[we];)we++;return we?ie(Re[we],Ne[we]):Re[we]===x?-1:Ne[we]===x?1:0}),u},N.matches=function($,Y){return N($,null,null,Y)},N.matchesSelector=function($,Y){if(($.ownerDocument||$)!==u&&f($),Y=Y.replace(Z,"='$1']"),t.matchesSelector&&_&&!y[Y+" "]&&(!w||!w.test(Y))&&(!b||!b.test(Y)))try{var ee=p.call($,Y);if(ee||t.disconnectedMatch||$.document&&$.document.nodeType!==11)return ee}catch{}return N(Y,u,null,[$]).length>0},N.contains=function($,Y){return($.ownerDocument||$)!==u&&f($),m($,Y)},N.attr=function($,Y){($.ownerDocument||$)!==u&&f($);var ee=n.attrHandle[Y.toLowerCase()],oe=ee&&k.call(n.attrHandle,Y.toLowerCase())?ee($,Y,!_):void 0;return oe!==void 0?oe:t.attributes||!_?$.getAttribute(Y):(oe=$.getAttributeNode(Y))&&oe.specified?oe.value:null},N.escape=function($){return($+"").replace(Te,Fe)},N.error=function($){throw new Error("Syntax error, unrecognized expression: "+$)},N.uniqueSort=function($){var Y,ee=[],oe=0,ne=0;if(d=!t.detectDuplicates,h=!t.sortStable&&$.slice(0),$.sort(E),d){for(;Y=$[ne++];)Y===$[ne]&&(oe=ee.push(ne));for(;oe--;)$.splice(ee[oe],1)}return h=null,$},s=N.getText=function($){var Y,ee="",oe=0,ne=$.nodeType;if(ne){if(ne===1||ne===9||ne===11){if(typeof $.textContent=="string")return $.textContent;for($=$.firstChild;$;$=$.nextSibling)ee+=s($)}else if(ne===3||ne===4)return $.nodeValue}else for(;Y=$[oe++];)ee+=s(Y);return ee},n=N.selectors={cacheLength:50,createPseudo:Q,match:re,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function($){return $[1]=$[1].replace(ge,ke),$[3]=($[3]||$[4]||$[5]||"").replace(ge,ke),$[2]==="~="&&($[3]=" "+$[3]+" "),$.slice(0,4)},CHILD:function($){return $[1]=$[1].toLowerCase(),$[1].slice(0,3)==="nth"?($[3]||N.error($[0]),$[4]=+($[4]?$[5]+($[6]||1):2*($[3]==="even"||$[3]==="odd")),$[5]=+($[7]+$[8]||$[3]==="odd")):$[3]&&N.error($[0]),$},PSEUDO:function($){var Y,ee=!$[6]&&$[2];return re.CHILD.test($[0])?null:($[3]?$[2]=$[4]||$[5]||"":ee&&te.test(ee)&&(Y=a(ee,!0))&&(Y=ee.indexOf(")",ee.length-Y)-ee.length)&&($[0]=$[0].slice(0,Y),$[2]=ee.slice(0,Y)),$.slice(0,3))}},filter:{TAG:function($){var Y=$.replace(ge,ke).toLowerCase();return $==="*"?function(){return!0}:function(ee){return ee.nodeName&&ee.nodeName.toLowerCase()===Y}},CLASS:function($){var Y=C[$+" "];return Y||(Y=new RegExp("(^|"+S+")"+$+"("+S+"|$)"))&&C($,function(ee){return Y.test(typeof ee.className=="string"&&ee.className||typeof ee.getAttribute<"u"&&ee.getAttribute("class")||"")})},ATTR:function($,Y,ee){return function(oe){var ne=N.attr(oe,$);return ne==null?Y==="!=":Y?(ne+="",Y==="="?ne===ee:Y==="!="?ne!==ee:Y==="^="?ee&&ne.indexOf(ee)===0:Y==="*="?ee&&ne.indexOf(ee)>-1:Y==="$="?ee&&ne.slice(-ee.length)===ee:Y==="~="?(" "+ne.replace(O," ")+" ").indexOf(ee)>-1:Y==="|="?ne===ee||ne.slice(0,ee.length+1)===ee+"-":!1):!0}},CHILD:function($,Y,ee,oe,ne){var le=$.slice(0,3)!=="nth",fe=$.slice(-4)!=="last",we=Y==="of-type";return oe===1&&ne===0?function(ve){return!!ve.parentNode}:function(ve,Le,Re){var Ne,Ue,We,Ae,ct,ut,St=le!==fe?"nextSibling":"previousSibling",tt=ve.parentNode,Mi=we&&ve.nodeName.toLowerCase(),Ee=!Re&&!we,J=!1;if(tt){if(le){for(;St;){for(Ae=ve;Ae=Ae[St];)if(we?Ae.nodeName.toLowerCase()===Mi:Ae.nodeType===1)return!1;ut=St=$==="only"&&!ut&&"nextSibling"}return!0}if(ut=[fe?tt.firstChild:tt.lastChild],fe&&Ee){for(Ae=tt,We=Ae[v]||(Ae[v]={}),Ue=We[Ae.uniqueID]||(We[Ae.uniqueID]={}),Ne=Ue[$]||[],ct=Ne[0]===R&&Ne[1],J=ct&&Ne[2],Ae=ct&&tt.childNodes[ct];Ae=++ct&&Ae&&Ae[St]||(J=ct=0)||ut.pop();)if(Ae.nodeType===1&&++J&&Ae===ve){Ue[$]=[R,ct,J];break}}else if(Ee&&(Ae=ve,We=Ae[v]||(Ae[v]={}),Ue=We[Ae.uniqueID]||(We[Ae.uniqueID]={}),Ne=Ue[$]||[],ct=Ne[0]===R&&Ne[1],J=ct),J===!1)for(;(Ae=++ct&&Ae&&Ae[St]||(J=ct=0)||ut.pop())&&!((we?Ae.nodeName.toLowerCase()===Mi:Ae.nodeType===1)&&++J&&(Ee&&(We=Ae[v]||(Ae[v]={}),Ue=We[Ae.uniqueID]||(We[Ae.uniqueID]={}),Ue[$]=[R,J]),Ae===ve)););return J-=ne,J===oe||J%oe===0&&J/oe>=0}}},PSEUDO:function($,Y){var ee,oe=n.pseudos[$]||n.setFilters[$.toLowerCase()]||N.error("unsupported pseudo: "+$);return oe[v]?oe(Y):oe.length>1?(ee=[$,$,"",Y],n.setFilters.hasOwnProperty($.toLowerCase())?Q(function(ne,le){for(var fe,we=oe(ne,Y),ve=we.length;ve--;)fe=V(ne,we[ve]),ne[fe]=!(le[fe]=we[ve])}):function(ne){return oe(ne,0,ee)}):oe}},pseudos:{not:Q(function($){var Y=[],ee=[],oe=o($.replace(W,"$1"));return oe[v]?Q(function(ne,le,fe,we){for(var ve,Le=oe(ne,null,we,[]),Re=ne.length;Re--;)(ve=Le[Re])&&(ne[Re]=!(le[Re]=ve))}):function(ne,le,fe){return Y[0]=ne,oe(Y,null,fe,ee),Y[0]=null,!ee.pop()}}),has:Q(function($){return function(Y){return N($,Y).length>0}}),contains:Q(function($){return $=$.replace(ge,ke),function(Y){return(Y.textContent||Y.innerText||s(Y)).indexOf($)>-1}}),lang:Q(function($){return se.test($||"")||N.error("unsupported lang: "+$),$=$.replace(ge,ke).toLowerCase(),function(Y){var ee;do if(ee=_?Y.lang:Y.getAttribute("xml:lang")||Y.getAttribute("lang"))return ee=ee.toLowerCase(),ee===$||ee.indexOf($+"-")===0;while((Y=Y.parentNode)&&Y.nodeType===1);return!1}}),target:function($){var Y=i.location&&i.location.hash;return Y&&Y.slice(1)===$.id},root:function($){return $===g},focus:function($){return $===u.activeElement&&(!u.hasFocus||u.hasFocus())&&!!($.type||$.href||~$.tabIndex)},enabled:Be(!1),disabled:Be(!0),checked:function($){var Y=$.nodeName.toLowerCase();return Y==="input"&&!!$.checked||Y==="option"&&!!$.selected},selected:function($){return $.parentNode&&$.parentNode.selectedIndex,$.selected===!0},empty:function($){for($=$.firstChild;$;$=$.nextSibling)if($.nodeType<6)return!1;return!0},parent:function($){return!n.pseudos.empty($)},header:function($){return me.test($.nodeName)},input:function($){return ae.test($.nodeName)},button:function($){var Y=$.nodeName.toLowerCase();return Y==="input"&&$.type==="button"||Y==="button"},text:function($){var Y;return $.nodeName.toLowerCase()==="input"&&$.type==="text"&&((Y=$.getAttribute("type"))==null||Y.toLowerCase()==="text")},first:He(function(){return[0]}),last:He(function($,Y){return[Y-1]}),eq:He(function($,Y,ee){return[ee<0?ee+Y:ee]}),even:He(function($,Y){for(var ee=0;ee<Y;ee+=2)$.push(ee);return $}),odd:He(function($,Y){for(var ee=1;ee<Y;ee+=2)$.push(ee);return $}),lt:He(function($,Y,ee){for(var oe=ee<0?ee+Y:ee;--oe>=0;)$.push(oe);return $}),gt:He(function($,Y,ee){for(var oe=ee<0?ee+Y:ee;++oe<Y;)$.push(oe);return $})}},n.pseudos.nth=n.pseudos.eq;for(e in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})n.pseudos[e]=ce(e);for(e in{submit:!0,reset:!0})n.pseudos[e]=Me(e);function et(){}et.prototype=n.filters=n.pseudos,n.setFilters=new et,a=N.tokenize=function($,Y){var ee,oe,ne,le,fe,we,ve,Le=L[$+" "];if(Le)return Y?0:Le.slice(0);for(fe=$,we=[],ve=n.preFilter;fe;){(!ee||(oe=j.exec(fe)))&&(oe&&(fe=fe.slice(oe[0].length)||fe),we.push(ne=[])),ee=!1,(oe=G.exec(fe))&&(ee=oe.shift(),ne.push({value:ee,type:oe[0].replace(W," ")}),fe=fe.slice(ee.length));for(le in n.filter)(oe=re[le].exec(fe))&&(!ve[le]||(oe=ve[le](oe)))&&(ee=oe.shift(),ne.push({value:ee,type:le,matches:oe}),fe=fe.slice(ee.length));if(!ee)break}return Y?fe.length:fe?N.error($):L($,we).slice(0)};function wi($){for(var Y=0,ee=$.length,oe="";Y<ee;Y++)oe+=$[Y].value;return oe}function rn($,Y,ee){var oe=Y.dir,ne=Y.next,le=ne||oe,fe=ee&&le==="parentNode",we=M++;return Y.first?function(ve,Le,Re){for(;ve=ve[oe];)if(ve.nodeType===1||fe)return $(ve,Le,Re);return!1}:function(ve,Le,Re){var Ne,Ue,We,Ae=[R,we];if(Re){for(;ve=ve[oe];)if((ve.nodeType===1||fe)&&$(ve,Le,Re))return!0}else for(;ve=ve[oe];)if(ve.nodeType===1||fe)if(We=ve[v]||(ve[v]={}),Ue=We[ve.uniqueID]||(We[ve.uniqueID]={}),ne&&ne===ve.nodeName.toLowerCase())ve=ve[oe]||ve;else{if((Ne=Ue[le])&&Ne[0]===R&&Ne[1]===we)return Ae[2]=Ne[2];if(Ue[le]=Ae,Ae[2]=$(ve,Le,Re))return!0}return!1}}function qt($){return $.length>1?function(Y,ee,oe){for(var ne=$.length;ne--;)if(!$[ne](Y,ee,oe))return!1;return!0}:$[0]}function Ca($,Y,ee){for(var oe=0,ne=Y.length;oe<ne;oe++)N($,Y[oe],ee);return ee}function sn($,Y,ee,oe,ne){for(var le,fe=[],we=0,ve=$.length,Le=Y!=null;we<ve;we++)(le=$[we])&&(!ee||ee(le,oe,ne))&&(fe.push(le),Le&&Y.push(we));return fe}function ht($,Y,ee,oe,ne,le){return oe&&!oe[v]&&(oe=ht(oe)),ne&&!ne[v]&&(ne=ht(ne,le)),Q(function(fe,we,ve,Le){var Re,Ne,Ue,We=[],Ae=[],ct=we.length,ut=fe||Ca(Y||"*",ve.nodeType?[ve]:ve,[]),St=$&&(fe||!Y)?sn(ut,We,$,ve,Le):ut,tt=ee?ne||(fe?$:ct||oe)?[]:we:St;if(ee&&ee(St,tt,ve,Le),oe)for(Re=sn(tt,Ae),oe(Re,[],ve,Le),Ne=Re.length;Ne--;)(Ue=Re[Ne])&&(tt[Ae[Ne]]=!(St[Ae[Ne]]=Ue));if(fe){if(ne||$){if(ne){for(Re=[],Ne=tt.length;Ne--;)(Ue=tt[Ne])&&Re.push(St[Ne]=Ue);ne(null,tt=[],Re,Le)}for(Ne=tt.length;Ne--;)(Ue=tt[Ne])&&(Re=ne?V(fe,Ue):We[Ne])>-1&&(fe[Re]=!(we[Re]=Ue))}}else tt=sn(tt===we?tt.splice(ct,tt.length):tt),ne?ne(null,we,tt,Le):X.apply(we,tt)})}function Yt($){for(var Y,ee,oe,ne=$.length,le=n.relative[$[0].type],fe=le||n.relative[" "],we=le?1:0,ve=rn(function(Ne){return Ne===Y},fe,!0),Le=rn(function(Ne){return V(Y,Ne)>-1},fe,!0),Re=[function(Ne,Ue,We){var Ae=!le&&(We||Ue!==c)||((Y=Ue).nodeType?ve(Ne,Ue,We):Le(Ne,Ue,We));return Y=null,Ae}];we<ne;we++)if(ee=n.relative[$[we].type])Re=[rn(qt(Re),ee)];else{if(ee=n.filter[$[we].type].apply(null,$[we].matches),ee[v]){for(oe=++we;oe<ne&&!n.relative[$[oe].type];oe++);return ht(we>1&&qt(Re),we>1&&wi($.slice(0,we-1).concat({value:$[we-2].type===" "?"*":""})).replace(W,"$1"),ee,we<oe&&Yt($.slice(we,oe)),oe<ne&&Yt($=$.slice(oe)),oe<ne&&wi($))}Re.push(ee)}return qt(Re)}function Ea($,Y){var ee=Y.length>0,oe=$.length>0,ne=function(le,fe,we,ve,Le){var Re,Ne,Ue,We=0,Ae="0",ct=le&&[],ut=[],St=c,tt=le||oe&&n.find.TAG("*",Le),Mi=R+=St==null?1:Math.random()||.1,Ee=tt.length;for(Le&&(c=fe===u||fe||Le);Ae!==Ee&&(Re=tt[Ae])!=null;Ae++){if(oe&&Re){for(Ne=0,!fe&&Re.ownerDocument!==u&&(f(Re),we=!_);Ue=$[Ne++];)if(Ue(Re,fe||u,we)){ve.push(Re);break}Le&&(R=Mi)}ee&&((Re=!Ue&&Re)&&We--,le&&ct.push(Re))}if(We+=Ae,ee&&Ae!==We){for(Ne=0;Ue=Y[Ne++];)Ue(ct,ut,fe,we);if(le){if(We>0)for(;Ae--;)ct[Ae]||ut[Ae]||(ut[Ae]=I.call(ve));ut=sn(ut)}X.apply(ve,ut),Le&&!le&&ut.length>0&&We+Y.length>1&&N.uniqueSort(ve)}return Le&&(R=Mi,c=St),ct};return ee?Q(ne):ne}return o=N.compile=function($,Y){var ee,oe=[],ne=[],le=y[$+" "];if(!le){for(Y||(Y=a($)),ee=Y.length;ee--;)le=Yt(Y[ee]),le[v]?oe.push(le):ne.push(le);le=y($,Ea(ne,oe)),le.selector=$}return le},l=N.select=function($,Y,ee,oe){var ne,le,fe,we,ve,Le=typeof $=="function"&&$,Re=!oe&&a($=Le.selector||$);if(ee=ee||[],Re.length===1){if(le=Re[0]=Re[0].slice(0),le.length>2&&(fe=le[0]).type==="ID"&&Y.nodeType===9&&_&&n.relative[le[1].type]){if(Y=(n.find.ID(fe.matches[0].replace(ge,ke),Y)||[])[0],Y)Le&&(Y=Y.parentNode);else return ee;$=$.slice(le.shift().value.length)}for(ne=re.needsContext.test($)?0:le.length;ne--&&(fe=le[ne],!n.relative[we=fe.type]);)if((ve=n.find[we])&&(oe=ve(fe.matches[0].replace(ge,ke),_e.test(le[0].type)&&Pe(Y.parentNode)||Y))){if(le.splice(ne,1),$=oe.length&&wi(le),!$)return X.apply(ee,oe),ee;break}}return(Le||o($,Re))(oe,Y,!_,ee,!Y||_e.test($)&&Pe(Y.parentNode)||Y),ee},t.sortStable=v.split("").sort(E).join("")===v,t.detectDuplicates=!!d,f(),N}(window);B.find=Qi;B.expr=Qi.selectors;B.expr[":"]=B.expr.pseudos;B.uniqueSort=B.unique=Qi.uniqueSort;B.text=Qi.getText;B.isXMLDoc=Qi.isXML;B.contains=Qi.contains;B.escapeSelector=Qi.escape;var an=function(i,e,t){for(var n=[],s=t!==void 0;(i=i[e])&&i.nodeType!==9;)if(i.nodeType===1){if(s&&B(i).is(t))break;n.push(i)}return n},Nc=function(i,e){for(var t=[];i;i=i.nextSibling)i.nodeType===1&&i!==e&&t.push(i);return t},vp=B.expr.match.needsContext;function ai(i,e){return i.nodeName&&i.nodeName.toLowerCase()===e.toLowerCase()}var _p=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function Ma(i,e,t){return Ze(e)?B.grep(i,function(n,s){return!!e.call(n,s,n)!==t}):e.nodeType?B.grep(i,function(n){return n===e!==t}):typeof e!="string"?B.grep(i,function(n){return ms.call(e,n)>-1!==t}):B.filter(e,i,t)}B.filter=function(i,e,t){var n=e[0];return t&&(i=":not("+i+")"),e.length===1&&n.nodeType===1?B.find.matchesSelector(n,i)?[n]:[]:B.find.matches(i,B.grep(e,function(s){return s.nodeType===1}))};B.fn.extend({find:function(i){var e,t,n=this.length,s=this;if(typeof i!="string")return this.pushStack(B(i).filter(function(){for(e=0;e<n;e++)if(B.contains(s[e],this))return!0}));for(t=this.pushStack([]),e=0;e<n;e++)B.find(i,s[e],t);return n>1?B.uniqueSort(t):t},filter:function(i){return this.pushStack(Ma(this,i||[],!1))},not:function(i){return this.pushStack(Ma(this,i||[],!0))},is:function(i){return!!Ma(this,typeof i=="string"&&vp.test(i)?B(i):i||[],!1).length}});var yp,w0=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,v0=B.fn.init=function(i,e,t){var n,s;if(!i)return this;if(t=t||yp,typeof i=="string")if(i[0]==="<"&&i[i.length-1]===">"&&i.length>=3?n=[null,i,null]:n=w0.exec(i),n&&(n[1]||!e))if(n[1]){if(e=e instanceof B?e[0]:e,B.merge(this,B.parseHTML(n[1],e&&e.nodeType?e.ownerDocument||e:Ye,!0)),_p.test(n[1])&&B.isPlainObject(e))for(n in e)Ze(this[n])?this[n](e[n]):this.attr(n,e[n]);return this}else return s=Ye.getElementById(n[2]),s&&(this[0]=s,this.length=1),this;else return!e||e.jquery?(e||t).find(i):this.constructor(e).find(i);else{if(i.nodeType)return this[0]=i,this.length=1,this;if(Ze(i))return t.ready!==void 0?t.ready(i):i(B)}return B.makeArray(i,this)};v0.prototype=B.fn;yp=B(Ye);var _0=/^(?:parents|prev(?:Until|All))/,y0={children:!0,contents:!0,next:!0,prev:!0};B.fn.extend({has:function(i){var e=B(i,this),t=e.length;return this.filter(function(){for(var n=0;n<t;n++)if(B.contains(this,e[n]))return!0})},closest:function(i,e){var t,n=0,s=this.length,r=[],a=typeof i!="string"&&B(i);if(!vp.test(i)){for(;n<s;n++)for(t=this[n];t&&t!==e;t=t.parentNode)if(t.nodeType<11&&(a?a.index(t)>-1:t.nodeType===1&&B.find.matchesSelector(t,i))){r.push(t);break}}return this.pushStack(r.length>1?B.uniqueSort(r):r)},index:function(i){return i?typeof i=="string"?ms.call(B(i),this[0]):ms.call(this,i.jquery?i[0]:i):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(i,e){return this.pushStack(B.uniqueSort(B.merge(this.get(),B(i,e))))},addBack:function(i){return this.add(i==null?this.prevObject:this.prevObject.filter(i))}});function Fc(i,e){for(;(i=i[e])&&i.nodeType!==1;);return i}B.each({parent:function(i){var e=i.parentNode;return e&&e.nodeType!==11?e:null},parents:function(i){return an(i,"parentNode")},parentsUntil:function(i,e,t){return an(i,"parentNode",t)},next:function(i){return Fc(i,"nextSibling")},prev:function(i){return Fc(i,"previousSibling")},nextAll:function(i){return an(i,"nextSibling")},prevAll:function(i){return an(i,"previousSibling")},nextUntil:function(i,e,t){return an(i,"nextSibling",t)},prevUntil:function(i,e,t){return an(i,"previousSibling",t)},siblings:function(i){return Nc((i.parentNode||{}).firstChild,i)},children:function(i){return Nc(i.firstChild)},contents:function(i){return ai(i,"iframe")?i.contentDocument:(ai(i,"template")&&(i=i.content||i),B.merge([],i.childNodes))}},function(i,e){B.fn[i]=function(t,n){var s=B.map(this,e,t);return i.slice(-5)!=="Until"&&(n=t),n&&typeof n=="string"&&(s=B.filter(n,s)),this.length>1&&(y0[i]||B.uniqueSort(s),_0.test(i)&&s.reverse()),this.pushStack(s)}});var Hi=/[^\x20\t\r\n\f]+/g;function x0(i){var e={};return B.each(i.match(Hi)||[],function(t,n){e[n]=!0}),e}B.Callbacks=function(i){i=typeof i=="string"?x0(i):B.extend({},i);var e,t,n,s,r=[],a=[],o=-1,l=function(){for(s=s||i.once,n=e=!0;a.length;o=-1)for(t=a.shift();++o<r.length;)r[o].apply(t[0],t[1])===!1&&i.stopOnFalse&&(o=r.length,t=!1);i.memory||(t=!1),e=!1,s&&(t?r=[]:r="")},c={add:function(){return r&&(t&&!e&&(o=r.length-1,a.push(t)),function h(d){B.each(d,function(f,u){Ze(u)?(!i.unique||!c.has(u))&&r.push(u):u&&u.length&&In(u)!=="string"&&h(u)})}(arguments),t&&!e&&l()),this},remove:function(){return B.each(arguments,function(h,d){for(var f;(f=B.inArray(d,r,f))>-1;)r.splice(f,1),f<=o&&o--}),this},has:function(h){return h?B.inArray(h,r)>-1:r.length>0},empty:function(){return r&&(r=[]),this},disable:function(){return s=a=[],r=t="",this},disabled:function(){return!r},lock:function(){return s=a=[],!t&&!e&&(r=t=""),this},locked:function(){return!!s},fireWith:function(h,d){return s||(d=d||[],d=[h,d.slice?d.slice():d],a.push(d),e||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!n}};return c};function on(i){return i}function Br(i){throw i}function Dc(i,e,t,n){var s;try{i&&Ze(s=i.promise)?s.call(i).done(e).fail(t):i&&Ze(s=i.then)?s.call(i,e,t):e.apply(void 0,[i].slice(n))}catch(r){t.apply(void 0,[r])}}B.extend({Deferred:function(i){var e=[["notify","progress",B.Callbacks("memory"),B.Callbacks("memory"),2],["resolve","done",B.Callbacks("once memory"),B.Callbacks("once memory"),0,"resolved"],["reject","fail",B.Callbacks("once memory"),B.Callbacks("once memory"),1,"rejected"]],t="pending",n={state:function(){return t},always:function(){return s.done(arguments).fail(arguments),this},catch:function(r){return n.then(null,r)},pipe:function(){var r=arguments;return B.Deferred(function(a){B.each(e,function(o,l){var c=Ze(r[l[4]])&&r[l[4]];s[l[1]](function(){var h=c&&c.apply(this,arguments);h&&Ze(h.promise)?h.promise().progress(a.notify).done(a.resolve).fail(a.reject):a[l[0]+"With"](this,c?[h]:arguments)})}),r=null}).promise()},then:function(r,a,o){var l=0;function c(h,d,f,u){return function(){var g=this,_=arguments,b=function(){var p,m;if(!(h<l)){if(p=f.apply(g,_),p===d.promise())throw new TypeError("Thenable self-resolution");m=p&&(typeof p=="object"||typeof p=="function")&&p.then,Ze(m)?u?m.call(p,c(l,d,on,u),c(l,d,Br,u)):(l++,m.call(p,c(l,d,on,u),c(l,d,Br,u),c(l,d,on,d.notifyWith))):(f!==on&&(g=void 0,_=[p]),(u||d.resolveWith)(g,_))}},w=u?b:function(){try{b()}catch(p){B.Deferred.exceptionHook&&B.Deferred.exceptionHook(p,w.stackTrace),h+1>=l&&(f!==Br&&(g=void 0,_=[p]),d.rejectWith(g,_))}};h?w():(B.Deferred.getStackHook&&(w.stackTrace=B.Deferred.getStackHook()),window.setTimeout(w))}}return B.Deferred(function(h){e[0][3].add(c(0,h,Ze(o)?o:on,h.notifyWith)),e[1][3].add(c(0,h,Ze(r)?r:on)),e[2][3].add(c(0,h,Ze(a)?a:Br))}).promise()},promise:function(r){return r!=null?B.extend(r,n):n}},s={};return B.each(e,function(r,a){var o=a[2],l=a[5];n[a[1]]=o.add,l&&o.add(function(){t=l},e[3-r][2].disable,e[3-r][3].disable,e[0][2].lock,e[0][3].lock),o.add(a[3].fire),s[a[0]]=function(){return s[a[0]+"With"](this===s?void 0:this,arguments),this},s[a[0]+"With"]=o.fireWith}),n.promise(s),i&&i.call(s,s),s},when:function(i){var e=arguments.length,t=e,n=Array(t),s=Bi.call(arguments),r=B.Deferred(),a=function(o){return function(l){n[o]=this,s[o]=arguments.length>1?Bi.call(arguments):l,--e||r.resolveWith(n,s)}};if(e<=1&&(Dc(i,r.done(a(t)).resolve,r.reject,!e),r.state()==="pending"||Ze(s[t]&&s[t].then)))return r.then();for(;t--;)Dc(s[t],a(t),r.reject);return r.promise()}});var k0=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;B.Deferred.exceptionHook=function(i,e){window.console&&window.console.warn&&i&&k0.test(i.name)&&window.console.warn("jQuery.Deferred exception: "+i.message,i.stack,e)};B.readyException=function(i){window.setTimeout(function(){throw i})};var ic=B.Deferred();B.fn.ready=function(i){return ic.then(i).catch(function(e){B.readyException(e)}),this};B.extend({isReady:!1,readyWait:1,ready:function(i){(i===!0?--B.readyWait:B.isReady)||(B.isReady=!0,!(i!==!0&&--B.readyWait>0)&&ic.resolveWith(Ye,[B]))}});B.ready.then=ic.then;function ws(){Ye.removeEventListener("DOMContentLoaded",ws),window.removeEventListener("load",ws),B.ready()}Ye.readyState==="complete"||Ye.readyState!=="loading"&&!Ye.documentElement.doScroll?window.setTimeout(B.ready):(Ye.addEventListener("DOMContentLoaded",ws),window.addEventListener("load",ws));var mi=function(i,e,t,n,s,r,a){var o=0,l=i.length,c=t==null;if(In(t)==="object"){s=!0;for(o in t)mi(i,e,o,t[o],!0,r,a)}else if(n!==void 0&&(s=!0,Ze(n)||(a=!0),c&&(a?(e.call(i,n),e=null):(c=e,e=function(h,d,f){return c.call(B(h),f)})),e))for(;o<l;o++)e(i[o],t,a?n:n.call(i[o],o,e(i[o],t)));return s?i:c?e.call(i):l?e(i[0],t):r},S0=/^-ms-/,C0=/-([a-z])/g;function E0(i,e){return e.toUpperCase()}function gi(i){return i.replace(S0,"ms-").replace(C0,E0)}var vs=function(i){return i.nodeType===1||i.nodeType===9||!+i.nodeType};function Rr(){this.expando=B.expando+Rr.uid++}Rr.uid=1;Rr.prototype={cache:function(i){var e=i[this.expando];return e||(e={},vs(i)&&(i.nodeType?i[this.expando]=e:Object.defineProperty(i,this.expando,{value:e,configurable:!0}))),e},set:function(i,e,t){var n,s=this.cache(i);if(typeof e=="string")s[gi(e)]=t;else for(n in e)s[gi(n)]=e[n];return s},get:function(i,e){return e===void 0?this.cache(i):i[this.expando]&&i[this.expando][gi(e)]},access:function(i,e,t){return e===void 0||e&&typeof e=="string"&&t===void 0?this.get(i,e):(this.set(i,e,t),t!==void 0?t:e)},remove:function(i,e){var t,n=i[this.expando];if(n!==void 0){if(e!==void 0)for(Array.isArray(e)?e=e.map(gi):(e=gi(e),e=e in n?[e]:e.match(Hi)||[]),t=e.length;t--;)delete n[e[t]];(e===void 0||B.isEmptyObject(n))&&(i.nodeType?i[this.expando]=void 0:delete i[this.expando])}},hasData:function(i){var e=i[this.expando];return e!==void 0&&!B.isEmptyObject(e)}};var qe=new Rr,Rt=new Rr,A0=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,T0=/[A-Z]/g;function M0(i){return i==="true"?!0:i==="false"?!1:i==="null"?null:i===+i+""?+i:A0.test(i)?JSON.parse(i):i}function Oc(i,e,t){var n;if(t===void 0&&i.nodeType===1)if(n="data-"+e.replace(T0,"-$&").toLowerCase(),t=i.getAttribute(n),typeof t=="string"){try{t=M0(t)}catch{}Rt.set(i,e,t)}else t=void 0;return t}B.extend({hasData:function(i){return Rt.hasData(i)||qe.hasData(i)},data:function(i,e,t){return Rt.access(i,e,t)},removeData:function(i,e){Rt.remove(i,e)},_data:function(i,e,t){return qe.access(i,e,t)},_removeData:function(i,e){qe.remove(i,e)}});B.fn.extend({data:function(i,e){var t,n,s,r=this[0],a=r&&r.attributes;if(i===void 0){if(this.length&&(s=Rt.get(r),r.nodeType===1&&!qe.get(r,"hasDataAttrs"))){for(t=a.length;t--;)a[t]&&(n=a[t].name,n.indexOf("data-")===0&&(n=gi(n.slice(5)),Oc(r,n,s[n])));qe.set(r,"hasDataAttrs",!0)}return s}return typeof i=="object"?this.each(function(){Rt.set(this,i)}):mi(this,function(o){var l;if(r&&o===void 0)return l=Rt.get(r,i),l!==void 0||(l=Oc(r,i),l!==void 0)?l:void 0;this.each(function(){Rt.set(this,i,o)})},null,e,arguments.length>1,null,!0)},removeData:function(i){return this.each(function(){Rt.remove(this,i)})}});B.extend({queue:function(i,e,t){var n;if(i)return e=(e||"fx")+"queue",n=qe.get(i,e),t&&(!n||Array.isArray(t)?n=qe.access(i,e,B.makeArray(t)):n.push(t)),n||[]},dequeue:function(i,e){e=e||"fx";var t=B.queue(i,e),n=t.length,s=t.shift(),r=B._queueHooks(i,e),a=function(){B.dequeue(i,e)};s==="inprogress"&&(s=t.shift(),n--),s&&(e==="fx"&&t.unshift("inprogress"),delete r.stop,s.call(i,a,r)),!n&&r&&r.empty.fire()},_queueHooks:function(i,e){var t=e+"queueHooks";return qe.get(i,t)||qe.access(i,t,{empty:B.Callbacks("once memory").add(function(){qe.remove(i,[e+"queue",t])})})}});B.fn.extend({queue:function(i,e){var t=2;return typeof i!="string"&&(e=i,i="fx",t--),arguments.length<t?B.queue(this[0],i):e===void 0?this:this.each(function(){var n=B.queue(this,i,e);B._queueHooks(this,i),i==="fx"&&n[0]!=="inprogress"&&B.dequeue(this,i)})},dequeue:function(i){return this.each(function(){B.dequeue(this,i)})},clearQueue:function(i){return this.queue(i||"fx",[])},promise:function(i,e){var t,n=1,s=B.Deferred(),r=this,a=this.length,o=function(){--n||s.resolveWith(r,[r])};for(typeof i!="string"&&(e=i,i=void 0),i=i||"fx";a--;)t=qe.get(r[a],i+"queueHooks"),t&&t.empty&&(n++,t.empty.add(o));return o(),s.promise(e)}});var xp=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ga=new RegExp("^(?:([+-])=|)("+xp+")([a-z%]*)$","i"),_i=["Top","Right","Bottom","Left"],kp=function(i,e){return i=e||i,i.style.display==="none"||i.style.display===""&&B.contains(i.ownerDocument,i)&&B.css(i,"display")==="none"},Sp=function(i,e,t,n){var s,r,a={};for(r in e)a[r]=i.style[r],i.style[r]=e[r];s=t.apply(i,n||[]);for(r in e)i.style[r]=a[r];return s};function R0(i,e,t,n){var s,r,a=20,o=n?function(){return n.cur()}:function(){return B.css(i,e,"")},l=o(),c=t&&t[3]||(B.cssNumber[e]?"":"px"),h=(B.cssNumber[e]||c!=="px"&&+l)&&ga.exec(B.css(i,e));if(h&&h[3]!==c){for(l=l/2,c=c||h[3],h=+l||1;a--;)B.style(i,e,h+c),(1-r)*(1-(r=o()/l||.5))<=0&&(a=0),h=h/r;h=h*2,B.style(i,e,h+c),t=t||[]}return t&&(h=+h||+l||0,s=t[1]?h+(t[1]+1)*t[2]:+t[2],n&&(n.unit=c,n.start=h,n.end=s)),s}var Bc={};function I0(i){var e,t=i.ownerDocument,n=i.nodeName,s=Bc[n];return s||(e=t.body.appendChild(t.createElement(n)),s=B.css(e,"display"),e.parentNode.removeChild(e),s==="none"&&(s="block"),Bc[n]=s,s)}function Pc(i,e){for(var t,n,s=[],r=0,a=i.length;r<a;r++)n=i[r],n.style&&(t=n.style.display,e?(t==="none"&&(s[r]=qe.get(n,"display")||null,s[r]||(n.style.display="")),n.style.display===""&&kp(n)&&(s[r]=I0(n))):t!=="none"&&(s[r]="none",qe.set(n,"display",t)));for(r=0;r<a;r++)s[r]!=null&&(i[r].style.display=s[r]);return i}B.fn.extend({show:function(){return Pc(this,!0)},hide:function(){return Pc(this)},toggle:function(i){return typeof i=="boolean"?i?this.show():this.hide():this.each(function(){kp(this)?B(this).show():B(this).hide()})}});var Cp=/^(?:checkbox|radio)$/i,Ep=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,Ap=/^$|^module$|\/(?:java|ecma)script/i,zt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};zt.optgroup=zt.option;zt.tbody=zt.tfoot=zt.colgroup=zt.caption=zt.thead;zt.th=zt.td;function Mt(i,e){var t;return typeof i.getElementsByTagName<"u"?t=i.getElementsByTagName(e||"*"):typeof i.querySelectorAll<"u"?t=i.querySelectorAll(e||"*"):t=[],e===void 0||e&&ai(i,e)?B.merge([i],t):t}function nc(i,e){for(var t=0,n=i.length;t<n;t++)qe.set(i[t],"globalEval",!e||qe.get(e[t],"globalEval"))}var L0=/<|&#?\w+;/;function Tp(i,e,t,n,s){for(var r,a,o,l,c,h,d=e.createDocumentFragment(),f=[],u=0,g=i.length;u<g;u++)if(r=i[u],r||r===0)if(In(r)==="object")B.merge(f,r.nodeType?[r]:r);else if(!L0.test(r))f.push(e.createTextNode(r));else{for(a=a||d.appendChild(e.createElement("div")),o=(Ep.exec(r)||["",""])[1].toLowerCase(),l=zt[o]||zt._default,a.innerHTML=l[1]+B.htmlPrefilter(r)+l[2],h=l[0];h--;)a=a.lastChild;B.merge(f,a.childNodes),a=d.firstChild,a.textContent=""}for(d.textContent="",u=0;r=f[u++];){if(n&&B.inArray(r,n)>-1){s&&s.push(r);continue}if(c=B.contains(r.ownerDocument,r),a=Mt(d.appendChild(r),"script"),c&&nc(a),t)for(h=0;r=a[h++];)Ap.test(r.type||"")&&t.push(r)}return d}(function(){var i=Ye.createDocumentFragment(),e=i.appendChild(Ye.createElement("div")),t=Ye.createElement("input");t.setAttribute("type","radio"),t.setAttribute("checked","checked"),t.setAttribute("name","t"),e.appendChild(t),lt.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",lt.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue})();var _s=Ye.documentElement,N0=/^key/,F0=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,zc=/^([^.]*)(?:\.(.+)|)/;function os(){return!0}function _n(){return!1}function Hc(){try{return Ye.activeElement}catch{}}function Io(i,e,t,n,s,r){var a,o;if(typeof e=="object"){typeof t!="string"&&(n=n||t,t=void 0);for(o in e)Io(i,o,t,n,e[o],r);return i}if(n==null&&s==null?(s=t,n=t=void 0):s==null&&(typeof t=="string"?(s=n,n=void 0):(s=n,n=t,t=void 0)),s===!1)s=_n;else if(!s)return i;return r===1&&(a=s,s=function(l){return B().off(l),a.apply(this,arguments)},s.guid=a.guid||(a.guid=B.guid++)),i.each(function(){B.event.add(this,e,s,n,t)})}B.event={global:{},add:function(i,e,t,n,s){var r,a,o,l,c,h,d,f,u,g,_,b=qe.get(i);if(b)for(t.handler&&(r=t,t=r.handler,s=r.selector),s&&B.find.matchesSelector(_s,s),t.guid||(t.guid=B.guid++),(l=b.events)||(l=b.events={}),(a=b.handle)||(a=b.handle=function(w){return typeof B<"u"&&B.event.triggered!==w.type?B.event.dispatch.apply(i,arguments):void 0}),e=(e||"").match(Hi)||[""],c=e.length;c--;)o=zc.exec(e[c])||[],u=_=o[1],g=(o[2]||"").split(".").sort(),u&&(d=B.event.special[u]||{},u=(s?d.delegateType:d.bindType)||u,d=B.event.special[u]||{},h=B.extend({type:u,origType:_,data:n,handler:t,guid:t.guid,selector:s,needsContext:s&&B.expr.match.needsContext.test(s),namespace:g.join(".")},r),(f=l[u])||(f=l[u]=[],f.delegateCount=0,(!d.setup||d.setup.call(i,n,g,a)===!1)&&i.addEventListener&&i.addEventListener(u,a)),d.add&&(d.add.call(i,h),h.handler.guid||(h.handler.guid=t.guid)),s?f.splice(f.delegateCount++,0,h):f.push(h),B.event.global[u]=!0)},remove:function(i,e,t,n,s){var r,a,o,l,c,h,d,f,u,g,_,b=qe.hasData(i)&&qe.get(i);if(!(!b||!(l=b.events))){for(e=(e||"").match(Hi)||[""],c=e.length;c--;){if(o=zc.exec(e[c])||[],u=_=o[1],g=(o[2]||"").split(".").sort(),!u){for(u in l)B.event.remove(i,u+e[c],t,n,!0);continue}for(d=B.event.special[u]||{},u=(n?d.delegateType:d.bindType)||u,f=l[u]||[],o=o[2]&&new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=r=f.length;r--;)h=f[r],(s||_===h.origType)&&(!t||t.guid===h.guid)&&(!o||o.test(h.namespace))&&(!n||n===h.selector||n==="**"&&h.selector)&&(f.splice(r,1),h.selector&&f.delegateCount--,d.remove&&d.remove.call(i,h));a&&!f.length&&((!d.teardown||d.teardown.call(i,g,b.handle)===!1)&&B.removeEvent(i,u,b.handle),delete l[u])}B.isEmptyObject(l)&&qe.remove(i,"handle events")}},dispatch:function(i){var e=B.event.fix(i),t,n,s,r,a,o,l=new Array(arguments.length),c=(qe.get(this,"events")||{})[e.type]||[],h=B.event.special[e.type]||{};for(l[0]=e,t=1;t<arguments.length;t++)l[t]=arguments[t];if(e.delegateTarget=this,!(h.preDispatch&&h.preDispatch.call(this,e)===!1)){for(o=B.event.handlers.call(this,e,c),t=0;(r=o[t++])&&!e.isPropagationStopped();)for(e.currentTarget=r.elem,n=0;(a=r.handlers[n++])&&!e.isImmediatePropagationStopped();)(!e.rnamespace||e.rnamespace.test(a.namespace))&&(e.handleObj=a,e.data=a.data,s=((B.event.special[a.origType]||{}).handle||a.handler).apply(r.elem,l),s!==void 0&&(e.result=s)===!1&&(e.preventDefault(),e.stopPropagation()));return h.postDispatch&&h.postDispatch.call(this,e),e.result}},handlers:function(i,e){var t,n,s,r,a,o=[],l=e.delegateCount,c=i.target;if(l&&c.nodeType&&!(i.type==="click"&&i.button>=1)){for(;c!==this;c=c.parentNode||this)if(c.nodeType===1&&!(i.type==="click"&&c.disabled===!0)){for(r=[],a={},t=0;t<l;t++)n=e[t],s=n.selector+" ",a[s]===void 0&&(a[s]=n.needsContext?B(s,this).index(c)>-1:B.find(s,this,null,[c]).length),a[s]&&r.push(n);r.length&&o.push({elem:c,handlers:r})}}return c=this,l<e.length&&o.push({elem:c,handlers:e.slice(l)}),o},addProp:function(i,e){Object.defineProperty(B.Event.prototype,i,{enumerable:!0,configurable:!0,get:Ze(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[i]},set:function(t){Object.defineProperty(this,i,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(i){return i[B.expando]?i:new B.Event(i)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==Hc()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===Hc()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(this.type==="checkbox"&&this.click&&ai(this,"input"))return this.click(),!1},_default:function(i){return ai(i.target,"a")}},beforeunload:{postDispatch:function(i){i.result!==void 0&&i.originalEvent&&(i.originalEvent.returnValue=i.result)}}}};B.removeEvent=function(i,e,t){i.removeEventListener&&i.removeEventListener(e,t)};B.Event=function(i,e){if(!(this instanceof B.Event))return new B.Event(i,e);i&&i.type?(this.originalEvent=i,this.type=i.type,this.isDefaultPrevented=i.defaultPrevented||i.defaultPrevented===void 0&&i.returnValue===!1?os:_n,this.target=i.target&&i.target.nodeType===3?i.target.parentNode:i.target,this.currentTarget=i.currentTarget,this.relatedTarget=i.relatedTarget):this.type=i,e&&B.extend(this,e),this.timeStamp=i&&i.timeStamp||Date.now(),this[B.expando]=!0};B.Event.prototype={constructor:B.Event,isDefaultPrevented:_n,isPropagationStopped:_n,isImmediatePropagationStopped:_n,isSimulated:!1,preventDefault:function(){var i=this.originalEvent;this.isDefaultPrevented=os,i&&!this.isSimulated&&i.preventDefault()},stopPropagation:function(){var i=this.originalEvent;this.isPropagationStopped=os,i&&!this.isSimulated&&i.stopPropagation()},stopImmediatePropagation:function(){var i=this.originalEvent;this.isImmediatePropagationStopped=os,i&&!this.isSimulated&&i.stopImmediatePropagation(),this.stopPropagation()}};B.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(i){var e=i.button;return i.which==null&&N0.test(i.type)?i.charCode!=null?i.charCode:i.keyCode:!i.which&&e!==void 0&&F0.test(i.type)?e&1?1:e&2?3:e&4?2:0:i.which}},B.event.addProp);B.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(i,e){B.event.special[i]={delegateType:e,bindType:e,handle:function(t){var n,s=this,r=t.relatedTarget,a=t.handleObj;return(!r||r!==s&&!B.contains(s,r))&&(t.type=a.origType,n=a.handler.apply(this,arguments),t.type=e),n}}});B.fn.extend({on:function(i,e,t,n){return Io(this,i,e,t,n)},one:function(i,e,t,n){return Io(this,i,e,t,n,1)},off:function(i,e,t){var n,s;if(i&&i.preventDefault&&i.handleObj)return n=i.handleObj,B(i.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if(typeof i=="object"){for(s in i)this.off(s,e,i[s]);return this}return(e===!1||typeof e=="function")&&(t=e,e=void 0),t===!1&&(t=_n),this.each(function(){B.event.remove(this,i,t,e)})}});var D0=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,O0=/<script|<style|<link/i,B0=/checked\s*(?:[^=]|=\s*.checked.)/i,P0=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Uc(i,e){return ai(i,"table")&&ai(e.nodeType!==11?e:e.firstChild,"tr")&&B(i).children("tbody")[0]||i}function z0(i){return i.type=(i.getAttribute("type")!==null)+"/"+i.type,i}function H0(i){return(i.type||"").slice(0,5)==="true/"?i.type=i.type.slice(5):i.removeAttribute("type"),i}function $c(i,e){var t,n,s,r,a,o,l,c;if(e.nodeType===1){if(qe.hasData(i)&&(r=qe.access(i),a=qe.set(e,r),c=r.events,c)){delete a.handle,a.events={};for(s in c)for(t=0,n=c[s].length;t<n;t++)B.event.add(e,s,c[s][t])}Rt.hasData(i)&&(o=Rt.access(i),l=B.extend({},o),Rt.set(e,l))}}function U0(i,e){var t=e.nodeName.toLowerCase();t==="input"&&Cp.test(i.type)?e.checked=i.checked:(t==="input"||t==="textarea")&&(e.defaultValue=i.defaultValue)}function mn(i,e,t,n){e=pp.apply([],e);var s,r,a,o,l,c,h=0,d=i.length,f=d-1,u=e[0],g=Ze(u);if(g||d>1&&typeof u=="string"&&!lt.checkClone&&B0.test(u))return i.each(function(_){var b=i.eq(_);g&&(e[0]=u.call(this,_,b.html())),mn(b,e,t,n)});if(d&&(s=Tp(e,i[0].ownerDocument,!1,i,n),r=s.firstChild,s.childNodes.length===1&&(s=r),r||n)){for(a=B.map(Mt(s,"script"),z0),o=a.length;h<d;h++)l=s,h!==f&&(l=B.clone(l,!0,!0),o&&B.merge(a,Mt(l,"script"))),t.call(i[h],l,h);if(o)for(c=a[a.length-1].ownerDocument,B.map(a,H0),h=0;h<o;h++)l=a[h],Ap.test(l.type||"")&&!qe.access(l,"globalEval")&&B.contains(c,l)&&(l.src&&(l.type||"").toLowerCase()!=="module"?B._evalUrl&&B._evalUrl(l.src):bp(l.textContent.replace(P0,""),c,l))}return i}function Vc(i,e,t){for(var n,s=e?B.filter(e,i):i,r=0;(n=s[r])!=null;r++)!t&&n.nodeType===1&&B.cleanData(Mt(n)),n.parentNode&&(t&&B.contains(n.ownerDocument,n)&&nc(Mt(n,"script")),n.parentNode.removeChild(n));return i}B.extend({htmlPrefilter:function(i){return i.replace(D0,"<$1></$2>")},clone:function(i,e,t){var n,s,r,a,o=i.cloneNode(!0),l=B.contains(i.ownerDocument,i);if(!lt.noCloneChecked&&(i.nodeType===1||i.nodeType===11)&&!B.isXMLDoc(i))for(a=Mt(o),r=Mt(i),n=0,s=r.length;n<s;n++)U0(r[n],a[n]);if(e)if(t)for(r=r||Mt(i),a=a||Mt(o),n=0,s=r.length;n<s;n++)$c(r[n],a[n]);else $c(i,o);return a=Mt(o,"script"),a.length>0&&nc(a,!l&&Mt(i,"script")),o},cleanData:function(i){for(var e,t,n,s=B.event.special,r=0;(t=i[r])!==void 0;r++)if(vs(t)){if(e=t[qe.expando]){if(e.events)for(n in e.events)s[n]?B.event.remove(t,n):B.removeEvent(t,n,e.handle);t[qe.expando]=void 0}t[Rt.expando]&&(t[Rt.expando]=void 0)}}});B.fn.extend({detach:function(i){return Vc(this,i,!0)},remove:function(i){return Vc(this,i)},text:function(i){return mi(this,function(e){return e===void 0?B.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=e)})},null,i,arguments.length)},append:function(){return mn(this,arguments,function(i){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var e=Uc(this,i);e.appendChild(i)}})},prepend:function(){return mn(this,arguments,function(i){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var e=Uc(this,i);e.insertBefore(i,e.firstChild)}})},before:function(){return mn(this,arguments,function(i){this.parentNode&&this.parentNode.insertBefore(i,this)})},after:function(){return mn(this,arguments,function(i){this.parentNode&&this.parentNode.insertBefore(i,this.nextSibling)})},empty:function(){for(var i,e=0;(i=this[e])!=null;e++)i.nodeType===1&&(B.cleanData(Mt(i,!1)),i.textContent="");return this},clone:function(i,e){return i=i??!1,e=e??i,this.map(function(){return B.clone(this,i,e)})},html:function(i){return mi(this,function(e){var t=this[0]||{},n=0,s=this.length;if(e===void 0&&t.nodeType===1)return t.innerHTML;if(typeof e=="string"&&!O0.test(e)&&!zt[(Ep.exec(e)||["",""])[1].toLowerCase()]){e=B.htmlPrefilter(e);try{for(;n<s;n++)t=this[n]||{},t.nodeType===1&&(B.cleanData(Mt(t,!1)),t.innerHTML=e);t=0}catch{}}t&&this.empty().append(e)},null,i,arguments.length)},replaceWith:function(){var i=[];return mn(this,arguments,function(e){var t=this.parentNode;B.inArray(this,i)<0&&(B.cleanData(Mt(this)),t&&t.replaceChild(e,this))},i)}});B.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(i,e){B.fn[i]=function(t){for(var n,s=[],r=B(t),a=r.length-1,o=0;o<=a;o++)n=o===a?this:this.clone(!0),B(r[o])[e](n),tc.apply(s,n.get());return this.pushStack(s)}});var rc=new RegExp("^("+xp+")(?!px)[a-z%]+$","i"),ma=function(i){var e=i.ownerDocument.defaultView;return(!e||!e.opener)&&(e=window),e.getComputedStyle(i)},$0=new RegExp(_i.join("|"),"i");(function(){function i(){if(l){o.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",_s.appendChild(o).appendChild(l);var c=window.getComputedStyle(l);t=c.top!=="1%",a=e(c.marginLeft)===12,l.style.right="60%",r=e(c.right)===36,n=e(c.width)===36,l.style.position="absolute",s=l.offsetWidth===36||"absolute",_s.removeChild(o),l=null}}function e(c){return Math.round(parseFloat(c))}var t,n,s,r,a,o=Ye.createElement("div"),l=Ye.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",lt.clearCloneStyle=l.style.backgroundClip==="content-box",B.extend(lt,{boxSizingReliable:function(){return i(),n},pixelBoxStyles:function(){return i(),r},pixelPosition:function(){return i(),t},reliableMarginLeft:function(){return i(),a},scrollboxSize:function(){return i(),s}}))})();function ur(i,e,t){var n,s,r,a,o=i.style;return t=t||ma(i),t&&(a=t.getPropertyValue(e)||t[e],a===""&&!B.contains(i.ownerDocument,i)&&(a=B.style(i,e)),!lt.pixelBoxStyles()&&rc.test(a)&&$0.test(e)&&(n=o.width,s=o.minWidth,r=o.maxWidth,o.minWidth=o.maxWidth=o.width=a,a=t.width,o.width=n,o.minWidth=s,o.maxWidth=r)),a!==void 0?a+"":a}function Mp(i,e){return{get:function(){if(i()){delete this.get;return}return(this.get=e).apply(this,arguments)}}}var V0=/^(none|table(?!-c[ea]).+)/,qc=/^--/,q0={position:"absolute",visibility:"hidden",display:"block"},Wc={letterSpacing:"0",fontWeight:"400"},jc=["Webkit","Moz","ms"],Gc=Ye.createElement("div").style;function W0(i){if(i in Gc)return i;for(var e=i[0].toUpperCase()+i.slice(1),t=jc.length;t--;)if(i=jc[t]+e,i in Gc)return i}function Zc(i){var e=B.cssProps[i];return e||(e=B.cssProps[i]=W0(i)||i),e}function Rp(i,e,t){var n=ga.exec(e);return n?Math.max(0,n[2]-(t||0))+(n[3]||"px"):e}function Lo(i,e,t,n,s,r){var a=e==="width"?1:0,o=0,l=0;if(t===(n?"border":"content"))return 0;for(;a<4;a+=2)t==="margin"&&(l+=B.css(i,t+_i[a],!0,s)),n?(t==="content"&&(l-=B.css(i,"padding"+_i[a],!0,s)),t!=="margin"&&(l-=B.css(i,"border"+_i[a]+"Width",!0,s))):(l+=B.css(i,"padding"+_i[a],!0,s),t!=="padding"?l+=B.css(i,"border"+_i[a]+"Width",!0,s):o+=B.css(i,"border"+_i[a]+"Width",!0,s));return!n&&r>=0&&(l+=Math.max(0,Math.ceil(i["offset"+e[0].toUpperCase()+e.slice(1)]-r-l-o-.5))),l}function Xc(i,e,t){var n=ma(i),s=ur(i,e,n),r=B.css(i,"boxSizing",!1,n)==="border-box",a=r;if(rc.test(s)){if(!t)return s;s="auto"}return a=a&&(lt.boxSizingReliable()||s===i.style[e]),(s==="auto"||!parseFloat(s)&&B.css(i,"display",!1,n)==="inline")&&(s=i["offset"+e[0].toUpperCase()+e.slice(1)],a=!0),s=parseFloat(s)||0,s+Lo(i,e,t||(r?"border":"content"),a,n,s)+"px"}B.extend({cssHooks:{opacity:{get:function(i,e){if(e){var t=ur(i,"opacity");return t===""?"1":t}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(i,e,t,n){if(!(!i||i.nodeType===3||i.nodeType===8||!i.style)){var s,r,a,o=gi(e),l=qc.test(e),c=i.style;if(l||(e=Zc(o)),a=B.cssHooks[e]||B.cssHooks[o],t!==void 0){if(r=typeof t,r==="string"&&(s=ga.exec(t))&&s[1]&&(t=R0(i,e,s),r="number"),t==null||t!==t)return;r==="number"&&(t+=s&&s[3]||(B.cssNumber[o]?"":"px")),!lt.clearCloneStyle&&t===""&&e.indexOf("background")===0&&(c[e]="inherit"),(!a||!("set"in a)||(t=a.set(i,t,n))!==void 0)&&(l?c.setProperty(e,t):c[e]=t)}else return a&&"get"in a&&(s=a.get(i,!1,n))!==void 0?s:c[e]}},css:function(i,e,t,n){var s,r,a,o=gi(e),l=qc.test(e);return l||(e=Zc(o)),a=B.cssHooks[e]||B.cssHooks[o],a&&"get"in a&&(s=a.get(i,!0,t)),s===void 0&&(s=ur(i,e,n)),s==="normal"&&e in Wc&&(s=Wc[e]),t===""||t?(r=parseFloat(s),t===!0||isFinite(r)?r||0:s):s}});B.each(["height","width"],function(i,e){B.cssHooks[e]={get:function(t,n,s){if(n)return V0.test(B.css(t,"display"))&&(!t.getClientRects().length||!t.getBoundingClientRect().width)?Sp(t,q0,function(){return Xc(t,e,s)}):Xc(t,e,s)},set:function(t,n,s){var r,a=ma(t),o=B.css(t,"boxSizing",!1,a)==="border-box",l=s&&Lo(t,e,s,o,a);return o&&lt.scrollboxSize()===a.position&&(l-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(a[e])-Lo(t,e,"border",!1,a)-.5)),l&&(r=ga.exec(n))&&(r[3]||"px")!=="px"&&(t.style[e]=n,n=B.css(t,e)),Rp(t,n,l)}}});B.cssHooks.marginLeft=Mp(lt.reliableMarginLeft,function(i,e){if(e)return(parseFloat(ur(i,"marginLeft"))||i.getBoundingClientRect().left-Sp(i,{marginLeft:0},function(){return i.getBoundingClientRect().left}))+"px"});B.each({margin:"",padding:"",border:"Width"},function(i,e){B.cssHooks[i+e]={expand:function(t){for(var n=0,s={},r=typeof t=="string"?t.split(" "):[t];n<4;n++)s[i+_i[n]+e]=r[n]||r[n-2]||r[0];return s}},i!=="margin"&&(B.cssHooks[i+e].set=Rp)});B.fn.extend({css:function(i,e){return mi(this,function(t,n,s){var r,a,o={},l=0;if(Array.isArray(n)){for(r=ma(t),a=n.length;l<a;l++)o[n[l]]=B.css(t,n[l],!1,r);return o}return s!==void 0?B.style(t,n,s):B.css(t,n)},i,e,arguments.length>1)}});B.fn.delay=function(i,e){return i=B.fx&&B.fx.speeds[i]||i,e=e||"fx",this.queue(e,function(t,n){var s=window.setTimeout(t,i);n.stop=function(){window.clearTimeout(s)}})};(function(){var i=Ye.createElement("input"),e=Ye.createElement("select"),t=e.appendChild(Ye.createElement("option"));i.type="checkbox",lt.checkOn=i.value!=="",lt.optSelected=t.selected,i=Ye.createElement("input"),i.value="t",i.type="radio",lt.radioValue=i.value==="t"})();var Ip,Hn=B.expr.attrHandle;B.fn.extend({attr:function(i,e){return mi(this,B.attr,i,e,arguments.length>1)},removeAttr:function(i){return this.each(function(){B.removeAttr(this,i)})}});B.extend({attr:function(i,e,t){var n,s,r=i.nodeType;if(!(r===3||r===8||r===2)){if(typeof i.getAttribute>"u")return B.prop(i,e,t);if((r!==1||!B.isXMLDoc(i))&&(s=B.attrHooks[e.toLowerCase()]||(B.expr.match.bool.test(e)?Ip:void 0)),t!==void 0){if(t===null){B.removeAttr(i,e);return}return s&&"set"in s&&(n=s.set(i,t,e))!==void 0?n:(i.setAttribute(e,t+""),t)}return s&&"get"in s&&(n=s.get(i,e))!==null?n:(n=B.find.attr(i,e),n??void 0)}},attrHooks:{type:{set:function(i,e){if(!lt.radioValue&&e==="radio"&&ai(i,"input")){var t=i.value;return i.setAttribute("type",e),t&&(i.value=t),e}}}},removeAttr:function(i,e){var t,n=0,s=e&&e.match(Hi);if(s&&i.nodeType===1)for(;t=s[n++];)i.removeAttribute(t)}});Ip={set:function(i,e,t){return e===!1?B.removeAttr(i,t):i.setAttribute(t,t),t}};B.each(B.expr.match.bool.source.match(/\w+/g),function(i,e){var t=Hn[e]||B.find.attr;Hn[e]=function(n,s,r){var a,o,l=s.toLowerCase();return r||(o=Hn[l],Hn[l]=a,a=t(n,s,r)!=null?l:null,Hn[l]=o),a}});var j0=/^(?:input|select|textarea|button)$/i,G0=/^(?:a|area)$/i;B.fn.extend({prop:function(i,e){return mi(this,B.prop,i,e,arguments.length>1)},removeProp:function(i){return this.each(function(){delete this[B.propFix[i]||i]})}});B.extend({prop:function(i,e,t){var n,s,r=i.nodeType;if(!(r===3||r===8||r===2))return(r!==1||!B.isXMLDoc(i))&&(e=B.propFix[e]||e,s=B.propHooks[e]),t!==void 0?s&&"set"in s&&(n=s.set(i,t,e))!==void 0?n:i[e]=t:s&&"get"in s&&(n=s.get(i,e))!==null?n:i[e]},propHooks:{tabIndex:{get:function(i){var e=B.find.attr(i,"tabindex");return e?parseInt(e,10):j0.test(i.nodeName)||G0.test(i.nodeName)&&i.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}});lt.optSelected||(B.propHooks.selected={get:function(i){var e=i.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(i){var e=i.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}});B.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){B.propFix[this.toLowerCase()]=this});function bn(i){var e=i.match(Hi)||[];return e.join(" ")}function Ri(i){return i.getAttribute&&i.getAttribute("class")||""}function Ra(i){return Array.isArray(i)?i:typeof i=="string"?i.match(Hi)||[]:[]}B.fn.extend({addClass:function(i){var e,t,n,s,r,a,o,l=0;if(Ze(i))return this.each(function(c){B(this).addClass(i.call(this,c,Ri(this)))});if(e=Ra(i),e.length){for(;t=this[l++];)if(s=Ri(t),n=t.nodeType===1&&" "+bn(s)+" ",n){for(a=0;r=e[a++];)n.indexOf(" "+r+" ")<0&&(n+=r+" ");o=bn(n),s!==o&&t.setAttribute("class",o)}}return this},removeClass:function(i){var e,t,n,s,r,a,o,l=0;if(Ze(i))return this.each(function(c){B(this).removeClass(i.call(this,c,Ri(this)))});if(!arguments.length)return this.attr("class","");if(e=Ra(i),e.length){for(;t=this[l++];)if(s=Ri(t),n=t.nodeType===1&&" "+bn(s)+" ",n){for(a=0;r=e[a++];)for(;n.indexOf(" "+r+" ")>-1;)n=n.replace(" "+r+" "," ");o=bn(n),s!==o&&t.setAttribute("class",o)}}return this},toggleClass:function(i,e){var t=typeof i,n=t==="string"||Array.isArray(i);return typeof e=="boolean"&&n?e?this.addClass(i):this.removeClass(i):Ze(i)?this.each(function(s){B(this).toggleClass(i.call(this,s,Ri(this),e),e)}):this.each(function(){var s,r,a,o;if(n)for(r=0,a=B(this),o=Ra(i);s=o[r++];)a.hasClass(s)?a.removeClass(s):a.addClass(s);else(i===void 0||t==="boolean")&&(s=Ri(this),s&&qe.set(this,"__className__",s),this.setAttribute&&this.setAttribute("class",s||i===!1?"":qe.get(this,"__className__")||""))})},hasClass:function(i){var e,t,n=0;for(e=" "+i+" ";t=this[n++];)if(t.nodeType===1&&(" "+bn(Ri(t))+" ").indexOf(e)>-1)return!0;return!1}});var Z0=/\r/g;B.fn.extend({val:function(i){var e,t,n,s=this[0];return arguments.length?(n=Ze(i),this.each(function(r){var a;this.nodeType===1&&(n?a=i.call(this,r,B(this).val()):a=i,a==null?a="":typeof a=="number"?a+="":Array.isArray(a)&&(a=B.map(a,function(o){return o==null?"":o+""})),e=B.valHooks[this.type]||B.valHooks[this.nodeName.toLowerCase()],(!e||!("set"in e)||e.set(this,a,"value")===void 0)&&(this.value=a))})):s?(e=B.valHooks[s.type]||B.valHooks[s.nodeName.toLowerCase()],e&&"get"in e&&(t=e.get(s,"value"))!==void 0?t:(t=s.value,typeof t=="string"?t.replace(Z0,""):t??"")):void 0}});B.extend({valHooks:{option:{get:function(i){var e=B.find.attr(i,"value");return e??bn(B.text(i))}},select:{get:function(i){var e,t,n,s=i.options,r=i.selectedIndex,a=i.type==="select-one",o=a?null:[],l=a?r+1:s.length;for(r<0?n=l:n=a?r:0;n<l;n++)if(t=s[n],(t.selected||n===r)&&!t.disabled&&(!t.parentNode.disabled||!ai(t.parentNode,"optgroup"))){if(e=B(t).val(),a)return e;o.push(e)}return o},set:function(i,e){for(var t,n,s=i.options,r=B.makeArray(e),a=s.length;a--;)n=s[a],(n.selected=B.inArray(B.valHooks.option.get(n),r)>-1)&&(t=!0);return t||(i.selectedIndex=-1),r}}}});B.each(["radio","checkbox"],function(){B.valHooks[this]={set:function(i,e){if(Array.isArray(e))return i.checked=B.inArray(B(i).val(),e)>-1}},lt.checkOn||(B.valHooks[this].get=function(i){return i.getAttribute("value")===null?"on":i.value})});lt.focusin="onfocusin"in window;var Yc=/^(?:focusinfocus|focusoutblur)$/,Qc=function(i){i.stopPropagation()};B.extend(B.event,{trigger:function(i,e,t,n){var s,r,a,o,l,c,h,d,f=[t||Ye],u=bs.call(i,"type")?i.type:i,g=bs.call(i,"namespace")?i.namespace.split("."):[];if(r=d=a=t=t||Ye,!(t.nodeType===3||t.nodeType===8)&&!Yc.test(u+B.event.triggered)&&(u.indexOf(".")>-1&&(g=u.split("."),u=g.shift(),g.sort()),l=u.indexOf(":")<0&&"on"+u,i=i[B.expando]?i:new B.Event(u,typeof i=="object"&&i),i.isTrigger=n?2:3,i.namespace=g.join("."),i.rnamespace=i.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,i.result=void 0,i.target||(i.target=t),e=e==null?[i]:B.makeArray(e,[i]),h=B.event.special[u]||{},!(!n&&h.trigger&&h.trigger.apply(t,e)===!1))){if(!n&&!h.noBubble&&!Sn(t)){for(o=h.delegateType||u,Yc.test(o+u)||(r=r.parentNode);r;r=r.parentNode)f.push(r),a=r;a===(t.ownerDocument||Ye)&&f.push(a.defaultView||a.parentWindow||window)}for(s=0;(r=f[s++])&&!i.isPropagationStopped();)d=r,i.type=s>1?o:h.bindType||u,c=(qe.get(r,"events")||{})[i.type]&&qe.get(r,"handle"),c&&c.apply(r,e),c=l&&r[l],c&&c.apply&&vs(r)&&(i.result=c.apply(r,e),i.result===!1&&i.preventDefault());return i.type=u,!n&&!i.isDefaultPrevented()&&(!h._default||h._default.apply(f.pop(),e)===!1)&&vs(t)&&l&&Ze(t[u])&&!Sn(t)&&(a=t[l],a&&(t[l]=null),B.event.triggered=u,i.isPropagationStopped()&&d.addEventListener(u,Qc),t[u](),i.isPropagationStopped()&&d.removeEventListener(u,Qc),B.event.triggered=void 0,a&&(t[l]=a)),i.result}},simulate:function(i,e,t){var n=B.extend(new B.Event,t,{type:i,isSimulated:!0});B.event.trigger(n,null,e)}});B.fn.extend({trigger:function(i,e){return this.each(function(){B.event.trigger(i,e,this)})},triggerHandler:function(i,e){var t=this[0];if(t)return B.event.trigger(i,e,t,!0)}});lt.focusin||B.each({focus:"focusin",blur:"focusout"},function(i,e){var t=function(n){B.event.simulate(e,n.target,B.event.fix(n))};B.event.special[e]={setup:function(){var n=this.ownerDocument||this,s=qe.access(n,e);s||n.addEventListener(i,t,!0),qe.access(n,e,(s||0)+1)},teardown:function(){var n=this.ownerDocument||this,s=qe.access(n,e)-1;s?qe.access(n,e,s):(n.removeEventListener(i,t,!0),qe.remove(n,e))}}});var X0=/\[\]$/,Kc=/\r?\n/g,Y0=/^(?:submit|button|image|reset|file)$/i,Q0=/^(?:input|select|textarea|keygen)/i;function No(i,e,t,n){var s;if(Array.isArray(e))B.each(e,function(r,a){t||X0.test(i)?n(i,a):No(i+"["+(typeof a=="object"&&a!=null?r:"")+"]",a,t,n)});else if(!t&&In(e)==="object")for(s in e)No(i+"["+s+"]",e[s],t,n);else n(i,e)}B.param=function(i,e){var t,n=[],s=function(r,a){var o=Ze(a)?a():a;n[n.length]=encodeURIComponent(r)+"="+encodeURIComponent(o??"")};if(Array.isArray(i)||i.jquery&&!B.isPlainObject(i))B.each(i,function(){s(this.name,this.value)});else for(t in i)No(t,i[t],e,s);return n.join("&")};B.fn.extend({serialize:function(){return B.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var i=B.prop(this,"elements");return i?B.makeArray(i):this}).filter(function(){var i=this.type;return this.name&&!B(this).is(":disabled")&&Q0.test(this.nodeName)&&!Y0.test(i)&&(this.checked||!Cp.test(i))}).map(function(i,e){var t=B(this).val();return t==null?null:Array.isArray(t)?B.map(t,function(n){return{name:e.name,value:n.replace(Kc,`\r
`)}}):{name:e.name,value:t.replace(Kc,`\r
`)}}).get()}});B.fn.extend({wrapAll:function(i){var e;return this[0]&&(Ze(i)&&(i=i.call(this[0])),e=B(i,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this},wrapInner:function(i){return Ze(i)?this.each(function(e){B(this).wrapInner(i.call(this,e))}):this.each(function(){var e=B(this),t=e.contents();t.length?t.wrapAll(i):e.append(i)})},wrap:function(i){var e=Ze(i);return this.each(function(t){B(this).wrapAll(e?i.call(this,t):i)})},unwrap:function(i){return this.parent(i).not("body").each(function(){B(this).replaceWith(this.childNodes)}),this}});B.expr.pseudos.hidden=function(i){return!B.expr.pseudos.visible(i)};B.expr.pseudos.visible=function(i){return!!(i.offsetWidth||i.offsetHeight||i.getClientRects().length)};lt.createHTMLDocument=function(){var i=Ye.implementation.createHTMLDocument("").body;return i.innerHTML="<form></form><form></form>",i.childNodes.length===2}();B.parseHTML=function(i,e,t){if(typeof i!="string")return[];typeof e=="boolean"&&(t=e,e=!1);var n,s,r;return e||(lt.createHTMLDocument?(e=Ye.implementation.createHTMLDocument(""),n=e.createElement("base"),n.href=Ye.location.href,e.head.appendChild(n)):e=Ye),s=_p.exec(i),r=!t&&[],s?[e.createElement(s[1])]:(s=Tp([i],e,r),r&&r.length&&B(r).remove(),B.merge([],s.childNodes))};B.offset={setOffset:function(i,e,t){var n,s,r,a,o,l,c,h=B.css(i,"position"),d=B(i),f={};h==="static"&&(i.style.position="relative"),o=d.offset(),r=B.css(i,"top"),l=B.css(i,"left"),c=(h==="absolute"||h==="fixed")&&(r+l).indexOf("auto")>-1,c?(n=d.position(),a=n.top,s=n.left):(a=parseFloat(r)||0,s=parseFloat(l)||0),Ze(e)&&(e=e.call(i,t,B.extend({},o))),e.top!=null&&(f.top=e.top-o.top+a),e.left!=null&&(f.left=e.left-o.left+s),"using"in e?e.using.call(i,f):d.css(f)}};B.fn.extend({offset:function(i){if(arguments.length)return i===void 0?this:this.each(function(s){B.offset.setOffset(this,i,s)});var e,t,n=this[0];if(n)return n.getClientRects().length?(e=n.getBoundingClientRect(),t=n.ownerDocument.defaultView,{top:e.top+t.pageYOffset,left:e.left+t.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var i,e,t,n=this[0],s={top:0,left:0};if(B.css(n,"position")==="fixed")e=n.getBoundingClientRect();else{for(e=this.offset(),t=n.ownerDocument,i=n.offsetParent||t.documentElement;i&&(i===t.body||i===t.documentElement)&&B.css(i,"position")==="static";)i=i.parentNode;i&&i!==n&&i.nodeType===1&&(s=B(i).offset(),s.top+=B.css(i,"borderTopWidth",!0),s.left+=B.css(i,"borderLeftWidth",!0))}return{top:e.top-s.top-B.css(n,"marginTop",!0),left:e.left-s.left-B.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var i=this.offsetParent;i&&B.css(i,"position")==="static";)i=i.offsetParent;return i||_s})}});B.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(i,e){var t=e==="pageYOffset";B.fn[i]=function(n){return mi(this,function(s,r,a){var o;if(Sn(s)?o=s:s.nodeType===9&&(o=s.defaultView),a===void 0)return o?o[e]:s[r];o?o.scrollTo(t?o.pageXOffset:a,t?a:o.pageYOffset):s[r]=a},i,n,arguments.length)}});B.each(["top","left"],function(i,e){B.cssHooks[e]=Mp(lt.pixelPosition,function(t,n){if(n)return n=ur(t,e),rc.test(n)?B(t).position()[e]+"px":n})});B.each({Height:"height",Width:"width"},function(i,e){B.each({padding:"inner"+i,content:e,"":"outer"+i},function(t,n){B.fn[n]=function(s,r){var a=arguments.length&&(t||typeof s!="boolean"),o=t||(s===!0||r===!0?"margin":"border");return mi(this,function(l,c,h){var d;return Sn(l)?n.indexOf("outer")===0?l["inner"+i]:l.document.documentElement["client"+i]:l.nodeType===9?(d=l.documentElement,Math.max(l.body["scroll"+i],d["scroll"+i],l.body["offset"+i],d["offset"+i],d["client"+i])):h===void 0?B.css(l,c,o):B.style(l,c,h,o)},e,a?s:void 0,a)}})});B.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(i,e){B.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}});B.fn.extend({hover:function(i,e){return this.mouseenter(i).mouseleave(e||i)}});B.fn.extend({bind:function(i,e,t){return this.on(i,null,e,t)},unbind:function(i,e){return this.off(i,null,e)},delegate:function(i,e,t,n){return this.on(e,i,t,n)},undelegate:function(i,e,t){return arguments.length===1?this.off(i,"**"):this.off(e,i||"**",t)}});B.proxy=function(i,e){var t,n,s;if(typeof e=="string"&&(t=i[e],e=i,i=t),!!Ze(i))return n=Bi.call(arguments,2),s=function(){return i.apply(e||this,n.concat(Bi.call(arguments)))},s.guid=i.guid=i.guid||B.guid++,s};B.holdReady=function(i){i?B.readyWait++:B.ready(!0)};B.isArray=Array.isArray;B.parseJSON=JSON.parse;B.nodeName=ai;B.isFunction=Ze;B.isWindow=Sn;B.camelCase=gi;B.type=In;B.now=Date.now;B.isNumeric=function(i){var e=B.type(i);return(e==="number"||e==="string")&&!isNaN(i-parseFloat(i))};var pe=B;function Xe(i){return Lp("div",i)}function Lp(i,e){let t=document.createElement(i);return e&&(e.class&&t.classList.add(e.class),e.id&&(t.id=e.id),e.style&&Np(t,e.style)),t}function Dt(i){let e=getComputedStyle(i);e.display!=="none"&&(i._initialDisplay=e.display),i.style.display="none"}function ba(i){if(getComputedStyle(i).display==="none"){let t=i._initialDisplay||"block";i.style.display=t}}function K0(i){document.querySelectorAll(i).forEach(e=>{Dt(e)})}function J0(i){for(;i.firstChild;)i.removeChild(i.firstChild)}function eb(i){if(!i.getClientRects().length)return{top:0,left:0};let e=i.getBoundingClientRect(),t=i.ownerDocument.defaultView;return{top:e.top+t.pageYOffset,left:e.left+t.pageXOffset}}function tb(i){if(i.type.startsWith("touch")){let e=i.touches[0];return{x:e.pageX,y:e.pageY}}else return{x:i.pageX,y:i.pageY}}var ib=(i,e)=>{let{x:t,y:n,width:s,height:r}=i.getBoundingClientRect(),{x:a,y:o,width:l,height:c}=e.getBoundingClientRect();return{x:a-t,y:o-n,width:l,height:c}};function Np(i,e){for(let t of Object.keys(e))i.style[t]=e[t]}function nb(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}var rb=(i,{clientX:e,clientY:t})=>{let{left:n,top:s,width:r,height:a}=i.getBoundingClientRect(),o=e-n,l=t-s;return{x:o,y:l,xNormalized:o/r,yNormalized:l/a,width:r,height:a}};function Fp(i,e){let{clientX:t,clientY:n}=i;return rb(e,{clientX:t,clientY:n})}var de=Object.freeze({__proto__:null,applyStyle:Np,create:Lp,div:Xe,empty:J0,guid:nb,hide:Dt,hideAll:K0,offset:eb,pageCoordinates:tb,relativeDOMBBox:ib,show:ba,translateMouseCoordinates:Fp});var{entries:Dp,setPrototypeOf:Jc,isFrozen:sb,getPrototypeOf:ab,getOwnPropertyDescriptor:ob}=Object,{freeze:Tt,seal:Zt,create:lb}=Object,{apply:Fo,construct:Do}=typeof Reflect<"u"&&Reflect;Fo||(Fo=function(e,t,n){return e.apply(t,n)});Tt||(Tt=function(e){return e});Zt||(Zt=function(e){return e});Do||(Do=function(e,t){return new e(...t)});var hb=Ut(Array.prototype.forEach),ef=Ut(Array.prototype.pop),Un=Ut(Array.prototype.push),ls=Ut(String.prototype.toLowerCase),Ia=Ut(String.prototype.toString),cb=Ut(String.prototype.match),Wt=Ut(String.prototype.replace),fb=Ut(String.prototype.indexOf),ub=Ut(String.prototype.trim),Lt=Ut(RegExp.prototype.test),$n=db(TypeError);function Ut(i){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return Fo(i,e,n)}}function db(i){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Do(i,t)}}function ze(i,e,t){var n;t=(n=t)!==null&&n!==void 0?n:ls,Jc&&Jc(i,null);let s=e.length;for(;s--;){let r=e[s];if(typeof r=="string"){let a=t(r);a!==r&&(sb(e)||(e[s]=a),r=a)}i[r]=!0}return i}function ln(i){let e=lb(null);for(let[t,n]of Dp(i))e[t]=n;return e}function Pr(i,e){for(;i!==null;){let n=ob(i,e);if(n){if(n.get)return Ut(n.get);if(typeof n.value=="function")return Ut(n.value)}i=ab(i)}function t(n){return console.warn("fallback value for",n),null}return t}var tf=Tt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),La=Tt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Na=Tt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),pb=Tt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Fa=Tt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),gb=Tt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),nf=Tt(["#text"]),rf=Tt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Da=Tt(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),sf=Tt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),zr=Tt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),mb=Zt(/\{\{[\w\W]*|[\w\W]*\}\}/gm),bb=Zt(/<%[\w\W]*|[\w\W]*%>/gm),wb=Zt(/\${[\w\W]*}/gm),vb=Zt(/^data-[\-\w.\u00B7-\uFFFF]/),_b=Zt(/^aria-[\-\w]+$/),Op=Zt(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),yb=Zt(/^(?:\w+script|data):/i),xb=Zt(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Bp=Zt(/^html$/i),af=Object.freeze({__proto__:null,MUSTACHE_EXPR:mb,ERB_EXPR:bb,TMPLIT_EXPR:wb,DATA_ATTR:vb,ARIA_ATTR:_b,IS_ALLOWED_URI:Op,IS_SCRIPT_OR_DATA:yb,ATTR_WHITESPACE:xb,DOCTYPE_NAME:Bp}),kb=()=>typeof window>"u"?null:window,Sb=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null,s="data-tt-policy-suffix";t&&t.hasAttribute(s)&&(n=t.getAttribute(s));let r="dompurify"+(n?"#"+n:"");try{return e.createPolicy(r,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+r+" could not be created."),null}};function Pp(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:kb(),e=Ee=>Pp(Ee);if(e.version="3.0.5",e.removed=[],!i||!i.document||i.document.nodeType!==9)return e.isSupported=!1,e;let t=i.document,n=t.currentScript,{document:s}=i,{DocumentFragment:r,HTMLTemplateElement:a,Node:o,Element:l,NodeFilter:c,NamedNodeMap:h=i.NamedNodeMap||i.MozNamedAttrMap,HTMLFormElement:d,DOMParser:f,trustedTypes:u}=i,g=l.prototype,_=Pr(g,"cloneNode"),b=Pr(g,"nextSibling"),w=Pr(g,"childNodes"),p=Pr(g,"parentNode");if(typeof a=="function"){let Ee=s.createElement("template");Ee.content&&Ee.content.ownerDocument&&(s=Ee.content.ownerDocument)}let m,v="",{implementation:x,createNodeIterator:R,createDocumentFragment:M,getElementsByTagName:C}=s,{importNode:L}=t,y={};e.isSupported=typeof Dp=="function"&&typeof p=="function"&&x&&x.createHTMLDocument!==void 0;let{MUSTACHE_EXPR:E,ERB_EXPR:k,TMPLIT_EXPR:A,DATA_ATTR:I,ARIA_ATTR:F,IS_SCRIPT_OR_DATA:X,ATTR_WHITESPACE:U}=af,{IS_ALLOWED_URI:V}=af,q=null,S=ze({},[...tf,...La,...Na,...Fa,...nf]),P=null,H=ze({},[...rf,...Da,...sf,...zr]),D=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),O=null,W=null,j=!0,G=!0,Z=!1,te=!0,se=!1,re=!1,ae=!1,me=!1,ue=!1,Se=!1,_e=!1,ge=!0,ke=!1,Te="user-content-",Fe=!0,Ie=!1,T={},N=null,z=ze({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Q=null,K=ze({},["audio","video","img","source","image","track"]),ie=null,ce=ze({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Me="http://www.w3.org/1998/Math/MathML",Be="http://www.w3.org/2000/svg",He="http://www.w3.org/1999/xhtml",Pe=He,et=!1,wi=null,rn=ze({},[Me,Be,He],Ia),qt,Ca=["application/xhtml+xml","text/html"],sn="text/html",ht,Yt=null,Ea=s.createElement("form"),$=function(J){return J instanceof RegExp||J instanceof Function},Y=function(J){if(!(Yt&&Yt===J)){if((!J||typeof J!="object")&&(J={}),J=ln(J),qt=Ca.indexOf(J.PARSER_MEDIA_TYPE)===-1?qt=sn:qt=J.PARSER_MEDIA_TYPE,ht=qt==="application/xhtml+xml"?Ia:ls,q="ALLOWED_TAGS"in J?ze({},J.ALLOWED_TAGS,ht):S,P="ALLOWED_ATTR"in J?ze({},J.ALLOWED_ATTR,ht):H,wi="ALLOWED_NAMESPACES"in J?ze({},J.ALLOWED_NAMESPACES,Ia):rn,ie="ADD_URI_SAFE_ATTR"in J?ze(ln(ce),J.ADD_URI_SAFE_ATTR,ht):ce,Q="ADD_DATA_URI_TAGS"in J?ze(ln(K),J.ADD_DATA_URI_TAGS,ht):K,N="FORBID_CONTENTS"in J?ze({},J.FORBID_CONTENTS,ht):z,O="FORBID_TAGS"in J?ze({},J.FORBID_TAGS,ht):{},W="FORBID_ATTR"in J?ze({},J.FORBID_ATTR,ht):{},T="USE_PROFILES"in J?J.USE_PROFILES:!1,j=J.ALLOW_ARIA_ATTR!==!1,G=J.ALLOW_DATA_ATTR!==!1,Z=J.ALLOW_UNKNOWN_PROTOCOLS||!1,te=J.ALLOW_SELF_CLOSE_IN_ATTR!==!1,se=J.SAFE_FOR_TEMPLATES||!1,re=J.WHOLE_DOCUMENT||!1,ue=J.RETURN_DOM||!1,Se=J.RETURN_DOM_FRAGMENT||!1,_e=J.RETURN_TRUSTED_TYPE||!1,me=J.FORCE_BODY||!1,ge=J.SANITIZE_DOM!==!1,ke=J.SANITIZE_NAMED_PROPS||!1,Fe=J.KEEP_CONTENT!==!1,Ie=J.IN_PLACE||!1,V=J.ALLOWED_URI_REGEXP||Op,Pe=J.NAMESPACE||He,D=J.CUSTOM_ELEMENT_HANDLING||{},J.CUSTOM_ELEMENT_HANDLING&&$(J.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(D.tagNameCheck=J.CUSTOM_ELEMENT_HANDLING.tagNameCheck),J.CUSTOM_ELEMENT_HANDLING&&$(J.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(D.attributeNameCheck=J.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),J.CUSTOM_ELEMENT_HANDLING&&typeof J.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(D.allowCustomizedBuiltInElements=J.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),se&&(G=!1),Se&&(ue=!0),T&&(q=ze({},[...nf]),P=[],T.html===!0&&(ze(q,tf),ze(P,rf)),T.svg===!0&&(ze(q,La),ze(P,Da),ze(P,zr)),T.svgFilters===!0&&(ze(q,Na),ze(P,Da),ze(P,zr)),T.mathMl===!0&&(ze(q,Fa),ze(P,sf),ze(P,zr))),J.ADD_TAGS&&(q===S&&(q=ln(q)),ze(q,J.ADD_TAGS,ht)),J.ADD_ATTR&&(P===H&&(P=ln(P)),ze(P,J.ADD_ATTR,ht)),J.ADD_URI_SAFE_ATTR&&ze(ie,J.ADD_URI_SAFE_ATTR,ht),J.FORBID_CONTENTS&&(N===z&&(N=ln(N)),ze(N,J.FORBID_CONTENTS,ht)),Fe&&(q["#text"]=!0),re&&ze(q,["html","head","body"]),q.table&&(ze(q,["tbody"]),delete O.tbody),J.TRUSTED_TYPES_POLICY){if(typeof J.TRUSTED_TYPES_POLICY.createHTML!="function")throw $n('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof J.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw $n('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');m=J.TRUSTED_TYPES_POLICY,v=m.createHTML("")}else m===void 0&&(m=Sb(u,n)),m!==null&&typeof v=="string"&&(v=m.createHTML(""));Tt&&Tt(J),Yt=J}},ee=ze({},["mi","mo","mn","ms","mtext"]),oe=ze({},["foreignobject","desc","title","annotation-xml"]),ne=ze({},["title","style","font","a","script"]),le=ze({},La);ze(le,Na),ze(le,pb);let fe=ze({},Fa);ze(fe,gb);let we=function(J){let be=p(J);(!be||!be.tagName)&&(be={namespaceURI:Pe,tagName:"template"});let xe=ls(J.tagName),Qe=ls(be.tagName);return wi[J.namespaceURI]?J.namespaceURI===Be?be.namespaceURI===He?xe==="svg":be.namespaceURI===Me?xe==="svg"&&(Qe==="annotation-xml"||ee[Qe]):!!le[xe]:J.namespaceURI===Me?be.namespaceURI===He?xe==="math":be.namespaceURI===Be?xe==="math"&&oe[Qe]:!!fe[xe]:J.namespaceURI===He?be.namespaceURI===Be&&!oe[Qe]||be.namespaceURI===Me&&!ee[Qe]?!1:!fe[xe]&&(ne[xe]||!le[xe]):!!(qt==="application/xhtml+xml"&&wi[J.namespaceURI]):!1},ve=function(J){Un(e.removed,{element:J});try{J.parentNode.removeChild(J)}catch{J.remove()}},Le=function(J,be){try{Un(e.removed,{attribute:be.getAttributeNode(J),from:be})}catch{Un(e.removed,{attribute:null,from:be})}if(be.removeAttribute(J),J==="is"&&!P[J])if(ue||Se)try{ve(be)}catch{}else try{be.setAttribute(J,"")}catch{}},Re=function(J){let be,xe;if(me)J="<remove></remove>"+J;else{let Pt=cb(J,/^[\r\n\t ]+/);xe=Pt&&Pt[0]}qt==="application/xhtml+xml"&&Pe===He&&(J='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+J+"</body></html>");let Qe=m?m.createHTML(J):J;if(Pe===He)try{be=new f().parseFromString(Qe,qt)}catch{}if(!be||!be.documentElement){be=x.createDocument(Pe,"template",null);try{be.documentElement.innerHTML=et?v:Qe}catch{}}let bt=be.body||be.documentElement;return J&&xe&&bt.insertBefore(s.createTextNode(xe),bt.childNodes[0]||null),Pe===He?C.call(be,re?"html":"body")[0]:re?be.documentElement:bt},Ne=function(J){return R.call(J.ownerDocument||J,J,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT,null,!1)},Ue=function(J){return J instanceof d&&(typeof J.nodeName!="string"||typeof J.textContent!="string"||typeof J.removeChild!="function"||!(J.attributes instanceof h)||typeof J.removeAttribute!="function"||typeof J.setAttribute!="function"||typeof J.namespaceURI!="string"||typeof J.insertBefore!="function"||typeof J.hasChildNodes!="function")},We=function(J){return typeof o=="object"?J instanceof o:J&&typeof J=="object"&&typeof J.nodeType=="number"&&typeof J.nodeName=="string"},Ae=function(J,be,xe){y[J]&&hb(y[J],Qe=>{Qe.call(e,be,xe,Yt)})},ct=function(J){let be;if(Ae("beforeSanitizeElements",J,null),Ue(J))return ve(J),!0;let xe=ht(J.nodeName);if(Ae("uponSanitizeElement",J,{tagName:xe,allowedTags:q}),J.hasChildNodes()&&!We(J.firstElementChild)&&(!We(J.content)||!We(J.content.firstElementChild))&&Lt(/<[/\w]/g,J.innerHTML)&&Lt(/<[/\w]/g,J.textContent))return ve(J),!0;if(!q[xe]||O[xe]){if(!O[xe]&&St(xe)&&(D.tagNameCheck instanceof RegExp&&Lt(D.tagNameCheck,xe)||D.tagNameCheck instanceof Function&&D.tagNameCheck(xe)))return!1;if(Fe&&!N[xe]){let Qe=p(J)||J.parentNode,bt=w(J)||J.childNodes;if(bt&&Qe){let Pt=bt.length;for(let at=Pt-1;at>=0;--at)Qe.insertBefore(_(bt[at],!0),b(J))}}return ve(J),!0}return J instanceof l&&!we(J)||(xe==="noscript"||xe==="noembed"||xe==="noframes")&&Lt(/<\/no(script|embed|frames)/i,J.innerHTML)?(ve(J),!0):(se&&J.nodeType===3&&(be=J.textContent,be=Wt(be,E," "),be=Wt(be,k," "),be=Wt(be,A," "),J.textContent!==be&&(Un(e.removed,{element:J.cloneNode()}),J.textContent=be)),Ae("afterSanitizeElements",J,null),!1)},ut=function(J,be,xe){if(ge&&(be==="id"||be==="name")&&(xe in s||xe in Ea))return!1;if(!(G&&!W[be]&&Lt(I,be))){if(!(j&&Lt(F,be))){if(!P[be]||W[be]){if(!(St(J)&&(D.tagNameCheck instanceof RegExp&&Lt(D.tagNameCheck,J)||D.tagNameCheck instanceof Function&&D.tagNameCheck(J))&&(D.attributeNameCheck instanceof RegExp&&Lt(D.attributeNameCheck,be)||D.attributeNameCheck instanceof Function&&D.attributeNameCheck(be))||be==="is"&&D.allowCustomizedBuiltInElements&&(D.tagNameCheck instanceof RegExp&&Lt(D.tagNameCheck,xe)||D.tagNameCheck instanceof Function&&D.tagNameCheck(xe))))return!1}else if(!ie[be]){if(!Lt(V,Wt(xe,U,""))){if(!((be==="src"||be==="xlink:href"||be==="href")&&J!=="script"&&fb(xe,"data:")===0&&Q[J])){if(!(Z&&!Lt(X,Wt(xe,U,"")))){if(xe)return!1}}}}}}return!0},St=function(J){return J.indexOf("-")>0},tt=function(J){let be,xe,Qe,bt;Ae("beforeSanitizeAttributes",J,null);let{attributes:Pt}=J;if(!Pt)return;let at={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:P};for(bt=Pt.length;bt--;){be=Pt[bt];let{name:Qt,namespaceURI:Aa}=be;if(xe=Qt==="value"?be.value:ub(be.value),Qe=ht(Qt),at.attrName=Qe,at.attrValue=xe,at.keepAttr=!0,at.forceKeepAttr=void 0,Ae("uponSanitizeAttribute",J,at),xe=at.attrValue,at.forceKeepAttr||(Le(Qt,J),!at.keepAttr))continue;if(!te&&Lt(/\/>/i,xe)){Le(Qt,J);continue}se&&(xe=Wt(xe,E," "),xe=Wt(xe,k," "),xe=Wt(xe,A," "));let Lc=ht(J.nodeName);if(ut(Lc,Qe,xe)){if(ke&&(Qe==="id"||Qe==="name")&&(Le(Qt,J),xe=Te+xe),m&&typeof u=="object"&&typeof u.getAttributeType=="function"&&!Aa)switch(u.getAttributeType(Lc,Qe)){case"TrustedHTML":{xe=m.createHTML(xe);break}case"TrustedScriptURL":{xe=m.createScriptURL(xe);break}}try{Aa?J.setAttributeNS(Aa,Qt,xe):J.setAttribute(Qt,xe),ef(e.removed)}catch{}}}Ae("afterSanitizeAttributes",J,null)},Mi=function Ee(J){let be,xe=Ne(J);for(Ae("beforeSanitizeShadowDOM",J,null);be=xe.nextNode();)Ae("uponSanitizeShadowNode",be,null),!ct(be)&&(be.content instanceof r&&Ee(be.content),tt(be));Ae("afterSanitizeShadowDOM",J,null)};return e.sanitize=function(Ee){let J=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},be,xe,Qe,bt;if(et=!Ee,et&&(Ee="<!-->"),typeof Ee!="string"&&!We(Ee))if(typeof Ee.toString=="function"){if(Ee=Ee.toString(),typeof Ee!="string")throw $n("dirty is not a string, aborting")}else throw $n("toString is not a function");if(!e.isSupported)return Ee;if(ae||Y(J),e.removed=[],typeof Ee=="string"&&(Ie=!1),Ie){if(Ee.nodeName){let Qt=ht(Ee.nodeName);if(!q[Qt]||O[Qt])throw $n("root node is forbidden and cannot be sanitized in-place")}}else if(Ee instanceof o)be=Re("<!---->"),xe=be.ownerDocument.importNode(Ee,!0),xe.nodeType===1&&xe.nodeName==="BODY"||xe.nodeName==="HTML"?be=xe:be.appendChild(xe);else{if(!ue&&!se&&!re&&Ee.indexOf("<")===-1)return m&&_e?m.createHTML(Ee):Ee;if(be=Re(Ee),!be)return ue?null:_e?v:""}be&&me&&ve(be.firstChild);let Pt=Ne(Ie?Ee:be);for(;Qe=Pt.nextNode();)ct(Qe)||(Qe.content instanceof r&&Mi(Qe.content),tt(Qe));if(Ie)return Ee;if(ue){if(Se)for(bt=M.call(be.ownerDocument);be.firstChild;)bt.appendChild(be.firstChild);else bt=be;return(P.shadowroot||P.shadowrootmode)&&(bt=L.call(t,bt,!0)),bt}let at=re?be.outerHTML:be.innerHTML;return re&&q["!doctype"]&&be.ownerDocument&&be.ownerDocument.doctype&&be.ownerDocument.doctype.name&&Lt(Bp,be.ownerDocument.doctype.name)&&(at="<!DOCTYPE "+be.ownerDocument.doctype.name+`>
`+at),se&&(at=Wt(at,E," "),at=Wt(at,k," "),at=Wt(at,A," ")),m&&_e?m.createHTML(at):at},e.setConfig=function(Ee){Y(Ee),ae=!0},e.clearConfig=function(){Yt=null,ae=!1},e.isValidAttribute=function(Ee,J,be){Yt||Y({});let xe=ht(Ee),Qe=ht(J);return ut(xe,Qe,be)},e.addHook=function(Ee,J){typeof J=="function"&&(y[Ee]=y[Ee]||[],Un(y[Ee],J))},e.removeHook=function(Ee){if(y[Ee])return ef(y[Ee])},e.removeHooks=function(Ee){y[Ee]&&(y[Ee]=[])},e.removeAllHooks=function(){y={}},e}var zp=Pp();function Hp(i,e){let t=Xe({class:"igv-ui-trackgear-popover-check-container"}),n=$p("check",e===!0?"#444":"transparent");n.style.borderColor="gray",n.style.borderWidth="1px",n.style.borderStyle="solid",t.appendChild(n);let s=Xe();return s.textContent=i,t.appendChild(s),t}function Up(i,e){return $p(i,e)}function $p(i,e){e=e||"currentColor";let t=of[i];t||(console.error(`No icon named: ${i}`),t=of.question);let n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttributeNS(null,"viewBox","0 0 "+t[0]+" "+t[1]);let s=document.createElementNS("http://www.w3.org/2000/svg","path");return s.setAttributeNS(null,"fill",e),s.setAttributeNS(null,"d",t[4]),n.appendChild(s),n}var of={check:[512,512,[],"f00c","M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"],cog:[512,512,[],"f013","M444.788 291.1l42.616 24.599c4.867 2.809 7.126 8.618 5.459 13.985-11.07 35.642-29.97 67.842-54.689 94.586a12.016 12.016 0 0 1-14.832 2.254l-42.584-24.595a191.577 191.577 0 0 1-60.759 35.13v49.182a12.01 12.01 0 0 1-9.377 11.718c-34.956 7.85-72.499 8.256-109.219.007-5.49-1.233-9.403-6.096-9.403-11.723v-49.184a191.555 191.555 0 0 1-60.759-35.13l-42.584 24.595a12.016 12.016 0 0 1-14.832-2.254c-24.718-26.744-43.619-58.944-54.689-94.586-1.667-5.366.592-11.175 5.459-13.985L67.212 291.1a193.48 193.48 0 0 1 0-70.199l-42.616-24.599c-4.867-2.809-7.126-8.618-5.459-13.985 11.07-35.642 29.97-67.842 54.689-94.586a12.016 12.016 0 0 1 14.832-2.254l42.584 24.595a191.577 191.577 0 0 1 60.759-35.13V25.759a12.01 12.01 0 0 1 9.377-11.718c34.956-7.85 72.499-8.256 109.219-.007 5.49 1.233 9.403 6.096 9.403 11.723v49.184a191.555 191.555 0 0 1 60.759 35.13l42.584-24.595a12.016 12.016 0 0 1 14.832 2.254c24.718 26.744 43.619 58.944 54.689 94.586 1.667 5.366-.592 11.175-5.459 13.985L444.788 220.9a193.485 193.485 0 0 1 0 70.2zM336 256c0-44.112-35.888-80-80-80s-80 35.888-80 80 35.888 80 80 80 80-35.888 80-80z"],exclamation:[192,512,[],"f12a","M176 432c0 44.112-35.888 80-80 80s-80-35.888-80-80 35.888-80 80-80 80 35.888 80 80zM25.26 25.199l13.6 272C39.499 309.972 50.041 320 62.83 320h66.34c12.789 0 23.331-10.028 23.97-22.801l13.6-272C167.425 11.49 156.496 0 142.77 0H49.23C35.504 0 24.575 11.49 25.26 25.199z"],"exclamation-circle":[512,512,[],"f06a","M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"],"exclamation-triangle":[576,512,[],"f071","M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"],minus:[448,512,[],"f068","M424 318.2c13.3 0 24-10.7 24-24v-76.4c0-13.3-10.7-24-24-24H24c-13.3 0-24 10.7-24 24v76.4c0 13.3 10.7 24 24 24h400z"],"minus-circle":[512,512,[],"f056","M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zM124 296c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h264c6.6 0 12 5.4 12 12v56c0 6.6-5.4 12-12 12H124z"],"minus-square":[448,512,[],"f146","M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM92 296c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h264c6.6 0 12 5.4 12 12v56c0 6.6-5.4 12-12 12H92z"],plus:[448,512,[],"f067","M448 294.2v-76.4c0-13.3-10.7-24-24-24H286.2V56c0-13.3-10.7-24-24-24h-76.4c-13.3 0-24 10.7-24 24v137.8H24c-13.3 0-24 10.7-24 24v76.4c0 13.3 10.7 24 24 24h137.8V456c0 13.3 10.7 24 24 24h76.4c13.3 0 24-10.7 24-24V318.2H424c13.3 0 24-10.7 24-24z"],"plus-circle":[512,512,[],"f055","M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"],"plus-square":[448,512,[],"f0fe","M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zm-32 252c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92H92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"],question:[384,512,[],"f128","M202.021 0C122.202 0 70.503 32.703 29.914 91.026c-7.363 10.58-5.093 25.086 5.178 32.874l43.138 32.709c10.373 7.865 25.132 6.026 33.253-4.148 25.049-31.381 43.63-49.449 82.757-49.449 30.764 0 68.816 19.799 68.816 49.631 0 22.552-18.617 34.134-48.993 51.164-35.423 19.86-82.299 44.576-82.299 106.405V320c0 13.255 10.745 24 24 24h72.471c13.255 0 24-10.745 24-24v-5.773c0-42.86 125.268-44.645 125.268-160.627C377.504 66.256 286.902 0 202.021 0zM192 373.459c-38.196 0-69.271 31.075-69.271 69.271 0 38.195 31.075 69.27 69.271 69.27s69.271-31.075 69.271-69.271-31.075-69.27-69.271-69.27z"],save:[448,512,[],"f0c7","M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"],search:[512,512,[],"f002","M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"],share:[512,512,[],"f064","M503.691 189.836L327.687 37.851C312.281 24.546 288 35.347 288 56.015v80.053C127.371 137.907 0 170.1 0 322.326c0 61.441 39.581 122.309 83.333 154.132 13.653 9.931 33.111-2.533 28.077-18.631C66.066 312.814 132.917 274.316 288 272.085V360c0 20.7 24.3 31.453 39.687 18.164l176.004-152c11.071-9.562 11.086-26.753 0-36.328z"],spinner:[512,512,[],"f110","M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"],square:[448,512,[],"f0c8","M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48z"],"square-full":[512,512,[],"f45c","M512 512H0V0h512v512z"],times:[384,512,[],"f00d","M323.1 441l53.9-53.9c9.4-9.4 9.4-24.5 0-33.9L279.8 256l97.2-97.2c9.4-9.4 9.4-24.5 0-33.9L323.1 71c-9.4-9.4-24.5-9.4-33.9 0L192 168.2 94.8 71c-9.4-9.4-24.5-9.4-33.9 0L7 124.9c-9.4 9.4-9.4 24.5 0 33.9l97.2 97.2L7 353.2c-9.4 9.4-9.4 24.5 0 33.9L60.9 441c9.4 9.4 24.5 9.4 33.9 0l97.2-97.2 97.2 97.2c9.3 9.3 24.5 9.3 33.9 0z"],"times-circle":[512,512,[],"f057","M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"],wrench:[512,512,[],"f0ad","M481.156 200c9.3 0 15.12 10.155 10.325 18.124C466.295 259.992 420.419 288 368 288c-79.222 0-143.501-63.974-143.997-143.079C223.505 65.469 288.548-.001 368.002 0c52.362.001 98.196 27.949 123.4 69.743C496.24 77.766 490.523 88 481.154 88H376l-40 56 40 56h105.156zm-171.649 93.003L109.255 493.255c-24.994 24.993-65.515 24.994-90.51 0-24.993-24.994-24.993-65.516 0-90.51L218.991 202.5c16.16 41.197 49.303 74.335 90.516 90.503zM104 432c0-13.255-10.745-24-24-24s-24 10.745-24 24 10.745 24 24 24 24-10.745 24-24z"]},Ui=Object.freeze({__proto__:null,createCheckbox:Hp,createIcon:Up});function wa(i,e){var t=document.createElement("div");i.appendChild(t),t.appendChild(Up("times")),t.addEventListener("click",function(n){n.preventDefault(),n.stopPropagation(),e()})}var sc=Object.freeze({__proto__:null,attachDialogCloseHandlerWithParent:wa}),Ft;function Ki(i,e,t){e.addEventListener("mousedown",n.bind(i));function n(s){s.stopPropagation(),s.preventDefault();let r=Cb.bind(this),a=Eb.bind(this),o=getComputedStyle(this);Ft={constraint:t,dragFunction:r,dragEndFunction:a,screenX:s.screenX,screenY:s.screenY,top:parseInt(o.top.replace("px","")),left:parseInt(o.left.replace("px",""))},document.addEventListener("mousemove",r),document.addEventListener("mouseup",a),document.addEventListener("mouseleave",a),document.addEventListener("mouseexit",a)}}function Cb(i){if(!Ft){console.error("No drag data!");return}i.stopPropagation(),i.preventDefault();let e=i.screenX-Ft.screenX,t=i.screenY-Ft.screenY,n=Ft.left+e,s=Ft.constraint?Math.max(Ft.constraint.minY,Ft.top+t):Ft.top+t;this.style.left=`${n}px`,this.style.top=`${s}px`}function Eb(i){if(!Ft){console.error("No drag data!");return}i.stopPropagation(),i.preventDefault();let e=Ft.dragFunction,t=Ft.dragEndFunction;document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t),document.removeEventListener("mouseleave",t),document.removeEventListener("mouseexit",t),Ft=void 0}var lf={401:"Access unauthorized",403:"Access forbidden",404:"Not found"},ys=class{constructor(e,t){this.alertProps=Object.assign({shouldFocus:!0,preventScroll:!1},t),this.container=Xe({class:"igv-ui-alert-dialog-container"}),e.appendChild(this.container),this.container.setAttribute("tabIndex","-1");let n=Xe();this.container.appendChild(n),this.errorHeadline=Xe(),n.appendChild(this.errorHeadline),this.errorHeadline.textContent="";let s=Xe({class:"igv-ui-alert-dialog-body"});this.container.appendChild(s),this.body=Xe({class:"igv-ui-alert-dialog-body-copy"}),s.appendChild(this.body);let r=Xe();this.container.appendChild(r),this.ok=Xe(),r.appendChild(this.ok),this.ok.textContent="OK";let a=()=>{typeof this.callback=="function"&&(this.callback("OK"),this.callback=void 0),this.body.innerHTML="",Dt(this.container)};this.ok.addEventListener("click",o=>{o.stopPropagation(),a()}),this.container.addEventListener("keypress",o=>{o.stopPropagation(),o.key==="Enter"&&a()}),Ki(this.container,n),Dt(this.container)}present(e,t){this.errorHeadline.textContent=e.message?"ERROR":"";let n=e.message||e;lf.hasOwnProperty(n)&&(n=lf[n]);let s=zp.sanitize(n);this.body.innerHTML=s,this.callback=t,ba(this.container),this.alertProps.shouldFocus&&this.container.focus({preventScroll:this.alertProps.preventScroll})}},Oo=class{constructor(e){this.parent=e,this.container=Xe({class:"igv-ui-generic-dialog-container"}),e.appendChild(this.container);let t=Xe({class:"igv-ui-generic-dialog-header"});this.container.appendChild(t),this.label=Xe({class:"igv-ui-generic-dialog-one-liner"}),this.container.appendChild(this.label),this.label.text="Unlabeled",this.input_container=Xe({class:"igv-ui-generic-dialog-input"}),this.container.appendChild(this.input_container),this.input=document.createElement("input"),this.input_container.appendChild(this.input);let n=Xe({class:"igv-ui-generic-dialog-ok-cancel"});this.container.appendChild(n),this.ok=Xe(),n.appendChild(this.ok),this.ok.textContent="OK",this.cancel=Xe(),n.appendChild(this.cancel),this.cancel.textContent="Cancel",Dt(this.container),this.input.addEventListener("keyup",r=>{r.keyCode===13&&(typeof this.callback=="function"&&(this.callback(this.input.value),this.callback=void 0),this.input.value=void 0,Dt(this.container))}),this.ok.addEventListener("click",()=>{typeof this.callback=="function"&&(this.callback(this.input.value),this.callback=void 0),this.input.value=void 0,Dt(this.container)});let s=()=>{this.input.value="",Dt(this.container)};this.cancel.addEventListener("click",s),wa(t,s),Ki(this.container,t)}get value(){return zp.sanitize(this.input.value)}present(e,t){this.label.textContent=e.label,this.input.value=e.value,this.callback=e.callback||e.click,ba(this.container),this.clampLocation(t.clientX,t.clientY)}clampLocation(e,t){let{width:n,height:s}=this.container.getBoundingClientRect(),r=window.innerHeight,a=window.innerWidth,o=Math.min(r-s,t),l=Math.min(a-n,e);this.container.style.left=`${l}px`,this.container.style.top=`${o}px`}},Vp={licorice:"#000000",lead:"#1e1e1e",tungsten:"#3a3a3a",iron:"#545453",steel:"#6e6e6e",tin:"#878687",nickel:"#888787",aluminum:"#a09fa0",magnesium:"#b8b8b8",silver:"#d0d0d0",mercury:"#e8e8e8",snow:"#ffffff",cayenne:"#891100",mocha:"#894800",aspargus:"#888501",fern:"#458401",clover:"#028401",moss:"#018448",teal:"#008688",ocean:"#004a88",midnight:"#001888",eggplant:"#491a88",plum:"#891e88",maroon:"#891648",maraschino:"#ff2101",tangerine:"#ff8802",lemon:"#fffa03",lime:"#83f902",spring:"#05f802",seam_foam:"#03f987",turquoise:"#00fdff",aqua:"#008cff",blueberry:"#002eff",grape:"#8931ff",magenta:"#ff39ff",strawberry:"#ff2987",salmon:"#ff726e",cantaloupe:"#ffce6e",banana:"#fffb6d",honeydew:"#cefa6e",flora:"#68f96e",spindrift:"#68fbd0",ice:"#68fdff",sky:"#6acfff",orchid:"#6e76ff",lavender:"#d278ff",bubblegum:"#ff7aff",carnation:"#ff7fd3"},xs=class{constructor({parent:e,top:t,left:n,width:s,height:r,border:a,closeHandler:o}){let l=Xe({class:"igv-ui-generic-container"});e.appendChild(l),Dt(l),this.container=l,t!==void 0&&(this.container.style.top=`${t}px`),n!==void 0&&(this.container.style.left=`${n}px`),s!==void 0&&(this.container.style.width=`${s}px`),r!==void 0&&(this.container.style.height=`${r}px`),a&&(this.container.style.border=a);let c=Xe();this.container.appendChild(c),wa(c,h=>{Dt(this.container),typeof o=="function"&&o(h)}),Ki(this.container,c)}show(){ba(this.container)}hide(){Dt(this.container)}dispose(){this.container.parent&&this.container.parent.removeChild(this.container)}},Bo=class extends xs{constructor({parent:e,top:t,left:n,width:s,height:r,defaultColors:a,colorHandler:o}){super({parent:e,top:t,left:n,width:s,height:r,border:"1px solid gray"}),Ab(this.container,o,a)}},Ab=(i,e,t)=>{let n=Object.values(Vp);for(let s of n){let r=Xe({class:"igv-ui-color-swatch"});i.appendChild(r),hf(r,s,e)}if(t)for(let s of t){let r=Xe({class:"igv-ui-color-swatch"});i.appendChild(r),hf(r,s,e)}},hf=(i,e,t)=>{i.style.backgroundColor=e,i.addEventListener("mouseenter",n=>i.style.borderColor=e),i.addEventListener("mouseleave",n=>i.style.borderColor="white"),i.addEventListener("click",n=>{n.stopPropagation(),t(e)}),i.addEventListener("touchend",n=>{n.stopPropagation(),t(e)})},dr=class{constructor(e,t){this.parent=e,this.popover=Xe({class:"igv-ui-popover"}),e.appendChild(this.popover);let n=Xe();this.popover.appendChild(n);let s=Xe();n.appendChild(s),t&&(s.textContent=t),wa(n,()=>this.hide()),Ki(this.popover,n),this.popoverContent=Xe(),this.popover.appendChild(this.popoverContent),this.popover.style.display="none"}presentContentWithEvent(e,t){this.popover.style.display="block",this.popoverContent.innerHTML=t,cf(e,this.popover,this.popoverContent)}presentMenu(e,t){if(t.length===0)return;this.popover.style.display="block";let n=Tb(t,this.popover);for(let s of n)this.popoverContent.appendChild(s.object);cf(e,this.popover,this.popoverContent)}hide(){this.popover.style.display="none",this.dispose()}dispose(){this.popover&&this.popover.parentNode.removeChild(this.popover);let e=Object.keys(this);for(let t of e)this[t]=void 0}};function cf(i,e,t){let{x:n,y:s,width:r}=Fp(i,e.parentNode);e.style.top=`${s}px`;let{width:a}=e.getBoundingClientRect(),o=n+a,l=o-r;e.style.left=`${o>r?n-l:n}px`,t.style.maxWidth=`${Math.min(a,r)}px`}function Tb(i,e){return i.map(function(n,s){let r;if(typeof n=="string")r=Xe(),r.innerHTML=n;else if(typeof n=="Node")r=n;else{if(typeof n.init=="function"&&n.init(),n.type==="checkbox")r=Hp("Show all bases",n.value);else if(n.type==="color"){let a=new Bo({parent:e.parentElement,width:364,colorHandler:l=>n.click(l)});r=Xe(),typeof n.label=="string"&&(r.innerHTML=n.label);let o=l=>{a.show(),Dt(e),l.preventDefault(),l.stopPropagation()};r.addEventListener("click",o),r.addEventListener("touchend",o),r.addEventListener("mouseup",function(l){l.preventDefault(),l.stopPropagation()})}else r=Xe(),typeof n.label=="string"&&(r.innerHTML=n.label);if(n.click&&n.type!=="color"){let a=function(o){n.click(),Dt(e),o.preventDefault(),o.stopPropagation()};r.addEventListener("click",a),r.addEventListener("touchend",a),r.addEventListener("mouseup",function(o){o.preventDefault(),o.stopPropagation()})}}return{object:r,init:n.init}})}var ks=class extends xs{constructor({parent:e,width:t}){super({parent:e,width:t,border:"1px solid gray"})}configure(e,t){this.colorHandlers=t,this.setActiveColorHandler("color"),this.createSwatches(e)}setActiveColorHandler(e){this.activeColorHandler=this.colorHandlers[e]}createSwatches(e){this.container.querySelectorAll(".igv-ui-color-swatch").forEach(n=>n.remove());let t=Object.values(Vp);for(let n of t){let s=Xe({class:"igv-ui-color-swatch"});this.container.appendChild(s),this.decorateSwatch(s,n)}if(e)for(let n of e){let s=Xe({class:"igv-ui-color-swatch"});this.container.appendChild(s),this.decorateSwatch(s,n)}}decorateSwatch(e,t){e.style.backgroundColor=t,e.addEventListener("mouseenter",()=>e.style.borderColor=t),e.addEventListener("mouseleave",()=>e.style.borderColor="white"),e.addEventListener("click",n=>{n.stopPropagation(),this.activeColorHandler(t)}),e.addEventListener("touchend",n=>{n.stopPropagation(),this.activeColorHandler(t)})}};function Mb(){let i=document.createElement("style");i.setAttribute("type","text/css"),i.setAttribute("title","igv-ui.css"),i.innerHTML=`.igv-ui-popover {
  cursor: default;
  position: absolute;
  z-index: 2048;
  border-color: #7F7F7F;
  border-radius: 4px;
  border-style: solid;
  border-width: 1px;
  font-family: "Open Sans", sans-serif;
  font-size: small;
  background-color: white;
}
.igv-ui-popover > div:first-child {
  display: flex;
  flex-direction: row;
  flex-wrap: nowrap;
  justify-content: space-between;
  align-items: center;
  width: 100%;
  height: 24px;
  cursor: move;
  border-top-left-radius: 4px;
  border-top-right-radius: 4px;
  border-bottom-color: #7F7F7F;
  border-bottom-style: solid;
  border-bottom-width: thin;
  background-color: #eee;
}
.igv-ui-popover > div:first-child > div:first-child {
  margin-left: 4px;
}
.igv-ui-popover > div:first-child > div:last-child {
  margin-right: 4px;
  height: 12px;
  width: 12px;
  color: #7F7F7F;
}
.igv-ui-popover > div:first-child > div:last-child:hover {
  cursor: pointer;
  color: #444;
}
.igv-ui-popover > div:last-child {
  overflow-y: auto;
  overflow-x: hidden;
  max-height: 400px;
  max-width: 800px;
  background-color: white;
}
.igv-ui-popover > div:last-child > div {
  user-select: all;
  margin-left: 4px;
  margin-right: 4px;
  min-width: 220px;
  overflow-x: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
.igv-ui-popover > div:last-child > div > span {
  font-weight: bolder;
}
.igv-ui-popover > div:last-child hr {
  width: 100%;
}

.igv-ui-alert-dialog-container {
  box-sizing: content-box;
  position: absolute;
  z-index: 2048;
  top: 50%;
  left: 50%;
  width: 400px;
  height: 200px;
  border-color: #7F7F7F;
  border-radius: 4px;
  border-style: solid;
  border-width: thin;
  outline: none;
  font-family: "Open Sans", sans-serif;
  font-size: 15px;
  font-weight: 400;
  background-color: white;
  display: flex;
  flex-flow: column;
  flex-wrap: nowrap;
  justify-content: space-between;
  align-items: center;
}
.igv-ui-alert-dialog-container > div:first-child {
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: center;
  width: 100%;
  height: 24px;
  cursor: move;
  border-top-left-radius: 4px;
  border-top-right-radius: 4px;
  border-bottom-color: #7F7F7F;
  border-bottom-style: solid;
  border-bottom-width: thin;
  background-color: #eee;
}
.igv-ui-alert-dialog-container > div:first-child div:first-child {
  padding-left: 8px;
}
.igv-ui-alert-dialog-container .igv-ui-alert-dialog-body {
  -webkit-user-select: text;
  -moz-user-select: text;
  -ms-user-select: text;
  user-select: text;
  color: #373737;
  width: 100%;
  height: calc(100% - 24px - 64px);
  overflow-y: scroll;
}
.igv-ui-alert-dialog-container .igv-ui-alert-dialog-body .igv-ui-alert-dialog-body-copy {
  margin: 16px;
  width: auto;
  height: auto;
  overflow-wrap: break-word;
  word-break: break-word;
  background-color: white;
  border: unset;
}
.igv-ui-alert-dialog-container > div:last-child {
  width: 100%;
  margin-bottom: 10px;
  background-color: white;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: center;
  align-items: center;
}
.igv-ui-alert-dialog-container > div:last-child div {
  margin: unset;
  width: 40px;
  height: 30px;
  line-height: 30px;
  text-align: center;
  color: white;
  font-family: "Open Sans", sans-serif;
  font-size: small;
  font-weight: 400;
  border-color: #2B81AF;
  border-style: solid;
  border-width: thin;
  border-radius: 4px;
  background-color: #2B81AF;
}
.igv-ui-alert-dialog-container > div:last-child div:hover {
  cursor: pointer;
  border-color: #25597f;
  background-color: #25597f;
}

.igv-ui-color-swatch {
  position: relative;
  box-sizing: content-box;
  display: flex;
  flex-flow: row;
  flex-wrap: wrap;
  justify-content: center;
  align-items: center;
  width: 32px;
  height: 32px;
  border-style: solid;
  border-width: 2px;
  border-color: white;
  border-radius: 4px;
}

.igv-ui-color-swatch:hover {
  border-color: dimgray;
}

.igv-ui-colorpicker-menu-close-button {
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: flex-end;
  align-items: center;
  width: 100%;
  height: 32px;
  margin-top: 4px;
  margin-bottom: 4px;
  padding-right: 8px;
}
.igv-ui-colorpicker-menu-close-button i.fa {
  display: block;
  margin-left: 4px;
  margin-right: 4px;
  color: #5f5f5f;
}
.igv-ui-colorpicker-menu-close-button i.fa:hover,
.igv-ui-colorpicker-menu-close-button i.fa:focus,
.igv-ui-colorpicker-menu-close-button i.fa:active {
  cursor: pointer;
  color: #0f0f0f;
}

.igv-ui-generic-dialog-container {
  box-sizing: content-box;
  position: fixed;
  top: 0;
  left: 0;
  width: 300px;
  height: 200px;
  border-color: #7F7F7F;
  border-radius: 4px;
  border-style: solid;
  border-width: thin;
  font-family: "Open Sans", sans-serif;
  font-size: medium;
  font-weight: 400;
  z-index: 2048;
  background-color: white;
  display: flex;
  flex-flow: column;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: center;
}
.igv-ui-generic-dialog-container .igv-ui-generic-dialog-header {
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: flex-end;
  align-items: center;
  width: 100%;
  height: 24px;
  cursor: move;
  border-top-left-radius: 4px;
  border-top-right-radius: 4px;
  border-bottom-color: #7F7F7F;
  border-bottom-style: solid;
  border-bottom-width: thin;
  background-color: #eee;
}
.igv-ui-generic-dialog-container .igv-ui-generic-dialog-header div {
  margin-right: 4px;
  margin-bottom: 2px;
  height: 12px;
  width: 12px;
  color: #7F7F7F;
}
.igv-ui-generic-dialog-container .igv-ui-generic-dialog-header div:hover {
  cursor: pointer;
  color: #444;
}
.igv-ui-generic-dialog-container .igv-ui-generic-dialog-one-liner {
  color: #373737;
  width: 95%;
  height: 24px;
  line-height: 24px;
  text-align: left;
  margin-top: 8px;
  padding-left: 8px;
  overflow-wrap: break-word;
  background-color: white;
}
.igv-ui-generic-dialog-container .igv-ui-generic-dialog-label-input {
  margin-top: 8px;
  width: 95%;
  height: 24px;
  color: #373737;
  line-height: 24px;
  padding-left: 8px;
  background-color: white;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: center;
}
.igv-ui-generic-dialog-container .igv-ui-generic-dialog-label-input div {
  width: 30%;
  height: 100%;
  font-size: 16px;
  text-align: right;
  padding-right: 8px;
  background-color: white;
}
.igv-ui-generic-dialog-container .igv-ui-generic-dialog-label-input input {
  display: block;
  height: 100%;
  width: 100%;
  padding-left: 4px;
  font-family: "Open Sans", sans-serif;
  font-weight: 400;
  color: #373737;
  text-align: left;
  outline: none;
  border-style: solid;
  border-width: thin;
  border-color: #7F7F7F;
  background-color: white;
}
.igv-ui-generic-dialog-container .igv-ui-generic-dialog-label-input input {
  width: 50%;
  font-size: 16px;
}
.igv-ui-generic-dialog-container .igv-ui-generic-dialog-input {
  margin-top: 8px;
  width: calc(100% - 16px);
  height: 24px;
  color: #373737;
  line-height: 24px;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: space-around;
  align-items: center;
}
.igv-ui-generic-dialog-container .igv-ui-generic-dialog-input input {
  display: block;
  height: 100%;
  width: 100%;
  padding-left: 4px;
  font-family: "Open Sans", sans-serif;
  font-weight: 400;
  color: #373737;
  text-align: left;
  outline: none;
  border-style: solid;
  border-width: thin;
  border-color: #7F7F7F;
  background-color: white;
}
.igv-ui-generic-dialog-container .igv-ui-generic-dialog-input input {
  font-size: 16px;
}
.igv-ui-generic-dialog-container .igv-ui-generic-dialog-ok-cancel {
  width: 100%;
  height: 28px;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: space-around;
  align-items: center;
}
.igv-ui-generic-dialog-container .igv-ui-generic-dialog-ok-cancel div {
  margin-top: 32px;
  color: white;
  font-family: "Open Sans", sans-serif;
  font-size: 14px;
  font-weight: 400;
  width: 75px;
  height: 28px;
  line-height: 28px;
  text-align: center;
  border-color: transparent;
  border-style: solid;
  border-width: thin;
  border-radius: 2px;
}
.igv-ui-generic-dialog-container .igv-ui-generic-dialog-ok-cancel div:first-child {
  margin-left: 32px;
  margin-right: 0;
  background-color: #5ea4e0;
}
.igv-ui-generic-dialog-container .igv-ui-generic-dialog-ok-cancel div:last-child {
  margin-left: 0;
  margin-right: 32px;
  background-color: #c4c4c4;
}
.igv-ui-generic-dialog-container .igv-ui-generic-dialog-ok-cancel div:first-child:hover {
  cursor: pointer;
  background-color: #3b5c7f;
}
.igv-ui-generic-dialog-container .igv-ui-generic-dialog-ok-cancel div:last-child:hover {
  cursor: pointer;
  background-color: #7f7f7f;
}
.igv-ui-generic-dialog-container .igv-ui-generic-dialog-ok {
  width: 100%;
  height: 36px;
  margin-top: 32px;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: space-around;
  align-items: center;
}
.igv-ui-generic-dialog-container .igv-ui-generic-dialog-ok div {
  width: 98px;
  height: 36px;
  line-height: 36px;
  text-align: center;
  color: white;
  font-family: "Open Sans", sans-serif;
  font-size: medium;
  font-weight: 400;
  border-color: white;
  border-style: solid;
  border-width: thin;
  border-radius: 4px;
  background-color: #2B81AF;
}
.igv-ui-generic-dialog-container .igv-ui-generic-dialog-ok div:hover {
  cursor: pointer;
  background-color: #25597f;
}

.igv-ui-generic-container {
  box-sizing: content-box;
  position: absolute;
  z-index: 2048;
  background-color: white;
  cursor: pointer;
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  justify-content: flex-start;
  align-items: center;
}
.igv-ui-generic-container > div:first-child {
  cursor: move;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: flex-end;
  align-items: center;
  height: 24px;
  width: 100%;
  background-color: #dddddd;
}
.igv-ui-generic-container > div:first-child > div {
  display: block;
  color: #5f5f5f;
  cursor: pointer;
  width: 14px;
  height: 14px;
  margin-right: 8px;
  margin-bottom: 4px;
}

.igv-ui-dialog {
  z-index: 2048;
  position: fixed;
  width: fit-content;
  height: fit-content;
  display: flex;
  flex-flow: column;
  flex-wrap: nowrap;
  justify-content: flex-start;
  background-color: white;
  border-color: #7F7F7F;
  border-radius: 4px;
  border-style: solid;
  border-width: thin;
  font-family: "Open Sans", sans-serif;
  font-size: medium;
  font-weight: 400;
}
.igv-ui-dialog .igv-ui-dialog-header {
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: flex-end;
  align-items: center;
  width: 100%;
  height: 24px;
  cursor: move;
  border-top-left-radius: 4px;
  border-top-right-radius: 4px;
  border-bottom-color: #7F7F7F;
  border-bottom-style: solid;
  border-bottom-width: thin;
  background-color: #eee;
}
.igv-ui-dialog .igv-ui-dialog-header div {
  margin-right: 4px;
  margin-bottom: 2px;
  height: 12px;
  width: 12px;
  color: #7F7F7F;
}
.igv-ui-dialog .igv-ui-dialog-header div:hover {
  cursor: pointer;
  color: #444;
}
.igv-ui-dialog .igv-ui-dialog-one-liner {
  width: 95%;
  height: 24px;
  line-height: 24px;
  text-align: left;
  margin: 8px;
  overflow-wrap: break-word;
  background-color: white;
  font-weight: bold;
}
.igv-ui-dialog .igv-ui-dialog-ok-cancel {
  width: 100%;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: space-around;
  align-items: center;
}
.igv-ui-dialog .igv-ui-dialog-ok-cancel div {
  margin: 16px;
  margin-top: 32px;
  color: white;
  font-family: "Open Sans", sans-serif;
  font-size: 14px;
  font-weight: 400;
  width: 75px;
  height: 28px;
  line-height: 28px;
  text-align: center;
  border-color: transparent;
  border-style: solid;
  border-width: thin;
  border-radius: 2px;
}
.igv-ui-dialog .igv-ui-dialog-ok-cancel div:first-child {
  background-color: #5ea4e0;
}
.igv-ui-dialog .igv-ui-dialog-ok-cancel div:last-child {
  background-color: #c4c4c4;
}
.igv-ui-dialog .igv-ui-dialog-ok-cancel div:first-child:hover {
  cursor: pointer;
  background-color: #3b5c7f;
}
.igv-ui-dialog .igv-ui-dialog-ok-cancel div:last-child:hover {
  cursor: pointer;
  background-color: #7f7f7f;
}
.igv-ui-dialog .igv-ui-dialog-ok {
  width: 100%;
  height: 36px;
  margin-top: 32px;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: space-around;
  align-items: center;
}
.igv-ui-dialog .igv-ui-dialog-ok div {
  width: 98px;
  height: 36px;
  line-height: 36px;
  text-align: center;
  color: white;
  font-family: "Open Sans", sans-serif;
  font-size: medium;
  font-weight: 400;
  border-color: white;
  border-style: solid;
  border-width: thin;
  border-radius: 4px;
  background-color: #2B81AF;
}
.igv-ui-dialog .igv-ui-dialog-ok div:hover {
  cursor: pointer;
  background-color: #25597f;
}

.igv-ui-panel, .igv-ui-panel-row, .igv-ui-panel-column {
  z-index: 2048;
  background-color: white;
  font-family: "Open Sans", sans-serif;
  font-size: medium;
  font-weight: 400;
  display: flex;
  justify-content: flex-start;
  align-items: flex-start;
}

.igv-ui-panel-column {
  display: flex;
  flex-direction: column;
}

.igv-ui-panel-row {
  display: flex;
  flex-direction: row;
}

.igv-ui-textbox {
  background-color: white;
  font-family: "Open Sans", sans-serif;
  font-size: medium;
  font-weight: 400;
  display: flex;
  justify-content: flex-start;
  align-items: flex-start;
}

.igv-ui-table {
  background-color: white;
}

.igv-ui-table thead {
  position: sticky;
  top: 0;
}

.igv-ui-table th {
  text-align: left;
}

.igv-ui-table td {
  padding-right: 20px;
}

.igv-ui-table tr:hover {
  background-color: lightblue;
}

/*# sourceMappingURL=igv-ui.css.map */
`,document.head.append(i)}typeof document<"u"&&(function(e){for(let t of document.styleSheets)if(t=t.href?t.href.replace(/^.*[\\\/]/,""):"",t===e)return!0;return!1}("igv-ui.css")||Mb());function ot(i,e){let t=de.div({class:"igv-menu-popup-check-container"}),n=de.div();t.appendChild(n);let s=Ui.createIcon("check",e===!0?"#444":"transparent");n.appendChild(s);let r=de.div();return r.innerText=i,t.appendChild(r),t}var Xt={trackMenuItemList:function(i){let e=new Set(["alignment","annotation","variant","eqtl","snp"]),t=i.track.config&&i.track.config.visibilityWindow!==void 0,n=[];return i.track.config.type!=="sequence"&&(n.push(Fb(i)),n.push(Db(i))),this.showColorPicker(i.track)&&(n.push("<hr/>"),n.push(ff({trackView:i,label:"Set track color",option:"color"})),n.push(Lb({trackView:i,label:"Unset track color"})),(i.track.config.type==="wig"||i.track.config.type==="annotation")&&(n.push(ff({trackView:i,label:"Set alt color",option:"altColor"})),n.push(Nb({trackView:i,label:"Unset alt color"})))),i.track.menuItemList&&(n=n.concat(i.track.menuItemList())),(t||e.has(i.track.type))&&(n.push("<hr/>"),n.push(Rb(i))),i.track.removable!==!1&&(n.push("<hr/>"),n.push(Ib(i))),n},numericDataMenuItems:function(i){let e=[];e.push("<hr/>");let t=pe("<div>");t.text("Set data range");let n=()=>{i.browser.dataRangeDialog.configure(i),i.browser.dataRangeDialog.present(pe(i.browser.columnContainer))};return e.push({object:t,click:n}),i.track.logScale!==void 0&&e.push({object:pe(ot("Log scale",i.track.logScale)),click:()=>{i.track.logScale=!i.track.logScale,i.repaintViews()}}),e.push({object:pe(ot("Autoscale",i.track.autoscale)),click:()=>{i.track.autoscale=!i.track.autoscale,i.updateViews()}}),e},trackMenuItemListHelper:function(i,e){var t=[];return i.length>0&&(t=i.map(function(n,s){var r;if(n.name?(r=pe("<div>"),r.text(n.name)):n.object?r=n.object:typeof n.label=="string"?(r=pe("<div>"),r.html(n.label)):typeof n=="string"&&(n.startsWith("<")?r=pe(n):r=pe("<div>"+n+"</div>")),s===0&&r.addClass("igv-track-menu-border-top"),n.click){let a=function(o){n.click(o),e.hide(),o.preventDefault(),o.stopPropagation()};r.on("click",a),r.on("touchend",function(o){a(o)}),r.on("mouseup",function(o){o.preventDefault(),o.stopPropagation()})}return{object:r,init:n.init||void 0}})),t},showColorPicker(i){return i.type===void 0||i.type==="bedtype"||i.type==="alignment"||i.type==="annotation"||i.type==="variant"||i.type==="wig"||i.type==="interact"},createMenuItem(i,e){let t=pe("<div>");return t.text(i),{object:t,click:e}}};function Rb(i){let e=n=>{let s=()=>{let a=i.browser.inputDialog.value;a=a===""||a===void 0?-1:a.trim(),i.track.visibilityWindow=Number.parseInt(a),i.track.config.visibilityWindow=Number.parseInt(a),i.updateViews()},r={label:"Visibility Window",value:i.track.visibilityWindow,callback:s};i.browser.inputDialog.present(r,n)},t=pe("<div>");return t.text("Set visibility window"),{object:t,click:e}}function Ib(i){let e=pe("<div>");return e.text("Remove track"),{object:e,click:()=>i.browser.removeTrack(i.track)}}function ff({trackView:i,label:e,option:t}){let n=pe("<div>");return n.text(e),{object:n,click:()=>i.presentColorPicker(t)}}function Lb({trackView:i,label:e}){let t=pe("<div>");return t.text(e),{object:t,click:()=>{i.track.color=void 0,i.repaintViews()}}}function Nb({trackView:i,label:e}){let t=pe("<div>");return t.text(e),{object:t,click:()=>{i.track.altColor=void 0,i.repaintViews()}}}function Fb(i){let e=n=>{let s=function(){let a=i.browser.inputDialog.value;a=a===""||a===void 0?"untitled":a.trim(),i.track.name=a},r={label:"Track Name",value:Ob(i.track)||"unnamed",callback:s};i.browser.inputDialog.present(r,n)},t=pe("<div>");return t.text("Set track name"),{object:t,click:e}}function Db(i){let e=n=>{let s=()=>{let a=Number(i.browser.inputDialog.value,10);a!==void 0&&(i.track.minHeight!==void 0&&i.track.minHeight>a&&(i.track.minHeight=a),i.track.maxHeight!==void 0&&i.track.maxHeight<a&&(i.track.minHeight=a),i.setTrackHeight(a,!0),i.checkContentHeight(),i.repaintViews(),i.track.autoHeight=!1)},r={label:"Track Height",value:i.track.height,callback:s};i.browser.inputDialog.present(r,n)},t=pe("<div>");return t.text("Set track height"),{object:t,click:e}}function Ob(i){var e,t;return e=i.trackView.viewports[0],t=e.$trackLabel.text(),t}var Ss=class{constructor(e,t,n){this.browser=e,this.$container=pe("<div>",{class:"igv-generic-dialog-container"}),t.append(this.$container),this.$container.offset({left:0,top:0});let s=pe("<div>",{class:"igv-generic-dialog-header"});this.$container.append(s),sc.attachDialogCloseHandlerWithParent(s[0],()=>{this.$minimum_input.val(void 0),this.$maximum_input.val(void 0),this.$container.offset({left:0,top:0}),this.$container.hide()}),this.$minimum=pe("<div>",{class:"igv-generic-dialog-label-input"}),this.$container.append(this.$minimum);let r=pe("<div>");r.text("Minimum"),this.$minimum.append(r),this.$minimum_input=pe("<input>"),this.$minimum.append(this.$minimum_input),this.$maximum=pe("<div>",{class:"igv-generic-dialog-label-input"}),this.$container.append(this.$maximum);let a=pe("<div>");a.text("Maximum"),this.$maximum.append(a),this.$maximum_input=pe("<input>"),this.$maximum.append(this.$maximum_input);let o=pe("<div>",{class:"igv-generic-dialog-ok-cancel"});this.$container.append(o),this.$ok=pe("<div>"),o.append(this.$ok),this.$ok.text("OK"),this.$cancel=pe("<div>"),o.append(this.$cancel),this.$cancel.text("Cancel"),this.$cancel.on("click",()=>{this.$minimum_input.val(void 0),this.$maximum_input.val(void 0),this.$container.offset({left:0,top:0}),this.$container.hide()}),Ki(this.$container.get(0),s.get(0)),this.$container.hide()}configure(e){let t=e.dataRange(),n,s;t?(n=t.min,s=t.max):(n=0,s=100),this.$minimum_input.val(n),this.$maximum_input.val(s),this.$minimum_input.unbind(),this.$minimum_input.on("keyup",r=>{r.keyCode===13&&this.processResults(e)}),this.$maximum_input.unbind(),this.$maximum_input.on("keyup",r=>{r.keyCode===13&&this.processResults(e)}),this.$ok.unbind(),this.$ok.on("click",r=>{this.processResults(e)})}processResults(e){let t=Number(this.$minimum_input.val()),n=Number(this.$maximum_input.val());isNaN(t)||isNaN(n)?this.browser.alert.present(new Error("Must input numeric values"),void 0):e.setDataRange(t,n),this.$minimum_input.val(void 0),this.$maximum_input.val(void 0),this.$container.offset({left:0,top:0}),this.$container.hide()}present(e){let t=e.offset().top,n=pe("body").scrollTop();this.$container.offset({left:e.width()-this.$container.width(),top:t+n}),this.$container.show()}};function yt(i){return typeof i=="string"||i instanceof String}function De(i){var e=String(i).split(/[.,]/),t=",",n=".";return e[0].split("").reverse().reduce(function(s,r,a){return a%3===0?s+t+r:s+r}).split("").reverse().join("")+(e[1]?n+e[1]:"")}var Ji=function(i){return i.split(/\n|\r\n|\r/g)};function Bb(i,e){var t=[],n=i.length,s,r=0,a=!1,o;if(n>0)for(t[r]=i.charAt(0),s=1;s<n;s++)o=i.charAt(s),o==='"'?a=!a:!a&&o===e?(r++,t[r]=""):t[r]+=o;return t}function Pb(i){return i===void 0||((i.startsWith("'")||i.startsWith('"'))&&(i=i.substring(1)),(i.endsWith("'")||i.endsWith('"'))&&(i=i.substring(0,i.length-1))),i}function Po(i){return i.length>0?i.charAt(0).toUpperCase()+i.slice(1):i}function zb(i){let e=i.split(":"),t=e[1].split("-"),n={chr:e[0],start:Number.parseInt(t[0].replace(/,/g,""))-1};return t.length>1?n.end=Number.parseInt(t[1].replace(/,/g,"")):n.end=n.start+1,n}function Cs(i){if(i.name!==void 0)return i.name;if(yt(i)){let e=i.lastIndexOf("/"),t=e<0?i:i.substr(e+1);return e=t.indexOf("?"),e>0&&(t=t.substr(0,e)),t}else throw Error(`Expected File or string, got ${typeof i}`)}function Ei(i){return i?typeof i!="function"&&(i instanceof File||i.hasOwnProperty("name")&&typeof i.slice=="function"&&typeof i.arrayBuffer=="function"):!1}function zo(i,e){let t=document.createElement("a");t.setAttribute("href",e),t.setAttribute("download",i),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}typeof __Process$=="object"&&typeof window>"u"&&(__global$.atob=function(i){return __Buffer$.from(i,"base64").toString("binary")});function qp(i){for(var e=Hb,t=e.parser.loose.exec(i),n={},s=14;s--;)n[e.key[s]]=t[s]||"";return n[e.q.name]={},n[e.key[12]].replace(e.q.parser,function(r,a,o){a&&(n[e.q.name][a]=o)}),n}var Hb={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};async function Ub(i){return typeof i=="function"?i():i}var $b=4,uf=0,df=1,Vb=2;function Ln(i){let e=i.length;for(;--e>=0;)i[e]=0}var qb=0,Wp=1,Wb=2,jb=3,Gb=258,ac=29,Ir=256,pr=Ir+1+ac,yn=30,oc=19,jp=2*pr+1,Fi=15,Oa=16,Zb=7,lc=256,Gp=16,Zp=17,Xp=18,Ho=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),hs=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Xb=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Yp=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Yb=512,ui=new Array((pr+2)*2);Ln(ui);var tr=new Array(yn*2);Ln(tr);var gr=new Array(Yb);Ln(gr);var mr=new Array(Gb-jb+1);Ln(mr);var hc=new Array(ac);Ln(hc);var Es=new Array(yn);Ln(Es);function Ba(i,e,t,n,s){this.static_tree=i,this.extra_bits=e,this.extra_base=t,this.elems=n,this.max_length=s,this.has_stree=i&&i.length}var Qp,Kp,Jp;function Pa(i,e){this.dyn_tree=i,this.max_code=0,this.stat_desc=e}var eg=i=>i<256?gr[i]:gr[256+(i>>>7)],br=(i,e)=>{i.pending_buf[i.pending++]=e&255,i.pending_buf[i.pending++]=e>>>8&255},It=(i,e,t)=>{i.bi_valid>Oa-t?(i.bi_buf|=e<<i.bi_valid&65535,br(i,i.bi_buf),i.bi_buf=e>>Oa-i.bi_valid,i.bi_valid+=t-Oa):(i.bi_buf|=e<<i.bi_valid&65535,i.bi_valid+=t)},ii=(i,e,t)=>{It(i,t[e*2],t[e*2+1])},tg=(i,e)=>{let t=0;do t|=i&1,i>>>=1,t<<=1;while(--e>0);return t>>>1},Qb=i=>{i.bi_valid===16?(br(i,i.bi_buf),i.bi_buf=0,i.bi_valid=0):i.bi_valid>=8&&(i.pending_buf[i.pending++]=i.bi_buf&255,i.bi_buf>>=8,i.bi_valid-=8)},Kb=(i,e)=>{let t=e.dyn_tree,n=e.max_code,s=e.stat_desc.static_tree,r=e.stat_desc.has_stree,a=e.stat_desc.extra_bits,o=e.stat_desc.extra_base,l=e.stat_desc.max_length,c,h,d,f,u,g,_=0;for(f=0;f<=Fi;f++)i.bl_count[f]=0;for(t[i.heap[i.heap_max]*2+1]=0,c=i.heap_max+1;c<jp;c++)h=i.heap[c],f=t[t[h*2+1]*2+1]+1,f>l&&(f=l,_++),t[h*2+1]=f,!(h>n)&&(i.bl_count[f]++,u=0,h>=o&&(u=a[h-o]),g=t[h*2],i.opt_len+=g*(f+u),r&&(i.static_len+=g*(s[h*2+1]+u)));if(_!==0){do{for(f=l-1;i.bl_count[f]===0;)f--;i.bl_count[f]--,i.bl_count[f+1]+=2,i.bl_count[l]--,_-=2}while(_>0);for(f=l;f!==0;f--)for(h=i.bl_count[f];h!==0;)d=i.heap[--c],!(d>n)&&(t[d*2+1]!==f&&(i.opt_len+=(f-t[d*2+1])*t[d*2],t[d*2+1]=f),h--)}},ig=(i,e,t)=>{let n=new Array(Fi+1),s=0,r,a;for(r=1;r<=Fi;r++)s=s+t[r-1]<<1,n[r]=s;for(a=0;a<=e;a++){let o=i[a*2+1];o!==0&&(i[a*2]=tg(n[o]++,o))}},Jb=()=>{let i,e,t,n,s,r=new Array(Fi+1);for(t=0,n=0;n<ac-1;n++)for(hc[n]=t,i=0;i<1<<Ho[n];i++)mr[t++]=n;for(mr[t-1]=n,s=0,n=0;n<16;n++)for(Es[n]=s,i=0;i<1<<hs[n];i++)gr[s++]=n;for(s>>=7;n<yn;n++)for(Es[n]=s<<7,i=0;i<1<<hs[n]-7;i++)gr[256+s++]=n;for(e=0;e<=Fi;e++)r[e]=0;for(i=0;i<=143;)ui[i*2+1]=8,i++,r[8]++;for(;i<=255;)ui[i*2+1]=9,i++,r[9]++;for(;i<=279;)ui[i*2+1]=7,i++,r[7]++;for(;i<=287;)ui[i*2+1]=8,i++,r[8]++;for(ig(ui,pr+1,r),i=0;i<yn;i++)tr[i*2+1]=5,tr[i*2]=tg(i,5);Qp=new Ba(ui,Ho,Ir+1,pr,Fi),Kp=new Ba(tr,hs,0,yn,Fi),Jp=new Ba(new Array(0),Xb,0,oc,Zb)},ng=i=>{let e;for(e=0;e<pr;e++)i.dyn_ltree[e*2]=0;for(e=0;e<yn;e++)i.dyn_dtree[e*2]=0;for(e=0;e<oc;e++)i.bl_tree[e*2]=0;i.dyn_ltree[lc*2]=1,i.opt_len=i.static_len=0,i.sym_next=i.matches=0},rg=i=>{i.bi_valid>8?br(i,i.bi_buf):i.bi_valid>0&&(i.pending_buf[i.pending++]=i.bi_buf),i.bi_buf=0,i.bi_valid=0},pf=(i,e,t,n)=>{let s=e*2,r=t*2;return i[s]<i[r]||i[s]===i[r]&&n[e]<=n[t]},za=(i,e,t)=>{let n=i.heap[t],s=t<<1;for(;s<=i.heap_len&&(s<i.heap_len&&pf(e,i.heap[s+1],i.heap[s],i.depth)&&s++,!pf(e,n,i.heap[s],i.depth));)i.heap[t]=i.heap[s],t=s,s<<=1;i.heap[t]=n},gf=(i,e,t)=>{let n,s,r=0,a,o;if(i.sym_next!==0)do n=i.pending_buf[i.sym_buf+r++]&255,n+=(i.pending_buf[i.sym_buf+r++]&255)<<8,s=i.pending_buf[i.sym_buf+r++],n===0?ii(i,s,e):(a=mr[s],ii(i,a+Ir+1,e),o=Ho[a],o!==0&&(s-=hc[a],It(i,s,o)),n--,a=eg(n),ii(i,a,t),o=hs[a],o!==0&&(n-=Es[a],It(i,n,o)));while(r<i.sym_next);ii(i,lc,e)},Uo=(i,e)=>{let t=e.dyn_tree,n=e.stat_desc.static_tree,s=e.stat_desc.has_stree,r=e.stat_desc.elems,a,o,l=-1,c;for(i.heap_len=0,i.heap_max=jp,a=0;a<r;a++)t[a*2]!==0?(i.heap[++i.heap_len]=l=a,i.depth[a]=0):t[a*2+1]=0;for(;i.heap_len<2;)c=i.heap[++i.heap_len]=l<2?++l:0,t[c*2]=1,i.depth[c]=0,i.opt_len--,s&&(i.static_len-=n[c*2+1]);for(e.max_code=l,a=i.heap_len>>1;a>=1;a--)za(i,t,a);c=r;do a=i.heap[1],i.heap[1]=i.heap[i.heap_len--],za(i,t,1),o=i.heap[1],i.heap[--i.heap_max]=a,i.heap[--i.heap_max]=o,t[c*2]=t[a*2]+t[o*2],i.depth[c]=(i.depth[a]>=i.depth[o]?i.depth[a]:i.depth[o])+1,t[a*2+1]=t[o*2+1]=c,i.heap[1]=c++,za(i,t,1);while(i.heap_len>=2);i.heap[--i.heap_max]=i.heap[1],Kb(i,e),ig(t,l,i.bl_count)},mf=(i,e,t)=>{let n,s=-1,r,a=e[0*2+1],o=0,l=7,c=4;for(a===0&&(l=138,c=3),e[(t+1)*2+1]=65535,n=0;n<=t;n++)r=a,a=e[(n+1)*2+1],!(++o<l&&r===a)&&(o<c?i.bl_tree[r*2]+=o:r!==0?(r!==s&&i.bl_tree[r*2]++,i.bl_tree[Gp*2]++):o<=10?i.bl_tree[Zp*2]++:i.bl_tree[Xp*2]++,o=0,s=r,a===0?(l=138,c=3):r===a?(l=6,c=3):(l=7,c=4))},bf=(i,e,t)=>{let n,s=-1,r,a=e[0*2+1],o=0,l=7,c=4;for(a===0&&(l=138,c=3),n=0;n<=t;n++)if(r=a,a=e[(n+1)*2+1],!(++o<l&&r===a)){if(o<c)do ii(i,r,i.bl_tree);while(--o!==0);else r!==0?(r!==s&&(ii(i,r,i.bl_tree),o--),ii(i,Gp,i.bl_tree),It(i,o-3,2)):o<=10?(ii(i,Zp,i.bl_tree),It(i,o-3,3)):(ii(i,Xp,i.bl_tree),It(i,o-11,7));o=0,s=r,a===0?(l=138,c=3):r===a?(l=6,c=3):(l=7,c=4)}},e1=i=>{let e;for(mf(i,i.dyn_ltree,i.l_desc.max_code),mf(i,i.dyn_dtree,i.d_desc.max_code),Uo(i,i.bl_desc),e=oc-1;e>=3&&i.bl_tree[Yp[e]*2+1]===0;e--);return i.opt_len+=3*(e+1)+5+5+4,e},t1=(i,e,t,n)=>{let s;for(It(i,e-257,5),It(i,t-1,5),It(i,n-4,4),s=0;s<n;s++)It(i,i.bl_tree[Yp[s]*2+1],3);bf(i,i.dyn_ltree,e-1),bf(i,i.dyn_dtree,t-1)},i1=i=>{let e=4093624447,t;for(t=0;t<=31;t++,e>>>=1)if(e&1&&i.dyn_ltree[t*2]!==0)return uf;if(i.dyn_ltree[9*2]!==0||i.dyn_ltree[10*2]!==0||i.dyn_ltree[13*2]!==0)return df;for(t=32;t<Ir;t++)if(i.dyn_ltree[t*2]!==0)return df;return uf},wf=!1,n1=i=>{wf||(Jb(),wf=!0),i.l_desc=new Pa(i.dyn_ltree,Qp),i.d_desc=new Pa(i.dyn_dtree,Kp),i.bl_desc=new Pa(i.bl_tree,Jp),i.bi_buf=0,i.bi_valid=0,ng(i)},sg=(i,e,t,n)=>{It(i,(qb<<1)+(n?1:0),3),rg(i),br(i,t),br(i,~t),t&&i.pending_buf.set(i.window.subarray(e,e+t),i.pending),i.pending+=t},r1=i=>{It(i,Wp<<1,3),ii(i,lc,ui),Qb(i)},s1=(i,e,t,n)=>{let s,r,a=0;i.level>0?(i.strm.data_type===Vb&&(i.strm.data_type=i1(i)),Uo(i,i.l_desc),Uo(i,i.d_desc),a=e1(i),s=i.opt_len+3+7>>>3,r=i.static_len+3+7>>>3,r<=s&&(s=r)):s=r=t+5,t+4<=s&&e!==-1?sg(i,e,t,n):i.strategy===$b||r===s?(It(i,(Wp<<1)+(n?1:0),3),gf(i,ui,tr)):(It(i,(Wb<<1)+(n?1:0),3),t1(i,i.l_desc.max_code+1,i.d_desc.max_code+1,a+1),gf(i,i.dyn_ltree,i.dyn_dtree)),ng(i),n&&rg(i)},a1=(i,e,t)=>(i.pending_buf[i.sym_buf+i.sym_next++]=e,i.pending_buf[i.sym_buf+i.sym_next++]=e>>8,i.pending_buf[i.sym_buf+i.sym_next++]=t,e===0?i.dyn_ltree[t*2]++:(i.matches++,e--,i.dyn_ltree[(mr[t]+Ir+1)*2]++,i.dyn_dtree[eg(e)*2]++),i.sym_next===i.sym_end),o1=n1,l1=sg,h1=s1,c1=a1,f1=r1,u1={_tr_init:o1,_tr_stored_block:l1,_tr_flush_block:h1,_tr_tally:c1,_tr_align:f1},d1=(i,e,t,n)=>{let s=i&65535|0,r=i>>>16&65535|0,a=0;for(;t!==0;){a=t>2e3?2e3:t,t-=a;do s=s+e[n++]|0,r=r+s|0;while(--a);s%=65521,r%=65521}return s|r<<16|0},wr=d1,p1=()=>{let i,e=[];for(var t=0;t<256;t++){i=t;for(var n=0;n<8;n++)i=i&1?3988292384^i>>>1:i>>>1;e[t]=i}return e},g1=new Uint32Array(p1()),m1=(i,e,t,n)=>{let s=g1,r=n+t;i^=-1;for(let a=n;a<r;a++)i=i>>>8^s[(i^e[a])&255];return i^-1},wt=m1,$i={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Nn={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},{_tr_init:b1,_tr_stored_block:$o,_tr_flush_block:w1,_tr_tally:ki,_tr_align:v1}=u1,{Z_NO_FLUSH:Si,Z_PARTIAL_FLUSH:_1,Z_FULL_FLUSH:y1,Z_FINISH:Ht,Z_BLOCK:vf,Z_OK:xt,Z_STREAM_END:_f,Z_STREAM_ERROR:ri,Z_DATA_ERROR:x1,Z_BUF_ERROR:Ha,Z_DEFAULT_COMPRESSION:k1,Z_FILTERED:S1,Z_HUFFMAN_ONLY:Hr,Z_RLE:C1,Z_FIXED:E1,Z_DEFAULT_STRATEGY:A1,Z_UNKNOWN:T1,Z_DEFLATED:va}=Nn,M1=9,R1=15,I1=8,L1=29,N1=256,Vo=N1+1+L1,F1=30,D1=19,O1=2*Vo+1,B1=15,$e=3,xi=258,si=xi+$e+1,P1=32,Cn=42,cc=57,qo=69,Wo=73,jo=91,Go=103,Di=113,Kn=666,At=1,Fn=2,Vi=3,Dn=4,z1=3,Oi=(i,e)=>(i.msg=$i[e],e),yf=i=>i*2-(i>4?9:0),yi=i=>{let e=i.length;for(;--e>=0;)i[e]=0},H1=i=>{let e,t,n,s=i.w_size;e=i.hash_size,n=e;do t=i.head[--n],i.head[n]=t>=s?t-s:0;while(--e);e=s,n=e;do t=i.prev[--n],i.prev[n]=t>=s?t-s:0;while(--e)},U1=(i,e,t)=>(e<<i.hash_shift^t)&i.hash_mask,Ci=U1,Nt=i=>{let e=i.state,t=e.pending;t>i.avail_out&&(t=i.avail_out),t!==0&&(i.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+t),i.next_out),i.next_out+=t,e.pending_out+=t,i.total_out+=t,i.avail_out-=t,e.pending-=t,e.pending===0&&(e.pending_out=0))},Ot=(i,e)=>{w1(i,i.block_start>=0?i.block_start:-1,i.strstart-i.block_start,e),i.block_start=i.strstart,Nt(i.strm)},je=(i,e)=>{i.pending_buf[i.pending++]=e},Vn=(i,e)=>{i.pending_buf[i.pending++]=e>>>8&255,i.pending_buf[i.pending++]=e&255},Zo=(i,e,t,n)=>{let s=i.avail_in;return s>n&&(s=n),s===0?0:(i.avail_in-=s,e.set(i.input.subarray(i.next_in,i.next_in+s),t),i.state.wrap===1?i.adler=wr(i.adler,e,s,t):i.state.wrap===2&&(i.adler=wt(i.adler,e,s,t)),i.next_in+=s,i.total_in+=s,s)},ag=(i,e)=>{let t=i.max_chain_length,n=i.strstart,s,r,a=i.prev_length,o=i.nice_match,l=i.strstart>i.w_size-si?i.strstart-(i.w_size-si):0,c=i.window,h=i.w_mask,d=i.prev,f=i.strstart+xi,u=c[n+a-1],g=c[n+a];i.prev_length>=i.good_match&&(t>>=2),o>i.lookahead&&(o=i.lookahead);do if(s=e,!(c[s+a]!==g||c[s+a-1]!==u||c[s]!==c[n]||c[++s]!==c[n+1])){n+=2,s++;do;while(c[++n]===c[++s]&&c[++n]===c[++s]&&c[++n]===c[++s]&&c[++n]===c[++s]&&c[++n]===c[++s]&&c[++n]===c[++s]&&c[++n]===c[++s]&&c[++n]===c[++s]&&n<f);if(r=xi-(f-n),n=f-xi,r>a){if(i.match_start=e,a=r,r>=o)break;u=c[n+a-1],g=c[n+a]}}while((e=d[e&h])>l&&--t!==0);return a<=i.lookahead?a:i.lookahead},En=i=>{let e=i.w_size,t,n,s;do{if(n=i.window_size-i.lookahead-i.strstart,i.strstart>=e+(e-si)&&(i.window.set(i.window.subarray(e,e+e-n),0),i.match_start-=e,i.strstart-=e,i.block_start-=e,i.insert>i.strstart&&(i.insert=i.strstart),H1(i),n+=e),i.strm.avail_in===0)break;if(t=Zo(i.strm,i.window,i.strstart+i.lookahead,n),i.lookahead+=t,i.lookahead+i.insert>=$e)for(s=i.strstart-i.insert,i.ins_h=i.window[s],i.ins_h=Ci(i,i.ins_h,i.window[s+1]);i.insert&&(i.ins_h=Ci(i,i.ins_h,i.window[s+$e-1]),i.prev[s&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=s,s++,i.insert--,!(i.lookahead+i.insert<$e)););}while(i.lookahead<si&&i.strm.avail_in!==0)},og=(i,e)=>{let t=i.pending_buf_size-5>i.w_size?i.w_size:i.pending_buf_size-5,n,s,r,a=0,o=i.strm.avail_in;do{if(n=65535,r=i.bi_valid+42>>3,i.strm.avail_out<r||(r=i.strm.avail_out-r,s=i.strstart-i.block_start,n>s+i.strm.avail_in&&(n=s+i.strm.avail_in),n>r&&(n=r),n<t&&(n===0&&e!==Ht||e===Si||n!==s+i.strm.avail_in)))break;a=e===Ht&&n===s+i.strm.avail_in?1:0,$o(i,0,0,a),i.pending_buf[i.pending-4]=n,i.pending_buf[i.pending-3]=n>>8,i.pending_buf[i.pending-2]=~n,i.pending_buf[i.pending-1]=~n>>8,Nt(i.strm),s&&(s>n&&(s=n),i.strm.output.set(i.window.subarray(i.block_start,i.block_start+s),i.strm.next_out),i.strm.next_out+=s,i.strm.avail_out-=s,i.strm.total_out+=s,i.block_start+=s,n-=s),n&&(Zo(i.strm,i.strm.output,i.strm.next_out,n),i.strm.next_out+=n,i.strm.avail_out-=n,i.strm.total_out+=n)}while(a===0);return o-=i.strm.avail_in,o&&(o>=i.w_size?(i.matches=2,i.window.set(i.strm.input.subarray(i.strm.next_in-i.w_size,i.strm.next_in),0),i.strstart=i.w_size,i.insert=i.strstart):(i.window_size-i.strstart<=o&&(i.strstart-=i.w_size,i.window.set(i.window.subarray(i.w_size,i.w_size+i.strstart),0),i.matches<2&&i.matches++,i.insert>i.strstart&&(i.insert=i.strstart)),i.window.set(i.strm.input.subarray(i.strm.next_in-o,i.strm.next_in),i.strstart),i.strstart+=o,i.insert+=o>i.w_size-i.insert?i.w_size-i.insert:o),i.block_start=i.strstart),i.high_water<i.strstart&&(i.high_water=i.strstart),a?Dn:e!==Si&&e!==Ht&&i.strm.avail_in===0&&i.strstart===i.block_start?Fn:(r=i.window_size-i.strstart,i.strm.avail_in>r&&i.block_start>=i.w_size&&(i.block_start-=i.w_size,i.strstart-=i.w_size,i.window.set(i.window.subarray(i.w_size,i.w_size+i.strstart),0),i.matches<2&&i.matches++,r+=i.w_size,i.insert>i.strstart&&(i.insert=i.strstart)),r>i.strm.avail_in&&(r=i.strm.avail_in),r&&(Zo(i.strm,i.window,i.strstart,r),i.strstart+=r,i.insert+=r>i.w_size-i.insert?i.w_size-i.insert:r),i.high_water<i.strstart&&(i.high_water=i.strstart),r=i.bi_valid+42>>3,r=i.pending_buf_size-r>65535?65535:i.pending_buf_size-r,t=r>i.w_size?i.w_size:r,s=i.strstart-i.block_start,(s>=t||(s||e===Ht)&&e!==Si&&i.strm.avail_in===0&&s<=r)&&(n=s>r?r:s,a=e===Ht&&i.strm.avail_in===0&&n===s?1:0,$o(i,i.block_start,n,a),i.block_start+=n,Nt(i.strm)),a?Vi:At)},Ua=(i,e)=>{let t,n;for(;;){if(i.lookahead<si){if(En(i),i.lookahead<si&&e===Si)return At;if(i.lookahead===0)break}if(t=0,i.lookahead>=$e&&(i.ins_h=Ci(i,i.ins_h,i.window[i.strstart+$e-1]),t=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart),t!==0&&i.strstart-t<=i.w_size-si&&(i.match_length=ag(i,t)),i.match_length>=$e)if(n=ki(i,i.strstart-i.match_start,i.match_length-$e),i.lookahead-=i.match_length,i.match_length<=i.max_lazy_match&&i.lookahead>=$e){i.match_length--;do i.strstart++,i.ins_h=Ci(i,i.ins_h,i.window[i.strstart+$e-1]),t=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart;while(--i.match_length!==0);i.strstart++}else i.strstart+=i.match_length,i.match_length=0,i.ins_h=i.window[i.strstart],i.ins_h=Ci(i,i.ins_h,i.window[i.strstart+1]);else n=ki(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++;if(n&&(Ot(i,!1),i.strm.avail_out===0))return At}return i.insert=i.strstart<$e-1?i.strstart:$e-1,e===Ht?(Ot(i,!0),i.strm.avail_out===0?Vi:Dn):i.sym_next&&(Ot(i,!1),i.strm.avail_out===0)?At:Fn},hn=(i,e)=>{let t,n,s;for(;;){if(i.lookahead<si){if(En(i),i.lookahead<si&&e===Si)return At;if(i.lookahead===0)break}if(t=0,i.lookahead>=$e&&(i.ins_h=Ci(i,i.ins_h,i.window[i.strstart+$e-1]),t=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart),i.prev_length=i.match_length,i.prev_match=i.match_start,i.match_length=$e-1,t!==0&&i.prev_length<i.max_lazy_match&&i.strstart-t<=i.w_size-si&&(i.match_length=ag(i,t),i.match_length<=5&&(i.strategy===S1||i.match_length===$e&&i.strstart-i.match_start>4096)&&(i.match_length=$e-1)),i.prev_length>=$e&&i.match_length<=i.prev_length){s=i.strstart+i.lookahead-$e,n=ki(i,i.strstart-1-i.prev_match,i.prev_length-$e),i.lookahead-=i.prev_length-1,i.prev_length-=2;do++i.strstart<=s&&(i.ins_h=Ci(i,i.ins_h,i.window[i.strstart+$e-1]),t=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart);while(--i.prev_length!==0);if(i.match_available=0,i.match_length=$e-1,i.strstart++,n&&(Ot(i,!1),i.strm.avail_out===0))return At}else if(i.match_available){if(n=ki(i,0,i.window[i.strstart-1]),n&&Ot(i,!1),i.strstart++,i.lookahead--,i.strm.avail_out===0)return At}else i.match_available=1,i.strstart++,i.lookahead--}return i.match_available&&(n=ki(i,0,i.window[i.strstart-1]),i.match_available=0),i.insert=i.strstart<$e-1?i.strstart:$e-1,e===Ht?(Ot(i,!0),i.strm.avail_out===0?Vi:Dn):i.sym_next&&(Ot(i,!1),i.strm.avail_out===0)?At:Fn},$1=(i,e)=>{let t,n,s,r,a=i.window;for(;;){if(i.lookahead<=xi){if(En(i),i.lookahead<=xi&&e===Si)return At;if(i.lookahead===0)break}if(i.match_length=0,i.lookahead>=$e&&i.strstart>0&&(s=i.strstart-1,n=a[s],n===a[++s]&&n===a[++s]&&n===a[++s])){r=i.strstart+xi;do;while(n===a[++s]&&n===a[++s]&&n===a[++s]&&n===a[++s]&&n===a[++s]&&n===a[++s]&&n===a[++s]&&n===a[++s]&&s<r);i.match_length=xi-(r-s),i.match_length>i.lookahead&&(i.match_length=i.lookahead)}if(i.match_length>=$e?(t=ki(i,1,i.match_length-$e),i.lookahead-=i.match_length,i.strstart+=i.match_length,i.match_length=0):(t=ki(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++),t&&(Ot(i,!1),i.strm.avail_out===0))return At}return i.insert=0,e===Ht?(Ot(i,!0),i.strm.avail_out===0?Vi:Dn):i.sym_next&&(Ot(i,!1),i.strm.avail_out===0)?At:Fn},V1=(i,e)=>{let t;for(;;){if(i.lookahead===0&&(En(i),i.lookahead===0)){if(e===Si)return At;break}if(i.match_length=0,t=ki(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++,t&&(Ot(i,!1),i.strm.avail_out===0))return At}return i.insert=0,e===Ht?(Ot(i,!0),i.strm.avail_out===0?Vi:Dn):i.sym_next&&(Ot(i,!1),i.strm.avail_out===0)?At:Fn};function Kt(i,e,t,n,s){this.good_length=i,this.max_lazy=e,this.nice_length=t,this.max_chain=n,this.func=s}var Jn=[new Kt(0,0,0,0,og),new Kt(4,4,8,4,Ua),new Kt(4,5,16,8,Ua),new Kt(4,6,32,32,Ua),new Kt(4,4,16,16,hn),new Kt(8,16,32,32,hn),new Kt(8,16,128,128,hn),new Kt(8,32,128,256,hn),new Kt(32,128,258,1024,hn),new Kt(32,258,258,4096,hn)],q1=i=>{i.window_size=2*i.w_size,yi(i.head),i.max_lazy_match=Jn[i.level].max_lazy,i.good_match=Jn[i.level].good_length,i.nice_match=Jn[i.level].nice_length,i.max_chain_length=Jn[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=$e-1,i.match_available=0,i.ins_h=0};function W1(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=va,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(O1*2),this.dyn_dtree=new Uint16Array((2*F1+1)*2),this.bl_tree=new Uint16Array((2*D1+1)*2),yi(this.dyn_ltree),yi(this.dyn_dtree),yi(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(B1+1),this.heap=new Uint16Array(2*Vo+1),yi(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Vo+1),yi(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var Lr=i=>{if(!i)return 1;let e=i.state;return!e||e.strm!==i||e.status!==Cn&&e.status!==cc&&e.status!==qo&&e.status!==Wo&&e.status!==jo&&e.status!==Go&&e.status!==Di&&e.status!==Kn?1:0},lg=i=>{if(Lr(i))return Oi(i,ri);i.total_in=i.total_out=0,i.data_type=T1;let e=i.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap===2?cc:e.wrap?Cn:Di,i.adler=e.wrap===2?0:1,e.last_flush=-2,b1(e),xt},hg=i=>{let e=lg(i);return e===xt&&q1(i.state),e},j1=(i,e)=>Lr(i)||i.state.wrap!==2?ri:(i.state.gzhead=e,xt),cg=(i,e,t,n,s,r)=>{if(!i)return ri;let a=1;if(e===k1&&(e=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),s<1||s>M1||t!==va||n<8||n>15||e<0||e>9||r<0||r>E1||n===8&&a!==1)return Oi(i,ri);n===8&&(n=9);let o=new W1;return i.state=o,o.strm=i,o.status=Cn,o.wrap=a,o.gzhead=null,o.w_bits=n,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=s+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+$e-1)/$e),o.window=new Uint8Array(o.w_size*2),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<s+6,o.pending_buf_size=o.lit_bufsize*4,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=(o.lit_bufsize-1)*3,o.level=e,o.strategy=r,o.method=t,hg(i)},G1=(i,e)=>cg(i,e,va,R1,I1,A1),Z1=(i,e)=>{if(Lr(i)||e>vf||e<0)return i?Oi(i,ri):ri;let t=i.state;if(!i.output||i.avail_in!==0&&!i.input||t.status===Kn&&e!==Ht)return Oi(i,i.avail_out===0?Ha:ri);let n=t.last_flush;if(t.last_flush=e,t.pending!==0){if(Nt(i),i.avail_out===0)return t.last_flush=-1,xt}else if(i.avail_in===0&&yf(e)<=yf(n)&&e!==Ht)return Oi(i,Ha);if(t.status===Kn&&i.avail_in!==0)return Oi(i,Ha);if(t.status===Cn&&t.wrap===0&&(t.status=Di),t.status===Cn){let s=va+(t.w_bits-8<<4)<<8,r=-1;if(t.strategy>=Hr||t.level<2?r=0:t.level<6?r=1:t.level===6?r=2:r=3,s|=r<<6,t.strstart!==0&&(s|=P1),s+=31-s%31,Vn(t,s),t.strstart!==0&&(Vn(t,i.adler>>>16),Vn(t,i.adler&65535)),i.adler=1,t.status=Di,Nt(i),t.pending!==0)return t.last_flush=-1,xt}if(t.status===cc){if(i.adler=0,je(t,31),je(t,139),je(t,8),t.gzhead)je(t,(t.gzhead.text?1:0)+(t.gzhead.hcrc?2:0)+(t.gzhead.extra?4:0)+(t.gzhead.name?8:0)+(t.gzhead.comment?16:0)),je(t,t.gzhead.time&255),je(t,t.gzhead.time>>8&255),je(t,t.gzhead.time>>16&255),je(t,t.gzhead.time>>24&255),je(t,t.level===9?2:t.strategy>=Hr||t.level<2?4:0),je(t,t.gzhead.os&255),t.gzhead.extra&&t.gzhead.extra.length&&(je(t,t.gzhead.extra.length&255),je(t,t.gzhead.extra.length>>8&255)),t.gzhead.hcrc&&(i.adler=wt(i.adler,t.pending_buf,t.pending,0)),t.gzindex=0,t.status=qo;else if(je(t,0),je(t,0),je(t,0),je(t,0),je(t,0),je(t,t.level===9?2:t.strategy>=Hr||t.level<2?4:0),je(t,z1),t.status=Di,Nt(i),t.pending!==0)return t.last_flush=-1,xt}if(t.status===qo){if(t.gzhead.extra){let s=t.pending,r=(t.gzhead.extra.length&65535)-t.gzindex;for(;t.pending+r>t.pending_buf_size;){let o=t.pending_buf_size-t.pending;if(t.pending_buf.set(t.gzhead.extra.subarray(t.gzindex,t.gzindex+o),t.pending),t.pending=t.pending_buf_size,t.gzhead.hcrc&&t.pending>s&&(i.adler=wt(i.adler,t.pending_buf,t.pending-s,s)),t.gzindex+=o,Nt(i),t.pending!==0)return t.last_flush=-1,xt;s=0,r-=o}let a=new Uint8Array(t.gzhead.extra);t.pending_buf.set(a.subarray(t.gzindex,t.gzindex+r),t.pending),t.pending+=r,t.gzhead.hcrc&&t.pending>s&&(i.adler=wt(i.adler,t.pending_buf,t.pending-s,s)),t.gzindex=0}t.status=Wo}if(t.status===Wo){if(t.gzhead.name){let s=t.pending,r;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>s&&(i.adler=wt(i.adler,t.pending_buf,t.pending-s,s)),Nt(i),t.pending!==0)return t.last_flush=-1,xt;s=0}t.gzindex<t.gzhead.name.length?r=t.gzhead.name.charCodeAt(t.gzindex++)&255:r=0,je(t,r)}while(r!==0);t.gzhead.hcrc&&t.pending>s&&(i.adler=wt(i.adler,t.pending_buf,t.pending-s,s)),t.gzindex=0}t.status=jo}if(t.status===jo){if(t.gzhead.comment){let s=t.pending,r;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>s&&(i.adler=wt(i.adler,t.pending_buf,t.pending-s,s)),Nt(i),t.pending!==0)return t.last_flush=-1,xt;s=0}t.gzindex<t.gzhead.comment.length?r=t.gzhead.comment.charCodeAt(t.gzindex++)&255:r=0,je(t,r)}while(r!==0);t.gzhead.hcrc&&t.pending>s&&(i.adler=wt(i.adler,t.pending_buf,t.pending-s,s))}t.status=Go}if(t.status===Go){if(t.gzhead.hcrc){if(t.pending+2>t.pending_buf_size&&(Nt(i),t.pending!==0))return t.last_flush=-1,xt;je(t,i.adler&255),je(t,i.adler>>8&255),i.adler=0}if(t.status=Di,Nt(i),t.pending!==0)return t.last_flush=-1,xt}if(i.avail_in!==0||t.lookahead!==0||e!==Si&&t.status!==Kn){let s=t.level===0?og(t,e):t.strategy===Hr?V1(t,e):t.strategy===C1?$1(t,e):Jn[t.level].func(t,e);if((s===Vi||s===Dn)&&(t.status=Kn),s===At||s===Vi)return i.avail_out===0&&(t.last_flush=-1),xt;if(s===Fn&&(e===_1?v1(t):e!==vf&&($o(t,0,0,!1),e===y1&&(yi(t.head),t.lookahead===0&&(t.strstart=0,t.block_start=0,t.insert=0))),Nt(i),i.avail_out===0))return t.last_flush=-1,xt}return e!==Ht?xt:t.wrap<=0?_f:(t.wrap===2?(je(t,i.adler&255),je(t,i.adler>>8&255),je(t,i.adler>>16&255),je(t,i.adler>>24&255),je(t,i.total_in&255),je(t,i.total_in>>8&255),je(t,i.total_in>>16&255),je(t,i.total_in>>24&255)):(Vn(t,i.adler>>>16),Vn(t,i.adler&65535)),Nt(i),t.wrap>0&&(t.wrap=-t.wrap),t.pending!==0?xt:_f)},X1=i=>{if(Lr(i))return ri;let e=i.state.status;return i.state=null,e===Di?Oi(i,x1):xt},Y1=(i,e)=>{let t=e.length;if(Lr(i))return ri;let n=i.state,s=n.wrap;if(s===2||s===1&&n.status!==Cn||n.lookahead)return ri;if(s===1&&(i.adler=wr(i.adler,e,t,0)),n.wrap=0,t>=n.w_size){s===0&&(yi(n.head),n.strstart=0,n.block_start=0,n.insert=0);let l=new Uint8Array(n.w_size);l.set(e.subarray(t-n.w_size,t),0),e=l,t=n.w_size}let r=i.avail_in,a=i.next_in,o=i.input;for(i.avail_in=t,i.next_in=0,i.input=e,En(n);n.lookahead>=$e;){let l=n.strstart,c=n.lookahead-($e-1);do n.ins_h=Ci(n,n.ins_h,n.window[l+$e-1]),n.prev[l&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=l,l++;while(--c);n.strstart=l,n.lookahead=$e-1,En(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=$e-1,n.match_available=0,i.next_in=a,i.input=o,i.avail_in=r,n.wrap=s,xt},Q1=G1,K1=cg,J1=hg,ew=lg,tw=j1,iw=Z1,nw=X1,rw=Y1,sw="pako deflate (from Nodeca project)",ir={deflateInit:Q1,deflateInit2:K1,deflateReset:J1,deflateResetKeep:ew,deflateSetHeader:tw,deflate:iw,deflateEnd:nw,deflateSetDictionary:rw,deflateInfo:sw},aw=(i,e)=>Object.prototype.hasOwnProperty.call(i,e),ow=function(i){let e=Array.prototype.slice.call(arguments,1);for(;e.length;){let t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(let n in t)aw(t,n)&&(i[n]=t[n])}}return i},lw=i=>{let e=0;for(let n=0,s=i.length;n<s;n++)e+=i[n].length;let t=new Uint8Array(e);for(let n=0,s=0,r=i.length;n<r;n++){let a=i[n];t.set(a,s),s+=a.length}return t},_a={assign:ow,flattenChunks:lw},fg=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{fg=!1}var vr=new Uint8Array(256);for(let i=0;i<256;i++)vr[i]=i>=252?6:i>=248?5:i>=240?4:i>=224?3:i>=192?2:1;vr[254]=vr[254]=1;var hw=i=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(i);let e,t,n,s,r,a=i.length,o=0;for(s=0;s<a;s++)t=i.charCodeAt(s),(t&64512)===55296&&s+1<a&&(n=i.charCodeAt(s+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),s++)),o+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(o),r=0,s=0;r<o;s++)t=i.charCodeAt(s),(t&64512)===55296&&s+1<a&&(n=i.charCodeAt(s+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),s++)),t<128?e[r++]=t:t<2048?(e[r++]=192|t>>>6,e[r++]=128|t&63):t<65536?(e[r++]=224|t>>>12,e[r++]=128|t>>>6&63,e[r++]=128|t&63):(e[r++]=240|t>>>18,e[r++]=128|t>>>12&63,e[r++]=128|t>>>6&63,e[r++]=128|t&63);return e},cw=(i,e)=>{if(e<65534&&i.subarray&&fg)return String.fromCharCode.apply(null,i.length===e?i:i.subarray(0,e));let t="";for(let n=0;n<e;n++)t+=String.fromCharCode(i[n]);return t},fw=(i,e)=>{let t=e||i.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(i.subarray(0,e));let n,s,r=new Array(t*2);for(s=0,n=0;n<t;){let a=i[n++];if(a<128){r[s++]=a;continue}let o=vr[a];if(o>4){r[s++]=65533,n+=o-1;continue}for(a&=o===2?31:o===3?15:7;o>1&&n<t;)a=a<<6|i[n++]&63,o--;if(o>1){r[s++]=65533;continue}a<65536?r[s++]=a:(a-=65536,r[s++]=55296|a>>10&1023,r[s++]=56320|a&1023)}return cw(r,s)},uw=(i,e)=>{e=e||i.length,e>i.length&&(e=i.length);let t=e-1;for(;t>=0&&(i[t]&192)===128;)t--;return t<0||t===0?e:t+vr[i[t]]>e?t:e},_r={string2buf:hw,buf2string:fw,utf8border:uw};function dw(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var ug=dw,dg=Object.prototype.toString,{Z_NO_FLUSH:pw,Z_SYNC_FLUSH:gw,Z_FULL_FLUSH:mw,Z_FINISH:bw,Z_OK:As,Z_STREAM_END:ww,Z_DEFAULT_COMPRESSION:vw,Z_DEFAULT_STRATEGY:_w,Z_DEFLATED:yw}=Nn;function Nr(i){this.options=_a.assign({level:vw,method:yw,chunkSize:16384,windowBits:15,memLevel:8,strategy:_w},i||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ug,this.strm.avail_out=0;let t=ir.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(t!==As)throw new Error($i[t]);if(e.header&&ir.deflateSetHeader(this.strm,e.header),e.dictionary){let n;if(typeof e.dictionary=="string"?n=_r.string2buf(e.dictionary):dg.call(e.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(e.dictionary):n=e.dictionary,t=ir.deflateSetDictionary(this.strm,n),t!==As)throw new Error($i[t]);this._dict_set=!0}}Nr.prototype.push=function(i,e){let t=this.strm,n=this.options.chunkSize,s,r;if(this.ended)return!1;for(e===~~e?r=e:r=e===!0?bw:pw,typeof i=="string"?t.input=_r.string2buf(i):dg.call(i)==="[object ArrayBuffer]"?t.input=new Uint8Array(i):t.input=i,t.next_in=0,t.avail_in=t.input.length;;){if(t.avail_out===0&&(t.output=new Uint8Array(n),t.next_out=0,t.avail_out=n),(r===gw||r===mw)&&t.avail_out<=6){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(s=ir.deflate(t,r),s===ww)return t.next_out>0&&this.onData(t.output.subarray(0,t.next_out)),s=ir.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===As;if(t.avail_out===0){this.onData(t.output);continue}if(r>0&&t.next_out>0){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(t.avail_in===0)break}return!0};Nr.prototype.onData=function(i){this.chunks.push(i)};Nr.prototype.onEnd=function(i){i===As&&(this.result=_a.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};function fc(i,e){let t=new Nr(e);if(t.push(i,!0),t.err)throw t.msg||$i[t.err];return t.result}function xw(i,e){return e=e||{},e.raw=!0,fc(i,e)}function kw(i,e){return e=e||{},e.gzip=!0,fc(i,e)}var Sw=Nr,Cw=fc,Ew=xw,Aw=kw,Tw=Nn,Mw={Deflate:Sw,deflate:Cw,deflateRaw:Ew,gzip:Aw,constants:Tw},Ur=16209,Rw=16191,Iw=function(e,t){let n,s,r,a,o,l,c,h,d,f,u,g,_,b,w,p,m,v,x,R,M,C,L,y,E=e.state;n=e.next_in,L=e.input,s=n+(e.avail_in-5),r=e.next_out,y=e.output,a=r-(t-e.avail_out),o=r+(e.avail_out-257),l=E.dmax,c=E.wsize,h=E.whave,d=E.wnext,f=E.window,u=E.hold,g=E.bits,_=E.lencode,b=E.distcode,w=(1<<E.lenbits)-1,p=(1<<E.distbits)-1;e:do{g<15&&(u+=L[n++]<<g,g+=8,u+=L[n++]<<g,g+=8),m=_[u&w];t:for(;;){if(v=m>>>24,u>>>=v,g-=v,v=m>>>16&255,v===0)y[r++]=m&65535;else if(v&16){x=m&65535,v&=15,v&&(g<v&&(u+=L[n++]<<g,g+=8),x+=u&(1<<v)-1,u>>>=v,g-=v),g<15&&(u+=L[n++]<<g,g+=8,u+=L[n++]<<g,g+=8),m=b[u&p];i:for(;;){if(v=m>>>24,u>>>=v,g-=v,v=m>>>16&255,v&16){if(R=m&65535,v&=15,g<v&&(u+=L[n++]<<g,g+=8,g<v&&(u+=L[n++]<<g,g+=8)),R+=u&(1<<v)-1,R>l){e.msg="invalid distance too far back",E.mode=Ur;break e}if(u>>>=v,g-=v,v=r-a,R>v){if(v=R-v,v>h&&E.sane){e.msg="invalid distance too far back",E.mode=Ur;break e}if(M=0,C=f,d===0){if(M+=c-v,v<x){x-=v;do y[r++]=f[M++];while(--v);M=r-R,C=y}}else if(d<v){if(M+=c+d-v,v-=d,v<x){x-=v;do y[r++]=f[M++];while(--v);if(M=0,d<x){v=d,x-=v;do y[r++]=f[M++];while(--v);M=r-R,C=y}}}else if(M+=d-v,v<x){x-=v;do y[r++]=f[M++];while(--v);M=r-R,C=y}for(;x>2;)y[r++]=C[M++],y[r++]=C[M++],y[r++]=C[M++],x-=3;x&&(y[r++]=C[M++],x>1&&(y[r++]=C[M++]))}else{M=r-R;do y[r++]=y[M++],y[r++]=y[M++],y[r++]=y[M++],x-=3;while(x>2);x&&(y[r++]=y[M++],x>1&&(y[r++]=y[M++]))}}else if(v&64){e.msg="invalid distance code",E.mode=Ur;break e}else{m=b[(m&65535)+(u&(1<<v)-1)];continue i}break}}else if(v&64)if(v&32){E.mode=Rw;break e}else{e.msg="invalid literal/length code",E.mode=Ur;break e}else{m=_[(m&65535)+(u&(1<<v)-1)];continue t}break}}while(n<s&&r<o);x=g>>3,n-=x,g-=x<<3,u&=(1<<g)-1,e.next_in=n,e.next_out=r,e.avail_in=n<s?5+(s-n):5-(n-s),e.avail_out=r<o?257+(o-r):257-(r-o),E.hold=u,E.bits=g},cn=15,xf=852,kf=592,Sf=0,$a=1,Cf=2,Lw=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Nw=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Fw=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Dw=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Ow=(i,e,t,n,s,r,a,o)=>{let l=o.bits,c=0,h=0,d=0,f=0,u=0,g=0,_=0,b=0,w=0,p=0,m,v,x,R,M,C=null,L,y=new Uint16Array(cn+1),E=new Uint16Array(cn+1),k=null,A,I,F;for(c=0;c<=cn;c++)y[c]=0;for(h=0;h<n;h++)y[e[t+h]]++;for(u=l,f=cn;f>=1&&y[f]===0;f--);if(u>f&&(u=f),f===0)return s[r++]=1<<24|64<<16|0,s[r++]=1<<24|64<<16|0,o.bits=1,0;for(d=1;d<f&&y[d]===0;d++);for(u<d&&(u=d),b=1,c=1;c<=cn;c++)if(b<<=1,b-=y[c],b<0)return-1;if(b>0&&(i===Sf||f!==1))return-1;for(E[1]=0,c=1;c<cn;c++)E[c+1]=E[c]+y[c];for(h=0;h<n;h++)e[t+h]!==0&&(a[E[e[t+h]]++]=h);if(i===Sf?(C=k=a,L=20):i===$a?(C=Lw,k=Nw,L=257):(C=Fw,k=Dw,L=0),p=0,h=0,c=d,M=r,g=u,_=0,x=-1,w=1<<u,R=w-1,i===$a&&w>xf||i===Cf&&w>kf)return 1;for(;;){A=c-_,a[h]+1<L?(I=0,F=a[h]):a[h]>=L?(I=k[a[h]-L],F=C[a[h]-L]):(I=96,F=0),m=1<<c-_,v=1<<g,d=v;do v-=m,s[M+(p>>_)+v]=A<<24|I<<16|F|0;while(v!==0);for(m=1<<c-1;p&m;)m>>=1;if(m!==0?(p&=m-1,p+=m):p=0,h++,--y[c]===0){if(c===f)break;c=e[t+a[h]]}if(c>u&&(p&R)!==x){for(_===0&&(_=u),M+=d,g=c-_,b=1<<g;g+_<f&&(b-=y[g+_],!(b<=0));)g++,b<<=1;if(w+=1<<g,i===$a&&w>xf||i===Cf&&w>kf)return 1;x=p&R,s[x]=u<<24|g<<16|M-r|0}}return p!==0&&(s[M+p]=c-_<<24|64<<16|0),o.bits=u,0},nr=Ow,Bw=0,pg=1,gg=2,{Z_FINISH:Ef,Z_BLOCK:Pw,Z_TREES:$r,Z_OK:qi,Z_STREAM_END:zw,Z_NEED_DICT:Hw,Z_STREAM_ERROR:$t,Z_DATA_ERROR:mg,Z_MEM_ERROR:bg,Z_BUF_ERROR:Uw,Z_DEFLATED:Af}=Nn,ya=16180,Tf=16181,Mf=16182,Rf=16183,If=16184,Lf=16185,Nf=16186,Ff=16187,Df=16188,Of=16189,Ts=16190,hi=16191,Va=16192,Bf=16193,qa=16194,Pf=16195,zf=16196,Hf=16197,Uf=16198,Vr=16199,qr=16200,$f=16201,Vf=16202,qf=16203,Wf=16204,jf=16205,Wa=16206,Gf=16207,Zf=16208,rt=16209,wg=16210,vg=16211,$w=852,Vw=592,qw=15,Ww=qw,Xf=i=>(i>>>24&255)+(i>>>8&65280)+((i&65280)<<8)+((i&255)<<24);function jw(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var en=i=>{if(!i)return 1;let e=i.state;return!e||e.strm!==i||e.mode<ya||e.mode>vg?1:0},_g=i=>{if(en(i))return $t;let e=i.state;return i.total_in=i.total_out=e.total=0,i.msg="",e.wrap&&(i.adler=e.wrap&1),e.mode=ya,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array($w),e.distcode=e.distdyn=new Int32Array(Vw),e.sane=1,e.back=-1,qi},yg=i=>{if(en(i))return $t;let e=i.state;return e.wsize=0,e.whave=0,e.wnext=0,_g(i)},xg=(i,e)=>{let t;if(en(i))return $t;let n=i.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?$t:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=t,n.wbits=e,yg(i))},kg=(i,e)=>{if(!i)return $t;let t=new jw;i.state=t,t.strm=i,t.window=null,t.mode=ya;let n=xg(i,e);return n!==qi&&(i.state=null),n},Gw=i=>kg(i,Ww),Yf=!0,ja,Ga,Zw=i=>{if(Yf){ja=new Int32Array(512),Ga=new Int32Array(32);let e=0;for(;e<144;)i.lens[e++]=8;for(;e<256;)i.lens[e++]=9;for(;e<280;)i.lens[e++]=7;for(;e<288;)i.lens[e++]=8;for(nr(pg,i.lens,0,288,ja,0,i.work,{bits:9}),e=0;e<32;)i.lens[e++]=5;nr(gg,i.lens,0,32,Ga,0,i.work,{bits:5}),Yf=!1}i.lencode=ja,i.lenbits=9,i.distcode=Ga,i.distbits=5},Sg=(i,e,t,n)=>{let s,r=i.state;return r.window===null&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new Uint8Array(r.wsize)),n>=r.wsize?(r.window.set(e.subarray(t-r.wsize,t),0),r.wnext=0,r.whave=r.wsize):(s=r.wsize-r.wnext,s>n&&(s=n),r.window.set(e.subarray(t-n,t-n+s),r.wnext),n-=s,n?(r.window.set(e.subarray(t-n,t),0),r.wnext=n,r.whave=r.wsize):(r.wnext+=s,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=s))),0},Xw=(i,e)=>{let t,n,s,r,a,o,l,c,h,d,f,u,g,_,b=0,w,p,m,v,x,R,M,C,L=new Uint8Array(4),y,E,k=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(en(i)||!i.output||!i.input&&i.avail_in!==0)return $t;t=i.state,t.mode===hi&&(t.mode=Va),a=i.next_out,s=i.output,l=i.avail_out,r=i.next_in,n=i.input,o=i.avail_in,c=t.hold,h=t.bits,d=o,f=l,C=qi;e:for(;;)switch(t.mode){case ya:if(t.wrap===0){t.mode=Va;break}for(;h<16;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}if(t.wrap&2&&c===35615){t.wbits===0&&(t.wbits=15),t.check=0,L[0]=c&255,L[1]=c>>>8&255,t.check=wt(t.check,L,2,0),c=0,h=0,t.mode=Tf;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((c&255)<<8)+(c>>8))%31){i.msg="incorrect header check",t.mode=rt;break}if((c&15)!==Af){i.msg="unknown compression method",t.mode=rt;break}if(c>>>=4,h-=4,M=(c&15)+8,t.wbits===0&&(t.wbits=M),M>15||M>t.wbits){i.msg="invalid window size",t.mode=rt;break}t.dmax=1<<t.wbits,t.flags=0,i.adler=t.check=1,t.mode=c&512?Of:hi,c=0,h=0;break;case Tf:for(;h<16;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}if(t.flags=c,(t.flags&255)!==Af){i.msg="unknown compression method",t.mode=rt;break}if(t.flags&57344){i.msg="unknown header flags set",t.mode=rt;break}t.head&&(t.head.text=c>>8&1),t.flags&512&&t.wrap&4&&(L[0]=c&255,L[1]=c>>>8&255,t.check=wt(t.check,L,2,0)),c=0,h=0,t.mode=Mf;case Mf:for(;h<32;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}t.head&&(t.head.time=c),t.flags&512&&t.wrap&4&&(L[0]=c&255,L[1]=c>>>8&255,L[2]=c>>>16&255,L[3]=c>>>24&255,t.check=wt(t.check,L,4,0)),c=0,h=0,t.mode=Rf;case Rf:for(;h<16;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}t.head&&(t.head.xflags=c&255,t.head.os=c>>8),t.flags&512&&t.wrap&4&&(L[0]=c&255,L[1]=c>>>8&255,t.check=wt(t.check,L,2,0)),c=0,h=0,t.mode=If;case If:if(t.flags&1024){for(;h<16;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}t.length=c,t.head&&(t.head.extra_len=c),t.flags&512&&t.wrap&4&&(L[0]=c&255,L[1]=c>>>8&255,t.check=wt(t.check,L,2,0)),c=0,h=0}else t.head&&(t.head.extra=null);t.mode=Lf;case Lf:if(t.flags&1024&&(u=t.length,u>o&&(u=o),u&&(t.head&&(M=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(n.subarray(r,r+u),M)),t.flags&512&&t.wrap&4&&(t.check=wt(t.check,n,u,r)),o-=u,r+=u,t.length-=u),t.length))break e;t.length=0,t.mode=Nf;case Nf:if(t.flags&2048){if(o===0)break e;u=0;do M=n[r+u++],t.head&&M&&t.length<65536&&(t.head.name+=String.fromCharCode(M));while(M&&u<o);if(t.flags&512&&t.wrap&4&&(t.check=wt(t.check,n,u,r)),o-=u,r+=u,M)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=Ff;case Ff:if(t.flags&4096){if(o===0)break e;u=0;do M=n[r+u++],t.head&&M&&t.length<65536&&(t.head.comment+=String.fromCharCode(M));while(M&&u<o);if(t.flags&512&&t.wrap&4&&(t.check=wt(t.check,n,u,r)),o-=u,r+=u,M)break e}else t.head&&(t.head.comment=null);t.mode=Df;case Df:if(t.flags&512){for(;h<16;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}if(t.wrap&4&&c!==(t.check&65535)){i.msg="header crc mismatch",t.mode=rt;break}c=0,h=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),i.adler=t.check=0,t.mode=hi;break;case Of:for(;h<32;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}i.adler=t.check=Xf(c),c=0,h=0,t.mode=Ts;case Ts:if(t.havedict===0)return i.next_out=a,i.avail_out=l,i.next_in=r,i.avail_in=o,t.hold=c,t.bits=h,Hw;i.adler=t.check=1,t.mode=hi;case hi:if(e===Pw||e===$r)break e;case Va:if(t.last){c>>>=h&7,h-=h&7,t.mode=Wa;break}for(;h<3;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}switch(t.last=c&1,c>>>=1,h-=1,c&3){case 0:t.mode=Bf;break;case 1:if(Zw(t),t.mode=Vr,e===$r){c>>>=2,h-=2;break e}break;case 2:t.mode=zf;break;case 3:i.msg="invalid block type",t.mode=rt}c>>>=2,h-=2;break;case Bf:for(c>>>=h&7,h-=h&7;h<32;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}if((c&65535)!==(c>>>16^65535)){i.msg="invalid stored block lengths",t.mode=rt;break}if(t.length=c&65535,c=0,h=0,t.mode=qa,e===$r)break e;case qa:t.mode=Pf;case Pf:if(u=t.length,u){if(u>o&&(u=o),u>l&&(u=l),u===0)break e;s.set(n.subarray(r,r+u),a),o-=u,r+=u,l-=u,a+=u,t.length-=u;break}t.mode=hi;break;case zf:for(;h<14;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}if(t.nlen=(c&31)+257,c>>>=5,h-=5,t.ndist=(c&31)+1,c>>>=5,h-=5,t.ncode=(c&15)+4,c>>>=4,h-=4,t.nlen>286||t.ndist>30){i.msg="too many length or distance symbols",t.mode=rt;break}t.have=0,t.mode=Hf;case Hf:for(;t.have<t.ncode;){for(;h<3;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}t.lens[k[t.have++]]=c&7,c>>>=3,h-=3}for(;t.have<19;)t.lens[k[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,y={bits:t.lenbits},C=nr(Bw,t.lens,0,19,t.lencode,0,t.work,y),t.lenbits=y.bits,C){i.msg="invalid code lengths set",t.mode=rt;break}t.have=0,t.mode=Uf;case Uf:for(;t.have<t.nlen+t.ndist;){for(;b=t.lencode[c&(1<<t.lenbits)-1],w=b>>>24,p=b>>>16&255,m=b&65535,!(w<=h);){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}if(m<16)c>>>=w,h-=w,t.lens[t.have++]=m;else{if(m===16){for(E=w+2;h<E;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}if(c>>>=w,h-=w,t.have===0){i.msg="invalid bit length repeat",t.mode=rt;break}M=t.lens[t.have-1],u=3+(c&3),c>>>=2,h-=2}else if(m===17){for(E=w+3;h<E;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}c>>>=w,h-=w,M=0,u=3+(c&7),c>>>=3,h-=3}else{for(E=w+7;h<E;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}c>>>=w,h-=w,M=0,u=11+(c&127),c>>>=7,h-=7}if(t.have+u>t.nlen+t.ndist){i.msg="invalid bit length repeat",t.mode=rt;break}for(;u--;)t.lens[t.have++]=M}}if(t.mode===rt)break;if(t.lens[256]===0){i.msg="invalid code -- missing end-of-block",t.mode=rt;break}if(t.lenbits=9,y={bits:t.lenbits},C=nr(pg,t.lens,0,t.nlen,t.lencode,0,t.work,y),t.lenbits=y.bits,C){i.msg="invalid literal/lengths set",t.mode=rt;break}if(t.distbits=6,t.distcode=t.distdyn,y={bits:t.distbits},C=nr(gg,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,y),t.distbits=y.bits,C){i.msg="invalid distances set",t.mode=rt;break}if(t.mode=Vr,e===$r)break e;case Vr:t.mode=qr;case qr:if(o>=6&&l>=258){i.next_out=a,i.avail_out=l,i.next_in=r,i.avail_in=o,t.hold=c,t.bits=h,Iw(i,f),a=i.next_out,s=i.output,l=i.avail_out,r=i.next_in,n=i.input,o=i.avail_in,c=t.hold,h=t.bits,t.mode===hi&&(t.back=-1);break}for(t.back=0;b=t.lencode[c&(1<<t.lenbits)-1],w=b>>>24,p=b>>>16&255,m=b&65535,!(w<=h);){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}if(p&&!(p&240)){for(v=w,x=p,R=m;b=t.lencode[R+((c&(1<<v+x)-1)>>v)],w=b>>>24,p=b>>>16&255,m=b&65535,!(v+w<=h);){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}c>>>=v,h-=v,t.back+=v}if(c>>>=w,h-=w,t.back+=w,t.length=m,p===0){t.mode=jf;break}if(p&32){t.back=-1,t.mode=hi;break}if(p&64){i.msg="invalid literal/length code",t.mode=rt;break}t.extra=p&15,t.mode=$f;case $f:if(t.extra){for(E=t.extra;h<E;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}t.length+=c&(1<<t.extra)-1,c>>>=t.extra,h-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=Vf;case Vf:for(;b=t.distcode[c&(1<<t.distbits)-1],w=b>>>24,p=b>>>16&255,m=b&65535,!(w<=h);){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}if(!(p&240)){for(v=w,x=p,R=m;b=t.distcode[R+((c&(1<<v+x)-1)>>v)],w=b>>>24,p=b>>>16&255,m=b&65535,!(v+w<=h);){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}c>>>=v,h-=v,t.back+=v}if(c>>>=w,h-=w,t.back+=w,p&64){i.msg="invalid distance code",t.mode=rt;break}t.offset=m,t.extra=p&15,t.mode=qf;case qf:if(t.extra){for(E=t.extra;h<E;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}t.offset+=c&(1<<t.extra)-1,c>>>=t.extra,h-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){i.msg="invalid distance too far back",t.mode=rt;break}t.mode=Wf;case Wf:if(l===0)break e;if(u=f-l,t.offset>u){if(u=t.offset-u,u>t.whave&&t.sane){i.msg="invalid distance too far back",t.mode=rt;break}u>t.wnext?(u-=t.wnext,g=t.wsize-u):g=t.wnext-u,u>t.length&&(u=t.length),_=t.window}else _=s,g=a-t.offset,u=t.length;u>l&&(u=l),l-=u,t.length-=u;do s[a++]=_[g++];while(--u);t.length===0&&(t.mode=qr);break;case jf:if(l===0)break e;s[a++]=t.length,l--,t.mode=qr;break;case Wa:if(t.wrap){for(;h<32;){if(o===0)break e;o--,c|=n[r++]<<h,h+=8}if(f-=l,i.total_out+=f,t.total+=f,t.wrap&4&&f&&(i.adler=t.check=t.flags?wt(t.check,s,f,a-f):wr(t.check,s,f,a-f)),f=l,t.wrap&4&&(t.flags?c:Xf(c))!==t.check){i.msg="incorrect data check",t.mode=rt;break}c=0,h=0}t.mode=Gf;case Gf:if(t.wrap&&t.flags){for(;h<32;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}if(t.wrap&4&&c!==(t.total&4294967295)){i.msg="incorrect length check",t.mode=rt;break}c=0,h=0}t.mode=Zf;case Zf:C=zw;break e;case rt:C=mg;break e;case wg:return bg;case vg:default:return $t}return i.next_out=a,i.avail_out=l,i.next_in=r,i.avail_in=o,t.hold=c,t.bits=h,(t.wsize||f!==i.avail_out&&t.mode<rt&&(t.mode<Wa||e!==Ef))&&Sg(i,i.output,i.next_out,f-i.avail_out),d-=i.avail_in,f-=i.avail_out,i.total_in+=d,i.total_out+=f,t.total+=f,t.wrap&4&&f&&(i.adler=t.check=t.flags?wt(t.check,s,f,i.next_out-f):wr(t.check,s,f,i.next_out-f)),i.data_type=t.bits+(t.last?64:0)+(t.mode===hi?128:0)+(t.mode===Vr||t.mode===qa?256:0),(d===0&&f===0||e===Ef)&&C===qi&&(C=Uw),C},Yw=i=>{if(en(i))return $t;let e=i.state;return e.window&&(e.window=null),i.state=null,qi},Qw=(i,e)=>{if(en(i))return $t;let t=i.state;return t.wrap&2?(t.head=e,e.done=!1,qi):$t},Kw=(i,e)=>{let t=e.length,n,s,r;return en(i)||(n=i.state,n.wrap!==0&&n.mode!==Ts)?$t:n.mode===Ts&&(s=1,s=wr(s,e,t,0),s!==n.check)?mg:(r=Sg(i,e,t,t),r?(n.mode=wg,bg):(n.havedict=1,qi))},Jw=yg,ev=xg,tv=_g,iv=Gw,nv=kg,rv=Xw,sv=Yw,av=Qw,ov=Kw,lv="pako inflate (from Nodeca project)",di={inflateReset:Jw,inflateReset2:ev,inflateResetKeep:tv,inflateInit:iv,inflateInit2:nv,inflate:rv,inflateEnd:sv,inflateGetHeader:av,inflateSetDictionary:ov,inflateInfo:lv};function hv(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var cv=hv,Cg=Object.prototype.toString,{Z_NO_FLUSH:fv,Z_FINISH:uv,Z_OK:yr,Z_STREAM_END:Za,Z_NEED_DICT:Xa,Z_STREAM_ERROR:dv,Z_DATA_ERROR:Qf,Z_MEM_ERROR:pv}=Nn;function Fr(i){this.options=_a.assign({chunkSize:1024*64,windowBits:15,to:""},i||{});let e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(i&&i.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ug,this.strm.avail_out=0;let t=di.inflateInit2(this.strm,e.windowBits);if(t!==yr)throw new Error($i[t]);if(this.header=new cv,di.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=_r.string2buf(e.dictionary):Cg.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=di.inflateSetDictionary(this.strm,e.dictionary),t!==yr)))throw new Error($i[t])}Fr.prototype.push=function(i,e){let t=this.strm,n=this.options.chunkSize,s=this.options.dictionary,r,a,o;if(this.ended)return!1;for(e===~~e?a=e:a=e===!0?uv:fv,Cg.call(i)==="[object ArrayBuffer]"?t.input=new Uint8Array(i):t.input=i,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(n),t.next_out=0,t.avail_out=n),r=di.inflate(t,a),r===Xa&&s&&(r=di.inflateSetDictionary(t,s),r===yr?r=di.inflate(t,a):r===Qf&&(r=Xa));t.avail_in>0&&r===Za&&t.state.wrap>0&&i[t.next_in]!==0;)di.inflateReset(t),r=di.inflate(t,a);switch(r){case dv:case Qf:case Xa:case pv:return this.onEnd(r),this.ended=!0,!1}if(o=t.avail_out,t.next_out&&(t.avail_out===0||r===Za))if(this.options.to==="string"){let l=_r.utf8border(t.output,t.next_out),c=t.next_out-l,h=_r.buf2string(t.output,l);t.next_out=c,t.avail_out=n-c,c&&t.output.set(t.output.subarray(l,l+c),0),this.onData(h)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(r===yr&&o===0)){if(r===Za)return r=di.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};Fr.prototype.onData=function(i){this.chunks.push(i)};Fr.prototype.onEnd=function(i){i===yr&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=_a.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};function uc(i,e){let t=new Fr(e);if(t.push(i),t.err)throw t.msg||$i[t.err];return t.result}function gv(i,e){return e=e||{},e.raw=!0,uc(i,e)}var mv=Fr,bv=uc,wv=gv,vv=uc,_v=Nn,yv={Inflate:mv,inflate:bv,inflateRaw:wv,ungzip:vv,constants:_v},{Deflate:EC,deflate:AC,deflateRaw:xv,gzip:TC}=Mw,{Inflate:MC,inflate:kv,inflateRaw:Sv,ungzip:Cv}=yv,Ev=xv,Xo=kv,dc=Sv,Eg=Cv,Ag=4;function Tg(i){let e=ArrayBuffer.isView(i)?i:new Uint8Array(i);return e[0]===31&&e[1]===139}function Mg(i){let e=ArrayBuffer.isView(i)?i:new Uint8Array(i);return(e[3]&Ag)!==0&&e[12]===66&&e[13]===67?bi(e.buffer):Eg(e)}function bi(i,e){let t=[],n=0,s=0;for(e=e||i.byteLength-18;n<e;)try{let a=ArrayBuffer.isView(i)?i:new Uint8Array(i,n,18),o=a[11]<<8|a[10],c=a[3]&Ag,h=a[12],d=a[13],f=a[15]<<8|a[14],u=(a[17]<<8|a[16])+1,g=12+o+n,_=i.byteLength-g,b=u-o-19;if(_<b||b<=0)break;let w=new Uint8Array(i,g,b),p=dc(w);n+=b-1+26,s+=p.byteLength,t.push(p)}catch(a){console.error(a);break}if(t.length===1)return t[0];{let a=new Uint8Array(s),o=0;for(let l=0;l<t.length;++l){var r=new Uint8Array(t[l]);Mv(r,0,a,o,r.length),o+=r.length}return a}}function Rg(i){let e=ArrayBuffer.isView(i)?i:new Uint8Array(i);return(e[17]<<8|e[16])+1}var Av=new Uint8Array(1),Tv=typeof Av.subarray=="function";function Mv(i,e,t,n,s){if(s!==0){if(i){if(!t)throw"Undef dest"}else throw"Undef src";e===0&&s===i.length?Ya(i,t,n):Tv?Ya(i.subarray(e,e+s),t,n):i.BYTES_PER_ELEMENT===1&&s>100?Ya(new Uint8Array(i.buffer,i.byteOffset+e,s),t,n):Rv(i,e,t,n,s)}}function Rv(i,e,t,n,s){for(let r=0;r<s;++r)t[n+r]=i[e+r]}function Ya(i,e,t){e.set(i,t)}function Iv(i){let e=new Uint8Array(i.length);for(var t=0;t<i.length;t++)e[t]=i.charCodeAt(t);let n=new Ev(e),s=String.fromCharCode.apply(null,n);return btoa(s).replace(/\+/g,".").replace(/\//g,"_").replace(/=/g,"-")}function Lv(i){i=i.replace(/\./g,"+").replace(/_/g,"/").replace(/-/g,"=");let e=atob(i),t=[];for(let r=0;r<e.length;r++)t.push(e.charCodeAt(r));let n=dc(t),s="";for(let r of n)s+=String.fromCharCode(r);return s}function tn(i,e){let t=i.split(","),n=t[0].split(":")[1],s=t[1];if(n.indexOf("base64")>=0){s=atob(s);let r=new Uint8Array(s.length);for(let o=0;o<s.length;o++)r[o]=s.charCodeAt(o);let a;return e||n.indexOf("gzip")>0?a=Eg(r):a=r,a}else return decodeURIComponent(s)}var gt={lerp:(i,e,t)=>(1-t)*i+t*e,mean:function(i){var e=0,t=0,n;for(n=0;n<i.length;n++)isNaN(i[n])||(e+=i[n],t++);return t>0?e/t:0},meanAndStdev:function(i){var e,t=0,n=0,s=0,r;for(r=0;r<i.length;r++)e=i[r],isNaN(e)||(t+=e,n+=e*e,s++);return s>0?{mean:t/s,stdev:Math.sqrt(n-t*t/s)}:{mean:0,stdev:0}},median:function(i){var e=0,t=i.length;return i.sort(),t%2===0?e=(i[t/2-1]+i[t/2])/2:e=i[(t-1)/2],e},percentile:function(i,e){if(i.length!==0){var t=Math.floor(i.length*((100-e)/100));return t===0?(i.sort(function(n,s){return s-n}),i[t]):Nv(i,t)}},clamp:function(i,e,t){return Math.min(Math.max(i,e),t)},log2:function(i){return Math.log(i)/Math.LN2}};function Nv(i,e){var t=new Ig,n;for(n=0;n<i.length;n++){var s=i[n];(t.content.length<e||s>t.content[0])&&(t.content.length===e&&t.pop(),t.push(s))}return t.content[0]}function Ig(){this.content=[]}Ig.prototype={push:function(i){this.content.push(i),this.bubbleUp(this.content.length-1)},pop:function(){var i=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.sinkDown(0)),i},remove:function(i){for(var e=this.content.length,t=0;t<e;t++)if(this.content[t]===i){var n=this.content.pop();if(t===e-1)break;this.content[t]=n,this.bubbleUp(t),this.sinkDown(t);break}},size:function(){return this.content.length},bubbleUp:function(i){for(var e=this.content[i],t=e;i>0;){var n=Math.floor((i+1)/2)-1,s=this.content[n];if(t>=s)break;this.content[n]=e,this.content[i]=s,i=n}},sinkDown:function(i){for(var e=this.content.length,t=this.content[i],n=t;;){var s=(i+1)*2,r=s-1,a=null;if(r<e){var o=this.content[r],l=o;l<n&&(a=r)}if(s<e){var c=this.content[s],h=c;h<(a==null?n:l)&&(a=s)}if(a==null)break;this.content[i]=this.content[a],this.content[a]=t,i=a}}};function Ii(i,e){return Math.random()*(e-i)+i}var Ve={rgbListFromHSV:()=>{let i=1,e=[];for(let t=1;t>=.5;t-=.1)for(let n=0;n<1;n+=1/28){let s="rgb("+Ve.hsvToRgb(n,i,t).join(",")+")";e.push(s)}return e.pop(),e.push(Ve.rgbColor(16,16,16)),e},rgbToHex:function(i){return i=i.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i),i&&i.length===4?"#"+("0"+parseInt(i[1],10).toString(16)).slice(-2)+("0"+parseInt(i[2],10).toString(16)).slice(-2)+("0"+parseInt(i[3],10).toString(16)).slice(-2):""},hexToRgb:function(i){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(i);if(e!==null)return"rgb("+parseInt(e[1],16)+","+parseInt(e[2],16)+","+parseInt(e[3],16)+")"},hsvToRgb:function(i,e,t){var n,s,r,a=Math.floor(i*6),o=i*6-a,l=t*(1-e),c=t*(1-o*e),h=t*(1-(1-o)*e);switch(a%6){case 0:n=t,s=h,r=l;break;case 1:n=c,s=t,r=l;break;case 2:n=l,s=t,r=h;break;case 3:n=l,s=c,r=t;break;case 4:n=h,s=l,r=t;break;case 5:n=t,s=l,r=c;break}return[Math.floor(n*255),Math.floor(s*255),Math.floor(r*255)]},hslToRgb:function(i,e,t){var n,s,r;if(e===0)n=s=r=t;else{var a=t<.5?t*(1+e):t+e-t*e,o=2*t-a;n=Ve.hue2rgb(o,a,i+1/3),s=Ve.hue2rgb(o,a,i),r=Ve.hue2rgb(o,a,i-1/3)}return[n*255,s*255,r*255]},hue2rgb:(i,e,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*(2/3-t)*6:i),rgbaColor:function(i,e,t,n){return i=gt.clamp(i,0,255),e=gt.clamp(e,0,255),t=gt.clamp(t,0,255),n=gt.clamp(n,0,1),"rgba("+i+","+e+","+t+","+n+")"},rgbColor:function(i,e,t){return i=gt.clamp(i,0,255),e=gt.clamp(e,0,255),t=gt.clamp(t,0,255),"rgb("+i+","+e+","+t+")"},greyScale:function(i){var e=gt.clamp(i,0,255);return"rgb("+e+","+e+","+e+")"},randomGrey:function(i,e){i=gt.clamp(i,0,255),e=gt.clamp(e,0,255);var t=Math.round(Ii(i,e)).toString(10);return"rgb("+t+","+t+","+t+")"},randomRGB:function(i,e){i=gt.clamp(i,0,255),e=gt.clamp(e,0,255);var t=Math.round(Ii(i,e)).toString(10),n=Math.round(Ii(i,e)).toString(10),s=Math.round(Ii(i,e)).toString(10);return"rgb("+t+","+n+","+s+")"},randomRGBConstantAlpha:function(i,e,t){i=gt.clamp(i,0,255),e=gt.clamp(e,0,255);var n=Math.round(Ii(i,e)).toString(10),s=Math.round(Ii(i,e)).toString(10),r=Math.round(Ii(i,e)).toString(10);return"rgba("+n+","+s+","+r+","+t+")"},addAlpha:function(i,e){if(i==="0"||i===".")i="rgb(0,0,0)";else{let n=this.colorNameToHex(i);n&&(i=n)}var t=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(i);if(i.startsWith("rgba")){let n=i.lastIndexOf(",");return i.substring(0,n+1)+e.toString()+")"}return t&&(i=Ve.hexToRgb(i)),i.startsWith("rgb")?i.replace("rgb","rgba").replace(")",", "+e+")"):(console.log(i+" is not an rgb style string"),i)},rgbComponents:function(i){if(i==="0"||i===".")return[0,0,0];if(/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(i))i=Ve.hexToRgb(i);else if(!i.startsWith("rgb")){let t=this.colorNameToHex(i);i=this.hexToRgb(t)}if(i.startsWith("rgb("))return i.substring(4,i.length-1).split(",").map(t=>Number.parseInt(t.trim()));if(i.startsWith("rgba("))return i.substring(5,i.length-1).split(",").map((t,n)=>(t=t.trim(),n===3?Number.parseFloat(t):Number.parseInt(t)));throw Error("Unrecognized color string: color")},getCompositeColor:function(i,e,t){var n=Math.floor(t*e[0]+(1-t)*i[0]),s=Math.floor(t*e[1]+(1-t)*i[1]),r=Math.floor(t*e[2]+(1-t)*i[2]);return"rgb("+n+","+s+","+r+")"},createColorString:function(i){let e=this.createColorStringSafe(i);return e||i},createColorStringSafe:function(i){if(i=Pb(i),i.startsWith("rgb(")&&i.endsWith(")")||i.startsWith("#")&&i.length<8)return i;let e=this.colorNameToHex(i);if(e)return e;let t=i.split(",");if(t.length===3&&Qa(t[0])&&Qa(t[1])&&Qa(t[2]))return`rgb(${i})`},darkenLighten:function(i,e){let t,n=this.colorNameToHex(i);n?t=Ve.hexToRgb(n):t=i.startsWith("rgb(")?i:Ve.hexToRgb(i);let s=t.replace(")","").substring(4).split(","),r=Math.max(0,Math.min(255,Number.parseInt(s[0].trim())+e)),a=Math.max(0,Math.min(255,Number.parseInt(s[1].trim())+e)),o=Math.max(0,Math.min(255,Number.parseInt(s[2].trim())+e));return"rgb("+r.toString()+","+a.toString()+","+o.toString()+")"},colorNameToHex:function(i){return{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",darkgrey:"#a9a9a9",darkslategrey:"#2f4f4f",dimgrey:"#696969",grey:"#808080",lightgray:"#d3d3d3",lightslategrey:"#778899",slategrey:"#708090"}[i]}};function Qa(i){let e=Number.parseInt(i);return!Number.isNaN(e)&&e>=0&&e<=255}var Ka="googleapis",Yo=class{constructor(){this.oauthTokens={}}setToken(e,t){t=t||Ka,this.oauthTokens[t]=e}getToken(e){e=e||Ka;let t;for(let n of Object.keys(this.oauthTokens))if(Kf(n).test(e)){t=this.oauthTokens[n];break}return t}removeToken(e){e=e||Ka;for(let t of Object.keys(this.oauthTokens))Kf(t).test(e)&&(this.oauthTokens[t]=void 0)}};function Kf(i){return new RegExp("^"+i.split(/\*+/).map(Fv).join(".*")+"$")}function Fv(i){return i.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")}function qn(i){return i.includes("googleapis")&&!i.includes("urlshortener")||pc(i)||Ms(i)}function pc(i){return i.startsWith("gs://")||i.startsWith("https://www.googleapis.com/storage")||i.startsWith("https://storage.cloud.google.com")||i.startsWith("https://storage.googleapis.com")}function Ms(i){return i.indexOf("drive.google.com")>=0||i.indexOf("www.googleapis.com/drive")>0}function Dv(i){let{bucket:e,object:t}=Ov(i);t=Bv(t);let n=i.indexOf("?"),s=n>0?i.substring(n)+"&alt=media":"?alt=media";return`https://storage.googleapis.com/storage/v1/b/${e}/o/${t}${s}`}function Ov(i){let e,t;if(i.startsWith("gs://")){let n=i.indexOf("/",5);if(n>=0){e=i.substring(5,n);let s=i.indexOf("?");t=s<0?i.substring(n+1):i.substring(n+1,s)}}else if(i.startsWith("https://storage.googleapis.com")||i.startsWith("https://storage.cloud.google.com")){let n=i.indexOf("/v1/b/",8);if(n>0){let s=i.indexOf("/o/",n);if(s>0){let r=i.indexOf("?",s);e=i.substring(n+6,s),t=r>0?i.substring(s+3,r):i.substring(s+3)}}else{let s=i.indexOf("/",8),r=i.indexOf("/",s+1),a=i.indexOf("?",r);r>0&&(e=i.substring(s+1,r),t=a<0?i.substring(r+1):i.substring(r+1,a))}}else if(i.startsWith("https://www.googleapis.com/storage/v1/b")){let n=i.indexOf("/v1/b/",8),s=i.indexOf("/o/",n);if(s>0){let r=i.indexOf("?",s);e=i.substring(n+6,s),t=r>0?i.substring(s+3,r):i.substring(s+3)}}if(e&&t)return{bucket:e,object:t};throw Error(`Unrecognized Google Storage URI: ${i}`)}function Bv(i){let e="";return i.split("").forEach(function(t){ft.has(t)?e+=ft.get(t):e+=t}),e}var ft=new Map;ft.set("!","%21");ft.set("#","%23");ft.set("$","%24");ft.set("%","%25");ft.set("&","%26");ft.set("'","%27");ft.set("(","%28");ft.set(")","%29");ft.set("*","%2A");ft.set("+","%2B");ft.set(",","%2C");ft.set("/","%2F");ft.set(":","%3A");ft.set(";","%3B");ft.set("=","%3D");ft.set("?","%3F");ft.set("@","%40");ft.set("[","%5B");ft.set("]","%5D");ft.set(" ","%20");async function Pv(i){if(!google.accounts.oauth2.initTokenClient)throw new Error("Google accounts token client not loaded (https://accounts.google.com/gsi/client)");if(nn())throw new Error("Google client is already initialized");let e={client_id:i.client_id||i.clientId,scope:i.scope||"https://www.googleapis.com/auth/userinfo.profile",state:i.state||"igv",error:n=>{throw new Error(n.type)},hint:i.hint,hosted_domain:i.hosted_domain},t=google.accounts.oauth2.initTokenClient(e);google.igv={tokenClient:t,apiKey:i.apiKey}}function nn(){return window.google&&window.google.igv}function zv(){return nn()&&google.igv.tokenResponse&&Date.now()<google.igv.tokenExpiresAt?google.igv.tokenResponse.access_token:void 0}async function Lg(i){if(!nn())throw Error("Google oAuth has not been initialized");if(google.igv.tokenResponse&&Date.now()<google.igv.tokenExpiresAt&&google.accounts.oauth2.hasGrantedAllScopes(google.igv.tokenResponse,i))return google.igv.tokenResponse.access_token;{let e=google.igv.tokenClient;return new Promise((t,n)=>{try{e.callback=s=>{s.error!==void 0&&n(s),google.igv.tokenResponse=s,google.igv.tokenExpiresAt=Date.now()+s.expires_in*1e3,t(s.access_token)},e.requestAccessToken({scope:i})}catch(s){console.log(s)}})}}function Hv(i){return Ms(i)?"https://www.googleapis.com/auth/drive.file":pc(i)?"https://www.googleapis.com/auth/devstorage.read_only":"https://www.googleapis.com/auth/userinfo.profile"}function Ng(){return google.igv.apiKey}async function Uv(i){let t="https://www.googleapis.com/drive/v3/files/"+Dg(i)+"?supportsTeamDrives=true",n=Ng();n&&(t+="&key="+n);let r=await(await fetch(t)).json();if(r.error&&r.error.code===404){let o=await Lg("https://www.googleapis.com/auth/drive.readonly");if(o){if(r=await(await fetch(t,{headers:{Authorization:`Bearer ${o}`}})).json(),r.error)throw Error(r.error)}else throw Error(r.error)}return r}function Fg(i){var e=Dg(i);return e?"https://www.googleapis.com/drive/v3/files/"+e+"?alt=media&supportsTeamDrives=true":i}function Dg(i){if(i.includes("/open?id=")){let e=i.indexOf("/open?id=")+9,t=i.indexOf("&");if(e>0&&t>e)return i.substring(e,t);if(e>0)return i.substring(e)}else if(i.includes("/file/d/")){let e=i.indexOf("/file/d/")+8,t=i.lastIndexOf("/");return i.substring(e,t)}else if(i.startsWith("https://www.googleapis.com/drive")){let e=i.indexOf("/files/"),t=i.indexOf("?");if(e>0)return e+=7,t>0?i.substring(e,t):i.substring(e)}throw Error("Unknown Google Drive url format: "+i)}var Qo=class{constructor(e){this.requestsPerSecond=e.requestsPerSecond||10,this.lastStartTime=0,this.queued=[]}add(e,t){var n=this;return new Promise(function(s,r){n.queued.push({resolve:s,reject:r,asyncFunction:e}),n.dequeue()})}addAll(e,t){var n=e.map(function(s){return this.add(s,t)}.bind(this));return Promise.all(n)}dequeue(){if(this.queued.length>0){var e=new Date,t=1e3/this.requestsPerSecond+1,n=e-this.lastStartTime;n>=t?this._execute():setTimeout(function(){this.dequeue()}.bind(this),t-n)}}async _execute(){this.lastStartTime=new Date;var e=this.queued.shift();let t=e.asyncFunction;try{let n=await t();e.resolve(n)}catch(n){e.reject(n)}}},Ko=class{constructor(){this.apiKey=void 0,this.googleThrottle=new Qo({requestsPerSecond:8}),this.RANGE_WARNING_GIVEN=!1,this.oauth=new Yo}setApiKey(e){this.apiKey=e}async loadArrayBuffer(e,t){return t=t||{},t.responseType||(t.responseType="arraybuffer"),Ei(e)?this._loadFileSlice(e,t):this.load(e,t)}async loadByteArray(e,t){let n=await this.loadArrayBuffer(e,t),s;return Tg(n)?s=Mg(n):s=new Uint8Array(n),s}async loadJson(e,t){t=t||{},(t.method||(t.sendData?"POST":"GET"))==="POST"&&(t.contentType="application/json");let s=await this.loadString(e,t);return s&&JSON.parse(s)}async loadString(e,t){return t=t||{},e instanceof File?this._loadStringFromFile(e,t):this._loadStringFromUrl(e,t)}async load(e,t){t=t||{};let n=typeof e;if(e=await(typeof e=="function"?e():e),Ei(e))return this._loadFileSlice(e,t);if(typeof e.startsWith=="function")if(e.startsWith("data:")){let s=tn(e).buffer;if(t.range){let r=t.range.size?t.range.start+t.range.size:s.byteLength;return s.slice(t.range.start,r)}else return s}else return e.startsWith("https://drive.google.com")&&(e=Fg(e)),Ms(e)||e.startsWith("https://www.dropbox.com")?this.googleThrottle.add(async()=>this._loadURL(e,t)):this._loadURL(e,t);else throw Error(`url must be either a 'File', 'string', 'function', or 'Promise'.  Actual type: ${n}`)}async _loadURL(e,t){let n=this,s=e;e=Gv(e),t=t||{};let r=t.oauthToken||this.getOauthToken(e);return r&&(r=await(typeof r=="function"?r():r)),new Promise(function(a,o){qn(e)&&!$v(e)&&(pc(e)&&(e=Dv(e)),e=Wv(e),Ms(e)&&jv(e),r||(r=Jf()));let l=t.headers||{};r&&qv(l,r);let c=t.range,h=new XMLHttpRequest,d=t.sendData||t.body,f=t.method||(d?"POST":"GET"),u=t.responseType,g=t.contentType,_=t.mimeType;if(h.open(f,e),t.timeout&&(h.timeout=t.timeout),c){let p="";c.size&&(p=c.start+c.size-1),h.setRequestHeader("Range","bytes="+c.start+"-"+p)}if(g&&h.setRequestHeader("Content-Type",g),_&&h.overrideMimeType(_),u&&(h.responseType=u),l)for(let p of Object.keys(l)){let m=l[p];h.setRequestHeader(p,m)}t.withCredentials===!0&&(h.withCredentials=!0),h.onload=async function(p){if(h.status===0||h.status>=200&&h.status<=300)if(t.method==="HEAD"){let m=t.requestedHeaders||["content-length"],v={};for(let x of m)v[x]=h.getResponseHeader(x);a(v)}else c&&h.status!==206&&c.start!==0?(h.response.length>1e5&&!n.RANGE_WARNING_GIVEN&&alert(`Warning: Range header ignored for URL: ${e}.  This can have severe performance impacts.`),a(h.response.slice(c.start,c.start+c.size))):a(h.response);else h.status===416?b(Error("416 Unsatisfiable Range")):nn()&&(h.status===404||h.status===401||h.status===403)&&qn(e)&&!t.retries?w():h.status===403?b("Access forbidden: "+e):b(h.status)},h.onerror=function(p){qn(e)&&!t.retries?w():b("Error accessing resource: "+e+" Status: "+h.status)},h.ontimeout=function(p){b("Timed out")},h.onabort=function(p){console.log("Aborted"),o(p)};try{h.send(d)}catch(p){qn(e)&&!t.retries?w():b(p)}function b(p){if(o)o(p);else throw p}async function w(){try{let p=await Vv(s);t.retries=1,t.oauthToken=p;let m=await n.load(s,t);a(m)}catch(p){if(p.error){let m=p.error.startsWith("popup_blocked")?"Google login popup blocked by browser.":p.error;alert(m)}else b(p)}}})}async _loadFileSlice(e,t){let s=await(t&&t.range?e.slice(t.range.start,t.range.start+t.range.size):e).arrayBuffer();return t.responseType==="arraybuffer"?s:Ja(s)}async _loadStringFromFile(e,t){let s=await(t.range?e.slice(t.range.start,t.range.start+t.range.size):e).arrayBuffer();return Ja(s)}async _loadStringFromUrl(e,t){t=t||{},t.responseType="arraybuffer";let n=await this.load(e,t);return Ja(n)}setOauthToken(e,t){this.oauth.setToken(e,t)}getOauthToken(e){let t=qn(e)?void 0:qp(e).host,n=this.oauth.getToken(t);if(n)return n;if(t===void 0){let s=Jf();if(s&&s.expires_at>Date.now())return s.access_token}}async getContentLength(e,t){t=t||{},t.method="HEAD",t.requestedHeaders=["content-length"];let s=(await this._loadURL(e,t))["content-length"];return s?Number.parseInt(s):0}};function $v(i){return i.indexOf("X-Goog-Signature")>-1}async function Vv(i){if(nn()){let e=Hv(i);return await Lg(e)}else throw Error("Authorization is required, but Google oAuth has not been initalized. Contact your site administrator for assistance.")}function Jf(){if(nn())return zv()}function qv(i,e){return e&&(i["Cache-Control"]="no-cache",i.Authorization="Bearer "+e),i}function Wv(i){let e=Ce.apiKey;if(!e&&typeof gapi<"u"&&(e=gapi.apiKey),e!==void 0&&!i.includes("key=")){let t=i.includes("?")?"&":"?";i=i+t+"key="+e}return i}function jv(i){if(i.includes("supportsTeamDrive"))return i;{let e=i.includes("?")?"&":"?";i=i+e+"supportsTeamDrive=true"}}function Gv(i){return i.startsWith("https://www.dropbox.com")?i.replace("//www.dropbox.com","//dl.dropboxusercontent.com"):i.startsWith("https://drive.google.com")?Fg(i):i.includes("//www.broadinstitute.org/igvdata")?i.replace("//www.broadinstitute.org/igvdata","//data.broadinstitute.org/igvdata"):i.includes("//igvdata.broadinstitute.org")?i.replace("//igvdata.broadinstitute.org","//s3.amazonaws.com/igv.broadinstitute.org"):i.includes("//igv.genepattern.org")?i.replace("//igv.genepattern.org","//igv-genepattern-org.s3.amazonaws.com"):i.startsWith("ftp://ftp.ncbi.nlm.nih.gov/geo")?i.replace("ftp://","https://"):i}function Ja(i){let e;return Tg(i)?e=Mg(i):e=new Uint8Array(i),"TextDecoder"in Xv()?new TextDecoder().decode(e):Zv(e)}function Zv(i){for(var e="",t=0;t<i.length;){var n=i[t],s=0,r=0;if(n<=127?(s=0,r=n&255):n<=223?(s=1,r=n&31):n<=239?(s=2,r=n&15):n<=244&&(s=3,r=n&7),i.length-t-s>0)for(var a=0;a<s;)n=i[t+a+1],r=r<<6|n&63,a+=1;else r=65533,s=i.length-t;e+=String.fromCodePoint(r),t+=s+1}return e}function Xv(){return typeof self<"u"?self:typeof __global$<"u"?__global$:window}var Ce=new Ko,vi=1,fi=2,it={};it.color=vi;it.parent=it;it.left=it;it.right=it;var Rs=class{constructor(){this.root=it}insert(e,t,n){var s=new Is(e,t,n),r=new Yv(s);for(this.treeInsert(r),r.color=fi;r!==this.root&&r.parent.color===fi;)if(r.parent===r.parent.parent.left){let a=r.parent.parent.right;a.color===fi?(r.parent.color=vi,a.color=vi,r.parent.parent.color=fi,r=r.parent.parent):(r===r.parent.right&&(r=r.parent,eu.call(this,r)),r.parent.color=vi,r.parent.parent.color=fi,tu.call(this,r.parent.parent))}else{let a=r.parent.parent.left;a.color===fi?(r.parent.color=vi,a.color=vi,r.parent.parent.color=fi,r=r.parent.parent):(r===r.parent.left&&(r=r.parent,tu.call(this,r)),r.parent.color=vi,r.parent.parent.color=fi,eu.call(this,r.parent.parent))}this.root.color=vi}findOverlapping(e,t){var n=new Is(e,t,0);if(this.root===it)return[];var s=Jo.call(this,n,this.root,[]);return s.length>1&&s.sort(function(r,a){return r.low-a.low}),s}logIntervals(){e(this.root,0);function e(t,n){for(var s="",r=0;r<n;r++)s+=" ";console.log(s+t.interval.low+" "+t.interval.high),n+=5,t.left!==it&&e(t.left,n),t.right!==it&&e(t.right,n)}}mapIntervals(e){t(this.root);function t(n){e(n.interval),n.left!==it&&t(n.left),n.right!==it&&t(n.right)}}treeInsert(e){for(var t=this.root,n=it;t!==it;)n=t,e.interval.low<=t.interval.low?t=t.left:t=t.right;e.parent=n,n===it?(this.root=e,e.left=e.right=it):e.interval.low<=n.interval.low?n.left=e:n.right=e,gc.call(this,e)}};function Jo(i,e,t){return e.interval.overlaps(i)&&t.push(e.interval),e.left!==it&&e.left.max>=i.low&&Jo.call(this,i,e.left,t),e.right!==it&&e.right.min<=i.high&&Jo.call(this,i,e.right,t),t}function eu(i){var e=i.right;i.right=e.left,e.left!==it&&(e.left.parent=i),e.parent=i.parent,i.parent===it?this.root=e:i.parent.left===i?i.parent.left=e:i.parent.right=e,e.left=i,i.parent=e,gc.call(this,i)}function tu(i){var e=i.left;i.left=e.right,e.right!==it&&(e.right.parent=i),e.parent=i.parent,i.parent===it?this.root=e:i.parent.right===i?i.parent.right=e:i.parent.left=e,e.right=i,i.parent=e,gc.call(this,i)}function gc(i){for(;i!==it;){var e=i.left.max>i.right.max?i.left.max:i.right.max,t=i.interval.high;i.max=e>t?e:t;var n=i.left.min<i.right.min?i.left.min:i.right.min,s=i.interval.low;i.min=n<s?n:s,i=i.parent}}var Is=class{constructor(e,t,n){this.low=e,this.high=t,this.value=n}equals(e){return e?this===e?!0:this.low===e.low&&this.high===e.high:!1}compareTo(e){return this.low<e.low?-1:this.low>e.low?1:this.high<e.high?-1:this.high>e.high?1:0}overlaps(e){return this.low<=e.high&&e.low<=this.high}};function Yv(i){this.parent=it,this.left=it,this.right=it,this.interval=i,this.color=fi}var Wi=class{constructor(e,t,n){e=e||[],this.treeMap=this.buildTreeMap(e,t),this.range=n,this.count=e.length}containsRange(e){return this.range===void 0||this.range.contains(e.chr,e.start,e.end)}queryFeatures(e,t,n){let s=this.treeMap[e];if(!s)return[];let r=s.findOverlapping(t,n);if(r.length===0)return[];{let a=[],o=this.allFeatures[e];if(o){for(let l of r){let c=l.value;for(let h=c.start;h<c.end;h++){let d=o[h];if(d.start>n)break;d.end>=t&&a.push(d)}}a.sort(function(l,c){return l.start-c.start})}return a}}getAllFeatures(){return this.allFeatures}buildTreeMap(e,t){let n={},s=[];if(this.allFeatures={},e){for(let r of e){let a=r.chr;t&&(a=t.getChromosomeName(a));let o=this.allFeatures[a];o||(s.push(a),o=[],this.allFeatures[a]=o),o.push(r)}for(let r of s){let a=this.allFeatures[r];a.sort(function(o,l){return o.start===l.start?0:o.start>l.start?1:-1}),n[r]=Qv(a)}}return n}};function Qv(i){let e=new Rs,t=i.length,n=Math.max(10,Math.round(t/10));for(let s=0;s<t;s+=n){let r=Math.min(t,s+n),a=new el(s,r),o=i[s].start,l=o;for(let c=s;c<r;c++)l=Math.max(l,i[c].end);e.insert(o,l,a)}return e}var el=class{constructor(e,t){this.start=e,this.end=t}},Ls={packFeatures:function(i,e,t){var n,s;if(i){if(e=e||1e4,t||i.sort(function(_,b){return _.start-b.start}),i.length===0)return[];var r=[],a=0,o=0,l,c,h,d,f,u=2,g;for(n=i[0].start,s=i[i.length-1].start,g=Math.max(n,i[0].start),l=g,i.forEach(function(_){var b=Math.max(0,_.start-g);r[b]===void 0&&(r[b]=[]),r[b].push(_)}),c=0;a<i.length&&c<=e;){for(;l<=s;){for(d=void 0;!d&&l<=s;)h=l-g,r[h]===void 0?++l:d=r[h];if(!d)break;f=d.pop(),d.length===0&&(r[h]=void 0),f.row=c,l=f.end+u,++a}if(c++,l=g,a===o)break;o=a}}},findOverlapping:function(i,e,t){if(!i||i.length===0)return[];{let s=Kv(i).findOverlapping(e,t);return s.length===0?[]:(i=[],s.forEach(function(r){let a=r.value,o=a.length;for(let l=0;l<o;l++){let c=a[l];if(c.start>t)break;c.end>e&&i.push(c)}}),i.sort(function(r,a){return r.start-a.start}),i)}}};function Kv(i){let e=new Rs,t=i.length,n=Math.max(10,Math.round(t/100));i.sort(function(s,r){return s.start===r.start?0:s.start>r.start?1:-1});for(let s=0;s<t;s+=n){let r=Math.min(t,s+n),a=i.slice(s,r),o=a[0].start,l=o;a.forEach(function(c){l=Math.max(l,c.end)}),e.insert(o,l,a)}return e}var Og={cantaloupe:{r:255,g:206,b:110},honeydew:{r:206,g:250,b:110},spindrift:{r:104,g:251,b:208},sky:{r:106,g:207,b:255},lavender:{r:210,g:120,b:255},carnation:{r:255,g:127,b:211},licorice:{r:0,g:0,b:0},snow:{r:255,g:255,b:255},salmon:{r:255,g:114,b:110},banana:{r:255,g:251,b:109},flora:{r:104,g:249,b:110},ice:{r:104,g:253,b:255},orchid:{r:110,g:118,b:255},bubblegum:{r:255,g:122,b:255},lead:{r:30,g:30,b:30},mercury:{r:232,g:232,b:232},tangerine:{r:255,g:136,b:2},lime:{r:131,g:249,b:2},sea_foam:{r:3,g:249,b:135},aqua:{r:0,g:140,b:255},grape:{r:137,g:49,b:255},strawberry:{r:255,g:41,b:135},tungsten:{r:58,g:58,b:58},silver:{r:208,g:208,b:208},maraschino:{r:255,g:33,b:1},lemon:{r:255,g:250,b:3},spring:{r:5,g:248,b:2},turquoise:{r:0,g:253,b:255},blueberry:{r:0,g:46,b:255},magenta:{r:255,g:57,b:255},iron:{r:84,g:84,b:83},magnesium:{r:184,g:184,b:184},mocha:{r:137,g:72,b:0},fern:{r:69,g:132,b:1},moss:{r:1,g:132,b:72},ocean:{r:0,g:74,b:136},eggplant:{r:73,g:26,b:136},maroon:{r:137,g:22,b:72},steel:{r:110,g:110,b:110},aluminum:{r:160,g:159,b:160},cayenne:{r:137,g:17,b:0},aspargus:{r:136,g:133,b:1},clover:{r:2,g:132,b:1},teal:{r:0,g:134,b:136},midnight:{r:0,g:24,b:136},plum:{r:137,g:30,b:136},tin:{r:135,g:134,b:135},nickel:{r:136,g:135,b:135}};function Jv(i){let{r:e,g:t,b:n}=Og[i];return`rgb(${e},${t},${n})`}function e_(i,e){let{r:t,g:n,b:s}=Og[i];return`rgba(${t},${n},${s},${e})`}var t_={Set1:["rgb(228,26,28)","rgb(55,126,184)","rgb(77,175,74)","rgb(166,86,40)","rgb(152,78,163)","rgb(255,127,0)","rgb(247,129,191)","rgb(153,153,153)","rgb(255,255,51)"],Dark2:["rgb(27,158,119)","rgb(217,95,2)","rgb(117,112,179)","rgb(231,41,138)","rgb(102,166,30)","rgb(230,171,2)","rgb(166,118,29)","rgb(102,102,102)"],Set2:["rgb(102, 194,165)","rgb(252,141,98)","rgb(141,160,203)","rgb(231,138,195)","rgb(166,216,84)","rgb(255,217,47)","rgb(229,196,148)","rgb(179,179,179)"],Set3:["rgb(141,211,199)","rgb(255,255,179)","rgb(190,186,218)","rgb(251,128,114)","rgb(128,177,211)","rgb(253,180,98)","rgb(179,222,105)","rgb(252,205,229)","rgb(217,217,217)","rgb(188,128,189)","rgb(204,235,197)","rgb(255,237,111)"],Pastel1:["rgb(251,180,174)","rgb(179,205,227)","rgb(204,235,197)","rgb(222,203,228)","rgb(254,217,166)","rgb(255,255,204)","rgb(229,216,189)","rgb(253,218,236)"],Pastel2:["rgb(173,226,207)","rgb(253,205,172)","rgb(203,213,232)","rgb(244,202,228)","rgb(230,245,201)","rgb(255,242,174)","rgb(243,225,206)"],Accent:["rgb(127,201,127)","rgb(190,174,212)","rgb(253,192,134)","rgb(255,255,153)","rgb(56,108,176)","rgb(240,2,127)","rgb(191,91,23)"]},ji=class{constructor(e){this.colors=t_[e],Array.isArray(this.colors)||(this.colors=[]),this.colorTable={},this.nextIdx=0,this.colorGenerator=new On}getColor(e){return this.colorTable.hasOwnProperty(e)||(this.nextIdx<this.colors.length?this.colorTable[e]=this.colors[this.nextIdx]:this.colorTable[e]=this.colorGenerator.get(),this.nextIdx++),this.colorTable[e]}},Gi=class{constructor(e){this.colorTable=e||{},this.nextIdx=0,this.colorGenerator=new On}getColor(e){if(!this.colorTable.hasOwnProperty(e)){if(this.colorTable.hasOwnProperty("*"))return this.colorTable["*"];this.colorTable[e]=this.colorGenerator.get()}return this.colorTable[e]}};function On(){this.hue=Math.random(),this.goldenRatio=.618033988749895,this.hexwidth=2}On.prototype.hsvToRgb=function(i,e,t){var n=Math.floor(i*6),s=i*6-n,r=t*(1-e),a=t*(1-s*e),o=t*(1-(1-s)*e),l=255,c=255,h=255;switch(n){case 0:l=t,c=o,h=r;break;case 1:l=a,c=t,h=r;break;case 2:l=r,c=t,h=o;break;case 3:l=r,c=a,h=t;break;case 4:l=o,c=r,h=t;break;case 5:l=t,c=r,h=a;break}return[Math.floor(l*256),Math.floor(c*256),Math.floor(h*256)]};On.prototype.padHex=function(i){return i.length>this.hexwidth?i:new Array(this.hexwidth-i.length+1).join("0")+i};On.prototype.get=function(i,e){this.hue+=this.goldenRatio,this.hue%=1,typeof i!="number"&&(i=.5),typeof e!="number"&&(e=.95);var t=this.hsvToRgb(this.hue,i,e);return"#"+this.padHex(t[0].toString(16))+this.padHex(t[1].toString(16))+this.padHex(t[2].toString(16))};new On;function i_(i,e){i=gt.clamp(i,0,255),e=gt.clamp(e,0,255);let t=Math.round(Math.random()*(e-i)+i).toString(10),n=Math.round(Math.random()*(e-i)+i).toString(10),s=Math.round(Math.random()*(e-i)+i).toString(10);return`rgb(${t},${n},${s})`}var he={configureHighDPICanvas:function(i,e,t){let n=window.devicePixelRatio;i.canvas.style.width=`${e}px`,i.canvas.width=Math.floor(n*e),i.canvas.style.height=`${t}px`,i.canvas.height=Math.floor(n*t),i.scale(n,n)},setProperties:function(i,e){for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];i[t]=n}},strokeLine:function(i,e,t,n,s,r){e=Math.floor(e)+.5,t=Math.floor(t)+.5,n=Math.floor(n)+.5,s=Math.floor(s)+.5,r&&(i.save(),he.setProperties(i,r)),i.beginPath(),i.moveTo(e,t),i.lineTo(n,s),i.stroke(),r&&i.restore()},fillRect:function(i,e,t,n,s,r){e=Math.round(e),t=Math.round(t),r&&(i.save(),he.setProperties(i,r)),i.fillRect(e,t,n,s),r&&i.restore()},fillPolygon:function(i,e,t,n){n&&(i.save(),he.setProperties(i,n)),iu(i,e,t),i.fill(),n&&i.restore()},strokePolygon:function(i,e,t,n){n&&(i.save(),he.setProperties(i,n)),iu(i,e,t),i.stroke(),n&&i.restore()},fillText:function(i,e,t,n,s,r){if((s||r)&&i.save(),s&&he.setProperties(i,s),r){i.translate(t,n);for(var a in r){var o=r[a];a==="translate"&&i.translate(o.x,o.y),a==="rotate"&&i.rotate(o.angle*Math.PI/180)}i.fillText(e,0,0)}else i.fillText(e,t,n);(s||r)&&i.restore()},strokeText:function(i,e,t,n,s,r){if((s||r)&&i.save(),s&&he.setProperties(i,s),r){i.translate(t,n);for(var a in r){var o=r[a];a==="translate"&&i.translate(o.x,o.y),a==="rotate"&&i.rotate(o.angle*Math.PI/180)}i.strokeText(e,0,0)}else i.strokeText(e,t,n);(s||r)&&i.restore()},strokeCircle:function(i,e,t,n,s){s&&(i.save(),he.setProperties(i,s)),i.beginPath(),i.arc(e,t,n,0,2*Math.PI),i.stroke(),s&&i.restore()},fillCircle:function(i,e,t,n,s){s&&(i.save(),he.setProperties(i,s)),i.beginPath(),i.arc(e,t,n,0,2*Math.PI),i.fill(),s&&i.restore()},drawArrowhead:function(i,e,t,n,s){i.save(),n||(n=5),s&&(i.lineWidth=s),i.beginPath(),i.moveTo(e,t-n/2),i.lineTo(e,t+n/2),i.lineTo(e+n,t),i.lineTo(e,t-n/2),i.closePath(),i.fill(),i.restore()},dashedLine:function(i,e,t,n,s,r,a={}){r===void 0&&(r=2),i.setLineDash([r,r]),he.strokeLine(i,e,t,n,s,a),i.setLineDash([])},roundRect:function(i,e,t,n,s,r,a,o){typeof o>"u"&&(o=!0),typeof r>"u"&&(r=5),i.beginPath(),i.moveTo(e+r,t),i.lineTo(e+n-r,t),i.quadraticCurveTo(e+n,t,e+n,t+r),i.lineTo(e+n,t+s-r),i.quadraticCurveTo(e+n,t+s,e+n-r,t+s),i.lineTo(e+r,t+s),i.quadraticCurveTo(e,t+s,e,t+s-r),i.lineTo(e,t+r),i.quadraticCurveTo(e,t,e+r,t),i.closePath(),o&&i.stroke(),a&&i.fill()},polygon:function(i,e,t,n,s){typeof s>"u"&&(s=!0),i.beginPath();var r=e.length;i.moveTo(e[0],t[0]);for(var a=1;a<r;a++)i.lineTo(e[a],t[a]);i.closePath(),s&&i.stroke(),n&&i.fill()},drawRandomColorVerticalLines:i=>{for(let e=0;e<i.canvas.width;e++)he.fillRect(i,e,0,1,i.canvas.height,{fillStyle:i_(100,250)})},labelTransformWithContext:(i,e)=>{i.translate(e,0),i.scale(-1,1),i.translate(-e,0)}};function iu(i,e,t){var n,s=e.length;for(n=0;n<s;n++)e[n]=Math.round(e[n]),t[n]=Math.round(t[n]);for(i.beginPath(),i.moveTo(e[0],t[0]),n=1;n<s;n++)i.lineTo(e[n],t[n]);i.closePath()}var tl=class{constructor(e){this.dialog=new ys(e)}present(e,t){this.dialog.present(e,t)}},cs={gwascatalog:{fields:["bin","chr","start","end","name","pubMedID","author","pubDate","journal","title","trait","initSample","replSample","region","genes","riskAllele","riskAlFreq","pValue","pValueDesc","orOrBeta","ci95","platform","cnv"]},wgrna:{fields:["bin","chr","start","end","name","score","strand","thickStart","thickEnd","type"]},cpgislandext:{fields:["bin","chr","start","end","name","length","cpgNum","gcNum","perCpg","perGc","obsExp"]},clinVarMain:{fields:["chr1","start","end","name","score","strand","thickStart","thickEnd","reserved","blockCount","blockSizes","chromStarts","origName","clinSign","reviewStatus","type","geneId","snpId","nsvId","rcvAcc","testedInGtr","phenotypeList","phenotype","origin","assembly","cytogenetic","hgvsCod","hgvsProt","numSubmit","lastEval","guidelines","otherIds"]}};function fs(i){let e=new Set(["boolean","number","string","symbol"]),t=typeof i;return i!==void 0&&(e.has(t)||i.substring||i.toFixed)}function Oe(i,e){var t={oauthToken:i.oauthToken,headers:i.headers,withCredentials:i.withCredentials,filename:i.filename};return Object.assign(t,e)}var mc=function(i){var e,t;if(i&&i.length>0){e=Number.MAX_VALUE,t=-Number.MAX_VALUE;for(let n of i)Number.isNaN(n.value)||(e=Math.min(e,n.value),t=Math.max(t,n.value));t>0&&(e=Math.min(0,e)),t<0&&(t=0)}else e=0,t=100;return{min:e,max:t}},Bg=function(i,e,t){let n=e.start,s=e.end;if(s===void 0)n-=t/2,s=n+t,s>i?(s=i,n=s-t):n<0&&(n=0,s=t);else if(s-n<t){let r=(s+n)/2;r-t/2<0?(n=0,s=n+t):r+t/2>i?(s=i,n=s-t):(n=r-t/2,s=n+t)}e.start=Math.ceil(n),e.end=Math.floor(s)};var n_=function(i){return typeof i=="number"?i-i===0:typeof i=="string"&&i.trim()!==""?Number.isFinite?Number.isFinite(+i):isFinite(+i):!1};async function il(i){if(yt(i)&&i.startsWith("https://drive.google.com")){if(Ng()===void 0)throw Error("Google drive is referenced, but API key is not defined.  An API key is required for Google Drive access");let e=await Uv(i);return e.originalFileName||e.name}else return Cs(i)}function nl(i){var e,t,n,s;if(i>1e7)e=1e6,t=" mb";else return i>1e4?(e=1e3,t=" kb",n=i/e,s=Math.floor(n),De(s)+t):De(i)+" bp";return n=i/e,s=Math.floor(n),s.toString()+t}function oi(i){return yt(i)&&i.startsWith("data:")}function Li(i,e){let t=de.div({class:e});i.appendChild(t)}function nu(i,e){e.parentNode.insertBefore(i,e)}function ru(i,e){e.parentNode.insertBefore(i,e.nextSibling)}function bc(){return window.location.protocol==="https:"||window.location.hostname==="localhost"}function r_(i){i=typeof i=="string"?document.querySelector(i):i;let e=window.getComputedStyle(i),t=parseFloat(e.marginTop)+parseFloat(e.marginBottom),n=i.offsetHeight;return Math.ceil(t+n)}function eo(i,e){if(i.length<6){console.log("Skipping line: "+i.join(" "));return}var t={chr1:i[0],start1:Number.parseInt(i[1]),end1:Number.parseInt(i[2]),chr2:i[3],start2:Number.parseInt(i[4]),end2:Number.parseInt(i[5])};if(isNaN(t.start1)||isNaN(t.end1)||isNaN(t.start2)||isNaN(t.end2))return;e&&e.hiccups===void 0&&(e.hiccups=e.columnNames?Pg(e.columnNames):!1);let n=e&&e.hiccups,s=n?6:10;if(n||(i.length>6&&i[6]!=="."&&(t.name=i[6]),i.length>7&&i[7]!=="."&&(t.score=Number(i[7])),i.length>8&&i[8]!=="."&&(t.strand1=i[8]),i.length>9&&i[9]!=="."&&(t.strand2=i[9])),e){let r=e.colorColumn;r&&r<i.length&&(t.color=Ve.createColorString(i[r]));let a=e.thicknessColumn;a&&a<i.length&&(t.thickness=i[a]),i.length>s&&e.columnNames&&e.columnNames.length===i.length&&(t.extras=i.slice(s))}return t.chr1===t.chr2&&(t.chr=t.chr1,t.start=Math.min(t.start1,t.start2),t.end=Math.max(t.end1,t.end2)),t}function s_(i){if(i.length==0)return;let e=i[0];if(e.score===void 0&&e.name!==void 0){for(let n of i)if(!(n_(n.name)||n.name==="."))return;for(let n of i)n.score=Number(n.name),delete n.name}let t=i.filter(n=>n.chr1!==n.chr2);for(let n of t){let s=Object.assign({},n);s.dup=!0,i.push(s),n.chr=n.chr1,n.start=n.start1,n.end=n.end1,s.chr=s.chr2,s.start=s.start2,s.end=s.end2}}function a_(i,e){if(!(i.length<8))return{chr:i[0],start:Number.parseInt(i[1]),end:Number.parseInt(i[2]),color:Ve.createColorString(i[6]),value:Number(i[7])}}function Pg(i){return i&&(i.includes("fdrDonut")||i.includes("fdr_donut"))}var zg=new Set(["narrowpeak","broadpeak","regionpeak","peaks","bedgraph","wig","gff3","gff","gtf","fusionjuncspan","refflat","seg","aed","bed","vcf","bb","bigbed","biginteract","biggenepred","bignarrowpeak","bw","bigwig","bam","tdf","refgene","genepred","genepredext","bedpe","bp","snp","rmsk","cram","gwas","maf","mut","tsv","hiccups","fasta","fa","fna","pytor"]);function Hg(i){if(cs&&cs[i])return e(cs[i]);return;function e(t){let n=t.fields,s=["chr","start","end"];for(let r=0;r<n.length;r++)for(let a of s)a===n[r]&&(t[a]=r);return t}}function wc(i){var e,t;if(i=i.toLowerCase(),i.endsWith("refgene.txt.gz")||i.endsWith("refgene.txt.bgz")||i.endsWith("refgene.txt")||i.endsWith("refgene.sorted.txt.gz")||i.endsWith("refgene.sorted.txt.bgz"))return"refgene";switch(e=i.indexOf("?"),e>0&&(i=i.substr(0,e)),i.endsWith(".gz")&&(i=i.substr(0,i.length-3)),(i.endsWith(".txt")||i.endsWith(".tab")||i.endsWith(".bgz"))&&(i=i.substr(0,i.length-4)),e=i.lastIndexOf("."),t=e<0?i:i.substr(e+1),t){case"bw":return"bigwig";case"bb":return"bigbed";case"fasta":case"fa":case"fna":return"fasta";default:return zg.has(t)?t:void 0}}function Ug(i,e){if(yt(i))if(i.includes("?")){let t=i.indexOf("?");return i.substring(0,t)+"."+e+i.substring(t)}else return i+"."+e;else return}function $g(i){if(o_(i),i.type)return i.type;if(i.format)switch(i.format.toLowerCase()){case"bw":case"bigwig":case"wig":case"bedgraph":case"tdf":return"wig";case"vcf":return"variant";case"seg":return"seg";case"mut":case"maf":return"mut";case"bam":case"cram":return"alignment";case"hiccups":case"bedpe":case"bedpe-loop":case"biginteract":return"interact";case"bp":return"arc";case"gwas":return"gwas";case"bed":case"bigbed":case"bb":case"biggenepred":case"bignarrowpeak":return"bedtype";case"fasta":return"sequence";case"pytor":return"cnvpytor";default:return"annotation"}}function o_(i){i.featureType&&(i.type=i.type||i.featureType,i.featureType=void 0),i.type==="junctions"?i.type="junction":i.type==="bed"?(i.type="annotation",i.format=i.format||"bed"):i.type==="annotations"?i.type="annotation":i.type==="alignments"?i.type="alignment":i.type==="bam"?(i.type="alignment",i.format="bam"):i.type==="vcf"?(i.type="variant",i.format="vcf"):i.type==="t2d"?i.type="gwas":i.type==="FusionJuncSpan"&&!i.format?i.format="fusionjuncspan":i.type==="aed"&&(i.type="annotation",i.format=i.format||"aed")}async function Vg(i){if(i.url){let e=await Ce.loadString(i.url,Oe(i,{range:{start:0,size:1e3}}));if(e){let t=e.split(`
`)[0].split("	");if(Pg(t))return"hiccups"}}}function qg(i,e){cs[i]={fields:e}}var l_=Object.freeze({__proto__:null,knownFileExtensions:zg,getFormat:Hg,inferFileFormat:wc,inferFileFormatFromHeader:Vg,inferTrackType:$g,inferIndexPath:Ug,registerFileFormats:qg}),h_=[["A","T"],["G","C"],["Y","R"],["W","S"],["K","M"],["D","H"],["B","V"]],wn=new Map;for(let i of h_){let e=i[0],t=i[1];wn.set(e,t),wn.set(t,e),wn.set(e.toLowerCase(),t.toLowerCase()),wn.set(t.toLowerCase(),e.toLowerCase())}function Pi(i){let e="",t=i.length;for(;t-- >0;){let n=i[t];e+=wn.has(n)?wn.get(n):n}return e}var xr=class{constructor(e,t,n){this.name=e,this.order=t,this.bpLength=n}},c_=Ji,f_=new Set(["fastaURL","indexURL","cytobandURL","indexed"]),rl=class{constructor(e){this.fastaURL=e.fastaURL,this.withCredentials=e.withCredentials,this.chromosomeNames=[],this.chromosomes={},this.sequences=new Map;let t={};for(let n in e)e.hasOwnProperty(n)&&!f_.has(n)&&(t[n]=e[n]);this.config=t}async init(){return this.loadAll()}async getSequence(e,t,n){if(!this.sequences.has(e))return;let s=this.sequences.get(e).find(l=>l.contains(t,n));if(!s&&(s=this.sequences.get(e).find(l=>l.overlaps(t,n)),!s))return;t-=s.offset,n-=s.offset;let r="";if(t<0)for(let l=t;l<Math.min(n,0);l++)r+="*";if(n<=0)return Promise.resolve(r);let a=s.sequence,o=Math.min(n,a.length);return r+a.substring(t,o)}async loadAll(){let e;if(oi(this.fastaURL)){let h=tn(this.fastaURL);e="";for(let d of h)e+=String.fromCharCode(d)}else e=await Ce.load(this.fastaURL,Oe(this.config));let t=new Set,n=c_(e),s=n.length,r=0,a=0,o,l={};for(;r<s;){if(o=n[r++].trim(),!(o.startsWith("#")||o.length===0))if(o.startsWith(">")){l&&l.seq&&c.call(this,l,a++);let h=o.substr(1).split(/\s+/),d=h[0].split(":");if(l.chr=d[0],l.seq="",l.offset=0,d.length>1&&d[1].indexOf("-")>0){let f=d[1].split("-");f.length===2&&/^[0-9]+$/.test(f[0])&&/^[0-9]+$/.test(f[1]);let u=Number.parseInt(f[0]);if(Number.parseInt(f[1])>u&&(l.offset=u-1),h.length>1&&h[1].startsWith("@len="))try{l.length=parseInt(h[1].trim().substring(5))}catch{l.length=void 0,console.error(`Error parsing sequence length for ${o}`)}else l.length=void 0}}else l.seq+=o;l&&l.seq&&c.call(this,l,a)}function c(h,d){let f=h.length||h.offset+h.seq.length;if(!t.has(h.chr))this.chromosomeNames.push(h.chr),this.sequences.set(h.chr,[]),this.chromosomes[h.chr]=new xr(h.chr,d,f),t.add(h.chr);else{let u=this.chromosomes[h.chr];u.bpLength=Math.max(u.bpLength,f)}this.sequences.get(h.chr).push(new sl(h.offset,h.seq))}}},sl=class{constructor(e,t){this.offset=e,this.sequence=t}contains(e,t){return this.offset<=e&&this.end>=t}overlaps(e,t){return this.offset<t&&this.end>e}get end(){return this.offset+this.sequence.length}},Zi=function(i,e,t,n){this.chr=i,this.start=e,this.end=t,this.features=n};Zi.prototype.contains=function(i,e,t){return this.chr===i&&this.start<=e&&this.end>=t};Zi.prototype.containsRange=function(i){return this.chr===i.chr&&this.start<=i.start&&this.end>=i.end};var u_=Ji,d_=new Set(["fastaURL","indexURL","compressedIndexURL","cytobandURL","indexed"]),al=class{constructor(e){this.file=e.fastaURL,this.indexFile=e.indexURL||e.indexFile||this.file+".fai",this.compressedIndexFile=e.compressedIndexURL||!1,this.withCredentials=e.withCredentials,this.chromosomeNames=[],this.chromosomes={},this.sequences={},this.offsets={};let t={};for(let n in e)e.hasOwnProperty(n)&&!d_.has(n)&&(t[n]=e[n]);this.config=t}async init(){return this.getIndex()}async getSequence(e,t,n){if(!(this.interval&&this.interval.contains(e,t,n))){let l=t,c=n;if(n-t<5e4){let d=n-t,f=Math.round(t+d/2);l=Math.max(0,f-25e3),c=f+25e3}let h=await this.readSequence(e,l,c);this.interval=new Zi(e,l,c,h)}let r=t-this.interval.start,a=n-t;return this.interval.features?this.interval.features.substr(r,a):null}async getIndex(){if(this.index)return this.index;{let e=await Ce.load(this.indexFile,Oe(this.config)),t=u_(e),n=t.length,s=0,r=0;for(this.index={};s<n;){let a=t[s++].split("	");if(a.length===5){let l=a[0],c=parseInt(a[1]),h=parseInt(a[2]),d=parseInt(a[3]),f=parseInt(a[4]),u={size:c,position:h,basesPerLine:d,bytesPerLine:f};this.chromosomeNames.push(l),this.index[l]=u,this.chromosomes[l]=new xr(l,r++,c)}}return this.index}}async getCompressedIndex(){if(this.compressedIndex)return this.compressedIndex;if(!this.compressedIndexFile)return this.compressedIndex=[],this.compressedIndex;this.compressedIndex=[];let n=await Ce.loadArrayBuffer(this.compressedIndexFile,Oe(this.config)),s=n.byteLength;if(s<8)return console.log("Cannot parse GZI index file: length ("+s+" bytes) is insufficient to determine content of index."),this.compressedIndex;let r=n.slice(0,8),a=Number(new DataView(r).getBigUint64(0,!0)),o=8+a*2*8;if(s!=o)return console.log("Incorrect file size of reference genome index. Expected : "+o+". Received : "+s),this.compressedIndex;this.compressedIndex.push([0,0]);for(let l=0;l<a;l++){let c=8+l*2*8,h=8+l*2*8+2*8,d=n.slice(c,h),f=new DataView(d),u=Number(f.getBigUint64(0,!0)),g=Number(f.getBigUint64(8,!0));this.compressedIndex.push([u,g])}return this.compressedIndex}async getRelevantCompressedBlockNumbers(e,t){if(e<0||t<0||t<e)return console.log("Incompatible query positions for reference-genome. Start:"+e+" | End:"+t),[];await this.getCompressedIndex();let s=[],r=0,a=this.compressedIndex.length-1;if(this.compressedIndex.length==0)return console.log("Compressed index does not contain any content"),[];if(e>this.compressedIndex[a][1])return[a];let o=r,l=a,c=Math.floor(this.compressedIndex.length/2),h=this.compressedIndex.length+1,d=!1;for(let g=0;g<h;g++){let _=this.compressedIndex[c][1],b=c<this.compressedIndex.length-1?this.compressedIndex[c+1][1]:1/0;if(_<=e&&b>e){d=!0;break}else _<e?o=c+1:l=c-1;c=Math.ceil((l-o)/2)+o}if(!d)return console.log("No blocks within compressed index found that correspond with query positions "+e+","+t),console.log(this.compressedIndex),[];s.push(c);for(let g=c+1;g<this.compressedIndex.length&&(s.push(g),!(this.compressedIndex[g][1]>=t));g++);let f=s[s.length-1],u=this.compressedIndex.length-1;return f===u&&this.compressedIndex[f][1]<t&&s.push(-1),s}async loadAndUncompressBlocks(e,t){if(await this.getCompressedIndex(),e.length==0)return"";let r=Array(e.length-1);for(let c=0;c<e.length-1;c++){let h=e[c],f=this.compressedIndex[h][0],u=e[c+1],g=[];if(u!=-1){let p=this.compressedIndex[u][0]-f;g=await Ce.loadArrayBuffer(this.file,Oe(this.config,{range:{start:f,size:p}}))}else g=await Ce.loadArrayBuffer(this.file,Oe(this.config,{range:{start:f}}));let _=await bi(g);r[c]=_}let a="";for(let c=0;c<r.length;c++)for(let h=0;h<r[c].length;h++){let d=String.fromCharCode(r[c][h]);a=a+d}let o=this.compressedIndex[e[0]],l=t-o[1];return a=a.substring(l),a}async readSequence(e,t,n){await this.getIndex(),await this.getCompressedIndex();let s=this.index[e];if(!s)return console.log("No index entry for chr: "+e),this.interval=new Zi(e,t,n,null),null;let r=Math.max(0,t),a=Math.min(s.size,n),o=s.bytesPerLine,l=s.basesPerLine,c=s.position,h=o-l,d=Math.floor(r/l),f=Math.floor(a/l),u=d*l,g=r-u,_=c+d*o+g,b=f*l,w=a-b,p=c+f*o+w-1,m=p-_+1;if(m<=0)return console.error("No sequence for "+e+":"+t+"-"+n),null;let v;if(!this.compressedIndexFile)v=await Ce.load(this.file,Oe(this.config,{range:{start:_,size:m}}));else{let L=await this.getRelevantCompressedBlockNumbers(_,p);if(L.length===0)return console.log("No blocks in the compressed index that correspond with the requested byte positions ("+_+","+p+")"),null;v=await this.loadAndUncompressBlocks(L,_)}if(!v)return null;let x,R="",M=0,C=v.length;for(g>0&&(x=Math.min(a-r,l-g),R+=v.substr(M,x),M+=x+h);M<C;)x=Math.min(l,C-M),R+=v.substr(M,x),M+=x+h;return R}},p_=Ji,ol=class{constructor(e){this.url=e,this.chromosomeNames=[],this.chromosomes={}}async init(){return this.loadAll()}async getSequence(e,t,n){}async loadAll(){let e;if(oi(this.url)){let s=tn(this.fastaURL);e="";for(let r of s)e+=String.fromCharCode(r)}else e=await Ce.load(this.url,{});this.chromosomeNames=[],this.chromosomes={};let t=p_(e),n=0;for(let s of t){let r=s.split("	");this.chromosomeNames.push(r[0]);let a=Number.parseInt(r[1]),o=new xr(r[0],n++,a);this.chromosomes[r[0]]=o}}};async function Wg(i){let e;return i.format==="chromsizes"?e=new ol(i.fastaURL):oi(i.fastaURL)||i.indexed===!1?e=new rl(i):e=new al(i),await e.init(),e}var jg={A:"rgb(  0, 200,   0)",C:"rgb(  0,0,200)",T:"rgb(255,0,0)",G:"rgb(209,113,  5)",N:"rgb(80,80,80)"},Ns=Number.MIN_SAFE_INTEGER,g_={TTT:"F",TTC:"F",TTA:"L",TTG:"L",CTT:"L",CTC:"L",CTA:"L",CTG:"L",ATT:"I",ATC:"I",ATA:"I",ATG:"M",GTT:"V",GTC:"V",GTA:"V",GTG:"V",TCT:"S",TCC:"S",TCA:"S",TCG:"S",CCT:"P",CCC:"P",CCA:"P",CCG:"P",ACT:"T",ACC:"T",ACA:"T",ACG:"T",GCT:"A",GCC:"A",GCA:"A",GCG:"A",TAT:"Y",TAC:"Y",TAA:"STOP",TAG:"STOP",CAT:"H",CAC:"H",CAA:"Q",CAG:"Q",AAT:"N",AAC:"N",AAA:"K",AAG:"K",GAT:"D",GAC:"D",GAA:"E",GAG:"E",TGT:"C",TGC:"C",TGA:"STOP",TGG:"W",CGT:"R",CGC:"R",CGA:"R",CGG:"R",AGT:"S",AGC:"S",AGA:"R",AGG:"R",GGT:"G",GGC:"G",GGA:"G",GGG:"G"},ll={},to=["A","G","C","T","Y","R","W","S","K","M","D","V","H","B","N","X"],su=["T","C","G","A","R","Y","W","S","M","K","H","B","D","V","N","X"];for(let i=0;i<to.length;i++)ll[to[i]]=su[i],ll[to[i].toLowerCase()]=su[i].toLowerCase();var Wr=25,jr=115,Gr=15,au=25,Zr=5,m_=1/10,Gg=10,Fs=class{constructor(e,t){this.config=e,this.browser=t,this.type="sequence",this.removable=e.removable===void 0?!0:e.removable,this.name=e.name,this.id=e.id,this.sequenceType=e.sequenceType||"dna",this.disableButtons=!1,this.order=e.order||Ns,this.ignoreTrackMenu=!1,this.reversed=e.reversed===!0,this.frameTranslate=e.frameTranslate===!0,this.height=this.frameTranslate?jr:Wr,e.url&&(e.fastaURL=e.url),e.fastaURL||(this.id=e.id||"sequence")}menuItemList(){return[{name:this.reversed?"Forward":"Reverse",click:()=>{this.reversed=!this.reversed,this.trackView.repaintViews()}},{name:this.frameTranslate?"Close Translation":"Three-frame Translate",click:()=>{if(this.frameTranslate=!this.frameTranslate,this.frameTranslate){for(let e of this.trackView.viewports)e.setContentHeight(jr);this.trackView.setTrackHeight(jr)}else{for(let e of this.trackView.viewports)e.setContentHeight(Wr);this.trackView.setTrackHeight(Wr)}this.trackView.repaintViews()}}]}contextMenuItemList(e){let t=e.viewport;if(t.referenceFrame.bpPerPixel<=1){let s=t.getWidth()*t.referenceFrame.bpPerPixel,r=t.referenceFrame.chr,a=Math.floor(t.referenceFrame.start),o=Math.ceil(a+s),l=[{label:this.reversed?"View visible sequence (reversed)...":"View visible sequence...",click:async()=>{let c=await this.browser.genome.sequence.getSequence(r,a,o);c?this.reversed&&(c=Pi(c)):c="Unknown sequence",this.browser.alert.present(c)}}];return bc()&&l.push({label:"Copy visible sequence",click:async()=>{let c=await this.browser.genome.sequence.getSequence(r,a,o);c?this.reversed&&(c=Pi(c)):c="Unknown sequence";try{await navigator.clipboard.writeText(c)}catch(h){console.error(h),this.browser.alert.present(`error copying sequence to clipboard ${h}`)}}}),l.push("<hr/>"),l}else return}translateSequence(e){let t=[[],[],[]];for(let n of[0,1,2]){let s=n;for(;e.length-s>=3;){let r=e.slice(s,s+3);this.reversed&&(r=r.split("").reverse().join(""));let a=g_[r.toUpperCase()]||"";t[n].push({codons:r,aminoA:a}),s+=3}}return t}async getSequenceSource(){return this.config.fastaURL?(this.fasta||(this.fasta=new hl(this.config,this.browser.genome),await this.fasta.init()),this.fasta):this.browser.genome.sequence}async getFeatures(e,t,n,s){if(t=Math.floor(t),n=Math.floor(n),s&&s>Gg)return null;{let a=await(await this.getSequenceSource()).getSequence(e,t,n);return{bpStart:t,sequence:a}}}draw(e){let t=e.context;if(e.features){let n=e.features.sequence;if(!n)return;this.reversed&&(n=n.split("").map(function(a){return ll[a]}).join(""));let s=e.features.bpStart,r=1+e.bpStart+e.pixelWidth*e.bpPerPixel;for(let a=Math.floor(e.bpStart);a<=r;a++){let o=Math.floor(a-s);if(o>=0&&o<n.length){let c=(a-e.bpStart)/e.bpPerPixel,h=1/e.bpPerPixel,d=n[o],f=this.fillColor(d.toUpperCase());if(e.bpPerPixel>m_)he.fillRect(t,c,Zr,h,Gr-Zr,{fillStyle:f});else{let u=c+.5*(h-t.measureText(d).width);e.axis==="y"?(t.save(),he.labelTransformWithContext(t,u),he.strokeText(t,d,u,Gr,{strokeStyle:f}),t.restore()):he.strokeText(t,d,u,Gr,{strokeStyle:f})}}}if(this.frameTranslate){let a=Gr+2*Zr,o=this.translateSequence(n);for(let l=0;l<o.length;l++){let c=o[l];for(let h=0;h<c.length;h++){let d=h%2===0?"rgb(160,160,160)":"rgb(224,224,224)",f=c[h],g=s+l+h*3-e.bpStart,_=Math.floor(g/e.bpPerPixel),b=Math.floor((g+3)/e.bpPerPixel),w=Math.round((_+b)/2);if(b<0)continue;if(_>e.pixelWidth)break;let p=f.aminoA;f.aminoA.indexOf("STOP")>-1?(d="rgb(255, 0, 0)",p="STOP"):f.aminoA==="M"&&(d="rgb(0, 153, 0)",p="START"),he.fillRect(t,_,a,b-_,au,{fillStyle:d}),e.bpPerPixel<=1/10&&he.strokeText(t,p,w-t.measureText(p).width/2,a+15)}a+=au+Zr}}}}get supportsWholeGenome(){return!1}computePixelHeight(e){return this.height=this.frameTranslate?jr:Wr,this.height}fillColor(e){return this.color?this.color:this.sequenceType==="dna"?jg[e]||"gray":"rgb(0, 0, 150)"}getState(){let e={type:"sequence"};return this.order!==Ns&&(e.order=this.order),this.reversed&&(e.revealed=!0),e}},hl=class{constructor(e,t){this.config=e,this.genome=t}async init(){this.fasta=await Wg(this.config),this.chrNameMap=new Map;for(let e of this.fasta.chromosomeNames)this.chrNameMap.set(this.genome.getChromosomeName(e),e)}async getSequence(e,t,n){let s=this.chrNameMap.has(e)?this.chrNameMap.get(e):e;return this.fasta.getSequence(s,t,n)}},cl=class{constructor(e,t,n,s){this.guid=de.guid(),this.trackView=e,this.referenceFrame=n,this.browser=e.browser,this.$viewport=pe('<div class="igv-viewport">'),t.appendChild(this.$viewport.get(0)),e.track.height&&(this.$viewport.get(0).style.height=`${e.track.height}px`),e.track instanceof Fs&&(this.alert=new ys(this.$viewport.get(0))),this.contentTop=0,this.contentHeight=this.$viewport.height(),this.$viewport.width(s),this.initializationHelper()}initializationHelper(){}showMessage(e){this.messageDiv||(this.messageDiv=document.createElement("div"),this.messageDiv.className="igv-viewport-message",this.$viewport.append(pe(this.messageDiv))),this.messageDiv.textContent=e,this.messageDiv.style.display="inline-block"}hideMessage(e){this.messageDiv&&(this.messageDiv.style.display="none")}setTrackLabel(e){}startSpinner(){}stopSpinner(){}checkZoomIn(){return!0}shift(){}setTop(e){this.contentTop=e,this.$viewport.height()}async loadFeatures(){}clearCache(){}async repaint(){}draw(e,t,n){console.log("Viewport - draw(drawConfiguration, features, roiFeatures)")}checkContentHeight(e){let t=this.trackView.track;if(e=e||this.cachedFeatures,t.displayMode==="FILL")this.setContentHeight(this.$viewport.height());else if(typeof t.computePixelHeight=="function"&&e&&e.length>0){let n=t.computePixelHeight(e),s=this.contentHeight;n!==s&&this.setContentHeight(n)}}getContentHeight(){return this.contentHeight}setContentHeight(e){this.contentHeight=e}isLoading(){return!1}saveSVG(){}isVisible(){return this.$viewport.width()}setWidth(e){this.$viewport.width(e)}getWidth(){return this.$viewport.width()}getContentTop(){return this.contentTop}containsPosition(e,t){console.log("Viewport - containsPosition(chr, position)")}addMouseHandlers(){}removeMouseHandlers(){}dispose(){this.popover&&this.popover.dispose(),this.$viewport.get(0).remove();for(let e of Object.keys(this))this[e]=void 0}};function dt(i,e){var t=Object.keys(e),n;for(n=0;n<t.length;n++)i=i.replace(new RegExp("\\{"+t[n]+"\\}","gi"),e[t[n]]);return i}function Xr(i){var e,t,n;if(!i)throw new Error("cannot create a random attribute name for an undefined object");e="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",t="";do for(t="",n=0;n<12;n++)t+=e[Math.floor(Math.random()*e.length)];while(i[t]);return t}function b_(i,e){var t,n,s={},r;for(i=i.split(","),e=e||10,t=0;t<i.length;t+=2)n="&"+i[t+1]+";",r=parseInt(i[t],e),s[n]="&#"+r+";";return s["\\xa0"]="&#160;",s}function w_(i){var e={left:"start",right:"end",center:"middle",start:"start",end:"end"};return e[i]||e.start}function v_(i){var e={alphabetic:"alphabetic",hanging:"hanging",top:"text-before-edge",bottom:"text-after-edge",middle:"central"};return e[i]||e.alphabetic}function io(i){var e=Math.sqrt(i[0]*i[0]+i[1]*i[1]);return[i[0]/e,i[1]/e]}function __(i,e){return i.x<e.x+e.width&&i.x+i.width>e.x&&i.y<e.y+e.height&&i.y+i.height>e.y}var ou=b_("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),Wn={strokeStyle:{svgAttr:"stroke",canvas:"#000000",svg:"none",apply:"stroke"},fillStyle:{svgAttr:"fill",canvas:"#000000",svg:null,apply:"fill"},lineCap:{svgAttr:"stroke-linecap",canvas:"butt",svg:"butt",apply:"stroke"},lineJoin:{svgAttr:"stroke-linejoin",canvas:"miter",svg:"miter",apply:"stroke"},miterLimit:{svgAttr:"stroke-miterlimit",canvas:10,svg:4,apply:"stroke"},lineWidth:{svgAttr:"stroke-width",canvas:1,svg:1,apply:"stroke"},globalAlpha:{svgAttr:"opacity",canvas:1,svg:1,apply:"fill stroke"},font:{canvas:"10px sans-serif"},shadowColor:{canvas:"#000000"},shadowOffsetX:{canvas:0},shadowOffsetY:{canvas:0},shadowBlur:{canvas:0},textAlign:{canvas:"start"},textBaseline:{canvas:"alphabetic"},lineDash:{svgAttr:"stroke-dasharray",canvas:[],svg:null,apply:"stroke"}},rr=class{constructor(e,t){this.__root=e,this.__ctx=t}addColorStop(e,t){var n=this.__ctx.__createElement("stop"),s,r;n.setAttribute("offset",e),t&&t.indexOf("rgba")!==-1?(s=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi,r=s.exec(t),n.setAttribute("stop-color",dt("rgb({r},{g},{b})",{r:r[1],g:r[2],b:r[3]})),n.setAttribute("stop-opacity",r[4])):n.setAttribute("stop-color",t),this.__root.appendChild(n)}},Ds=class{constructor(e,t){this.__root=e,this.__ctx=t}},Os=class i{constructor(e){if(!(this instanceof i))return new i(e);if(this.config=e,this.width=e.width,this.height=e.height,this.enableMirroring=e.enableMirroring||!1,this.canvas=this,this.__document=document,e.ctx?this.__ctx=e.ctx:(this.__canvas=this.__document.createElement("canvas"),this.__ctx=this.__canvas.getContext("2d")),this.isSVG=!0,this.__setDefaultStyles(),this.__stack=[this.__getStyleState()],this.__groupStack=[],this.__root=this.__createElement("svg"),this.__root.setAttribute("width",this.width),this.__root.setAttribute("height",this.height),this.__root.setAttribute("overflow","visible"),e.viewbox){let s=e.viewbox.x+" "+e.viewbox.y+" "+e.viewbox.width+" "+e.viewbox.height;this.__root.setAttribute("viewBox",s),this.viewbox=e.viewbox}this.__ids={},this.__defs=this.__createElement("defs"),this.__root.appendChild(this.__defs),this.multiLocusGap=e.multiLocusGap;let t={id:"svg_output_backdrop",width:"100%",height:"100%",fill:e.backdropColor||"white"},n=this.__createElement("rect",t);this.__root.appendChild(n),this.__rootGroup=this.__createElement("g",{id:"root-group"}),this.__root.appendChild(this.__rootGroup),this.__currentElement=this.__rootGroup}setWidth(e){this.width=e,this.__root.setAttribute("width",this.width);let t=this.config.viewbox.x+" "+this.config.viewbox.y+" "+e+" "+this.config.viewbox.height;this.__root.setAttribute("viewBox",t)}setHeight(e){this.height=e,this.__root.setAttribute("height",this.height);let t=this.config.viewbox.x+" "+this.config.viewbox.y+" "+this.config.viewbox.width+" "+e;this.__root.setAttribute("viewBox",t)}__createElement(e,t,n){typeof t>"u"&&(t={});let s=this.__document.createElementNS("http://www.w3.org/2000/svg",e);n&&(s.setAttribute("fill","none"),s.setAttribute("stroke","none"));for(let r of Object.keys(t))s.setAttribute(r,t[r]);return s}__setDefaultStyles(){var e=Object.keys(Wn),t,n;for(t=0;t<e.length;t++)n=e[t],this[n]=Wn[n].canvas}__applyStyleState(e){var t=Object.keys(e),n,s;for(n=0;n<t.length;n++)s=t[n],this[s]=e[s]}__getStyleState(){var e,t={},n=Object.keys(Wn),s;for(e=0;e<n.length;e++)s=n[e],t[s]=this[s];return t}__applyStyleToCurrentElement(e){var t=this.__currentElement,n=this.__currentElementsToStyle;n&&(t.setAttribute(e,""),t=n.element,n.children.forEach(function(g){g.setAttribute(e,"")}));var s=Object.keys(Wn),r,a,o,l,c,h;for(r=0;r<s.length;r++)if(a=Wn[s[r]],o=this[s[r]],a.apply){if(o instanceof Ds){if(o.__ctx)for(;o.__ctx.__defs.childNodes.length;)l=o.__ctx.__defs.childNodes[0].getAttribute("id"),this.__ids[l]=l,this.__defs.appendChild(o.__ctx.__defs.childNodes[0]);t.setAttribute(a.apply,dt("url(#{id})",{id:o.__root.getAttribute("id")}))}else if(o instanceof rr)t.setAttribute(a.apply,dt("url(#{id})",{id:o.__root.getAttribute("id")}));else if(a&&a.apply.indexOf(e)!==-1&&a.svg!==o)if((a.svgAttr==="stroke"||a.svgAttr==="fill")&&o&&o.indexOf("rgba")!==-1){c=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi,h=c.exec(o),t.setAttribute(a.svgAttr,dt("rgb({r},{g},{b})",{r:h[1],g:h[2],b:h[3]}));var d=h[4],f=this.globalAlpha;f!=null&&(d*=f),t.setAttribute(a.svgAttr+"-opacity",d)}else{var u=a.svgAttr;if(s[r]==="globalAlpha"&&(u=e+"-"+a.svgAttr,t.getAttribute(u)))continue;t.setAttribute(u,o)}}}__closestGroupOrSvg(e){return e=e||this.__currentElement,e.nodeName==="g"||e.nodeName==="svg"?e:this.__closestGroupOrSvg(e.parentNode)}getSerializedSvg(e){var t=new XMLSerializer().serializeToString(this.__root),n,s,r,a,o;if(e)for(n=Object.keys(ou),s=0;s<n.length;s++)r=n[s],a=ou[r],o=new RegExp(r,"gi"),o.test(t)&&(t=t.replace(o,a));return t}getSvg(){return this.__root}saveWithTranslationAndClipRect(e,t,n,s,r,a){let o=`${e}_clip_rect`,l=this.__createElement("clipPath",{id:o});this.__defs.appendChild(l);let c={x:"0",y:a.toString(),width:s.toString(),height:r.toString()};l.appendChild(this.__createElement("rect",c));let h=this.__createElement("g");h.setAttribute("transform",dt("translate({x},{y})",{x:t,y:n})),h.setAttribute("clip-path",dt("url(#{id})",{id:o}));let d=this.__closestGroupOrSvg();d.appendChild(h),this.__groupStack.push(d),this.__currentElement=h,this.__stack.push(this.__getStyleState())}save(){var e=this.__createElement("g"),t=this.__closestGroupOrSvg();this.__groupStack.push(t),t.appendChild(e),this.__currentElement=e,this.__stack.push(this.__getStyleState())}restore(){this.__currentElement=this.__groupStack.pop(),this.__currentElementsToStyle=null,this.__currentElement||(this.__currentElement=this.__root.childNodes[1]);var e=this.__stack.pop();this.__applyStyleState(e)}__addTransform(e){var t=this.__closestGroupOrSvg();if(t.childNodes.length>0){this.__currentElement.nodeName==="path"&&(this.__currentElementsToStyle||(this.__currentElementsToStyle={element:t,children:[]}),this.__currentElementsToStyle.children.push(this.__currentElement),this.__applyCurrentDefaultPath());var n=this.__createElement("g");t.appendChild(n),this.__currentElement=n}var s=this.__currentElement.getAttribute("transform");s?s+=" ":s="",s+=e,this.__currentElement.setAttribute("transform",s)}addTrackGroupWithTranslationAndClipRect(e,t,n,s,r,a){let o=e+"_clip_rect",l=this.__createElement("clipPath",{id:o});this.__defs.appendChild(l),l.appendChild(this.__createElement("rect",{x:"0",y:a.toString(),width:s.toString(),height:r.toString()}));let c=this.__createElement("g");this.__rootGroup.appendChild(c),c.setAttribute("transform",dt("translate({x},{y})",{x:t,y:n})),c.setAttribute("id",e+"_group"),c.setAttribute("clip-path",dt("url(#{id})",{id:o})),this.__currentElement=c}scale(e,t){t===void 0&&(t=e),this.__addTransform(dt("scale({x},{y})",{x:e,y:t}))}rotate(e){var t=e*180/Math.PI;this.__addTransform(dt("rotate({angle},{cx},{cy})",{angle:t,cx:0,cy:0}))}translate(e,t){this.__addTransform(dt("translate({x},{y})",{x:e,y:t}))}transform(e,t,n,s,r,a){this.__addTransform(dt("matrix({a},{b},{c},{d},{e},{f})",{a:e,b:t,c:n,d:s,e:r,f:a}))}beginPath(){var e,t;this.__currentDefaultPath="",this.__currentPosition={},e=this.__createElement("path",{},!0),t=this.__closestGroupOrSvg(),t.appendChild(e),this.__currentElement=e}__applyCurrentDefaultPath(){var e=this.__currentElement;e.nodeName==="path"?e.setAttribute("d",this.__currentDefaultPath):console.error("Attempted to apply path command to node",e.nodeName)}__addPathCommand(e){this.__currentDefaultPath+=" ",this.__currentDefaultPath+=e}moveTo(e,t){this.__currentElement.nodeName!=="path"&&this.beginPath(),this.__currentPosition={x:e,y:t},this.__addPathCommand(dt("M {x} {y}",{x:e,y:t}))}closePath(){this.__currentDefaultPath&&this.__addPathCommand("Z")}lineTo(e,t){this.__currentPosition={x:e,y:t},this.__currentDefaultPath&&this.__currentDefaultPath.indexOf("M")>-1?this.__addPathCommand(dt("L {x} {y}",{x:e,y:t})):this.__addPathCommand(dt("M {x} {y}",{x:e,y:t}))}bezierCurveTo(e,t,n,s,r,a){this.__currentPosition={x:r,y:a},this.__addPathCommand(dt("C {cp1x} {cp1y} {cp2x} {cp2y} {x} {y}",{cp1x:e,cp1y:t,cp2x:n,cp2y:s,x:r,y:a}))}quadraticCurveTo(e,t,n,s){this.__currentPosition={x:n,y:s},this.__addPathCommand(dt("Q {cpx} {cpy} {x} {y}",{cpx:e,cpy:t,x:n,y:s}))}arcTo(e,t,n,s,r){var a=this.__currentPosition&&this.__currentPosition.x,o=this.__currentPosition&&this.__currentPosition.y;if(!(typeof a>"u"||typeof o>"u")){if(r<0)throw new Error("IndexSizeError: The radius provided ("+r+") is negative.");if(a===e&&o===t||e===n&&t===s||r===0){this.lineTo(e,t);return}var l=io([a-e,o-t]),c=io([n-e,s-t]);if(l[0]*c[1]===l[1]*c[0]){this.lineTo(e,t);return}var h=l[0]*c[0]+l[1]*c[1],d=Math.acos(Math.abs(h)),f=io([l[0]+c[0],l[1]+c[1]]),u=r/Math.sin(d/2),g=e+u*f[0],_=t+u*f[1],b=[-l[1],l[0]],w=[c[1],-c[0]],p=function(x){var R=x[0],M=x[1];return M>=0?Math.acos(R):-Math.acos(R)},m=p(b),v=p(w);this.lineTo(g+b[0]*r,_+b[1]*r),this.arc(g,_,r,m,v)}}stroke(){this.__currentElement.nodeName==="path"&&this.__currentElement.setAttribute("paint-order","fill stroke markers"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("stroke")}fill(){this.__currentElement.nodeName==="path"&&this.__currentElement.setAttribute("paint-order","stroke fill markers"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("fill")}rect(e,t,n,s){this.__currentElement.nodeName!=="path"&&this.beginPath(),this.moveTo(e,t),this.lineTo(e+n,t),this.lineTo(e+n,t+s),this.lineTo(e,t+s),this.lineTo(e,t),this.closePath()}fillRect(e,t,n,s){s<0&&(t+=s,s=-s),n<0&&(e+=n,n=-n);var r={x:e,y:t,width:n,height:s};if(!(this.viewbox&&!__(this.viewbox,r))){var a,o;a=this.__createElement("rect",r,!0),o=this.__closestGroupOrSvg(),o.appendChild(a),this.__currentElement=a,this.__applyStyleToCurrentElement("fill")}}strokeRect(e,t,n,s){var r,a;r=this.__createElement("rect",{x:e,y:t,width:n,height:s},!0),a=this.__closestGroupOrSvg(),a.appendChild(r),this.__currentElement=r,this.__applyStyleToCurrentElement("stroke")}strokeEllipse(e,t,n,s,r,a,o,l){this.__ellipse(e,t,n,s,r,a,o,l,"stroke")}fillEllipse(e,t,n,s,r,a,o,l){this.__ellipse(e,t,n,s,r,a,o,l,"fill")}__ellipse(e,t,n,s,r,a,o,l,c){let h={cx:e,cy:t,rx:n,ry:s},d=this.__createElement("ellipse",h,!0);this.__closestGroupOrSvg().appendChild(d),this.__currentElement=d,this.__applyStyleToCurrentElement(c)}__clearCanvas(){for(var e=this.__closestGroupOrSvg(),t=e.getAttribute("transform"),n=this.__root.childNodes[1],s=n.childNodes,r=s.length-1;r>=0;r--)s[r]&&n.removeChild(s[r]);this.__currentElement=n,this.__groupStack=[],t&&this.__addTransform(t)}clearRect(e,t,n,s){if(e===0&&t===0&&n===this.width&&s===this.height){this.__clearCanvas();return}var r,a=this.__closestGroupOrSvg();r=this.__createElement("rect",{x:e,y:t,width:n,height:s,fill:"#FFFFFF"},!0),a.appendChild(r)}createLinearGradient(e,t,n,s){var r=this.__createElement("linearGradient",{id:Xr(this.__ids),x1:e+"px",x2:n+"px",y1:t+"px",y2:s+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(r),new rr(r,this)}createRadialGradient(e,t,n,s,r,a){var o=this.__createElement("radialGradient",{id:Xr(this.__ids),cx:s+"px",cy:r+"px",r:a+"px",fx:e+"px",fy:t+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(o),new rr(o,this)}__parseFont(){var e=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-,\'\"\sa-z0-9]+?)\s*$/i,t=e.exec(this.font),n={style:t[1]||"normal",size:t[4]||"10px",family:t[6]||"sans-serif",weight:t[3]||"normal",decoration:t[2]||"normal",href:null};return this.__fontUnderline==="underline"&&(n.decoration="underline"),this.__fontHref&&(n.href=this.__fontHref),n}__wrapTextLink(e,t){if(e.href){var n=this.__createElement("a");return n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e.href),n.appendChild(t),n}return t}__applyText(e,t,n,s){var r=this.__parseFont(),a=this.__closestGroupOrSvg(),o=this.__createElement("text",{"font-family":r.family,"font-size":r.size,"font-style":r.style,"font-weight":r.weight,"text-decoration":r.decoration,x:t,y:n,"text-anchor":w_(this.textAlign),"dominant-baseline":v_(this.textBaseline)},!0);o.appendChild(this.__document.createTextNode(e)),this.__currentElement=o,this.__applyStyleToCurrentElement(s),a.appendChild(this.__wrapTextLink(r,o))}fillText(e,t,n){this.__applyText(e,t,n,"fill")}strokeText(e,t,n){this.__applyText(e,t,n,"stroke")}measureText(e){return this.__ctx.font=this.font,this.__ctx.measureText(e)}arc(e,t,n,s,r,a){if(s!==r){s=s%(2*Math.PI),r=r%(2*Math.PI),s===r&&(r=(r+2*Math.PI-.001*(a?-1:1))%(2*Math.PI));var o=e+n*Math.cos(r),l=t+n*Math.sin(r),c=e+n*Math.cos(s),h=t+n*Math.sin(s),d=a?0:1,f=0,u=r-s;u<0&&(u+=2*Math.PI),a?f=u>Math.PI?0:1:f=u>Math.PI?1:0,this.lineTo(c,h),this.__addPathCommand(dt("A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}",{rx:n,ry:n,xAxisRotation:0,largeArcFlag:f,sweepFlag:d,endX:o,endY:l})),this.__currentPosition={x:o,y:l}}}clip(){var e=this.__closestGroupOrSvg(),t=this.__createElement("clipPath"),n=Xr(this.__ids),s=this.__createElement("g");this.__applyCurrentDefaultPath(),e.removeChild(this.__currentElement),t.setAttribute("id",n),t.appendChild(this.__currentElement),this.__defs.appendChild(t),e.setAttribute("clip-path",dt("url(#{id})",{id:n})),e.appendChild(s),this.__currentElement=s}drawImage(){var e=Array.prototype.slice.call(arguments),t=e[0],n,s,r,a,o=0,l=0,c,h,d,f,u,g,_,b,w,p;if(e.length===3)n=e[1],s=e[2],c=t.width,h=t.height,r=c,a=h;else if(e.length===5)n=e[1],s=e[2],r=e[3],a=e[4],c=t.width,h=t.height;else if(e.length===9)o=e[1],l=e[2],c=e[3],h=e[4],n=e[5],s=e[6],r=e[7],a=e[8];else throw new Error("Invalid number of arguments passed to drawImage: "+arguments.length);d=this.__closestGroupOrSvg(),this.__currentElement;var m="translate("+n+", "+s+")";if(t instanceof i){if(f=t.getSvg().cloneNode(!0),f.childNodes&&f.childNodes.length>1){for(u=f.childNodes[0];u.childNodes.length;)p=u.childNodes[0].getAttribute("id"),this.__ids[p]=p,this.__defs.appendChild(u.childNodes[0]);if(g=f.childNodes[1],g){var v=g.getAttribute("transform"),x;v?x=v+" "+m:x=m,g.setAttribute("transform",x),d.appendChild(g)}}}else(t.nodeName==="CANVAS"||t.nodeName==="IMG")&&(_=this.__createElement("image"),_.setAttribute("width",r),_.setAttribute("height",a),_.setAttribute("preserveAspectRatio","none"),(o||l||c!==t.width||h!==t.height)&&(b=this.__document.createElement("canvas"),b.width=r,b.height=a,w=b.getContext("2d"),w.drawImage(t,o,l,c,h,0,0,r,a),t=b),_.setAttribute("transform",m),_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t.nodeName==="CANVAS"?t.toDataURL():t.getAttribute("src")),d.appendChild(_))}createPattern(e,t){let n=this.__document.__createElement("pattern"),s=Xr(this.__ids),r;return n.setAttribute("id",s),n.setAttribute("width",e.width),n.setAttribute("height",e.height),e.nodeName==="CANVAS"||e.nodeName==="IMG"?(r=this.__createElement("image"),r.setAttribute("width",e.width),r.setAttribute("height",e.height),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e.nodeName==="CANVAS"?e.toDataURL():e.getAttribute("src")),n.appendChild(r),this.__defs.appendChild(n)):e instanceof i&&(n.appendChild(e.__root.childNodes[1]),this.__defs.appendChild(n)),new Ds(n,this)}setLineDash(e){e&&e.length>0?this.lineDash=e.join(","):this.lineDash=null}drawFocusRing(){}createImageData(){}getImageData(){}putImageData(){}globalCompositeOperation(){}setTransform(){}},y_=function(i,e,t,n){this.start=i,this.end=e,this.name=t,this.stain=0,n==="acen"?this.type="c":(this.type=n.charAt(1),this.type==="p"&&(this.stain=parseInt(n.substring(4))))},x_="2.15.13";function Bs(){return x_}var k_="https://igv.org/genomes/genomes.json",S_="https://s3.amazonaws.com/igv.org.genomes/genomes.json",Zg=Ji,mt={loadGenome:async function(i){let e=i.cytobandURL,t=i.aliasURL,n=await Wg(i),s;t&&(s=await E_(t,n.config));let r=new fl(i,n,s);return e&&(r.cytobands=await C_(e,n.config,r)),r},initializeGenomes:async function(i){if(!mt.KNOWN_GENOMES){let n=function(s){return s.forEach(function(r){e[r.id]=r}),e},e={};if(i.loadDefaultGenomes!==!1)try{let s=k_+`?randomSeed=${Math.random().toString(36)}&version=${Bs()}`,r=await Ce.loadJson(s,{timeout:5e3});n(r)}catch(s){console.error(s);try{let r=S_+`?randomSeed=${Math.random().toString(36)}&version=${Bs()}`,a=await Ce.loadJson(r,{});n(a)}catch(r){console.error(r),console.warn("Errors loading default genome definitions.")}}let t=i.genomeList||i.genomes;if(t)if(typeof t=="string"){let s=await Ce.loadJson(t,{});n(s)}else n(t);mt.KNOWN_GENOMES=e}},isWholeGenomeView:function(i){return i.toLowerCase()==="all"},expandReference:function(i,e){if(yt(e)&&e.startsWith("{"))try{e=JSON.parse(e)}catch{}let t;if(yt(e)?t=e:e.genome?t=e.genome:e.id!==void 0&&e.fastaURL===void 0&&(t=e.id),t){let s=mt.KNOWN_GENOMES[t];return s||i.present(new Error(`Unknown genome id: ${t}`),void 0),s}else return e}},fl=class{constructor(e,t,n){this.config=e,this.id=e.id||T_(e),this.sequence=t,this.chromosomeNames=t.chromosomeNames,this.chromosomes=t.chromosomes,this.featureDB=new Map,this.wholeGenomeView=e.wholeGenomeView===void 0||e.wholeGenomeView,this.wholeGenomeView&&Object.keys(t.chromosomes).length>1?A_(this,e):this.wgChromosomeNames=t.chromosomeNames;var s={},r=this;s.all="all",this.chromosomeNames.forEach(function(a){var o=a.startsWith("chr")?a.substring(3):"chr"+a;s[o.toLowerCase()]=a,a==="chrM"&&(s.mt="chrM"),a==="MT"&&(s.chrm="MT"),s[a.toLowerCase()]=a}),n&&n.forEach(function(a){var o,l;for(l=0;l<a.length;l++)if(r.chromosomes[a[l]]){o=a[l];break}o&&a.forEach(function(c){c!==o&&(s[c.toLowerCase()]=o,s[c]=o)})}),this.chrAliasTable=s}showWholeGenomeView(){return this.config.wholeGenomeView!==!1}toJSON(){return Object.assign({},this.config,{tracks:void 0})}getInitialLocus(){}getHomeChromosomeName(){return this.showWholeGenomeView()&&this.chromosomes.hasOwnProperty("all")?"all":this.chromosomeNames[0]}getChromosomeName(e){let t=e&&this.chrAliasTable[e.toLowerCase()];return t||e}getChromosome(e){return e=this.getChromosomeName(e),this.chromosomes[e]}getCytobands(e){return this.cytobands?this.cytobands[e]:null}getLongestChromosome(){var e,t=this.chromosomes;for(let s in t){if(t.hasOwnProperty(s)){var n=t[s];(e===void 0||n.bpLength>e.bpLength)&&(e=n)}return e}}getChromosomes(){return this.chromosomes}getGenomeCoordinate(e,t){var n=this.getCumulativeOffset(e);if(n!==void 0)return n+t}getChromosomeCoordinate(e){this.cumulativeOffsets===void 0&&(this.cumulativeOffsets=computeCumulativeOffsets.call(this));let t,n=0;for(let s of this.wgChromosomeNames){let r=this.cumulativeOffsets[s];if(r>e){let a=e-n;return{chr:t,position:a}}t=s,n=r}return{chr:this.wgChromosomeNames[this.wgChromosomeNames.length-1],position:0}}getCumulativeOffset(e){this.cumulativeOffsets===void 0&&(this.cumulativeOffsets=n.call(this));let t=this.getChromosomeName(e);return this.cumulativeOffsets[t];function n(){let s=this,r={},a=0;for(let o of s.wgChromosomeNames){r[o]=Math.floor(a);let l=s.getChromosome(o);a+=l.bpLength}return r}}getGenomeLength(){let e=this;if(!this.bpLength){let t=0;e.wgChromosomeNames.forEach(function(n){let s=e.chromosomes[n];t+=s.bpLength}),this.bpLength=t}return this.bpLength}async getSequence(e,t,n){return e=this.getChromosomeName(e),this.sequence.getSequence(e,t,n)}addFeaturesToDB(e,t){let n=(s,r)=>{let a=this.featureDB.get(s);a&&(r=r.end-r.start>a.end-a.start?r:a),this.featureDB.set(s,r)};for(let s of e)if(s.name&&n(s.name.toUpperCase(),s),s.gene&&s.gene.name&&n(s.gene.name.toUpperCase(),s),t.searchableFields)for(let r of t.searchableFields){let a=s.getAttributeValue(r);a&&(a.indexOf(" ")>0?n(a.replaceAll(" ","+").toUpperCase(),s):n(a.toUpperCase(),s))}}};async function C_(i,e,t){let n;if(oi(i)){let g=tn(i);n="";let _=g.length;for(let b=0;b<_;b++)n+=String.fromCharCode(g[b])}else n=await Ce.loadString(i,Oe(e));let s={},r,a=[],o=Zg(n);for(let g of o){var l=g.split("	"),c=t.getChromosomeName(l[0]);if(r||(r=c),c!==r&&(s[r]=a,a=[],r=c),l.length===5){var h=parseInt(l[1]),d=parseInt(l[2]),f=l[3],u=l[4];a.push(new y_(h,d,f,u))}}return s}function E_(i,e){return Ce.loadString(i,Oe(e)).then(function(t){var n=Zg(t),s=[];return n.forEach(function(r){!r.startsWith("#")&&r.length>0&&s.push(r.split("	"))}),s})}function A_(i,e){let t;if(e.chromosomeOrder)Array.isArray(e.chromosomeOrder)?i.wgChromosomeNames=e.chromosomeOrder:i.wgChromosomeNames=e.chromosomeOrder.split(",").map(r=>r.trim()),t=i.wgChromosomeNames.map(r=>i.chromosomes[r]).filter(r=>r!==void 0);else{let o=Object.keys(i.chromosomes).map(d=>i.chromosomes[d].bpLength).reduce((d,f)=>Math.max(d,f))/50;t=Object.values(i.chromosomes).filter(d=>d.bpLength>o);let l=t.filter(d=>s(d.name.replace("chr",""))),c=t.filter(d=>!s(d.name.replace("chr","")));l.sort((d,f)=>Number.parseInt(d.name.replace("chr",""))-Number.parseInt(f.name.replace("chr","")));let h=l.map(d=>d.name);for(let d of c)h.push(d.name);i.wgChromosomeNames=h}let n=t.reduce((r,a)=>r+=a.bpLength,0);i.chromosomes.all={name:"all",bpLength:n};function s(r){return/^\d+$/.test(r)}}function T_(i){return i.id!==void 0?i.id:i.fastaURL&&yt(i.fastaURL)?i.fastaURL:i.fastaURL&&i.fastaURL.name?i.fastaURL.name:("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}var M_="Error loading track data",lu=0,hu=0,fn,kr=class extends cl{constructor(e,t,n,s){super(e,t,n,s)}initializationHelper(){this.$spinner=pe("<div>",{class:"igv-loading-spinner-container"}),this.$viewport.append(this.$spinner),this.$spinner.append(pe("<div>"));let e=this.trackView.track;e.type!=="sequence"&&(this.$zoomInNotice=this.createZoomInNotice(this.$viewport)),e.name&&e.id!=="sequence"&&(this.$trackLabel=pe('<div class="igv-track-label">'),this.$viewport.append(this.$trackLabel),this.setTrackLabel(e.name),this.browser.trackLabelsVisible===!1&&this.$trackLabel.hide()),this.stopSpinner(),this.addMouseHandlers()}setContentHeight(e){super.setContentHeight(e),this.featureCache&&(this.featureCache.redraw=!0)}setTrackLabel(e){this.$trackLabel.empty(),this.$trackLabel.html(e);let t=this.$trackLabel.text();this.$trackLabel.attr("title",t)}startSpinner(){this.$spinner.show()}stopSpinner(){this.$spinner&&this.$spinner.hide()}checkZoomIn(){let e=()=>{if(this.referenceFrame.chr.toLowerCase()==="all"&&!this.trackView.track.supportsWholeGenome)return!0;{let t=this.trackView.track.visibilityWindow;return t!==void 0&&t>0&&this.referenceFrame.bpPerPixel*this.$viewport.width()>t}};if(this.trackView.track&&this.trackView.track.type==="sequence"&&this.referenceFrame.bpPerPixel>Gg)return pe(this.canvas).remove(),this.canvas=void 0,!1;if(!this.viewIsReady())return!1;if(e()){if(this.canvas&&(pe(this.canvas).remove(),this.canvas=void 0),this.trackView.track.autoHeight){let t=this.trackView.minHeight||0;this.setContentHeight(t)}return this.$zoomInNotice&&this.$zoomInNotice.show(),!1}else return this.$zoomInNotice&&this.$zoomInNotice.hide(),!0}shift(){let e=this.referenceFrame;if(this.canvas&&this.canvas._data&&this.canvas._data.referenceFrame.chr===this.referenceFrame.chr&&this.canvas._data.bpPerPixel===e.bpPerPixel){let t=Math.round((this.canvas._data.bpStart-e.start)/e.bpPerPixel);this.canvas.style.left=t+"px"}}setTop(e){if(super.setTop(e),!this.canvas)this.repaint();else{let n=this.$viewport.height(),s=e+this.canvas._data.pixelTop,r=s+this.canvas._data.pixelHeight;(s>0||r<n)&&this.repaint()}let t=e+this.canvas._data.pixelTop;this.canvas.style.top=`${t}px`}async loadFeatures(){let e=this.referenceFrame,t=e.chr,n=this.browser.genome.getChromosome(t).bpLength,r=this.$viewport.width()*e.bpPerPixel,a=Math.floor(Math.max(0,e.start-r)),o=Math.ceil(Math.min(n,e.start+r+r));if(!(this.loading&&this.loading.start===a&&this.loading.end===o)){this.loading={start:a,end:o},this.startSpinner();try{let l=this.trackView.track,c=await this.getFeatures(l,t,a,o,e.bpPerPixel);if(c){let h=[];if(l.roiSets&&l.roiSets.length>0)for(let f of l.roiSets){let u=await f.getFeatures(t,a,o,e.bpPerPixel);h.push({track:f,features:u})}let d=l&&(l.type==="wig"||l.type==="merged");return this.featureCache=new ul(t,a,o,e.bpPerPixel,c,h,d),this.loading=!1,this.hideMessage(),this.stopSpinner(),this.featureCache}}catch(l){this.trackView&&this.trackView.disposed!==!0&&(this.showMessage(M_),this.browser.alert.present(l),console.error(l))}finally{this.loading=!1,this.stopSpinner()}}}repaintDimensions(){let e=mt.isWholeGenomeView(this.referenceFrame.chr),t=e?this.$viewport.width():3*this.$viewport.width(),n=this.referenceFrame.bpPerPixel,s=this.referenceFrame.start-(e?0:t/3*n),r=this.referenceFrame.end+(e?0:t/3*n);return{bpStart:s,bpEnd:r,pixelWidth:t}}repaint(){if(this.featureCache===void 0)return;let{features:e,roiFeatures:t}=this.featureCache,{bpStart:n,bpEnd:s,pixelWidth:r}=this.repaintDimensions(),a=this.$viewport.height(),o=this.getContentHeight(),l=t?Math.max(o,a):o,c=Math.min(l,3*a);if(r===0||c===0){this.canvas&&pe(this.canvas).remove();return}let h=Math.max(0,-this.contentTop-Math.floor(c/3)),d=this.referenceFrame.bpPerPixel,f=Math.round((n-this.referenceFrame.start)/d),u=(this.contentTop||0)+h,g=document.createElement("canvas");g.style.position="relative",g.style.display="block",g.style.width=r+"px",g.style.height=c+"px",g.style.left=f+"px",g.style.top=u+"px";let _=this.trackView.track.displayMode==="FILL"||this.trackView.track.supportHiDPI!==!1?window.devicePixelRatio:1;g.width=_*r,g.height=_*c;let b=g.getContext("2d");b.scale(_,_),b.translate(0,-h);let w={context:b,pixelXOffset:f,pixelWidth:r,pixelHeight:c,pixelTop:h,bpStart:n,bpEnd:s,bpPerPixel:d,referenceFrame:this.referenceFrame,selection:this.selection,viewport:this,viewportWidth:this.$viewport.width()};this.draw(w,e,t),this.canvas&&pe(this.canvas).remove(),g._data=w,this.canvas=g,this.$viewport.append(pe(g))}refresh(){if(!(this.canvas&&this.featureCache))return;let e=this.canvas._data;e.context.clearRect(0,0,this.canvas.width,this.canvas.height);let{features:t,roiFeatures:n}=this.featureCache;this.draw(e,t,n)}draw(e,t,n){if(t&&(e.features=t,this.trackView.track.draw(e)),n&&n.length>0)for(let s of n)e.features=s.features,s.track.draw(e)}containsPosition(e,t){return this.referenceFrame.chr===e&&t>=this.referenceFrame.start?t<=this.referenceFrame.calculateEnd(this.getWidth()):!1}isLoading(){return this.loading}savePNG(){if(!this.canvas)return;let e=this.canvas._data,t=e?e.pixelTop:0,n=window.devicePixelRatio,s=this.$viewport.width()*n,r=this.$viewport.height()*n,a=-pe(this.canvas).position().left*n,o=(-this.contentTop-t)*n,c=this.canvas.getContext("2d").getImageData(a,o,s,r),h=document.createElement("canvas"),d=h.getContext("2d");h.width=c.width,h.height=c.height,d.putImageData(c,0,0);let f=(this.$trackLabel.text()?this.$trackLabel.text():"image")+".png",u=h.toDataURL("image/png");zo(f,u)}saveSVG(){let{width:n,height:s}=this.browser.columnContainer.getBoundingClientRect(),r=8e3,a={width:n,height:r,backdropColor:"white",multiLocusGap:0,viewbox:{x:0,y:0,width:n,height:r}},o=new Os(a),l={deltaX:32,deltaY:32};this.renderViewportToSVG(o,l),o.setHeight(s);let c=(this.trackView.track.name||this.trackView.track.id).replace(/\W/g,""),h=this.browser.referenceFrameList.indexOf(this.referenceFrame),d=o.getSerializedSvg(!0),f=URL.createObjectURL(new Blob([d],{type:"application/octet-stream"})),u=`${c}_referenceFrame_${h}_guid_${de.guid()}`;zo(`${u}.svg`,f)}renderViewportToSVG(e,{deltaX:t,deltaY:n}){if(this.$zoomInNotice&&this.$zoomInNotice.is(":visible"))return;let{width:s,height:r}=this.$viewport.get(0).getBoundingClientRect(),a=(this.trackView.track.name||this.trackView.track.id).replace(/\W/g,""),o=this.browser.referenceFrameList.indexOf(this.referenceFrame),l=`${a}_referenceFrame_${o}_guid_${de.guid()}`;this.drawSVGWithContext(e,s,r,l,t,n+this.contentTop,-this.contentTop)}renderSVGContext(e,{deltaX:t,deltaY:n}){if(this.renderViewportToSVG(e,{deltaX:t,deltaY:n}),!(this.$zoomInNotice&&this.$zoomInNotice.is(":visible"))&&this.$trackLabel&&this.browser.trackLabelsVisible===!0){let{x:s,y:r,width:a,height:o}=de.relativeDOMBBox(this.$viewport.get(0),this.$trackLabel.get(0));this.renderTrackLabelSVG(e,t+s,n+r,a,o)}}renderTrackLabelSVG(e,t,n,s,r){let o=`${(this.trackView.track.name||this.trackView.track.id).replace(/\W/g,"")}_track_label_guid_${de.guid()}`;e.saveWithTranslationAndClipRect(o,t,n,s,r,0),e.fillStyle="white",e.fillRect(0,0,s,r),e.font="12px Arial",e.fillStyle="rgb(68, 68, 68)";let{width:l}=e.measureText(this.$trackLabel.text()),c=.25*(s-l),h=.7*(r-12);e.fillText(this.$trackLabel.text(),c,r-h),e.strokeStyle="rgb(68, 68, 68)",e.strokeRect(0,0,s,r),e.restore()}drawSVGWithContext(e,t,n,s,r,a,o){e.saveWithTranslationAndClipRect(s,r,a,t,n,o);let{start:l,bpPerPixel:c}=this.referenceFrame,h={context:e,viewport:this,referenceFrame:this.referenceFrame,top:o,pixelTop:o,pixelWidth:t,pixelHeight:n,bpStart:l,bpEnd:l+t*c,bpPerPixel:c,viewportWidth:t,selection:this.selection},d=this.featureCache?this.featureCache.features:void 0,f=this.featureCache?this.featureCache.roiFeatures:void 0;this.draw(h,d,f),e.restore()}get cachedFeatures(){return this.featureCache?this.featureCache.features:[]}clearCache(){this.featureCache=void 0,this.canvas&&(this.canvas._data=void 0)}async getFeatures(e,t,n,s,r){if(this.featureCache&&this.featureCache.containsRange(t,n,s,r))return this.featureCache.features;if(typeof e.getFeatures=="function"){let a=await e.getFeatures(t,n,s,r,this);return this.checkContentHeight(a),a}else return}needsRepaint(){if(!this.canvas)return!0;let e=this.canvas._data;return!e||this.referenceFrame.start<e.bpStart||this.referenceFrame.end>e.bpEnd||this.referenceFrame.chr!==e.referenceFrame.chr||this.referenceFrame.bpPerPixel!=e.bpPerPixel}needsReload(){if(!this.featureCache)return!0;let{chr:e,bpPerPixel:t}=this.referenceFrame,{bpStart:n,bpEnd:s}=this.repaintDimensions();return!this.featureCache.containsRange(e,n,s,t)}createZoomInNotice(e){let t=pe("<div>",{class:"igv-zoom-in-notice-container"});e.append(t);let n=pe("<div>");return t.append(n),n.text("Zoom in to see features"),t.hide(),t}viewIsReady(){return this.browser&&this.browser.referenceFrameList&&this.referenceFrame}addMouseHandlers(){let e=this.$viewport.get(0);this.addViewportContextMenuHandler(e);let t=s=>{this.enableClick=!0,this.browser.mouseDownOnViewport(s,this),de.pageCoordinates(s)};e.addEventListener("mousedown",t),e.addEventListener("touchstart",t);let n=s=>{this.browser.dragObject||this.browser.isScrolling?(this.browser.cancelTrackPan(),this.enableClick=!1):(this.browser.cancelTrackPan(),this.browser.endTrackDrag())};e.addEventListener("mouseup",n),e.addEventListener("touchend",n),typeof this.trackView.track.hoverText=="function"&&e.addEventListener("mousemove",s=>{if(s.buttons===0&&Date.now()-hu>100){hu=Date.now();let r=this.createClickState(s);if(r){let a=this.trackView.track.hoverText(r);a?this.$viewport[0].setAttribute("title",a):this.$viewport[0].removeAttribute("title")}}}),this.addViewportClickHandler(this.$viewport.get(0)),this.trackView.track.name&&this.trackView.track.config.type!=="sequence"&&this.addTrackLabelClickHandler(this.$trackLabel.get(0))}addViewportContextMenuHandler(e){e.addEventListener("contextmenu",t=>{if(this.browser.dragObject)return!1;let n=this.createClickState(t);if(n===void 0)return!1;t.preventDefault();let s=[];if(typeof this.trackView.track.contextMenuItemList=="function"){let r=this.trackView.track.contextMenuItemList(n);r&&(s=r)}s.length>0&&s.push({label:pe("<HR>")}),s.push({label:"Save Image (PNG)",click:()=>this.savePNG()}),s.push({label:"Save Image (SVG)",click:()=>this.saveSVG()}),this.browser.menuPopup.presentTrackContextMenu(t,s)})}addViewportClickHandler(e){e.addEventListener("click",t=>{if(this.enableClick&&this.canvas){if(t.which===3||t.ctrlKey||(pe(".igv-popover").hide(),this.browser.dragObject||this.browser.isScrolling))return;t.preventDefault();let n=de.translateMouseCoordinates(t,this.$viewport.get(0)).x,s=de.translateMouseCoordinates(t,this.canvas).x,r=this.referenceFrame,a=Math.floor(r.start+r.toBP(s)),o=Date.now();if(o-lu<this.browser.constants.doubleClickDelay){fn&&(window.clearTimeout(fn),fn=void 0);let l=Math.round(r.start+r.toBP(n)),c;if(this.referenceFrame.chr.toLowerCase()==="all"){let h=this.browser.genome.getChromosomeCoordinate(l).chr;if(this.browser.referenceFrameList.length===1)c=h;else{let d=this.browser.referenceFrameList.map(({locusSearchString:u})=>u),f=this.browser.referenceFrameList.indexOf(this.referenceFrame);d[f]=h,c=d.join(" ")}this.browser.search(c)}else this.browser.zoomWithScaleFactor(.5,l,this.referenceFrame)}else t.shiftKey&&typeof this.trackView.track.shiftClick=="function"?this.trackView.track.shiftClick(a,t):typeof this.trackView.track.popupData=="function"&&(fn=setTimeout(()=>{let l=this.getPopupContent(t);l&&(this.popover&&this.popover.dispose(),this.popover=new dr(this.browser.columnContainer),this.popover.presentContentWithEvent(t,l)),window.clearTimeout(fn),fn=void 0},this.browser.constants.doubleClickDelay));lu=o}})}addTrackLabelClickHandler(e){e.addEventListener("click",t=>{t.stopPropagation();let{track:n}=this.trackView,s;typeof n.description=="function"?s=n.description():n.description&&(s=`<div>${n.description}</div>`),s&&(this.popover&&this.popover.dispose(),this.popover=new dr(this.browser.columnContainer,n.name||""),this.popover.presentContentWithEvent(t,s))})}createClickState(e){if(!this.canvas)return;let t=this.referenceFrame,n=de.translateMouseCoordinates(e,this.$viewport.get(0)),s=de.translateMouseCoordinates(e,this.canvas),r=t.start+t.toBP(n.x);return{event:e,viewport:this,referenceFrame:t,genomicLocation:r,y:n.y-this.contentTop,canvasX:s.x,canvasY:s.y}}getPopupContent(e){let t=this.createClickState(e);if(t===void 0)return;let n=this.trackView.track,s=n.popupData(t),r=this.browser.fireEvent("trackclick",[n,s]),a;return r===void 0||r===!0?s&&s.length>0&&(a=R_(s)):typeof r=="string"&&(a=r),a}};function R_(i){return i.map(t=>{if(t.name){let n=`<span>${t.name}</span>&nbsp&nbsp&nbsp${t.value}`;return`<div title="${t.value}">${n}</div>`}else return t==="<hr>"?t:t.html?t.html:`<div title="${t}">${t}</div>`}).join("")}var ul=class{constructor(e,t,n,s,r,a,o){this.chr=e,this.bpStart=t,this.bpEnd=n,this.bpPerPixel=s,this.features=r,this.roiFeatures=a,this.multiresolution=o}containsRange(e,t,n,s){let r=this.multiresolution?this.bpPerPixel/s:1;return t>=this.bpStart&&n<=this.bpEnd&&e===this.chr&&r>.5&&r<2}overlapsRange(e,t,n){return this.chr===e&&n>=this.bpStart&&t<=this.bpEnd}};function I_(i,e){if(i.length<6){console.log("Skipping line: "+i.join(" "));return}var t={chr:i[0],start:i[1],end:i[2],chr1:i[8],start1:Number.parseInt(i[9]),end1:Number.parseInt(i[10]),chr2:i[13],start2:Number.parseInt(i[14]),end2:Number.parseInt(i[15]),name:i[3],score:Number(i[4]),value:Number(i[5]),color:i[7]==="."?void 0:i[7]==="0"?"rgb(0,0,0)":i[7]};return t}var L_=new Set(["transcript","primary_transcript","processed_transcript","mRNA","mrna","lnc_RNA","miRNA","ncRNA","rRNA","scRNA","snRNA","snoRNA","tRNA"]),Xg=new Set(["CDS","cds"]),Yg=new Set(["start_codon","stop_codon"]),Qg=new Set(["5UTR","3UTR","UTR","five_prime_UTR","three_prime_UTR","3'-UTR","5'-UTR"]),Kg=new Set(["exon","coding-exon"]),Jg=new Set;for(let i of[Xg,Yg,Qg,Kg])for(let e of i)Jg.add(e);function N_(i){return Kg.has(i)}function em(i){return i.includes("intron")}function F_(i){return Xg.has(i)||Yg.has(i)}function D_(i){return Qg.has(i)}function cu(i){return L_.has(i)||i.endsWith("RNA")||i.endsWith("transcript")}function fu(i){return Jg.has(i)||i.endsWith("RNA")||em(i)}var O_=new Set(["id","parent","name"]),Sr=class{constructor(e){Object.assign(this,e)}popupData(e){let t=this.geneObject?this.geneObject.popupData():[];if(this.geneObject&&t.push("<hr/>"),this.name&&t.push({name:"Name",value:this.name}),t.push({name:"Type",value:this.type}),t.push({name:"Source",value:this.source}),this.score!==void 0&&t.push({name:"Score",value:this.score}),this.attributeString){let n=An(this.attributeString,this.delim);for(let[s,r]of n)r!==void 0&&r.length>0&&!O_.has(s.toLowerCase())&&t.push({name:s+":",value:r})}return t.push({name:"Location",value:`${this.chr}:${De(this.start+1)}-${De(this.end)}`}),t}getAttributeValue(e){if(this.hasOwnProperty(e))return this[e];if(this._attributeCache||(this._attributeCache=new Map),this._attributeCache.has(e))return this._attributeCache.get(e);{let t=An(this.attributeString,this.delim),n;for(let[s,r]of t)if(s===e){n=r;break}return this._attributeCache.set(e,n),n}}},Ps=class extends Sr{constructor(e){super(e),this.exons=[],this.parts=[]}addExon(e){this.exons.push(e),this.start=Math.min(this.start,e.start),this.end=Math.max(this.end,e.end)}addPart(e){this.parts.push(e)}assembleParts(){if(this.parts.length===0)return;this.parts.sort(function(s,r){return s.start-r.start});let e=this.parts[0].start,t=this.parts[0].end;for(let s=1;s<this.parts.length;s++){let r=this.parts[s];em(r.type)||(r.start<=t?t=Math.max(t,r.end):(this.findExonContaining({start:e,end:t})||this.exons.push({start:e,end:t,psuedo:!0}),e=r.start,t=r.end))}this.findExonContaining({start:e,end:t})||(this.exons.push({start:e,end:t,psuedo:!0}),this.start=Math.min(this.start,e),this.end=Math.max(this.end,t));for(let s of this.parts){let r=s.type;F_(r)?this.addCDS(s):D_(r)&&this.addUTR(s)}}findExonContaining({start:e,end:t}){for(let n of this.exons)if(n.end>=t&&n.start<=e)return n}addCDS(e){let t,n=this.exons;for(let s of n)if(s.start<=e.start&&s.end>=e.end){t=s;break}t?(t.cdStart=t.cdStart?Math.min(e.start,t.cdStart):e.start,t.cdEnd=t.cdEnd?Math.max(e.end,t.cdEnd):e.end):console.error("No exon found spanning "+e.start+"-"+e.end),this.cdStart=this.cdStart?Math.min(e.start,this.cdStart):e.start,this.cdEnd=this.cdEnd?Math.max(e.end,this.cdEnd):e.end}addUTR(e){let t,n=this.exons;for(let s=0;s<n.length;s++)if(n[s].start<=e.start&&n[s].end>=e.end){t=n[s];break}t?e.start===t.start&&e.end===t.end?t.utr=!0:(e.end<t.end&&(t.cdStart=e.end),e.start>t.start&&(t.cdEnd=e.start)):console.error("No exon found spanning "+cds.start+"-"+cds.end)}finish(){this.assembleParts();var e=this.cdStart,t=this.cdEnd;this.exons.sort(function(n,s){return n.start-s.start}),e&&this.exons.forEach(function(n){(n.end<e||n.start>t)&&(n.utr=!0)})}popupData(e){let t=super.popupData(e);for(let n of this.exons)if(!n.pseudo&&e>=n.start&&e<n.end&&typeof n.popupData=="function"){t.push("<hr/>");let s=n.popupData(e);for(let r of s)t.push(r)}for(let n of this.parts)if(e>=n.start&&e<n.end&&typeof n.popupData=="function"){t.push("<hr/>");let s=n.popupData(e);for(let r of s)t.push(r)}return t}};function tm(i,e){let t=e.format;if(i.length<9)return;let n=t==="gff3"?"=":" ";return new Sr({source:dl(i[1]),type:i[2],chr:i[0],start:parseInt(i[3])-1,end:parseInt(i[4]),score:i[5]==="."?void 0:Number(i[5]),strand:i[6],phase:i[7]==="."?0:parseInt(i[7]),attributeString:i[8],delim:n})}function B_(i,e){let t=tm(i,e);if(!t)return;let n=An(t.attributeString,t.delim);for(let[s,r]of n){let a=s.toLowerCase();a==="color"||a==="colour"?t.color=Ve.createColorString(r):s==="ID"?t.id=r:s==="Parent"&&(t.parent=r)}return t}function P_(i,e){let t=tm(i,e);if(!t)return;let n=An(t.attributeString,t.delim),s,r;switch(t.type){case"gene":s="gene_id";break;case"transcript":s="transcript_id",r="gene_id";break;default:r="transcript_id"}for(let[a,o]of n){let l=a.toLowerCase();l==="color"||l==="colour"?t.color=Ve.createColorString(o):a===s?t.id=o:a===r&&(t.parent=o)}return t}function An(i,e,t=!1){var n=[];for(let s of i.split(";")){s=s.trim();let r=s.indexOf(e);if(r>0&&r<s.length-1){let a=uu(dl(s.substring(0,r).trim(),t)),o=uu(dl(s.substring(r+1).trim(),t));n.push([a,o])}}return n}function uu(i){return i.startsWith('"')&&i.endsWith('"')&&(i=i.substr(1,i.length-2)),i}var du=new Map([["%09","	"],["%0A",`
`],["%0D","\r"],["%25","%"],["%3B",";"],["%3D","="],["%26","&"],["%2C",","]]);function dl(i,e=!1){if(!i.includes("%"))return i;if(e)return decodeURIComponent(i);let t="";for(let n=0;n<i.length;n++)if(i.charCodeAt(n)===37&&n<i.length-2){let s=i.substring(n,n+3);du.has(s)?t+=du.get(s):t+=s,n+=2}else t+=i.charAt(n);return t}var zs=class{constructor(e){this.message=e}};function pu(i,e){if(i.length<3)return;e&&e.gffTags;let t=i[0],n=parseInt(i[1]),s=i.length>2?parseInt(i[2]):n+1;if(isNaN(n)||isNaN(s))return new zs("Unparsable bed record.");let r=new pl({chr:t,start:n,end:s,score:1e3});try{if(i.length>3){if(i[3].indexOf(";")>0&&i[3].indexOf("=")>0){let a=An(i[3],"=",!0);r.attributes={};for(let o of a)r.attributes[o[0]]=o[1],e.nameField!=null&&o[0]===e.nameField&&(r.name=o[1])}r.name||(r.name=i[3]==="."?"":i[3])}if(i.length>4&&(r.score=i[4]==="."?0:Number(i[4]),isNaN(r.score))||i.length>5&&(r.strand=i[5],!(r.strand==="."||r.strand==="+"||r.strand==="-"))||i.length>6&&(r.cdStart=parseInt(i[6]),isNaN(r.cdStart))||i.length>7&&(r.cdEnd=parseInt(i[7]),isNaN(r.cdEnd)))return r;if(i.length>8&&i[8]!=="."&&i[8]!=="0"&&(r.color=Ve.createColorString(i[8])),i.length>11){let a=parseInt(i[9]);if(a>1e3)return r;let o=i[10].replace(/,$/,"").split(","),l=i[11].replace(/,$/,"").split(",");if(!(o.length===l.length&&a===o.length))return r;let c=[];for(let h=0;h<a;h++){let d=n+parseInt(l[h]),f=d+parseInt(o[h]);c.push({start:d,end:f})}c.length>0&&(xa(c,r.cdStart,r.cdEnd),r.exons=c)}if(e){let a=e.thicknessColumn,o=e.colorColumn;o&&o<i.length&&(r.color=Ve.createColorString(i[o])),a&&a<i.length&&(r.thickness=i[a])}}catch{}return r}function z_(i,e){return i.length<=15?void 0:{swScore:Number.parseInt(i[1]),milliDiv:Number.parseInt(i[2]),milliDel:Number.parseInt(i[3]),milliIns:Number.parseInt(i[4]),chr:i[5],start:Number.parseInt(i[6]),end:Number.parseInt(i[7]),strand:i[9],repName:i[10],repClass:i[11],repFamily:i[12],repStart:Number.parseInt(i[13]),repEnd:Number.parseInt(i[14]),repLeft:Number.parseInt(i[15])}}function gu(i,e){var t=e.shift===void 0?0:1;if(i.length<=9+t)return;let n=parseInt(i[5+t]),s=parseInt(i[6+t]);var r={name:i[0+t],chr:i[1+t],strand:i[2+t],start:parseInt(i[3+t]),end:parseInt(i[4+t]),cdStart:n,cdEnd:s,id:i[0+t]};let a=vc(parseInt(i[7+t]),i[8+t],i[9+t]);return xa(a,n,s),r.exons=a,r}function mu(i,e){var t=e.shift===void 0?0:1;if(i.length<=11+t)return;let n=parseInt(i[5+t]),s=parseInt(i[6+t]),r={name:i[11+t],chr:i[1+t],strand:i[2+t],start:parseInt(i[3+t]),end:parseInt(i[4+t]),cdStart:n,cdEnd:s,id:i[0+t]},a=vc(parseInt(i[7+t]),i[8+t],i[9+t]);return xa(a,n,s),r.exons=a,r}function H_(i,e){var t=e.shift===void 0?0:1;if(i.length<=10+t)return;let n=parseInt(i[6+t]),s=parseInt(i[7+t]);var r={name:i[0+t],id:i[1+t],chr:i[2+t],strand:i[3+t],start:parseInt(i[4+t]),end:parseInt(i[5+t]),cdStart:n,cdEnd:s};let a=vc(parseInt(i[8+t]),i[9+t],i[10+t]);return xa(a,n,s),r.exons=a,r}function U_(i,e){if(i.length<21)return;let t=i[13],n=parseInt(i[15]),s=parseInt(i[16]),r=i[8].charAt(0),a=parseInt(i[17]),o=[],l=i[20].replace(/,$/,"").split(","),c=i[18].replace(/,$/,"").split(",");for(let h=0;h<a;h++){let d=parseInt(l[h]),f=d+parseInt(c[h]);o.push({start:d,end:f})}return new gl({chr:t,start:n,end:s,strand:r,exons:o,tokens:i})}function vc(i,e,t){let n=parseInt(i),s=e.replace(/,$/,"").split(","),r=t.replace(/,$/,"").split(","),a=[];for(let o=0;o<n;o++){let l=parseInt(s[o]),c=parseInt(r[o]);a.push({start:l,end:c})}return a}function xa(i,e,t){for(let n of i){let s=n.end,r=n.start;s<e||r>t?n.utr=!0:(e>=r&&e<=s&&(n.cdStart=e),t>=r&&t<=s&&(n.cdEnd=t))}}function $_(i,e){var t,n,s,r,a,o,l,c,h,d;if(t=i.length,!(t<9))return n=i[0],s=parseInt(i[1]),r=parseInt(i[2]),o=i[3],l=Number(i[4]),a=i[5].trim(),h=Number(i[6]),d=Number(i[7]),c=Number(i[8]),l===0&&(l=h),{chr:n,start:s,end:r,name:o,score:l,strand:a,signal:h,pValue:d,qValue:c}}function im(i,e){var t,n,s,r;if(i.length<=3)return;t=i[0],n=parseInt(i[1]),s=parseInt(i[2]),r=Number(i[3]);let a={chr:t,start:n,end:s,value:r};if(e){let o=e.colorColumn;o&&o<i.length&&(a.color=Ve.createColorString(i[o]))}return a}function V_(i,e){let t=e.wig;if(t&&t.format==="fixedStep"){let n=t.index*t.step+t.start,s=n+t.span,r=Number(i[0]);return++t.index,isNaN(r)?null:{chr:t.chrom,start:n,end:s,value:r}}else if(t&&t.format==="variableStep"){if(i.length<2)return null;let n=parseInt(i[0],10)-1,s=n+t.span,r=Number(i[1]);return isNaN(r)?null:{chr:t.chrom,start:n,end:s,value:r}}else return im(i)}function q_(i,e){if(i.length<6)return;let t=["bin","chr","start","end","name","score","strand","refNCBI","refUCSC","observed","molType","class","valid","avHet","avHetSE","func","locType","weight","exceptions","submitterCount","submitters","alleleFreqCount","alleles","alleleNs","alleleFreqs","bitfields"],n={chr:i[1],start:Number.parseInt(i[2]),end:Number.parseInt(i[3]),name:i[4],score:Number.parseInt(i[5])},s=Math.min(i.length,t.length);for(let r=6;r<s;r++)n[t[r]]=i[r];return n}var pl=class{constructor(e){Object.assign(this,e)}getAttributeValue(e){if(this.hasOwnProperty(e))return this[e];if(this.attributes)return this.attributes[e]}},gl=class{constructor(e){Object.assign(this,e)}get score(){let e=this.tokens,t=parseInt(e[0]),n=parseInt(e[2]),s=parseInt(e[1]),r=parseInt(e[4]),a=parseInt(e[6]),o=parseInt(e[10]);return Math.floor(1e3*(t+n-s-r-a)/o)}get matches(){return this.tokens[0]}get misMatches(){return this.tokens[1]}get repMatches(){return this.tokens[2]}get nCount(){return this.tokens[3]}get qNumInsert(){return this.tokens[4]}get qBaseInsert(){return this.tokens[5]}get tNumInsert(){return this.tokens[6]}get tBaseInsert(){return this.tokens[7]}popupData(){return[{name:"chr",value:this.chr},{name:"start",value:this.start+1},{name:"end",value:this.end},{name:"strand",value:this.strand},{name:"score",value:this.score},{name:"match",value:this.matches},{name:"mis-match",value:this.misMatches},{name:"rep. match",value:this.repMatches},{name:"N's",value:this.nCount},{name:"Q gap count",value:this.qNumInsert},{name:"Q gap bases",value:this.qBaseInsert},{name:"T gap count",value:this.tNumInsert},{name:"T gap bases",value:this.tBaseInsert}]}};function W_(i,e){if(!(i.length<7)){var t=i[0],n=i[1],s=parseInt(i[2]),r=parseInt(i[3]),a=parseInt(i[4]),o=parseInt(i[5]),l=i[6],c={chr:t,name:n,junction_left:s,junction_right:r,num_junction_reads:a,num_spanning_frags:o,spanning_frag_coords:[],start:-1,end:-1},h=s,d=r;if(o>0)for(var f=l.split(","),u=0;u<f.length;u++){var g=f[u].split("-"),_=g[0],b=g[1];_<h&&(h=_),b>d&&(d=b),c.spanning_frag_coords.push({left:_,right:b})}return c.start=h,c.end=d,c}}function j_(i,e){if(i.length<7)return null;let n={chr:i[0],start:parseInt(i[1])-1,end:parseInt(i[2]),"Strongest SNP-risk allele":i[3],"Disease/Phenotype":i[4],"P-value":i[5],"Odds ratio or beta":i[6]};return i.length>6&&(n.PUBMEDID=`<a target = "blank" href = "https://www.ncbi.nlm.nih.gov/pubmed/${i[7]}">${i[7]}</a>`),n}function G_(i,e){let t=e.customFormat;if(i.length<t.fields.length)return;let n=t.coords||0,s=i[t.chr],r=parseInt(i[t.start])-n,a=t.end!==void 0?parseInt(i[t.end]):r+1,o={chr:s,start:r,end:a};return t.fields&&t.fields.forEach(function(l,c){c!==t.chr&&c!==t.start&&c!==t.end&&(o[l]=i[c])}),o}function Z_(i,e){let t=e.columnNames;if(!t)throw Error("Sample names are not defined.   Missing column headers?");let n=t.length-3,s=i[0],r=parseInt(i[1]),a=parseInt(i[2]),o=i.slice(3).map(Number);if(o.length==n)return{chr:s,start:r,end:a,values:o};console.warn(`${s}:${r}-${a} row contains ${o.length} sample columns instead of the expected ${n} columns. Skipping...`)}var ml=class{constructor(e){this.config=e,this.header={},e.nameField&&(this.header.nameField=e.nameField),this.skipRows=0,e.decode?(this.decode=e.decode,this.delimiter=e.delimiter||"	"):e.format&&(this.header.format=e.format.toLowerCase(),this.setDecoder(this.header.format)),this.delimiter||(this.delimiter="	")}async parseHeader(e){let t=this.header,n,s;for(;(s=await e.nextLine())!==void 0;)if(s.startsWith("track")||s.startsWith("#track")){let r=X_(s);Object.assign(t,r)}else if(!s.startsWith("browser"))if(s.startsWith("#columns")){let r=Y_(s);Object.assign(t,r)}else if(s.startsWith("##gff-version 3"))t.format="gff3";else if(s.startsWith("#gffTags"))t.gffTags=!0;else{if(s.startsWith("fixedStep")||s.startsWith("variableStep"))break;if(s.startsWith("#")){let r=s.split(this.delimiter||"	");r.length>1&&(n=r)}else{this.setDecoder(t.format);let r=s.split(this.delimiter||"	");try{let a=Object.assign({columnNames:n},t);if(this.decode(r,a))break;r.length>1&&(n=r)}catch{r.length>1&&(n=r)}}}if(n){t.columnNames=n;for(let r=0;r<n.length;r++)n[r]==="color"||n[r]==="colour"?t.colorColumn=r:n[r]==="thickness"&&(t.thicknessColumn=r)}return this.header=t,t}async parseFeatures(e){let t=[],n=this.decode,s=this.header.format,r=this.delimiter||"	",a=0,o=0,l;for(;(l=await e.nextLine())!==void 0;){if(a++,a<=this.skipRows||!l||l.startsWith("track")||l.startsWith("#")||l.startsWith("browser"))continue;if(s==="wig"&&l.startsWith("fixedStep")){this.header.wig=Q_(l);continue}else if(s==="wig"&&l.startsWith("variableStep")){this.header.wig=K_(l);continue}let c=l.split(r);if(c.length<1)continue;let h=n(c,this.header);if(h instanceof zs){o++,o>0&&console.error(`Error parsing line '${l}': ${h.message}`);continue}h&&t.push(h)}return n===eo&&s_(t),t}setDecoder(e){switch(e){case"narrowpeak":case"broadpeak":case"regionpeak":case"peaks":this.decode=$_,this.delimiter=this.config.delimiter||/\s+/;break;case"bedgraph":this.decode=im,this.delimiter=/\s+/;break;case"wig":this.decode=V_,this.delimiter=this.config.delimiter||/\s+/;break;case"gff3":case"gff":this.decode=B_,this.delimiter="	";break;case"gtf":this.decode=P_,this.delimiter="	";break;case"fusionjuncspan":this.decode=W_,this.delimiter=this.config.delimiter||/\s+/;break;case"gtexgwas":this.skipRows=1,this.decode=j_,this.delimiter="	";break;case"refflat":this.decode=H_,this.delimiter=this.config.delimiter||/\s+/;break;case"genepred":this.decode=gu,this.delimiter=this.config.delimiter||/\s+/;break;case"genepredext":this.decode=mu,this.delimiter=this.config.delimiter||/\s+/;break;case"ensgene":this.decode=gu,this.header.shift=1,this.delimiter=this.config.delimiter||/\s+/;break;case"refgene":this.decode=mu,this.delimiter=this.config.delimiter||/\s+/,this.header.shift=1;break;case"bed":this.decode=pu,this.delimiter=this.config.delimiter||/\s+/;break;case"bedpe":case"hiccups":this.decode=eo,this.delimiter=this.config.delimiter||"	";break;case"bedpe-domain":this.decode=a_,this.headerLine=!0,this.delimiter=this.config.delimiter||"	";break;case"bedpe-loop":this.decode=eo,this.delimiter=this.config.delimiter||"	",this.header={colorColumn:7};break;case"interact":this.decode=I_,this.delimiter=this.config.delimiter||/\s+/;break;case"snp":this.decode=q_,this.delimiter="	";break;case"rmsk":this.decode=z_,this.delimiter="	";break;case"gcnv":this.decode=Z_,this.delimiter="	";break;default:let t=Hg(e);t!==void 0?(this.decode=G_,this.header.customFormat=t,this.delimiter=t.delimiter||"	"):(this.decode=pu,this.delimiter=this.config.delimiter||/\s+/)}}};function X_(i){let e={},t=i.split(/(?:")([^"]+)(?:")|([^\s"]+)(?=\s+|$)/g),n,s=[];for(let a of t)!a||a.trim().length===0||(a.endsWith("=")?n=a:n?(s.push(n+a),n=void 0):s.push(a));for(let a of s){if(!a)return;var r=a.split("=",2);if(r.length===2){let o=r[0].trim(),l=r[1].trim();if(e.hasOwnProperty(o)){let c=e[o];Array.isArray(c)?c.push(l):e[o]=[c,l]}else e[o]=l}}return e.type=="interact"?e.format="interact":e.type==="gcnv"&&(e.format="gcnv"),e}function Y_(i){let e={},t=i.split(/\s+/);return t.length===2&&t[1].split(";").forEach(function(s){let r=s.split("=");r[0]==="color"?e.colorColumn=Number.parseInt(r[1])-1:r[0]==="thickness"&&(e.thicknessColumn=Number.parseInt(r[1])-1)}),e}function Q_(i){let e=i.split(/\s+/),t=e[1].split("=")[1],n=parseInt(e[2].split("=")[1],10)-1,s=parseInt(e[3].split("=")[1],10),r=e.length>4?parseInt(e[4].split("=")[1],10):1;return{format:"fixedStep",chrom:t,start:n,step:s,span:r,index:0}}function K_(i){let e=i.split(/\s+/),t=e[1].split("=")[1],n=e.length>2?parseInt(e[2].split("=")[1],10):1;return{format:"variableStep",chrom:t,span:n}}var J_=i=>yt(i)&&i.indexOf(",")>0&&!(i.startsWith("rgb(")||i.startsWith("rgba("))?`rgb(${i})`:i,kt=class i{static defaults={height:50,autoHeight:!1,visibilityWindow:void 0,color:void 0,altColor:void 0,supportHiDPI:!0};constructor(e,t){this.browser=t,this.init(e)}init(e){this.config=e,e.displayMode&&(e.displayMode=e.displayMode.toUpperCase());let t=Object.assign({},i.defaults);if(this.constructor.defaults)for(let n of Object.keys(this.constructor.defaults))t[n]=this.constructor.defaults[n];for(let n of Object.keys(t))this[n]=e.hasOwnProperty(n)?e[n]:t[n],(n==="color"||n==="altColor")&&(this[n]=J_(this[n]));e.name||e.label?this.name=e.name||e.label:Ei(e.url)?this.name=e.url.name:yt(e.url)&&!e.url.startsWith("data:")&&(this.name=Cs(e.url)),this.url=e.url,this.config.type&&(this.type=this.config.type),this.id=this.config.id===void 0?this.name:this.config.id,this.order=e.order,this.autoscaleGroup=e.autoscaleGroup,this.removable=e.removable===void 0?!0:e.removable,this.minHeight=e.minHeight||Math.min(25,this.height),this.maxHeight=e.maxHeight||Math.max(1e3,this.height),e.onclick&&(this.onclick=e.onclick,e.onclick=void 0),e.description&&(typeof e.description=="function"?this.description=e.description:this.description=()=>e.description),e.hoverTextFields?this.hoverText=ey.bind(this):typeof this.config.hoverText=="function"&&(this.hoverText=this.config.hoverText)}get name(){return this._name}set name(e){this._name=e,this.trackView&&this.trackView.setTrackLabelName(e)}updateConfig(e){this.init(e)}clearCachedFeatures(){this.trackView&&this.trackView.clearCachedFeatures()}updateViews(){this.trackView&&this.trackView.updateViews()}getState(){let e=s=>!(s===void 0||typeof s=="function"||s instanceof File||s instanceof Promise),t={};for(let s of Object.keys(this.config))!s.startsWith("_")&&e(this.config[s])&&(t[s]=this.config[s]);for(let s of Object.keys(t)){if(s.startsWith("_"))continue;let r=this[s];r&&(fs(r)||typeof r=="boolean"||s==="metadata")&&(t[s]=r)}let n=i.defaults;if(this.constructor.defaults)for(let s of Object.keys(this.constructor.defaults))n[s]=this.constructor.defaults[s];for(let s of Object.keys(n))this[s]!==void 0&&n[s]!==this[s]&&(t[s]=this[s]);return!this.autoscale&&this.dataRange&&(t.min=this.dataRange.min,t.max=this.dataRange.max),t}get supportsWholeGenome(){return this.config.supportsWholeGenome===!0}hasSamples(){return!1}getGenomeId(){return this.browser.genome?this.browser.genome.id:void 0}setTrackProperties(e){if(this.disposed)return;let t={},n;for(let s of Object.keys(e))switch(s.toLowerCase()){case"usescore":t.useScore=e[s]===1||e[s]==="1"||e[s]==="on"||e[s]===!0;break;case"visibility":switch(e[s]){case"2":case"3":case"pack":case"full":t.displayMode="EXPANDED";break;case"4":case"squish":t.displayMode="SQUISHED";break;case"1":case"dense":t.displayMode="COLLAPSED"}break;case"color":case"altcolor":t[s]=e[s].startsWith("rgb(")?e[s]:"rgb("+e[s]+")";break;case"featurevisiblitywindow":case"visibilitywindow":t.visibilityWindow=Number.parseInt(e[s]);break;case"maxheightpixels":n=e[s].split(":"),n.length===3&&(t.minHeight=Number.parseInt(n[2]),t.height=Number.parseInt(n[1]),t.maxHeight=Number.parseInt(n[0]));break;case"viewlimits":if(!this.config.autoscale){n=e[s].split(":");let a=0,o;n.length==1?o=Number(n[0]):n.length==2&&(a=Number(n[0]),o=Number(n[1])),t.autoscale=!1,t.dataRange={min:a,max:o},this.viewLimitMin=a,this.viewLimitMax=o}case"name":t[s]=e[s];break;case"url":t.infoURL=e[s];break;case"type":let r=e[s];bu.has(r)?t[s]=bu.get(r):t[s]=r;break;case"graphtype":t.graphType=e[s];break;default:t[s]=e[s]}for(let s of Object.keys(t))if(!this.config.hasOwnProperty(s)||s==="name"&&this.config._derivedName){let r=t[s];if(r==="true"&&(r=!0),r==="false"&&(r=!1),this[s]=r,s==="height"&&this.trackView)try{let a=Number.parseInt(r);this.trackView.setTrackHeight(a)}catch(a){console.error(a)}}}clickedFeatures(e){let t=e.viewport.cachedFeatures;if(!t||!Array.isArray(t)||t.length===0)return[];let n=e.genomicLocation,s=e.referenceFrame.bpPerPixel>.2?3*e.referenceFrame.bpPerPixel:.2,r=n-s,a=n+s;return Ls.findOverlapping(t,r,a)}extractPopupData(e,t){let n=new Set(["row","color","chr","start","end","cdStart","cdEnd","strand","alpha"]),s=[],r,a;for(let l in e)if(e.hasOwnProperty(l)&&!n.has(l)&&fs(e[l])){let c=e[l];s.push({name:Po(l),value:c}),l==="alleles"?r=e[l]:l==="alleleFreqs"&&(a=e[l])}if(r&&a){r.endsWith(",")&&(r=r.substr(0,r.length-1)),a.endsWith(",")&&(a=a.substr(0,a.length-1));let l=r.split(","),c=a.split(",");if(c.length>1){let h=[];for(let f=0;f<c.length;f++)h.push({a:l[f],af:Number(c[f])});h.sort(function(f,u){return f.af-u.af});let d=h[h.length-1].a;if(d.length===1)for(let f=h.length-2;f>=0;f--){let u=h[f].a;if(u.length===1){t||(t=this.getGenomeId());let g=i.getCravatLink(e.chr,e.start+1,d,u,t);console.log(g),g&&(s.push("<hr/>"),s.push({html:g}),s.push("<hr/>"))}}}}if(e.attributes)for(let l of Object.keys(e.attributes))s.push({name:l,value:e.attributes[l]});let o=`${e.chr}:${De(e.start+1)}-${De(e.end)}`;return e.strand&&(o+=` (${e.strand})`),s.push({name:"Location",value:o}),s}description(){let e=(n,s)=>`<div class="igv-track-label-popup-shim"><b>${n}: </b>${s}</div>`,t='<div class="igv-track-label-popup">';if(this.url?Ei(this.url)?t+=e("Filename",this.url.name):t+=e("URL",this.url):t=this.name,this.config){if(this.config.metadata)for(let n of Object.keys(this.config.metadata)){let s=this.config.metadata[n];t+=e(n,s)}for(let n of Object.keys(this.config)){if(n.startsWith("_"))continue;let s=n.substr(0,1);if(s!==s.toLowerCase()){let r=this.config[n];r&&fs(r)&&(t+=e(n,r))}}}return t+="</div>",t}getColorForFeature(e){return typeof this.color=="function"?this.color(feature):this.color}dispose(){this.disposed=!0;for(let e of Object.keys(this))this[e]=void 0}static getCravatLink(e,t,n,s,r){if(r==="hg38"||r==="GRCh38")return`<a target="_blank" href="https://run.opencravat.org/result/nocache/variant.html?chrom=${e.startsWith("chr")?e:"chr"+e}&pos=${t}&ref_base=${n}&alt_base=${s}"><b>Cravat ${n}->${s}</b></a>`}};function ey(i){if(!this.hoverTextFields)return;let e=this.clickedFeatures(i);if(e&&e.length>0){let t="";for(let n=0;n<e.length;n++){if(n===10){t+="; ...";break}if(!e[n])continue;let s=e[n]._f||e[n];t.length>0&&(t+=`
`),t="";for(let r of this.hoverTextFields)t.length>0&&(t+=`
`),s.hasOwnProperty(r)?t+=s[r]:typeof s.getAttribute=="function"&&(t+=s.getAttribute(r))}return t}}var bu=new Map([["wiggle_0","wig"],["bed","bed"],["bigBed","bigBed"],["bigWig","bigWig"]]),sr=class{constructor(e){switch(this.type=e||"seg",this.type){case"mut":this.sampleColumn=3,this.chrColumn=0,this.startColumn=1,this.endColumn=2,this.dataColumn=4;break;case"maf":this.sampleColumn=15,this.chrColumn=4,this.startColumn=5,this.endColumn=6,this.dataColumn=8;break;default:this.sampleColumn=0,this.chrColumn=1,this.startColumn=2,this.endColumn=3}}async parseHeader(e){let t;for(;(t=await e.nextLine())!==void 0;)if(!t.startsWith("#")){let n=t.split("	");this.header={headings:n};break}return this.header}async parseFeatures(e){let t=[],n;this.header||(this.header=await this.parseHeader(e)),this.type==="seg"&&(this.dataColumn=this.header.headings.length-1),this.header.headings.length>5&&(n=this.extractExtraColumns(this.header.headings));let s=this.header.headings[this.dataColumn],r;for(;(r=await e.nextLine())!==void 0;){let a=r.split("	"),o=this.type==="seg"?Number(a[this.dataColumn]):a[this.dataColumn];if(a.length>this.dataColumn){let l=new bl({sample:a[this.sampleColumn],chr:a[this.chrColumn],start:parseInt(a[this.startColumn])-1,end:parseInt(a[this.endColumn]),value:o,valueColumnName:s});if(n){let c=this.extractExtraColumns(a);l.setAttributes({names:n,values:c})}t.push(l)}}return t}extractExtraColumns(e){let t=[];for(let n=0;n<e.length;n++)n!==this.chrColumn&&n!==this.startColumn&&n!==this.endColumn&&n!==this.sampleColumn&&t.push(e[n]);return t}},bl=class{constructor({sample:e,chr:t,start:n,end:s,value:r,valueColumnName:a}){this.sample=e,this.chr=t,this.start=n,this.end=s,this.value=r,this.valueColumnName=a}setAttributes({names:e,values:t}){this.attributeNames=e,this.attributeValues=t}getAttribute(e){if(this.attributeNames){let t=this.attributeNames.indexOf(e);if(t>=0)return this.attributeValues[t]}}popupData(e,t){let n=new Set(["chr","start","end","sample","value","row","color","sampleKey","uniqueSampleKey","sampleId","chromosome","uniquePatientKey"]),s=this.chr+":"+De(this.start+1)+"-"+De(this.end),r=[{name:"Sample",value:this.sample},{name:"Location",value:s},{name:this.valueColumnName?Po(this.valueColumnName):"Value",value:this.value}];if(e==="mut"&&t==="hg38"){let a=this.extractCravatLink(t);a&&(r.push("<hr/>"),r.push({html:a}),r.push("<hr/>"))}if(this.attributeNames&&this.attributeNames.length>0)for(let a=0;a<this.attributeNames.length;a++)!n.has(this.attributeNames[a])&this.valueColumnName!==this.attributeNames[a]&&r.push({name:Po(this.attributeNames[a]),value:this.attributeValues[a]});return r}extractCravatLink(e){let t,n;if(this.attributeNames&&this.attributeNames.length>0){for(let s=0;s<this.attributeNames.length;s++)if(!t&&this.attributeNames[s]==="Reference_Allele"&&(t=this.attributeValues[s]),!n&&this.attributeNames[s].startsWith("Tumor_Seq_Allele")&&this.attributeValues[s]!==t&&(n=this.attributeValues[s]),t&&n)return kt.getCravatLink(this.chr,this.start+1,t,n,e)}}};function ty(i){let e=new Hs;e.chr=i[0],e.pos=parseInt(i[1]),e.names=i[2],e.referenceBases=i[3],e.alternateBases=i[4],e.quality=i[5],e.filter=i[6],e.info={};let t=i[7];if(t)for(let s of t.split(";")){var n=s.split("=");e.info[n[0]]=n[1]}return e.init(),e}function iy(i){var e=new Hs;e.chr=i.referenceName,e.start=parseInt(i.start),e.end=parseInt(i.end),e.pos=e.start+1,e.names=us(i.names,"; "),e.referenceBases=i.referenceBases,e.alternateBases=us(i.alternateBases),e.quality=i.quality,e.filter=us(i.filter),e.info={},i.info&&Object.keys(i.info).forEach(function(n){var s,r=i.info[n];Array.isArray(r)?s=r.join(","):s=r,e.info[n]=s}),e.calls={};var t;return i.calls&&i.calls.forEach(function(n){t=n.callSetId,e.calls[t]=n}),init(e),e}var Hs=class{init(){let e=this.referenceBases,t=this.alternateBases;if(this.info&&(this.info.VT?this.type=this.info.VT:this.info.SVTYPE?this.type="SV":this.info.PERIOD&&(this.type="STR")),this.type===void 0&&(this.type=sy(e,t)),this.type==="NONVARIANT"&&(this.heterozygosity=0),this.info.END)this.start=this.pos-1,this.info.CHR2&&this.info.CHR2!==this.chr?this.end=this.start+1:this.end=Number.parseInt(this.info.END);else if(this.type==="NONVARIANT")this.start=this.pos-1,this.end=this.start+e.length;else{let n=t.split(",").filter(s=>s.length>0);this.alleles=[],this.start=void 0,this.end=void 0;for(let s of n)if(this.alleles.push(s),this.type!=="SV"&&ry(s)){let r=s.length,a=e.length,o=Math.min(r,a),l=0;for(;l<o&&e.charCodeAt(l)===s.charCodeAt(l);)l++,r--,a--;for(;r>0&&a>0;){let d=l+r-1,f=l+a-1;if(s.charCodeAt(d)===e.charCodeAt(f))r--,a--;else break}for(;r>0&&a>0;){let d=l,f=l;if(s.charCodeAt(d)===e.charCodeAt(f))l++,r--,a--;else break}let c=this.pos+l-1,h=c+a;this.start=this.start===void 0?c:Math.min(this.start,c),this.end=this.end===void 0?h:Math.max(this.end,h)}this.start===void 0&&(this.start=this.pos-1,this.end=this.pos)}}popupData(e,t){let n=`${De(this.pos)}`,s=this.start===this.end?`${De(this.start)} | ${De(this.start+1)}`:`${De(this.start+1)}-${De(this.end)}`,r=[{name:"Chr",value:this.chr},{name:"Pos",value:n},{name:"Loc",value:s},{name:"ID",value:this.names?this.names:""},{name:"Ref",value:this.referenceBases},{name:"Alt",value:this.alternateBases.replace("<","&lt;")},{name:"Qual",value:this.quality},{name:"Filter",value:this.filter}];if(this.type==="SNP"){let a=this.referenceBases;if(a.length===1){let o=this.alternateBases.split(",");for(let l of o)if(l.length===1){let c=kt.getCravatLink(this.chr,this.pos,a,l,t);c&&(r.push("<hr/>"),r.push({html:c}))}}}if(this.hasOwnProperty("heterozygosity")&&r.push({name:"Heterozygosity",value:this.heterozygosity}),this.info){r.push({html:'<hr style="border-top: dotted 1px;border-color: #c9c3ba" />'});for(let a of Object.keys(this.info))r.push({name:a,value:us(decodeURIComponent(this.info[a]))})}return r}getInfo(e){return this.info?this.info[e]:void 0}isRefBlock(){return this.type==="NONVARIANT"}},ny=new Set(["A","C","T","G"].map(i=>i.charCodeAt(0)));function ry(i){for(let e=0;e<i.length;e++)if(!ny.has(i.charCodeAt(e)))return!1;return!0}function sy(i,e){let t=i.length;if(e===void 0)return"UNKNOWN";if(e.trim().length===0||e==="<NON_REF>"||e==="<*>"||e===".")return"NONVARIANT";{let s=e.split(",").map(function(a){return t===1&&a.length===1?"SNP":a==="<NON_REF>"?"NONVARIANT":"OTHER"}),r=s[0];for(let a of s)if(a!==r)return"MIXED";return r}}function us(i,e){return e===void 0&&(e=","),Array.isArray(i)?i.join(e):i}var Us=class{construtor(){}async parseHeader(e,t){let n={};n.chrAliasTable=new Map;let s=await e.nextLine();if(s.startsWith("##fileformat"))n.version=s.substr(13);else throw new Error("Invalid VCF file: missing fileformat line");for(;(s=await e.nextLine())!==void 0&&s.startsWith("#");){let a,o={};if(s.startsWith("##")){if(s.startsWith("##INFO")||s.startsWith("##FILTER")||s.startsWith("##FORMAT")){let l=s.indexOf("<"),c=s.lastIndexOf(">");if(!(l>2&&c>0)){console.log("Malformed VCF header line: "+s);continue}let h=s.substring(2,l-1);n[h]||(n[h]={});let d=Bb(s.substring(l+1,c-1),",");for(let f of d){var r=f.split("=");r.length>1&&(r[0]==="ID"?a=r[1]:o[r[0]]=r[1])}a&&(n[h][a]=o)}else if(s.startsWith("##contig")&&t){let l=s.indexOf("<ID="),c=s.indexOf(",",l);c==-1&&(c=s.indexOf(">",l));let h=s.substring(l+4,c),d=t.getChromosomeName(h);n.chrAliasTable.set(d,h)}}else if(s.startsWith("#CHROM")){let l=s.split("	");if(l.length>8){n.callSets=[];for(let c=9;c<l.length;c++)n.callSets.push({id:c,name:l[c]})}}}return this.header=n,n}async parseFeatures(e){let t=[],n=this.header.callSets,s=8+(n?n.length+1:0),r;for(;(r=await e.nextLine())!==void 0;)if(r&&!r.startsWith("#")){let a=r.split("	");if(a.length===s){let o=ty(a);if(o.header=this.header,t.push(o),a.length>9){let l=ay(a[8].split(":"));o.calls={};for(let c=9;c<a.length;c++){let h=a[c],d=n[c-9],f={callSetName:d.name,info:{}};o.calls[d.id]=f,h.split(":").forEach(function(u,g){switch(g){case l.genotypeIndex:f.genotype=[],u.split(/[\|\/]/).forEach(function(_){f.genotype.push(_==="."?_:parseInt(_))});break;default:f.info[l.fields[g]]=u}})}}o.info&&o.info.CHR2&&o.info.END&&t.push(oy(o))}}return t}};function ay(i){let e={genotypeIndex:-1,fields:i};for(let t=0;t<i.length;t++)i[t]==="GT"&&(e.genotypeIndex=t);return e}function oy(i){let e=i.info.CHR2,t=Number.parseInt(i.info.END);return{chr:e,start:t-1,end:t,_f:i}}var wl=class{constructor(e){if(this.config=e,e.columns){if(e.columns.chromosome===void 0||e.columns.position===void 0||e.columns.value===void 0)throw Error("columns property must define chrCol, posCol, and valueCol");this.posCol=e.columns.position-1,this.chrCol=e.columns.chromosome-1,this.valueCol=e.columns.value-1}else this.posCol=2,this.chrCol=1,this.valueCol=3}async parseHeader(e){let t=await e.nextLine();return this.parseHeaderLine(t)}parseHeaderLine(e){if(this.columns=e.split(/\t/),!this.config.columns)for(let t=0;t<this.columns.length;t++)switch(this.columns[t].toLowerCase()){case"chr":case"chromosome":case"chr_id":this.chrCol=t;break;case"bp":case"pos":case"position":case"chr_pos":this.posCol=t;break;case"p":case"pval":case"pvalue":case"p-value":case"p.value":this.valueCol=t;break}return this.columns}async parseFeatures(e){let t=[],n=e.nextLine();this.columns||this.parseHeaderLine(n);let s;for(;(s=e.nextLine())!==void 0;){let r=s.split(/\t/);if(r.length===this.columns.length){let a=r[this.chrCol],o=parseInt(r[this.posCol])-1,l=o+1,c=Number(r[this.valueCol]);t.push(new vl({chr:a,start:o,end:l,value:c,line:s,columns:this.columns}))}}return t}},vl=class{constructor({chr:e,start:t,end:n,value:s,line:r,columns:a}){this.chr=e,this.start=t,this.end=n,this.value=s,this.line=r,this.columns=a}popupData(){let e=this.line.split(/\t/);return this.columns.map(function(t,n){return{name:t,value:e[n]}})}getAttribute(e){let t=this.line.split(/\t/);for(let n=0;n<this.columns.length;n++)if(this.columns[n]===e)return t[n]}},ly=new RegExp("([^:]*)\\(([^)]*)\\)"),hy=new RegExp("([^:]*):([^(]*)\\(([^)]*)\\)"),_l=class{constructor(e){let t=e?e.decode:void 0;this.nameField=e?e.nameField:void 0,this.skipRows=0,t?this.decode=t:this.decode=dy,this.delimiter="	"}async parseHeader(e){let t,n;for(;(t=await e.nextLine())&&(t.startsWith("track")||t.startsWith("#")||t.startsWith("browser"));)if(t.startsWith("track")||t.startsWith("#track")){let s=fy(t);n?Object.assign(n,s):n=s}else if(t.startsWith("#columns")){let s=uy(t);n?Object.assign(n,s):n=s}else t.startsWith("##gff-version 3")&&(this.format="gff3",n||(n={}),n.format="gff3");return this.header=n,n}async parseFeatures(e){let t=[],n=this.decode,s=this.delimiter||"	",r=0,a,o;for(;(a=e.nextLine())!==void 0;){if(r++,r<=this.skipRows||a.startsWith("track")||a.startsWith("#")||a.startsWith("browser"))continue;let c=l();if(c.length<1)continue;if(!this.aed){this.aed=cy(c);continue}let h=n.call(this,c,o);h&&t.push(h)}return t;function l(){for(var c=[],h="",d=!1,f,u;a||a==="";){for(f=0;f<a.length;f++)u=a.charAt(f),u===s?d?h+=u:(c.push(h),h=""):u==='"'?f+1<a.length&&a.charAt(f+1)==='"'?(d&&(h+='"'),f++):d=!d:h+=u;if(d)h+=`
`,a=nextLine();else break}return c.push(h),c}}};function nm(i){var e=hy.exec(i);if(e)return{namespace:e[1],name:e[2],type:e[3]};if(e=ly.exec(i),e)return{namespace:"?",name:e[1],type:e[2]};throw new Error("Error parsing the header row of AED file - column not in ns:name(ns:type) format")}function cy(i){var e,t,n,s;for(e={columns:[],metadata:{}},t=0;t<i.length;t++)n=i[t],s=nm(n),e.columns.push(s);return e}function fy(i){let e={},t=i.split(/(?:")([^"]+)(?:")|([^\s"]+)(?=\s+|$)/g),n,s=[];for(let a of t)!a||a.trim().length===0||(a.endsWith("=")>0?n=a:n?(s.push(n+a),n=void 0):s.push(a));for(let a of s){if(!a)return;var r=a.split("=",2);if(r.length===2){let o=r[0].trim(),l=r[1].trim();e[o]=l}}return e}function uy(i){let e={},t=i.split(/\s+/);return t.length===2&&t[1].split(";").forEach(function(s){let r=s.split("=");r[0]==="color"?e.colorColumn=Number.parseInt(r[1])-1:r[0]==="thickness"&&(e.thicknessColumn=Number.parseInt(r[1])-1)}),e}function rm(i,e){var t,n,s=i.columns;this.aed=i,this.allColumns=e,this.chr=null,this.start=null,this.end=null,this.score=1e3,this.strand=".",this.cdStart=null,this.cdEnd=null,this.name=null,this.color=null;for(let a=0;a<e.length;a++)if(t=e[a],!!t){n=s[a],n.type==="aed:Integer"&&(t=parseInt(t));var r=[];if(n.namespace.length>0)for(let o=0;o<n.namespace.length;o++)r.push(n.namespace.charCodeAt(o));n.namespace.trim()==="bio"?n.name==="sequence"?this.chr=t:n.name==="start"?this.start=t:n.name==="end"?this.end=t:n.name==="cdsMin"?this.cdStart=t:n.name==="cdsMax"?this.cdEnd=t:n.name==="strand"&&(this.strand=t):n.namespace==="aed"?n.name==="name"&&(this.name=t):n.namespace==="style"&&n.name==="color"&&(this.color=Ve.createColorString(t))}}rm.prototype.popupData=function(){for(var i=[],e=this.aed,t=0;t<this.allColumns.length;t++){var n=this.allColumns[t],s=e.columns[t].name;s!=="sequence"&&s!=="color"&&n&&i.push({name:s,value:n})}return i};function dy(i,e){var t,n,s,r=0,a=this.aed.columns,o,l,c;if(i.length!==a.length){console.log("Corrupted AED file row: "+i.join(","));return}for(c=0;c<i.length;c++)o=a[c],s=i[c],s!==""&&r++,o.name==="name"&&o.namespace==="aed"?t=s:o.name==="value"&&o.namespace==="aed"&&(n=s);if(r===2&&t&&n){l=nm(t),this.aed.metadata[l.namespace]||(this.aed.metadata[l.namespace]={}),this.aed.metadata[l.namespace][l.name]||(this.aed.metadata[l.namespace][l.name]={type:l.type,value:n});return}var h=new rm(this.aed,i);if(!h.chr||!h.start&&h.start!==0||!h.end){console.log("Cannot parse feature: "+i.join(","));return}return h}var vt=class{constructor(e,t){this.littleEndian=t!==void 0?t:!0,this.position=0,this.view=e,this.length=e.byteLength}available(){return this.length-this.position}remLength(){return this.length-this.position}hasNext(){return this.position<this.length-1}getByte(){var e=this.view.getUint8(this.position,this.littleEndian);return this.position++,e}getShort(){var e=this.view.getInt16(this.position,this.littleEndian);return this.position+=2,e}getUShort(){var e=this.view.getUint16(this.position,this.littleEndian);return this.position+=2,e}getInt(){var e=this.view.getInt32(this.position,this.littleEndian);return this.position+=4,e}getUInt(){var e=this.view.getUint32(this.position,this.littleEndian);return this.position+=4,e}getLong(){var e=[];e[0]=this.view.getUint8(this.position),e[1]=this.view.getUint8(this.position+1),e[2]=this.view.getUint8(this.position+2),e[3]=this.view.getUint8(this.position+3),e[4]=this.view.getUint8(this.position+4),e[5]=this.view.getUint8(this.position+5),e[6]=this.view.getUint8(this.position+6),e[7]=this.view.getUint8(this.position+7);var t=0;if(this.littleEndian)for(let n=e.length-1;n>=0;n--)t=t*256+e[n];else for(let n=0;n<e.length;n++)t=t*256+e[n];return this.position+=8,t}getString(e){for(var t="",n;(n=this.view.getUint8(this.position++))!==0&&(t+=String.fromCharCode(n),!(e&&t.length===e)););return t}getFixedLengthString(e){var t="",n,s;for(n=0;n<e;n++)s=this.view.getUint8(this.position++),s>0&&(t+=String.fromCharCode(s));return t}getFixedLengthTrimmedString(e){var t="",n,s;for(n=0;n<e;n++)s=this.view.getUint8(this.position++),s>32&&(t+=String.fromCharCode(s));return t}getFloat(){var e=this.view.getFloat32(this.position,this.littleEndian);return this.position+=4,e}getDouble(){var e=this.view.getFloat64(this.position,this.littleEndian);return this.position+=8,e}skip(e){return this.position+=e,this.position}getVPointer(){var e=this.position,t=this.view.getUint8(e+1)<<8|this.view.getUint8(e),n=(this.view.getUint8(e+6)&255)*4294967296,s=(this.view.getUint8(e+5)&255)*16777216,r=(this.view.getUint8(e+4)&255)*65536,a=(this.view.getUint8(e+3)&255)*256,o=this.view.getUint8(e+2)&255,l=n+s+r+a+o;return this.position+=8,new yl(l,t)}},yl=class{constructor(e,t){this.block=e,this.offset=t}isLessThan(e){return this.block<e.block||this.block===e.block&&this.offset<e.offset}isGreaterThan(e){return this.block>e.block||this.block===e.block&&this.offset>e.offset}isEqualTo(e){return this.block===e.block&&this.offset===e.offset}print(){return""+this.block+":"+this.offset}};function sm(i,e){if(i.length===0||(i.sort(function(s,r){let a=s.minv.block-r.minv.block;return a!==0?a:s.minv.offset-r.minv.offset}),i.length<=1))return i;e&&(i=i.filter(s=>s.maxv.isGreaterThan(e)));let t=[],n;for(let s of i)n&&py(n,s)?s.maxv.isGreaterThan(n.maxv)&&(n.maxv=s.maxv):(t.push(s),n=s);return t}function py(i,e){return e.minv.block-i.maxv.block,i.maxv.block-i.minv.block<5e6}var gy=21582659,my=38359875;async function by(i,e){let t=new xl;return t.parse(i,e),t}var xl=class{constructor(e){this.tabix=!0}parse(e,t){let n=new vt(new DataView(e)),s=n.getInt();if(s!==gy)throw Error(s===my?"CSI version 2 is not supported.  Please enter an issue at https://github.com/igvteam/igv.js":"Not a CSI index");this.indices=[],this.blockMin=Number.MAX_SAFE_INTEGER,this.lastBlockPosition=[],this.sequenceIndexMap={},this.minShift=n.getInt(),this.depth=n.getInt();let r=n.getInt(),a=[],o=0;if(r>=28){n.getInt(),n.getInt(),n.getInt(),n.getInt(),n.getInt(),n.getInt();let h=n.getInt(),d=n.position+h,f=0;for(;n.position<d;){let u=n.getString();t&&(u=t.getChromosomeName(u)),this.sequenceIndexMap[u]=f,a[f]=u,f++}}let l=this.bin_limit()+1,c=n.getInt();for(let h=0;h<c;h++){let d=[],f=[],u=n.getInt();for(let g=0;g<u;g++){let _=n.getInt();if(f[_]=n.getVPointer(),_>l)n.getInt(),n.getVPointer(),n.getVPointer(),n.getLong(),n.getLong();else{d[_]=[];let b=n.getInt();for(let w=0;w<b;w++){let p=n.getVPointer(),m=n.getVPointer();p&&m&&(p.block<this.blockMin&&(this.blockMin=p.block),m.block>o&&(o=m.block),d[_].push([p,m]))}}}u>0&&(this.indices[h]={binIndex:d,loffset:f})}this.lastBlockPosition=o}get chromosomeNames(){return Object.keys(this.sequenceIndexMap)}chunksForRange(e,t,n){let s=this.indices[e];if(s){let r=this.reg2bins(t,n);if(r.length==0)return[];let a=[];for(let l of r)for(let c=l[0];c<=l[1];c++)if(s.binIndex[c]){let h=s.binIndex[c];for(let d of h){let f=d[0],u=d[1];a.push({minv:f,maxv:u,bin:c})}}let o=s.loffset[r[0]];return sm(a,o)}else return[]}reg2bins(e,t){e-=1,e<1&&(e=1),t>2**34&&(t=2**34),t-=1;let n=0,s=0,r=this.minShift+this.depth*3,a=[];for(;n<=this.depth;r-=3,s+=1<<n*3,n+=1){let o=s+(e>>r),l=s+(t>>r);a.push([o,l])}return a}bin_limit(){return((1<<(this.depth+1)*3)-1)/7}},wy=21578050,vy=21578324;async function _y(i,e){let t=new $s;return await t.parse(i,!1,e),t}async function yy(i,e){let t=new $s;return await t.parse(i,!0,e),t}var $s=class{constructor(){}async parse(e,t,n){let s=[],r=Number.MAX_SAFE_INTEGER,a=0,o=new vt(new DataView(e)),l=o.getInt(),c={};if(l===wy||t&&l===vy){let h=o.getInt();if(t){o.getInt(),o.getInt(),o.getInt(),o.getInt(),o.getInt(),o.getInt(),o.getInt();for(let d=0;d<h;d++){let f=o.getString();n&&(f=n.getChromosomeName(f)),c[f]=d}}for(let d=0;d<h;d++){let f={},u=[],g=o.getInt();for(let b=0;b<g;b++){let w=o.getInt();if(w===37450)o.getInt(),o.getVPointer(),o.getVPointer(),o.getLong(),o.getLong();else{f[w]=[];let p=o.getInt();for(let m=0;m<p;m++){let v=o.getVPointer(),x=o.getVPointer();v&&x&&(v.block<r&&(r=v.block),x.block>a&&(a=x.block),f[w].push([v,x]))}}}let _=o.getInt();for(let b=0;b<_;b++){let w=o.getVPointer();u.push(w)}g>0&&(s[d]={binIndex:f,linearIndex:u})}this.firstBlockPosition=r,this.lastBlockPosition=a,this.indices=s,this.sequenceIndexMap=c,this.tabix=t}else throw new Error(indexURL+" is not a "+(t?"tabix":"bai")+" file")}get chromosomeNames(){return Object.keys(this.sequenceIndexMap)}chunksForRange(e,t,n){let r=this.indices[e];if(r){let a=xy(t,n),o=[];for(let f of a)for(let u=f[0];u<=f[1];u++)if(r.binIndex[u]){let g=r.binIndex[u];for(let _ of g){let b=_[0],w=_[1];o.push({minv:b,maxv:w})}}let l=r.linearIndex.length,c,h=Math.min(t>>14,l-1),d=Math.min(n>>14,l-1);for(let f=h;f<=d;f++){let u=r.linearIndex[f];if(u){c=u;break}}return sm(o,c)}else return[]}};function xy(i,e){let t=[];return e>=1<<29&&(e=1<<29),--e,t.push([0,0]),t.push([1+(i>>26),1+(e>>26)]),t.push([9+(i>>23),9+(e>>23)]),t.push([73+(i>>20),73+(e>>20)]),t.push([585+(i>>17),585+(e>>17)]),t.push([4681+(i>>14),4681+(e>>14)]),t}async function ky(i,e){let t=new kl;return t.parse(i,e),t}var kl=class{constructor(){}async parse(e,t){let n=0;this.chrIndex={},this.lastBlockPosition=[];let s=new vt(new DataView(e));a(s);let r=s.getInt();for(;r-- >0;){let o=s.getString();t&&(o=t.getChromosomeName(o));let l=s.getInt(),c=s.getInt(),h=s.getInt();s.getInt()>0,s.getInt();let d=s.getLong(),f=[];for(let u=0;u<c;u++){let g=s.getLong();f.push({min:d,max:g}),d=g,g>n&&(n=g)}this.chrIndex[o]={chr:o,blocks:f,longestFeature:h,binWidth:l}}this.lastBlockPosition=n;function a(o){o.getInt(),o.getInt();let l=o.getInt();if(o.getString(),o.getLong(),o.getLong(),o.getString(),o.getInt(),l>=3){let c=o.getInt();for(;c-- >0;)o.getString(),o.getString()}}}get chromosomeNames(){return Object.keys(this.chrIndex)}chunksForRange(e,t,n){let s=this.chrIndex[e];if(s){let r=s.blocks,a=s.longestFeature,o=s.binWidth,l=Math.max(t-a,0),c=Math.floor(l/o);if(c>=r.length)return[];{let h=Math.min(Math.floor((n-1)/o),r.length-1),d=r[c].min,f=r[h].max;return f-d===0?[]:[{minv:{block:d,offset:0},maxv:{block:f,offset:0}}]}}else return}},Sy=21582659,Cy=38359875,Ey=21578050,Ay=21578324,Ty=1480870228;async function am(i,e,t){let n=await Ce.loadArrayBuffer(i,Oe(e)),s=new DataView(n);switch(s.getUint8(0)===31&&s.getUint8(1)===139&&(n=bi(n).buffer,s=new DataView(n)),s.getInt32(0,!0)){case Ey:return _y(n,t);case Ay:return yy(n,t);case Sy:return by(n,t);case Ty:return ky(n,t);case Cy:throw Error("CSI version 2 is not supported.");default:throw Error(`Unrecognized index type: ${i}`)}}function jt(i){return typeof i=="string"||i instanceof String?new Sl(i):new Cl(i)}var Sl=class{constructor(e){this.data=e,this.ptr=0}nextLine(){var e=this.ptr,t=this.data.indexOf(`
`,e),n=this.data;if(t>0)return this.ptr=t+1,t>e&&n.charAt(t-1)==="\r"?n.substring(e,t-1):n.substring(e,t);var s=n.length;return this.ptr=s,e>=s?void 0:n.substring(e)}},Cl=class{constructor(e){this.data=e,this.length=this.data.length,this.ptr=0}nextLine(){var e,t;if(t="",!(this.ptr>=this.length)){for(var n=this.ptr;n<this.length;n++)if(e=String.fromCharCode(this.data[n]),e!=="\r"){if(e===`
`)break;t=t+e}return this.ptr=n+1,t}}},El=class{constructor(e){this.config=e,this.filePtr=0,this.bufferPtr=0,this.buffer}async nextLine(){let e;try{for(;;){let t=this.buffer?this.buffer.length:0;for(;this.bufferPtr<t;){let n=String.fromCharCode(this.buffer[this.bufferPtr++]);if(n!=="\r"){if(n===`
`)return e;e=e?e+n:n}}if(this.eof)return e;await this.readNextBlock()}}catch(t){return console.warn(t),this.eof=!0,e}}async readNextBlock(){let e=Oe(this.config,{range:{start:this.filePtr,size:26}}),t=await Ce.loadArrayBuffer(this.config.url,e),n=Rg(t);if(n===0)this.eof=!0,this.buffer=void 0;else{let s=Oe(this.config,{range:{start:this.filePtr,size:n}}),r=await Ce.loadArrayBuffer(this.config.url,s);r.byteLength<n&&(this.eof=!0),this.buffer=bi(r),this.buffer.byteLength==0&&(this.eof=!0),this.bufferPtr=0,this.filePtr+=r.byteLength}}};function My(i){if(i.length===1)return i[0];let e=0;for(let s of i)e+=s.byteLength;let t=new Uint8Array(e),n=0;for(let s of i)t.set(new Uint8Array(s),n),n+=s.byteLength;return t.buffer}var wu=i=>{let e=ArrayBuffer.isView(i)?i:new Uint8Array(i);return(e[17]<<8|e[16])+1},Vs=class{constructor(e){this.config=e,this.cacheBlocks=e.cacheBlocks!=!1,this.cache=void 0}async getData(e,t){let n=e.block,s=t.block,r=t.offset===0,a=await this.getInflatedBlocks(n,s,r);if(a.length===1)return a[0];let o=0;for(let h of a)o+=h.byteLength;let l=new Uint8Array(o),c=0;for(let h of a)l.set(h,c),c+=h.byteLength;return l}async getInflatedBlocks(e,t,n){if(this.cacheBlocks){let s=this.cache;if(s&&s.startBlock<=e&&(s.endBlock>=t||n&&s.nextEndBlock===t)){let r=e-s.startBlock,a=t-s.startBlock;return no(s.buffer,r,a)}else{let r;if(!s||s.startBlock>t||s.endBlock<e)r=await this.loadBLockData(e,t,{skipEnd:n});else{let o=[];if(e<s.startBlock){let c=await this.loadBLockData(e,s.startBlock,{skipEnd:!0});o.push(c)}let l;if(e<=s.startBlock&&t>=s.endBlock)l=s.buffer;else{let c=Math.max(0,e-s.startBlock),h;if(t>=s.endBlock)h=s.buffer.byteLength;else{let d=vu(s.buffer);for(let f=0;f<d.length-1;f++)if(s.startBlock+d[f]===t){h=d[f+1];break}}l=s.buffer.slice(c,h)}if(o.push(l),t>s.endBlock){let c=await this.loadBLockData(s.endBlock,t,{skipStart:!0,skipEnd:n});o.push(c)}r=My(o)}let a=t;if(n){let o=vu(r);t=o[o.length-1]}return this.cache={startBlock:e,endBlock:t,nextEndBlock:a,buffer:r},no(r)}}else{let s=await this.loadBLockData(e,t,{skipEnd:n});return no(s)}}async loadBLockData(e,t,n){let s=this.config,r=n&&n.skipStart,a=n&&n.skipEnd,o=0;if(!a){let c=Oe(s,{range:{start:t,size:26}}),h=await Ce.loadArrayBuffer(s.url,c);o=wu(h)}if(r){let c=Oe(s,{range:{start:e,size:26}}),h=await Ce.loadArrayBuffer(s.url,c);e+=wu(h)}let l=Oe(s,{range:{start:e,size:t+o-e}});return Ce.loadArrayBuffer(s.url,l)}};function vu(i){let e=i.byteLength,t=0,n=[0];for(;t<e;){let s=new Uint8Array(i,t),r=(s[17]<<8|s[16])+1;t+=r,t<e&&n.push(t)}return n}function no(i,e,t){e=e||0;let n=[],s=e,r=i.byteLength-18;for(;s<r;)try{let a=new Uint8Array(i,s,18),o=a[11]<<8|a[10],l=a[17]<<8|a[16],c=12+o+s,h=i.byteLength-c,d=l-o-18;if(h<d||d<=0)break;let f=new Uint8Array(i,c,d),u=dc(f);if(n.push(u),t===s)break;s+=l+1}catch(a){console.error(a);break}return n}var Al=class{constructor(e,t){var n;this.config=e||{},this.genome=t,this.indexURL=e.indexURL,this.indexed=e.indexed||this.indexURL!==void 0,this.queryable=this.indexed,Ei(this.config.url)?this.filename=this.config.url.name:oi(this.config.url)?(this.indexed=!1,this.dataURI=e.url):(n=qp(this.config.url),this.filename=e.filename||n.file),this.parser=this.getParser(this.config),this.config.format==="vcf"&&!this.config.indexURL&&console.warn("Warning: index file not specified.  The entire vcf file will be loaded.")}async defaultVisibilityWindow(){if(this.config.indexURL){let e=await this.getIndex();if(e&&e.lastBlockPosition){let t=0,n=1e4;for(let s of e.chromosomeNames){let r=this.genome.getChromosome(s);r&&(t+=r.bpLength)}return Math.round(t/e.lastBlockPosition*n)}}}async readFeatures(e,t,n){return await this.getIndex()?(this.indexed=!0,this.loadFeaturesWithIndex(e,t,n)):this.dataURI?(this.indexed=!1,this.loadFeaturesFromDataURI()):(this.indexed=!1,this.loadFeaturesNoIndex())}async readHeader(){if(this.dataURI)return await this.loadFeaturesFromDataURI(this.dataURI),this.header;if(this.config.indexURL){let e=await this.getIndex();if(!e)throw new Error("Unable to load index: "+this.config.indexURL);let t;if(e.tabix)this._blockLoader=new Vs(this.config),t=new El(this.config);else{let n=Object.values(e.chrIndex).flatMap(a=>a.blocks).map(a=>a.max).reduce((a,o)=>Math.min(a,o),Number.MAX_SAFE_INTEGER),s=Oe(this.config,{bgz:e.tabix,range:{start:0,size:n}}),r=await Ce.loadString(this.config.url,s);t=jt(r)}return this.header=await this.parser.parseHeader(t),this.header}else{let e=Oe(this.config),t=await Ce.loadString(this.config.url,e),n=jt(t);return this.header=await this.parser.parseHeader(n),n=jt(t),this.features=await this.parser.parseFeatures(n),this.header}}getParser(e){switch(e.format){case"vcf":return new Us(e);case"seg":return new sr("seg");case"mut":return new sr("mut");case"maf":return new sr("maf");case"gwas":return new wl(e);case"aed":return new _l(e);default:return new ml(e)}}async loadFeaturesNoIndex(){if(this.features){let e=this.features;return delete this.features,e}else{let e=Oe(this.config),t=await Ce.loadString(this.config.url,e);if(!this.header){let r=jt(t);this.header=await this.parser.parseHeader(r)}let n=jt(t);return await this.parser.parseFeatures(n)}}async loadFeaturesWithIndex(e,t,n){!this.dataURI&&!this.header&&await this.readHeader();let s=this.config,r=this.parser,a=this.index.tabix,o=a?this.index.sequenceIndexMap[e]:e;if(o===void 0)return[];let l=this.genome,c=this.index.chunksForRange(o,t,n);if(!c||c.length===0)return[];{let h=[];for(let d of c){let f;if(a)f=await this._blockLoader.getData(d.minv,d.maxv);else{let w=Oe(s,{range:{start:d.minv.block,size:d.maxv.block-d.minv.block+1}});f=await Ce.loadString(s.url,w)}let u=d.minv.offset?f.slice(d.minv.offset):f,g=jt(u),_=await r.parseFeatures(g);_=_.filter(w=>w._f===void 0);let b=!1;for(let w=0;w<_.length;w++){let p=_[w];if((l?l.getChromosomeName(p.chr):p.chr)!==e){if(h.length===0)continue;break}if(p.start>n){h.push(p);break}p.end>=t&&p.start<=n&&(b||(b=!0,w>0&&h.push(_[w-1])),h.push(p))}}return h.sort(function(d,f){return d.start-f.start}),h}}async getIndex(){if(this.index)return this.index;if(this.config.indexURL)return this.index=await this.loadIndex(),this.index}async loadIndex(){let e=this.config.indexURL;return am(e,this.config,this.genome)}async loadFeaturesFromDataURI(){if(this.features){let e=this.features;return delete this.features,e}else{let e=tn(this.dataURI),t=jt(e);return this.header=await this.parser.parseHeader(t),this.header instanceof String&&this.header.startsWith("##gff-version 3")&&(this.format="gff3"),t=jt(e),this.features=await this.parser.parseFeatures(t),this.features}}},Ry=yt,Tl=class{constructor(e){this.config=e}async readFeatures(e,t,n){let s;typeof this.config.url=="function"?s=this.config.url({chr:e,start:t,end:n}):s=this.config.url.replace("$CHR",e).replace("$START",t).replace("$END",n);let r=Object.assign({},this.config);this.config.body!==void 0&&(typeof this.config.body=="function"?r.body=this.config.body({chr:e,start:t,end:n}):r.body=this.config.body.replace("$CHR",e).replace("$START",t).replace("$END",n));let a,o=await Ce.load(s,r);if(o&&(typeof this.config.parser=="function"?a=this.config.parser(o):Ry(o)?a=JSON.parse(o):a=o),this.config.mappings){let l=Object.keys(this.config.mappings);for(let c of a)for(let h of l)c[h]=c[this.config.mappings[h]]}return a}},om=function(i,e){this.config=i,this.genome=e,this.expandQueryInterval=!1};om.prototype.readFeatures=function(i,e,t){let n=Math.max(0,Math.floor(e)),s=Math.ceil(t);if(this.genome){let a=this.genome.getChromosome(i);a&&s>a.bpLength&&(s=a.bpLength)}let r=this.config.url+"?db="+this.config.db+"&table="+this.config.tableName+"&chr="+i+"&start="+n+"&end="+s;return Ce.loadJson(r,this.config).then(function(a){return a?(a.forEach(function(o){o.hasOwnProperty("exonStarts")&&o.hasOwnProperty("exonEnds")&&o.hasOwnProperty("exonCount")&&o.hasOwnProperty("cdsStart")&&o.hasOwnProperty("cdsEnd")&&Iy(o)}),a):null})};function Iy(i){var e,t,n,s,r,a;e=i.exonCount,t=i.exonStarts.split(","),n=i.exonEnds.split(","),s=[];for(var o=0;o<e;o++){r=parseInt(t[o]),a=parseInt(n[o]);var l={start:r,end:a};(i.cdsStart>a||i.cdsEnd<i.cdsStart)&&(l.utr=!0),i.cdsStart>=r&&i.cdsStart<=a&&(l.cdStart=i.cdsStart),i.cdsEnd>=r&&i.cdsEnd<=a&&(l.cdEnd=i.cdsEnd),s.push(l)}i.exons=s}var Ly=["Name","gene_name","gene","gene_id","alias","locus","name"],Ml=class{constructor(e){this.format=e.format,this.nameField=e.nameField,this.filterTypes=e.filterTypes===void 0?new Set(["chromosome"]):new Set(e.filterTypes)}combineFeatures(e,t){let n,s=this.filterTypes;if(e=e.filter(r=>s===void 0||!s.has(r.type)),this.format==="gff3"){let r=this.combineFeaturesById(e);n=this.combineFeaturesByType(r)}else n=this.combineFeaturesByType(e);return n.sort(function(r,a){return r.start-a.start}),this.numberExons(n,t),this.nameFeatures(n),n}combineFeaturesById(e){let t=new Map,n=[];for(let s of e)if(fu(s.type)||cu(s.type)||!s.id)n.push(s);else{let r=t.get(s.chr);r||(r=new Map,t.set(s.chr,r));let a=r.get(s.id);a?a.push(s):r.set(s.id,[s])}for(let s of t.values())for(let r of s.values())if(r.length>1){let a=r[0];a.exons=[];for(let o of r)a.start=Math.min(a.start,o.start),a.end=Math.max(a.end,o.end),a.exons.push({start:o.start,end:o.end});n.push(a)}else n.push(r[0]);return n}combineFeaturesByType(e){let t=e.filter(h=>h.type==="gene"||h.type.endsWith("_gene")),n=Object.create(null);for(let h of t)n[h.id]=h;let s=Object.create(null),r=[],a=new Set,o=this.filterTypes;e=e.filter(h=>o===void 0||!o.has(h.type));for(let h of e)if(h.type==="biological_region"&&console.log(),cu(h.type)){let d=h.id;if(d!==void 0){let f=new Ps(h);s[d]=f,r.push(f),a.add(h);let u=n[h.parent];u&&(f.geneObject=u,a.add(u))}}for(let h of e)if(fu(h.type)){let d=c(h);if(d)for(let f of d){let u=s[f];if(!u&&this.format==="gtf"){let g=Object.assign({},h);g.type="transcript",u=new Ps(g),s[f]=u,r.push(u)}if(u!==void 0){if(N_(h.type))if(d.length>1){let g=new Sr(h);u.addExon(g)}else u.addExon(h);else u.addPart(h);a.add(h)}}}r.forEach(function(h){typeof h.finish=="function"&&h.finish()});let l=e.filter(h=>!a.has(h));for(let h of l)r.push(h);return r;function c(h){return h.parent&&h.parent.trim()!==""?h.parent.trim().split(","):null}}numberExons(e,t){for(let n of e)if(n.exons&&(!t||n.end<=t.end&&n.start>t.start))for(let s=0;s<n.exons.length;s++){let r=n.exons[s];r.number=n.strand==="-"?n.exons.length-s:s+1}}nameFeatures(e){for(let t of e)if(t.attributeString){let n=this.format==="gff3"?"=":" ",s=An(t.attributeString,n),r=new Map(s);if(this.nameField)t.name=r.get(this.nameField);else for(let a of Ly)if(r.has(a)){t.name=r.get(a);break}}}},lm=function(i){this.config=i,this.url=i.url,this.tissueId=i.tissueSiteDetailId,this.indexed=!0,this.datasetId=i.datasetId||"gtex_v8"};lm.prototype.readFeatures=async function(i,e,t){let n=this,s=i.startsWith("chr")?i:"chr"+i,r=Math.floor(e),a=Math.ceil(t),o=this.datasetId,l=this.url+"?chromosome="+s+"&start="+r+"&end="+a+"&tissueSiteDetailId="+this.tissueId+"&datasetId="+o,c=await Ce.loadJson(l,{withCredentials:n.config.withCredentials});if(c&&c.singleTissueEqtl)return c.singleTissueEqtl.forEach(function(h){h.chr=h.chromosome,h.position=h.pos,h.start=h.pos-1,h.end=h.start+1,h.snp=h.snpId,h.geneName=h.geneSymbol,h.geneId=h.gencodeId}),c.singleTissueEqtl};var hm=function(i){this.config=i,this.url=i.url,this.cellConditionId=i.cellConditionId,this.valueThreshold=i.valueThreshold?i.valueThreshold:.05};hm.prototype.readFeatures=function(i,e,t){var n=this,s=this.url+"?chromosome="+i+"&start="+e+"&end="+t+"&cell_condition_id="+this.cellConditionId;return new Promise(function(r,a){Ce.loadJson(s,{withCredentials:n.config.withCredentials}).then(function(o){o?(o.eqtls.forEach(function(l){l.chr=l.chromosome,l.start=l.position,l.end=l.position+1}),r(o.eqtls)):r(null)}).catch(function(o){a(o)})})};var _u=Ce.apiKey;function cm(i){var e=i.url+"/"+i.entity+"/"+i.entityId;return i.headers=fm(),Ce.loadJson(e,i)}function qs(i){return new Promise(function(e,t){var n=i.results?i.results:[],s=i.url,r=i.body,a=i.decode,o="?",l=i.fields;return _u&&(s=s+o+"key="+_u,o="&"),l&&(s=s+o+"fields="+l),c();function c(h){h?r.pageToken=h:r.pageToken!==void 0&&delete r.pageToken;var d=JSON.stringify(r);Ce.loadJson(s,{sendData:d,contentType:"application/json",headers:fm()}).then(function(f){var u,g;f?(g=a?a(f):f,g&&g.forEach(function(_){n.push(_)}),u=f.nextPageToken,u?c(u):e(n)):e(n)}).catch(function(f){t(f)})}})}function fm(){return{"Cache-Control":"no-cache"}}var ka=function(i,e){this.config=i,this.genome=e,this.url=i.url,this.variantSetId=i.variantSetId,this.callSetIds=i.callSetIds,this.includeCalls=i.includeCalls===void 0?!0:i.includeCalls};ka.prototype.readHeader=function(){var i=this;if(i.header)return Promise.resolve(i.header);if(i.header={},i.includeCalls===!1)return Promise.resolve(i.header);var e=i.url+"/callsets/search";return qs({url:e,fields:"nextPageToken,callSets(id,name)",body:{variantSetIds:Array.isArray(i.variantSetId)?i.variantSetId:[i.variantSetId],pageSize:"10000"},decode:function(t){if(i.callSetIds){var n=[],s=new Set;return i.callSetIds.forEach(function(r){s.add(r)}),t.callSets.forEach(function(r){s.has(r.id)&&n.push(r)}),n}else return t.callSets}}).then(function(t){return i.header.callSets=t,i.header})};ka.prototype.readFeatures=function(i,e,t){let n=this,s=this.genome;return n.readHeader().then(function(a){return r()}).then(function(a){var o=a.hasOwnProperty(i)?a[i]:i,l=n.url+"/variants/search";return qs({url:l,fields:n.includeCalls?void 0:"nextPageToken,variants(id,variantSetId,names,referenceName,start,end,referenceBases,alternateBases,quality,filter,info)",body:{variantSetIds:Array.isArray(n.variantSetId)?n.variantSetId:[n.variantSetId],callSetIds:n.callSetIds?n.callSetIds:void 0,referenceName:o,start:e.toString(),end:t.toString(),pageSize:"10000"},decode:function(c){var h,d=[];return c.variants.forEach(function(f){h=iy(f),h.isRefBlock()||d.push(h)}),d}})});function r(){return new Promise(function(a,o){n.chrAliasTable?a(n.chrAliasTable):n.readMetadata().then(function(l){n.metadata=l.metadata,n.chrAliasTable={},l.referenceBounds&&s&&l.referenceBounds.forEach(function(c){var h=c.referenceName,d=s.getChromosomeName(h);n.chrAliasTable[d]=h}),a(n.chrAliasTable)})})}};ka.prototype.readMetadata=function(){return cm({url:this.url,entity:"variantsets",entityId:this.variantSetId})};var Rl=class{constructor(e){this.config=e}async readFeatures(e,t,n){let r=(await Ce.loadJson(this.config.url+"/variants/?count=50000")).records,a=[];for(let o of r)if(o.coordinates){o.id;let l=o.coordinates;l.chromosome&&a.push(new Ws(l.chromosome,l.start-1,l.stop,o)),l.chromosome2&&a.push(new Ws(l.chromosome2,l.start2-1,l.stop2,o))}return a}},Ws=class{constructor(e,t,n,s){if(this.chr=e,this.start=t,this.end=n,this.id=s.id,this.entrezName=s.entrez_name,this.name=s.name,this.actionabilityScore=s.civic_actionability_score,s.coordinates.reference_bases&&(this.refBases=s.coordinates.reference_bases),s.coordinates.variant_bases&&(this.altBases=s.coordinates.variant_bases),s.variant_types&&(this.variant_types=s.variant_types),this.locationString=this.chr+":"+De(this.start+1)+"-"+De(this.end),this.actionabilityScore!==void 0){let r;if(this.actionabilityScore<=10)r=.2;else{let a=Math.min(30,this.actionabilityScore);r=.2+.8*Math.log10((a-10)/2)}this.alpha=r}}popupData(){let e=n("CIViC","https://civicdb.org/links/variants/"+this.id);this.refBases!==this.altBases&&this.refBases&&this.refBases.length===1&&this.altBases&&this.altBases.length;let t=[e];if(t.push({name:"Entrez",value:n(this.entrezName,"https://ghr.nlm.nih.gov/gene/"+this.entrezName)}),t.push({name:"Name",value:this.name}),this.variant_types&&this.variant_types.length>0){let s=this.variant_types.length===1?"Type":"Types",r;for(let a of this.variant_types)r?r+=", "+a.display_name:r=a.display_name;t.push({name:s,value:r})}return t.push({name:"Actionability",value:this.actionabilityScore}),t.push({name:"Location",value:this.locationString}),t;function n(s,r){return"<a target='_blank' href='"+r+"'>"+s+"</a>"}}},Cr=class{constructor(e,t){if(this.config=e,this.genome=t,this.format=e.format?e.format.toUpperCase():"BAM",!(this.format==="BAM"||this.format==="VCF"))throw Error(`htsget format ${e.format} is not supported`)}async readHeaderData(){let e=`${ro(this.config)}?class=header&format=${this.format}`,t=await Ce.loadJson(e,Oe(this.config));return await this.loadUrls(t.htsget.urls)}async readData(e,t,n){let s=`${ro(this.config)}?format=${this.format}&referenceName=${e}&start=${Math.floor(t)}&end=${Math.ceil(n)}`,r=await Ce.loadJson(s,Oe(this.config));return this.loadUrls(r.htsget.urls)}async loadUrls(e){let t=[];for(let s of e)if(s.url.startsWith("data:"))t.push(Promise.resolve(Fy(s.url)));else{let r=Oe(this.config||{});s.headers&&(r.headers=Object.assign(r.headers||{},s.headers)),t.push(Ce.loadArrayBuffer(s.url,r))}let n=await Promise.all(t);return Ny(n)}static async inferFormat(e){try{let t=ro(e),n=`${t}${t.includes("?")?"&":"?"}class=header`,s=await Ce.loadJson(n,Oe(e));if(s.htsget){let r=s.htsget.format;if(!(r==="BAM"||r==="VCF"))throw Error(`htsget format ${r} is not supported`);e.format=r.toLowerCase(),e.sourceType="htsget",e.name||(e.name=await il(e.url))}}catch{}}};function ro(i){if(i.url&&i.endpoint&&i.id)return i.url+i.endpoint+i.id;if(i.endpoint&&i.id)return i.endpoint+i.id;if(i.url)return i.url.startsWith("htsget://")?i.url.replace("htsget://","https://"):i.url;throw Error("Must specify either 'url', or 'endpoint' and 'id")}function Ny(i){let e=0;for(let s of i)e+=s.byteLength;let t=0,n=new Uint8Array(e);for(let s of i){let r=new Uint8Array(s);n.set(r,t),t+=r.length}return n}function Fy(i){let e=i.split(","),t=e[0].split(":")[1],n=e[1];t.indexOf("base64")>=0?n=atob(n):n=decodeURI(n);let s=new Uint8Array(n.length);for(var r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return s}var Il=class extends Cr{constructor(e,t){super(e,t),this.parser=new Us}async readHeader(){if(!this.header){let e=await this.readHeaderData(),t=jt(e);this.header=await this.parser.parseHeader(t,this.genome),this.chrAliasTable=this.header.chrAliasTable}return this.header}async readFeatures(e,t,n){if(this.config.format&&this.config.format.toUpperCase()!=="VCF")throw Error(`htsget format ${this.config.format} is not supported`);this.chrAliasTable||await this.readHeader();let s=this.chrAliasTable.has(e)?this.chrAliasTable.get(e):e,r=await this.readData(s,t,n),a=jt(r);return this.parser.parseFeatures(a)}};function um(i,e){e=e||Number.MAX_SAFE_INTEGER;let t=[];i.sort(function(n,s){return n.start-s.start}),t.push(-1e3);for(let n of i){let s=0,r=Math.min(t.length,e);for(s=0;s<r;s++)if(n.start>=t[s]){n.row=s,t[s]=n.end;break}n.row=s,t[s]=n.end}}var Dy=1e4;function _c(i,e,t){let n=t||Dy,s=l=>{let c=Object.assign({},l);return c.chr="all",c.start=e.getGenomeCoordinate(l.chr,l.start),c.end=e.getGenomeCoordinate(l.chr,l.end),c._f=l,c.exons&&delete c.exons,c},r=new Set(e.wgChromosomeNames),a=[],o=0;for(let l of e.wgChromosomeNames){if(Array.isArray(i)){let h={};for(let d of i){let f=e.getChromosomeName(d.chr);h.hasOwnProperty(f)||(h[f]=[]),h[f].push(d)}i=h}let c=i[l];if(c)for(let h of c){let d=e.getChromosomeName(h.chr);if(r.has(d))if(a.length<n)a.push(s(h));else{let f=n/(o+1);if(Math.random()<f){let u=Math.floor(Math.random()*(n-1));a[u]=s(h)}}o++}}return a.sort(function(l,c){return l.start-c.start}),a}function dm(i,e){if(e=e||1e3,i==null||i.length===0)return;let t={},n=[];for(let s of i){let r=s.chr,a=t[r];a||(a=[],t[r]=a,n.push(r)),a.push(s)}for(let s of n)um(t[s],e)}var Oy=1e4,js=class{constructor(e,t){this.config=e||{},this.genome=t,this.sourceType=e.sourceType===void 0?"file":e.sourceType,this.maxWGCount=e.maxWGCount||Oy;let n=new Set(["bigwig","bw","bigbed","bb","biginteract","biggenepred","bignarrowpeak","tdf"]);this.queryable=e.indexURL||e.queryable===!0,e.reader?(this.reader=e.reader,this.queryable=e.queryable!==!1):e.sourceType==="ga4gh"?(this.reader=new ka(e,t),this.queryable=!0):e.sourceType==="immvar"?(this.reader=new hm(e),this.queryable=!0):e.type==="eqtl"&&e.sourceType==="gtex-ws"?(this.reader=new lm(e),this.queryable=!0):e.sourceType==="htsget"?(this.reader=new Il(e,t),this.queryable=!0):e.sourceType==="ucscservice"?(this.reader=new om(e.source),this.queryable=!0):e.sourceType==="custom"?(this.reader=new Tl(e.source),this.queryable=e.source.queryable!==!1):e.sourceType==="civic-ws"?(this.reader=new Rl(e),this.queryable=!1):(this.reader=new Al(e,t),e.queryable!==void 0?this.queryable=e.queryable:(n.has(e.format)||this.reader.indexed)&&(this.queryable=!0)),this.searchable=e.searchable===!0||e.searchableFields||e.searchable!==!1&&!this.queryable}async defaultVisibilityWindow(){if(this.reader&&typeof this.reader.defaultVisibilityWindow=="function")return this.reader.defaultVisibilityWindow()}async trackType(){let e=await this.getHeader();if(e)return e.type}async getHeader(){if(!this.header)if(this.reader&&typeof this.reader.readHeader=="function"){let e=await this.reader.readHeader();e?(this.header=e,e.format&&(this.config.format=e.format)):this.header={}}else this.header={};return this.header}async getFeatures({chr:e,start:t,end:n,bpPerPixel:s,visibilityWindow:r}){let a=this.genome,o=a?a.getChromosomeName(e):e,l=o.toLowerCase()==="all";return(l&&!this.wgFeatures&&this.supportsWholeGenome()||this.config.disableCache||!this.featureCache||!this.featureCache.containsRange(new Zi(o,t,n)))&&await this.loadFeatures(o,t,n,r),l?(this.wgFeatures||(this.supportsWholeGenome()?this.wgFeatures=_c(this.featureCache.getAllFeatures(),this.genome,this.maxWGCount):this.wgFeatures=[]),this.wgFeatures):this.featureCache.queryFeatures(o,t,n)}supportsWholeGenome(){return!this.queryable}getAllFeatures(){return this.queryable||!this.featureCache?[]:this.featureCache.getAllFeatures()}async loadFeatures(e,t,n,s){let r=this.reader,a=t,o=n;if((!s||s<=0)&&this.config.expandQuery!==!1){let h=this.genome?this.genome.getChromosome(e):void 0;a=0,o=Math.max(h?h.bpLength:Number.MAX_SAFE_INTEGER,n)}else if(s>n-t&&this.config.expandQuery!==!1){let h=Math.min(4.1*(n-t),s);a=Math.max(0,(t+n)/2-h),o=t+h}let l=await r.readFeatures(e,a,o);this.queryable===void 0&&(this.queryable=r.indexed);let c=this.queryable?new Zi(e,a,o):void 0;if(l){if(this.config.assembleGFF!==!1&&(this.config.format==="gtf"||this.config.format==="gff3"||this.config.format==="gff")&&(l=new Ml(this.config).combineFeatures(l,c)),this.config.format!=="wig"&&this.config.type!=="junctions"){let h=this.config.maxRows||Number.MAX_SAFE_INTEGER;dm(l,h)}this.featureCache=new Wi(l,this.genome,c),this.searchable&&this.genome.addFeaturesToDB(l,this.config)}else this.featureCache=new Wi([],c)}},Gs=class{constructor(e,t,n){this.path=e.url,this.bufferSize=n||512e3,this.range={start:-1,size:-1},this.config=e}async dataViewForRange(e,t,n=0){try{if(!(this.data&&this.range.start<=e.start&&this.range.start+this.range.size>=e.start+e.size)){let o;e.size?o=Math.max(this.bufferSize,e.size):o=this.bufferSize,this.contentLength&&(o=Math.min(o,this.contentLength-e.start));let l={start:e.start,size:o},c=await Ce.loadArrayBuffer(this.path,Oe(this.config,{range:l}));this.data=c,this.range=l}let r=this.data.byteLength,a=e.start-this.range.start;return t?new Uint8Array(this.data,a,r-a):new DataView(this.data,a,r-a)}catch(s){if(n===0&&s.message&&s.message.startsWith("416")){try{return this.contentLength=await Ce.getContentLength(this.path,Oe(this.config)),this.dataViewForRange(e,t,++n)}catch(r){console.error(r)}throw s}}}};function By(i,e,t,n){if(n==="biginteract"||t&&t.table==="chromatinInteract"||t.table==="interact")return s;{let r=i-3;return function(a,o){if(r>0&&(a.name=o[0]),r>1&&(a.score=Number(o[1])),r>2&&(a.strand=o[2]),r>3&&(a.cdStart=parseInt(o[3])),r>4&&(a.cdEnd=parseInt(o[4])),r>5&&o[5]!=="."&&o[5]!=="0"&&o[5]!=="-1"){let l=Ve.createColorString(o[5]);a.color=l.startsWith("rgb")?l:void 0}if(r>8){let l=parseInt(o[6]),c=o[7].split(","),h=o[8].split(","),d=[];for(let f=0;f<l;f++){let u=a.start+parseInt(h[f]),g=u+parseInt(c[f]);d.push({start:u,end:g})}Py(d,a.cdStart,a.cdEnd),a.exons=d}if(t){let l=i;for(let c=l;c<e;c++)if(c<t.fields.length){let h=t.fields[c].name,d=o[c-3];a[h]=d}}}}function s(r,a){return r.chr1=a[5],r.start1=Number.parseInt(a[6]),r.end1=Number.parseInt(a[7]),r.chr2=a[10],r.start2=Number.parseInt(a[11]),r.end2=Number.parseInt(a[12]),r.name=a[0],r.score=Number(a[1]),r.value=Number(a[2]),r.color=a[4]==="."?void 0:a[4]==="0"?"rgb(0,0,0)":a[4],r}}function Py(i,e,t){for(let n of i){let s=n.end,r=n.start;s<e||r>t?n.utr=!0:(e>=r&&e<=s&&(n.cdStart=e),t>=r&&t<=s&&(n.cdEnd=t))}}function zy(i,e){return Math.min(1,.11+.89*(i/779)).toString()}function Hy(i){let e,t=[],n=!1,s=i.trim().split(/\s*[\r\n]+\s*/g);for(let r of s)if(r.startsWith("table"))e=r.split(/\s+/)[1].trim();else if(r.startsWith("("))n=!0;else if(!r.startsWith(")")){if(n&&r.length>0){let a=r.indexOf(";"),o=r.substr(0,a).split(/\s+/),l=r.substr(a+1).replace(/"/g,"").trim();t.push({type:o[0],name:o[1],description:l})}}return{table:e,fields:t}}var Uy=2291137574,$y=654085990,Vy=2273964779,qy=3958540679,yu=64,Wy=48,jy=32,Gy=24,xu=512e3,Ll=class{constructor(e,t){this.path=e.url,this.format=e.format||"bigwig",this.genome=t,this.rpTreeCache={},this.config=e,this.loader=oi(this.path)?new Bl(this.path):Ce}async readWGFeatures(e,t){await this.loadHeader();let n=0,s=this.chromTree.idToChrom.length-1,r=this.chromTree.idToChrom[n],a=this.chromTree.idToChrom[s];return this.readFeatures(r,0,a,Number.MAX_VALUE,e,t)}async readFeatures(e,t,n,s,r,a){await this.loadHeader();let o=this.chromTree.chromToID[e],l=this.chromTree.chromToID[n];if(o===void 0||l===void 0)return[];let c,h;if(this.type==="bigwig"){let u=await this.getZoomHeaders(),g=r?Xy(r,u):void 0;g?(c=g.indexOffset,h=Ky):(c=this.header.fullIndexOffset,h=Yy)}else c=this.header.fullIndexOffset,h=Qy.call(this);let f=await(await this.loadRPTree(c)).findLeafItemsOverlapping(o,t,l,s);if(!f||f.length===0)return[];{let u=Number.MAX_VALUE,g=0;for(let p of f)u=Math.min(u,p.dataOffset),g=Math.max(g,p.dataOffset+p.dataSize);let _=g-u,b=await this.loader.loadArrayBuffer(this.config.url,Oe(this.config,{range:{start:u,size:_}})),w=[];for(let p of f){let m=new Uint8Array(b,p.dataOffset-u,p.dataSize),v;this.header.uncompressBuffSize>0?v=Xo(m):v=m,h.call(this,new DataView(v.buffer),o,t,l,s,w,this.chromTree.idToChrom,a)}return w.sort(function(p,m){return p.start-m.start}),w}}async getZoomHeaders(){return this.zoomLevelHeaders?this.zoomLevelHeaders:(await this.loadHeader(),this.zoomLevelHeaders)}async loadHeader(){if(this.header)return this.header;{let e=await this.loader.loadArrayBuffer(this.path,Oe(this.config,{range:{start:0,size:yu}})),t;this.littleEndian=!0;let n=new vt(new DataView(e)),s=n.getUInt();if(s===Uy)this.type="bigwig";else if(s===Vy)this.type="bigbed";else{this.littleEndian=!1,n.littleEndian=!1,n.position=0;let l=n.getUInt();l===$y?this.type="bigwig":l===qy&&(this.type="bigbed")}t={bwVersion:n.getUShort(),nZoomLevels:n.getUShort(),chromTreeOffset:n.getLong(),fullDataOffset:n.getLong(),fullIndexOffset:n.getLong(),fieldCount:n.getUShort(),definedFieldCount:n.getUShort(),autoSqlOffset:n.getLong(),totalSummaryOffset:n.getLong(),uncompressBuffSize:n.getInt(),extensionOffset:n.getLong()};let r=yu,a={start:r,size:t.fullDataOffset-r+5};e=await this.loader.loadArrayBuffer(this.path,Oe(this.config,{range:a}));let o=t.nZoomLevels;n=new vt(new DataView(e)),this.zoomLevelHeaders=[],this.firstZoomDataOffset=Number.MAX_SAFE_INTEGER;for(let l=1;l<=o;l++){let c=o-l,h=new Nl(c,n);this.firstZoomDataOffset=Math.min(h.dataOffset,this.firstZoomDataOffset),this.zoomLevelHeaders[c]=h}if(t.autoSqlOffset>0){n.position=t.autoSqlOffset-r;let l=n.getString();l&&(this.autoSql=Hy(l))}if(t.totalSummaryOffset>0&&(n.position=t.totalSummaryOffset-r,this.totalSummary=new Ol(n)),t.chromTreeOffset>0)n.position=t.chromTreeOffset-r,this.chromTree=new Dl(n,r,this.genome);else throw"BigWig chromosome tree offset <= 0";return n.position=t.fullDataOffset-r,t.dataCount=n.getInt(),this.setDefaultVisibilityWindow(t),this.header=t,this.header}}async loadRPTree(e){let t=this.rpTreeCache[e];return t||(t=new Fl(e,this.config,this.littleEndian,this.loader),await t.load(),this.rpTreeCache[e]=t,t)}async getType(){return await this.loadHeader(),this.type}async getTrackType(){return await this.loadHeader(),this.type==="bigwig"?"wig":this.autoSql&&this.autoSql.table==="chromatinInteract"?"interact":"annotation"}setDefaultVisibilityWindow(e){if(this.type==="bigwig")this.visibilityWindow=-1;else{let t=this.genome?this.genome.getGenomeLength():3088286401;this.visibilityWindow=e.dataCount<1e3?-1:1e3*(t/e.dataCount)}}},Nl=class{constructor(e,t){this.index=e,this.reductionLevel=t.getInt(),this.reserved=t.getInt(),this.dataOffset=t.getLong(),this.indexOffset=t.getLong()}},Fl=class{constructor(e,t,n,s){this.config=t,this.loader=s,this.fileOffset=e,this.path=t.url,this.littleEndian=n}async load(){let e=this.fileOffset+Wy,t=oi(this.path)?this.loader:new Gs(this.config,xu);return this.rootNode=await this.readNode(e,t),this}async readNode(e,t){let n=await t.dataViewForRange({start:e,size:4},!1),s=new vt(n,this.littleEndian),a=s.getByte()===1;s.getByte();let o=s.getUShort();e+=4;let l=o*(a?jy:Gy),c={start:e,size:l};n=await t.dataViewForRange(c,!1);let h=new Array(o);if(s=new vt(n),a){for(let d=0;d<o;d++){let f={isLeaf:!0,startChrom:s.getInt(),startBase:s.getInt(),endChrom:s.getInt(),endBase:s.getInt(),dataOffset:s.getLong(),dataSize:s.getLong()};h[d]=f}return new Zs(h)}else{for(let d=0;d<o;d++){let f={isLeaf:!1,startChrom:s.getInt(),startBase:s.getInt(),endChrom:s.getInt(),endBase:s.getInt(),childOffset:s.getLong()};h[d]=f}return new Zs(h)}}async findLeafItemsOverlapping(e,t,n,s){let r=this;return new Promise(function(a,o){let l=[],c=new Set,h=oi(r.path)?r.loader:new Gs(r.config,xu);c.add(0),d(r.rootNode,0);function d(f,u){ku(f,e,t,n,s)&&f.items.forEach(function(_){ku(_,e,t,n,s)&&(_.isLeaf?l.push(_):_.childNode?d(_.childNode):(c.add(_.childOffset),r.readNode(_.childOffset,h).then(function(b){_.childNode=b,d(b,_.childOffset)}).catch(o)))}),u!==void 0&&c.delete(u),c.size===0&&a(l)}})}},Zs=class{constructor(e){this.items=e;let t=Number.MAX_SAFE_INTEGER,n=0,s=Number.MAX_SAFE_INTEGER,r=0,a,o;for(a=0;a<e.length;a++)o=e[a],t=Math.min(t,o.startChrom),n=Math.max(n,o.endChrom),s=Math.min(s,o.startBase),r=Math.max(r,o.endBase);this.startChrom=t,this.endChrom=n,this.startBase=s,this.endBase=r}},Dl=class{constructor(e,t,n){let s=e.getInt(),r=e.getInt(),a=e.getInt(),o=e.getInt(),l=e.getLong(),c=e.getLong(),h={},d=[];this.header={magic:s,blockSize:r,keySize:a,valSize:o,itemCount:l,reserved:c},this.chromToID=h,this.idToChrom=d,f(e,-1);function f(u,g){g>=0&&(u.position=g);let _=u.getByte();u.getByte();let b=u.getUShort(),w,p,m,v,x,R;if(_===1)for(w=0;w<b;w++)p=u.getFixedLengthTrimmedString(a),m=u.getInt(),u.getInt(),n&&(p=n.getChromosomeName(p)),h[p]=m,d[m]=p;else for(w=0;w<b;w++)p=u.getFixedLengthTrimmedString(a),v=u.getLong(),x=v-t,R=u.position,f(u,x),u.position=R}}};function ku(i,e,t,n,s){return i?(n>i.startChrom||n===i.startChrom&&s>=i.startBase)&&(e<i.endChrom||e===i.endChrom&&t<=i.endBase):(console.log("null item for "+e+" "+t+" "+s),!1)}var Ol=class{constructor(e){e?(this.basesCovered=e.getLong(),this.minVal=e.getDouble(),this.maxVal=e.getDouble(),this.sumData=e.getDouble(),this.sumSquares=e.getDouble(),Zy.call(this)):(this.basesCovered=0,this.minVal=0,this.maxVal=0,this.sumData=0,this.sumSquares=0,this.mean=0,this.stddev=0)}};function Zy(){let i=this.basesCovered;if(i>0){this.mean=this.sumData/i,this.stddev=Math.sqrt(this.sumSquares/(i-1));let e=this.minVal<0?this.mean-2*this.stddev:0,t=this.maxVal>0?this.mean+2*this.stddev:0;this.defaultRange={min:e,max:t}}}function Xy(i,e){let t;for(let n=0;n<e.length;n++){let s=e[n];if(s.reductionLevel<i){t=s;break}}return t}function Yy(i,e,t,n,s,r,a){let o=new vt(i),l=o.getInt(),c=o.getInt(),h=c,d=o.getInt(),f=o.getInt(),u=o.getInt(),g=o.getByte();o.getByte();let _=o.getUShort();if(l>=e&&l<=n){let b=0;for(;_-- >0;){let w;switch(g){case 1:h=o.getInt(),d=o.getInt(),w=o.getFloat();break;case 2:h=o.getInt(),w=o.getFloat(),d=h+u;break;case 3:w=o.getFloat(),h=c+b*f,d=h+u,b++;break}if(!(l<e||l===e&&d<t)){if(l>n||l===n&&h>=s)break;if(Number.isFinite(w)){let p=a[l];r.push({chr:p,start:h,end:d,value:w})}}}}}function Qy(){let e=By(this.header.definedFieldCount,this.header.fieldCount,this.autoSql,this.format);return function(t,n,s,r,a,o,l){let c=new vt(t);for(;c.remLength()>=13;){let h=c.getInt(),d=l[h],f=c.getInt(),u=c.getInt(),g=c.getString();if(!(h<n||h===n&&u<s)){if(h>r||h===r&&f>=a)break;if(u>0){let _={chr:d,start:f,end:u};o.push(_);let b=g.split("	");e(_,b)}}}}}function Ky(i,e,t,n,s,r,a,o){let l=new vt(i),c=8*4;for(;l.remLength()>=c;){let h=l.getInt(),d=a[h],f=l.getInt(),u=l.getInt(),g=l.getInt(),_=l.getFloat(),b=l.getFloat(),w=l.getFloat();l.getFloat();let p;switch(o){case"min":p=_;break;case"max":p=b;break;default:p=g===0?0:w/g}if(!(h<e||h===e&&u<t)){if(h>n||h===n&&f>=s)break;Number.isFinite(p)&&r.push({chr:d,start:f,end:u,value:p})}}}var Bl=class{constructor(e){this.data=tn(e).buffer}loadArrayBuffer(e,t){let n=t.range;return n?this.data.slice(n.start,n.start+n.size):this.data}async dataViewForRange(e,t){let n=Math.min(this.data.byteLength-e.start,e.size);return t?new Uint8Array(this.data,e.start,n):new DataView(this.data,e.start,n)}},Xs=class{constructor(e,t){this.reader=new Ll(e,t),this.genome=t,this.format=e.format||"bigwig",this.wgValues={},this.queryable=!0}async getFeatures({chr:e,start:t,end:n,bpPerPixel:s,windowFunction:r}){let a=this.reader.type==="bigwig",o=e.toLowerCase()==="all"?a?await this.getWGValues(r):[]:await this.reader.readFeatures(e,t,e,n,s,r);return a||um(o),o}async getHeader(){return this.reader.loadHeader()}getDefaultRange(){if(this.reader.totalSummary!==void 0)return this.reader.totalSummary.defaultRange}async defaultVisibilityWindow(){return this.reader.defaultVisibilityWindow}async getWGValues(e){let n=this.genome;if(this.wgValues[e])return this.wgValues[e];{let s=n.getGenomeLength()/1e3,r=await this.reader.readWGFeatures(s,e),a=[];for(let o of r){let l=o.chr,c=n.getCumulativeOffset(l),h=Object.assign({},o);h.chr="all",h.start=c+o.start,h.end=c+o.end,a.push(h)}return this.wgValues[e]=a,a}}supportsWholeGenome(){return this.reader.type==="bigwig"}async trackType(){return this.reader.getTrackType()}},Jy=1,Pl=class{constructor(e,t){this.config=e,this.genome=t,this.path=e.url,this.groupCache={},this.datasetCache={}}async readHeader(){if(this.magic!==void 0)return this;let e=await Ce.loadArrayBuffer(this.path,Oe(this.config,{range:{start:0,size:64e3}})),t=new vt(new DataView(e));if(this.magic=t.getInt(),this.version=t.getInt(),this.indexPos=t.getLong(),this.indexSize=t.getInt(),t.getInt(),this.version>=2){let r=t.getInt();for(this.windowFunctions=[];r-- >0;)this.windowFunctions.push(t.getString())}this.trackType=t.getString(),this.trackLine=t.getString();let n=t.getInt();for(this.trackNames=[];n-- >0;)this.trackNames.push(t.getString());this.genomeID=t.getString(),this.flags=t.getInt(),this.compressed=(this.flags&Jy)!==0,e=await Ce.loadArrayBuffer(this.path,Oe(this.config,{range:{start:this.indexPos,size:this.indexSize}})),t=new vt(new DataView(e)),this.datasetIndex={};let s=t.getInt();for(;s-- >0;){let r=t.getString(),a=t.getLong(),o=t.getInt();this.datasetIndex[r]={position:a,size:o}}for(this.groupIndex={},s=t.getInt();s-- >0;){let r=t.getString(),a=t.getLong(),o=t.getInt();this.groupIndex[r]={position:a,size:o}}return this}async readDataset(e,t,n){let s=e+"_"+t+"_"+n;if(this.datasetCache[s])return this.datasetCache[s];{await this.readHeader();let r=this.version<2?"":"/"+t,a=e.toLowerCase()==="all"||n===void 0?"0":n.toString(),o;t==="raw"?o="/"+e+"/raw":o="/"+e+"/z"+a+r;let l=this.datasetIndex[o];if(l===void 0)return;let c=await Ce.loadArrayBuffer(this.path,Oe(this.config,{range:{start:l.position,size:l.size}}));if(!c)return;let h=new vt(new DataView(c)),d=h.getInt(),f={};for(;d-- >0;)f[h.getString()]=h.getString();let u=h.getString(),g=h.getFloat(),_=h.getInt(),b=[];for(;_-- >0;)b.push({position:h.getLong(),size:h.getInt()});let w={name:o,attributes:f,dataType:u,tileWidth:g,tiles:b};return this.datasetCache[s]=w,w}}async readRootGroup(){let e=this.genome,t=this.groupCache["/"];if(t)return t;{let n=await this.readGroup("/"),s=n.chromosomes,r=n.maxZoom;r&&(this.maxZoom=Number(r));let a=n.totalCount;a&&(n.totalCount=Number(a));let o={};return s&&s.split(",").forEach(function(l){let c=e.getChromosomeName(l);o[c]=l}),this.chrAliasTable=o,this.groupCache["/"]=n,n}}async readGroup(e){let t=this.groupCache[e];if(t)return t;{await this.readHeader();let n=this.groupIndex[e];if(n===void 0)return;let s=await Ce.loadArrayBuffer(this.path,Oe(this.config,{range:{start:n.position,size:n.size}}));if(!s)return;let r=new vt(new DataView(s)),a={name:e},o=r.getInt();for(;o-- >0;){let l=r.getString(),c=r.getString();a[l]=c}return this.groupCache[e]=a,a}}async readTiles(e,t){if(e.sort(function(c,h){return c.position-h.position}),e=e.filter(function(c){return c.size>0}),e.length===0)return Promise.resolve([]);let n=e[0],s=e[e.length-1],r=n.position,a=s.position+s.size-r,o=await Ce.loadArrayBuffer(this.path,Oe(this.config,{range:{start:r,size:a}})),l=[];for(let c of e){let h=c.position-r,d=c.size;if(d>0){let f;this.compressed?f=Xo(o.slice(h,h+d)).buffer:f=o.slice(h,h+d);let u=new vt(new DataView(f)),g=u.getString(),_;switch(g){case"fixedStep":_=Su(u,t);break;case"variableStep":_=Cu(u,t);break;case"bed":case"bedWithName":_=Eu(u,t,g);break;default:throw"Unknown tile type: "+g}l.push(_)}}return l}async readTile(e,t){let n=await Ce.loadArrayBuffer(this.path,Oe(this.config,{range:{start:e.position,size:e.size}}));this.compressed&&(n=Xo(n).buffer);let s=new vt(new DataView(n)),r=s.getString();switch(r){case"fixedStep":return Su(s,t);case"variableStep":return Cu(s,t);case"bed":case"bedWithName":return Eu(s,t,r);default:throw"Unknown tile type: "+r}}};function Su(i,e){let t=i.getInt(),n=i.getInt(),s=i.getFloat(),r=[],a=e;for(;a-- >0;){let o=t,l=[];for(;o-- >0;)l.push(i.getFloat());r.push(l)}return{type:"fixedStep",start:n,span:s,data:r,nTracks:e,nPositions:t}}function Cu(i,e){let t=i.getInt(),n=i.getFloat(),s=i.getInt(),r=[],a=s;for(;a-- >0;)r.push(i.getInt());i.getInt();let o=[],l=e;for(;l-- >0;){a=s;let c=[];for(;a-- >0;)c.push(i.getFloat());o.push(c)}return{type:"variableStep",tileStart:t,span:n,start:r,data:o,nTracks:e,nPositions:s}}function Eu(i,e,t){let n=i.getInt(),s=n,r=[];for(;s-- >0;)r.push(i.getInt());s=n;let a=[];for(;s-- >0;)a.push(i.getInt());i.getInt();let o=[],l=e;for(;l-- >0;){let c=n,h=[];for(;c-- >0;)h.push(i.getFloat());o.push(h)}if(t==="bedWithName"){s=n;let c=[];for(;s-- >0;)c.push(i.getString())}return{type:t,start:r,end:a,data:o,nTracks:e,nPositions:n}}var Ys=class{constructor(e,t){this.genome=t,this.windowFunction=e.windowFunction||"mean",this.reader=new Pl(e,t),this.queryable=!0}async getFeatures({chr:e,start:t,end:n,bpPerPixel:s}){if(e.toLowerCase()==="all"){let r=[],a=this.genome;if(this.genome.wgChromosomeNames)for(let l of a.wgChromosomeNames){let c=a.getChromosome(l).bpLength;s=c/1e3;let h=await this._getFeatures(l,0,c,s);if(h)for(let d of h){let f=Object.assign({},d);f.chr="all",f.start=a.getGenomeCoordinate(d.chr,d.start),f.end=a.getGenomeCoordinate(d.chr,d.end),f._f=d,r.push(f)}}return r}else return this._getFeatures(e,t,n,s)}async _getFeatures(e,t,n,s){let r=new Zi(e,t,n),a=this.genome;if(!this.rootGroup&&(this.rootGroup=await this.reader.readRootGroup(),!this.normalizationFactor)){let p=this.rootGroup.totalCount;p&&(this.normalizationFactor=1e6/p)}r.bpPerPixel=s;let o=r2(e,s,a),l=this.reader.chrAliasTable[e],c=this.reader.maxZoom;l===void 0&&(l=e),c===void 0&&(c=-1);let h=o>c?"raw":this.windowFunction,d=await this.reader.readDataset(l,h,o);if(d==null)return[];let f=d.tileWidth,u=Math.floor(t/f),g=Math.floor(n/f),b=await this.reader.readTiles(d.tiles.slice(u,g+1),1),w=[];for(let p of b)switch(p.type){case"bed":e2(p,e,t,n,s,w);break;case"variableStep":t2(p,e,t,n,s,w);break;case"fixedStep":i2(p,e,t,n,s,w);break;default:throw"Unknown tile type: "+p.type}return w.sort(function(p,m){return p.start-m.start}),w}get supportsWholeGenome(){return!0}};function e2(i,e,t,n,s,r){let a=i.nPositions,o=i.start,l=i.end,c=i.data[0];for(let h=0;h<a;h++){let d=o[h],f=l[h];if(!(f<t)){if(d>n)break;r.push({chr:e,start:d,end:f,value:c[h]})}}}function t2(i,e,t,n,s,r){let a=i.nPositions,o=i.start,l=i.span,c=i.data[0];for(let h=0;h<a;h++){let d=o[h],f=d+l;if(!(f<t)){if(d>n)break;r.push({chr:e,start:d,end:f,value:c[h]})}}}function i2(i,e,t,n,s,r){let a=i.nPositions,o=i.start,l=i.span,c=i.data[0];for(let h=0;h<a;h++){let d=o+l;if(o>n)break;d>=t&&(Number.isNaN(c[h])||r.push({chr:e,start:o,end:d,value:c[h]})),o=d}}var n2=Math.log(2);function r2(i,e,t){var n=t.getChromosome(i).bpLength;return Math.ceil(Math.log(Math.max(0,n/(e*700)))/n2)}var zl=class{constructor(e,t){this.config=e,this.genome=t,this.queryable=!1,this.searchable=e.searchable!==!1,this.updateFeatures(e.features)}updateFeatures(e){e=s2(e,this.genome),dm(e),this.config.mappings&&a2(e,this.config.mappings),this.featureCache=new Wi(e,this.genome),(this.searchable||this.config.searchableFields)&&this.genome.addFeaturesToDB(e,this.config)}async getFeatures({chr:e,start:t,end:n,bpPerPixel:s,visibilityWindow:r}){let a=this.genome,o=a?a.getChromosomeName(e):e;return o.toLowerCase()==="all"?_c(this.featureCache.getAllFeatures(),this.genome,this.maxWGCount):this.featureCache.queryFeatures(o,t,n)}getAllFeatures(){return this.featureCache.getAllFeatures()}supportsWholeGenome(){return!0}};function s2(i,e){if(e)for(let t of i)t.chr=e.getChromosomeName(t.chr);return i}function a2(i,e){let t=Object.keys(e);i.forEach(function(n){t.forEach(function(s){n[s]=n[e[s]]})})}var o2=new Set(["bigwig","bw","bigbed","bb","biginteract","biggenepred","bignarrowpeak"]);function Bt(i,e){let t=i.format?i.format.toLowerCase():void 0;return i.features?new zl(i,e):o2.has(t)?new Xs(i,e):t==="tdf"?new Ys(i,e):new js(i,e)}var l2="nickel",h2=2/16,yc=e_(l2,h2),c2="rgb(190,190,190)",f2="rgba(155,185,129)",pm=yc,Er=class{constructor(e,t){if(this.url=e.url,e.name?this.name=e.name:e.url&&Ei(e.url)?this.name=e.url.name:e.url&&yt(e.url)&&!e.url.startsWith("data:")&&(this.name=Cs(e.url)),this.isUserDefined=e.isUserDefined,e.features)this.featureSource=new Hl(e.features,t);else{if(e.format)e.format=e.format.toLowerCase();else{let n=Cs(e.url);e.format=wc(n)}this.featureSource=e.featureSource||Bt(e,t)}this.isUserDefined===!0?(this.color=e.color||pm,this.headerColor=f2):(this.color=e.color||yc,this.headerColor=c2)}async getFeatures(e,t,n){return this.featureSource.getFeatures({chr:e,start:t,end:n})}async getAllFeatures(){return typeof this.featureSource.getAllFeatures=="function"?await this.featureSource.getAllFeatures():{}}addFeature(e){this.isUserDefined?this.featureSource.addFeature(e):console.error("Attempt to add ROI to non user-defined set")}removeFeature(e){this.isUserDefined?this.featureSource.removeFeature(e):console.error("Attempt to remove ROI from non user-defined set")}toJSON(){if(this.url)return{name:this.name,color:this.color,url:this.url,isUserDefined:this.isUserDefined};{let e=this.featureSource.getAllFeatures(),t=[];for(let n of Object.keys(e))for(let s of e[n])t.push(s);return{name:this.name,color:this.color,features:t,isUserDefined:this.isUserDefined}}}dispose(){for(let e of Object.keys(this))this[e]=void 0}},Au=3;function gm(i,e,t,n){let s=Math.round((i-t)/n),a=Math.round((e-t)/n)-s;return a<Au&&(a=Au,s-=1),{x:s,width:a}}var Hl=class{constructor(e,t){this.featureMap={},this.genome=t;for(let n of e){let s=t?t.getChromosomeName(n.chr):n.chr,r=this.featureMap[s];r||(r=[],this.featureMap[s]=r),r.push(n)}for(let n of Object.keys(this.featureMap))this.featureMap[n].sort((s,r)=>s.start-r.start)}getFeatures({chr:e,start:t,end:n}){if(e.toLowerCase()==="all")return _c(this.featureMap,this.genome);{let s=this.featureMap[e];return s?s.filter(r=>r.end>t&&r.start<n):[]}}getAllFeatures(){return this.featureMap}supportsWholeGenome(){return!0}addFeature(e){let t=this.featureMap[e.chr];t||(t=[],this.featureMap[e.chr]=t),t.push(e),t.sort((n,s)=>n.start-s.start)}removeFeature({chr:e,start:t,end:n}){if(this.featureMap[e]){let s=`${e}-${t}-${n}`;this.featureMap[e]=this.featureMap[e].filter(r=>s!==`${r.chr}-${r.start}-${r.end}`)}}},u2="rgba(68, 134, 247, 0.25)",Ul=class{constructor(e,t,n,s){this.rulerViewport=e,this.rulerSweeper=de.div({class:"igv-ruler-sweeper"}),t.appendChild(this.rulerSweeper),this.browser=n,this.referenceFrame=s,this.isMouseHandlers=void 0,this.addBrowserObserver()}addBrowserObserver(){let e=()=>{this.referenceFrame&&(mt.isWholeGenomeView(this.referenceFrame.chr)?this.removeMouseHandlers():this.addMouseHandlers())};this.boundObserverHandler=e.bind(this),this.browser.on("locuschange",this.boundObserverHandler)}removeBrowserObserver(){this.browser.off("locuschange",this.boundObserverHandler)}addMouseHandlers(){if(this.isMouseHandlers===!0)return;let e=1,t,n,s,r,a,o;this.boundContentMouseDownHandler=l.bind(this),this.rulerViewport.contentDiv.addEventListener("mousedown",this.boundContentMouseDownHandler);function l(d){t=!0,n=!0;let{x:f}=de.translateMouseCoordinates(d,this.rulerViewport.contentDiv);r=s=f,a=e,this.rulerSweeper.style.display="block",this.rulerSweeper.style.backgroundColor=d.shiftKey===!0?pm:u2,this.rulerSweeper.style.left=`${r}px`,this.rulerSweeper.style.width=`${a}px`}this.boundDocumentMouseMoveHandler=c.bind(this),document.addEventListener("mousemove",this.boundDocumentMouseMoveHandler);function c(d){let f;if(t&&n){let{x:u}=de.translateMouseCoordinates(d,this.rulerViewport.contentDiv);f=Math.max(Math.min(u,this.rulerViewport.contentDiv.clientWidth),0),o=f-s,a=Math.abs(o),this.rulerSweeper.style.width=`${a}px`,o<0&&(r=s+o,this.rulerSweeper.style.left=`${r}px`)}}this.boundDocumentMouseUpHandler=h.bind(this),document.addEventListener("mouseup",this.boundDocumentMouseUpHandler);function h(d){let f;t===!0&&n===!0&&(t=n=void 0,this.rulerSweeper.style.display="none",a>e&&(f={start:Math.floor(this.referenceFrame.calculateEnd(r)),end:Math.floor(this.referenceFrame.calculateEnd(r+a))},d.shiftKey===!0?this.browser.roiManager.updateUserDefinedROISet(Object.assign({chr:this.referenceFrame.chr},f)):(Bg(this.browser.genome.getChromosome(this.referenceFrame.chr).bpLength,f,this.browser.minimumBases()),d2(this.referenceFrame,f,this.rulerViewport.contentDiv.clientWidth),this.browser.updateViews(this.referenceFrame))))}this.isMouseHandlers=!0}removeMouseHandlers(){this.rulerViewport.contentDiv.removeEventListener("mousedown",this.boundContentMouseDownHandler),document.removeEventListener("mousemove",this.boundDocumentMouseMoveHandler),document.removeEventListener("mouseup",this.boundDocumentMouseUpHandler),this.isMouseHandlers=!1}dispose(){this.removeBrowserObserver(),this.removeMouseHandlers(),this.rulerSweeper.remove()}};function d2(i,e,t){i.start=Math.round(e.start),i.end=Math.round(e.end),i.bpPerPixel=(i.end-i.start)/t}var Ai=class{constructor(e){this.paired=!0,this.firstAlignment=e,this.chr=e.chr,this.readName=e.readName,e.start<e.mate.position?(this.start=e.start,this.scStart=e.scStart,this.connectingStart=e.start+e.lengthOnRef,this.connectingEnd=e.mate.position):(this.start=e.mate.position,this.scStart=this.start,this.connectingStart=e.mate.position,this.connectingEnd=e.start),this.end=Math.max(e.mate.position,e.start+e.lengthOnRef),this.lengthOnRef=this.end-this.start;let t=Math.max(this.end,e.scStart+e.scLengthOnRef);this.scLengthOnRef=t-this.scStart}setSecondAlignment(e){this.secondAlignment=e;let t=this.firstAlignment;e.start>t.start?this.connectingEnd=e.start:this.connectingStart=e.start+e.lengthOnRef,this.start=Math.min(t.start,e.start),this.end=Math.max(t.start+t.lengthOnRef,e.start+e.lengthOnRef),this.lengthOnRef=this.end-this.start,this.scStart=Math.min(t.scStart,e.scStart);let n=Math.max(t.scStart+t.scLengthOnRef,e.scStart+e.scLengthOnRef);this.scLengthOnRef=n-this.scStart}containsLocation(e,t){let n=t?this.scStart:this.start,s=t?this.scLengthOnRef:this.lengthOnRef;return e>=n&&e<=n+s}alignmentContaining(e,t){return this.firstAlignment.containsLocation(e,t)?this.firstAlignment:this.secondAlignment&&this.secondAlignment.containsLocation(e,t)?this.secondAlignment:void 0}popupData(e){let t=this.firstAlignment.popupData(e);return this.secondAlignment&&(t.push("-------------------------------"),t=t.concat(this.secondAlignment.popupData(e))),t}isPaired(){return!0}isMateMapped(){return!0}isProperPair(){return this.firstAlignment.isProperPair()}get fragmentLength(){return Math.abs(this.firstAlignment.fragmentLength)}firstOfPairStrand(){return this.firstAlignment.isFirstOfPair()?this.firstAlignment.strand:this.secondAlignment&&this.secondAlignment.isFirstOfPair()?this.secondAlignment.strand:this.firstAlignment.mate.strand}hasTag(e){return this.firstAlignment.hasTag(e)||this.secondAlignment&&this.secondAlignment.hasTag(e)}},$l=class{constructor(){this.alignments=[],this.score=void 0}findAlignment(e){let t=(s,r)=>r>=s.start&&r<s.start+s.lengthOnRef,n;for(let s=0;s<this.alignments.length;s++){let r=this.alignments[s];if(e>=r.start&&e<r.start+r.lengthOnRef){r.paired?r.firstAlignment&&t(r.firstAlignment,e)?n=r.firstAlignment:r.secondAlignment&&t(r.secondAlignment,e)&&(n=r.secondAlignment):n=r;break}}return n}getSortValue({position:e,option:t,tag:n},s){t||(t="BASE");let r=this.findAlignment(e);if(r===void 0)return Number.MAX_VALUE;switch(t){case"NUCLEOTIDE":case"BASE":return a(r,s,e);case"STRAND":return r.strand?1:-1;case"START":return r.start;case"TAG":return r.tags()[n];case"READ_NAME":return r.readName;case"INSERT_SIZE":return-Math.abs(r.fragmentLength);case"GAP_SIZE":return-r.gapSizeAt(e);case"MATE_CHR":return r.mate;case"MQ":return r.mq===void 0?Number.MAX_VALUE:-r.mq;case"ALIGNED_READ_LENGTH":return-r.lengthOnRef;default:return Number.MAX_VALUE}function a(o,l,c){let h,d=Math.floor(c)-l.start;if(d<l.sequence.length&&(h=l.sequence.charAt(d)),!h)return 0;let f=o.readBaseAt(c),u=o.readBaseQualityAt(c),g=l.coverageMap,_=Math.floor(c-g.bpStart),b=g.coverage[_],w=0;if(o.insertions)for(let p of o.insertions)p.start===c&&(w=-b.ins);if(f){if(h=h.toUpperCase(),f==="N"&&w===0)w=2;else if((h===f||f==="=")&&w===0)w=4-u/1e3;else if(f==="X"||h!==f){let p=b["pos"+f]+b["neg"+f];w-=p+u/1e3}}else{let p=b.del;p>0?w-=p:w===0&&(w=1)}return w}}},Tu=2;function ds(i){return i.isPaired()&&i.mate&&i.isMateMapped()&&i.chr===i.mate.chr&&(i.isFirstOfPair()||i.isSecondOfPair())&&!(i.isSecondary()||i.isSupplementary())}function p2(i){let e={},t=[];for(let n of i)for(let s of n.alignments)if(ds(s)){let r=e[s.readName];r?(r.setSecondAlignment(s),e[s.readName]=void 0):(r=new Ai(s),e[s.readName]=r,t.push(r))}else t.push(s);return t}function mm(i){let e=[];for(let t of i)for(let n of t.alignments)n instanceof Ai?(n.firstAlignment&&e.push(n.firstAlignment),n.secondAlignment&&e.push(n.secondAlignment)):e.push(n);return e}function ps(i,e,t,n){if(i){if(i.length===0)return[];{i.sort(function(h,d){return n?h.scStart-d.scStart:h.start-d.start});let s=[],r,a=0,o=0,l=new Set,c=()=>{r=new $l,s.push(r),a=0,o=0,l.clear()};for(c();i.length>0;)if(o>=0&&o<i.length){let h=i[o];l.add(h),r.alignments.push(h),a=n?h.scStart+h.scLengthOnRef+Tu:h.start+h.lengthOnRef+Tu,o=g2(i,d=>(n?d.scStart:d.start)>a,o)}else i=i.filter(h=>!l.has(h)),c();return s}}else return}function g2(i,e,t){let n=t-1,s=i.length;for(;1+n<s;){let r=n+(s-n>>1);e(i[r])?s=r:n=r}return s}var li=class{constructor(e,t,n,{samplingWindowSize:s,samplingDepth:r,pairsSupported:a,alleleFreqThreshold:o}){this.chr=e,this.start=Math.floor(t),this.end=Math.ceil(n),this.length=n-t,this.alleleFreqThreshold=o===void 0?.2:o,this.coverageMap=new Vl(e,t,n,this.alleleFreqThreshold),this.alignments=[],this.downsampledIntervals=[],this.samplingWindowSize=s===void 0?100:s,this.samplingDepth=r===void 0?1e3:r,this.pairsSupported=a===void 0?!0:a,this.paired=!1,this.pairsCache={},this.downsampledReads=new Set,this.currentBucket=new Qs(this.start,this.start+this.samplingWindowSize,this),this.filter=function(c){return c.isMapped()&&!c.isFailsVendorQualityCheck()}}push(e){this.filter(e)!==!1&&(this.coverageMap.incCounts(e),!(this.pairsSupported&&this.downsampledReads.has(e.readName))&&(e.start>=this.currentBucket.end&&(this.finishBucket(),this.currentBucket=new Qs(e.start,e.start+this.samplingWindowSize,this)),this.currentBucket.addAlignment(e)))}forEach(e){this.alignments.forEach(e)}finish(){this.currentBucket!==void 0&&this.finishBucket(),this.alignments.sort(function(e,t){return e.start-t.start}),this.pairsCache=void 0,this.downsampledReads=void 0}contains(e,t,n){return this.chr===e&&this.start<=t&&this.end>=n}hasDownsampledIntervals(){return this.downsampledIntervals&&this.downsampledIntervals.length>0}finishBucket(){this.alignments=this.alignments.concat(this.currentBucket.alignments),this.currentBucket.downsampledCount>0&&this.downsampledIntervals.push(new ql(this.currentBucket.start,this.currentBucket.end,this.currentBucket.downsampledCount)),this.paired=this.paired||this.currentBucket.paired}setViewAsPairs(e){let t;e?t=p2(this.packedAlignmentRows):t=mm(this.packedAlignmentRows),this.packedAlignmentRows=ps(t,this.start,this.end)}setShowSoftClips(e){let t=this.allAlignments();this.packedAlignmentRows=ps(t,this.start,this.end,e)}repack(e,t){let n=this.allAlignments();this.packedAlignmentRows=ps(n,this.start,this.end,t)}allAlignments(){let e=[];for(let t of this.packedAlignmentRows)for(let n of t.alignments)e.push(n);return e}getMax(e,t){return this.coverageMap.getMax(e,t)}sortRows(e){let t=[],n=[];for(let s of this.packedAlignmentRows)s.findAlignment(e.position)!==void 0?t.push(s):n.push(s);t.sort((s,r)=>{let a=e.direction,o=s.getSortValue(e,this),l=r.getSortValue(e,this);if(l===void 0&&l!==void 0)return 1;if(o!==void 0&&l===void 0)return-1;let c=o>l?1:o<l?-1:0;return a===!0?c:-c});for(let s of n)t.push(s);this.packedAlignmentRows=t}},Qs=class{constructor(e,t,n){this.start=e,this.end=t,this.alignments=[],this.downsampledCount=0,this.samplingDepth=n.samplingDepth,this.pairsSupported=n.pairsSupported,this.downsampledReads=n.downsampledReads,this.pairsCache=n.pairsCache}addAlignment(e){var t,n,s;if(this.pairsSupported&&ds(e)&&(s=this.pairsCache[e.readName],s)){s.setSecondAlignment(e),this.pairsCache[e.readName]=void 0;return}this.alignments.length<this.samplingDepth?this.pairsSupported&&ds(e)?(s=new Ai(e),this.paired=!0,this.pairsCache[e.readName]=s,this.alignments.push(s)):this.alignments.push(e):(t=Math.floor(Math.random()*(this.samplingDepth+this.downsampledCount-1)),t<this.samplingDepth?(n=this.alignments[t],this.pairsSupported&&ds(e)?(this.pairsCache[n.readName]!==void 0&&(this.pairsCache[n.readName]=void 0),s=new Ai(e),this.paired=!0,this.pairsCache[e.readName]=s,this.alignments[t]=s):this.alignments[t]=e,this.downsampledReads.add(n.readName)):this.downsampledReads.add(e.readName),this.downsampledCount++)}},Vl=class{constructor(e,t,n,s){this.chr=e,this.bpStart=t,this.length=n-t,this.coverage=new Array(this.length),this.maximum=0,this.threshold=s,this.qualityWeight=!0}getMax(e,t){let n=0,s=this.coverage.length;for(let r=0;r<s;r++){let a=this.bpStart+r;if(a>t)break;let o=this.coverage[r];a>=e&&o&&(n=Math.max(n,o.total))}return n}incCounts(e){var t=this;if(e.blocks===void 0?n(e):e.blocks.forEach(function(s){n(s)}),e.gaps){for(let s of e.gaps)if(s.type==="D"){let r=s.start-t.bpStart;for(let a=r;a<r+s.len;a++)a<0||(this.coverage[a]||(this.coverage[a]=new ar(t.threshold)),this.coverage[a].del++)}}if(e.insertions)for(let s of e.insertions){let r=s.start-this.bpStart;r<0||(this.coverage[r]||(this.coverage[r]=new ar(t.threshold)),this.coverage[r].ins++)}function n(s){if(s.type==="S")return;let r=e.seq,a=e.qual,o=s.seqOffset;for(let l=s.start-t.bpStart,c=0;c<s.len;l++,c++){t.coverage[l]||(t.coverage[l]=new ar(t.threshold));let h=r==null?"N":r.charAt(o+c),d=e.strand?"pos"+h:"neg"+h,f=a&&o+c<a.length?a[o+c]:30;t.coverage[l][d]+=1,t.coverage[l]["qual"+h]+=f,t.coverage[l].total+=1,t.coverage[l].qual+=f,t.maximum=Math.max(t.coverage[l].total,t.maximum)}}}},ar=class{constructor(e){this.qualityWeight=!0,this.posA=0,this.negA=0,this.posT=0,this.negT=0,this.posC=0,this.negC=0,this.posG=0,this.negG=0,this.posN=0,this.negN=0,this.pos=0,this.neg=0,this.qualA=0,this.qualT=0,this.qualC=0,this.qualG=0,this.qualN=0,this.qual=0,this.total=0,this.del=0,this.ins=0,this.threshold=e}hoverText(){let e=this.posA+this.posT+this.posC+this.posG+this.posN,t=this.negA+this.negT+this.negC+this.negG+this.negN;return`${this.total} (${e}+, ${t}-)`}isMismatch(e){let t=this.threshold*(this.qualityWeight&&this.qual?this.qual:this.total),n=0;for(let s of["A","T","C","G"])s!==e&&(n+=this.qualityWeight&&this.qual?this["qual"+s]:this["pos"+s]+this["neg"+s]);return n>=t}},ql=class{constructor(e,t,n){this.start=e,this.end=t,this.counts=n}popupData(e){return[{name:"start",value:this.start+1},{name:"end",value:this.end},{name:"# downsampled:",value:this.counts}]}},Wl=class{constructor(e){let t=e.split(",");this.chr=t[0],this.start=parseInt(t[1]),this.strand=t[2].charAt(0),this.mapQ=parseInt(t[4]),this.numMismatches=parseInt(t[5]),this.lenOnRef=_t.computeLengthOnReference(t[3])}printString(){return this.chr+":"+De(this.start)+"-"+De(this.start+this.lenOnRef)+" ("+this.strand+") = "+De(this.lenOnRef)+"bp @MAPQ: "+this.mapQ+" NM: "+this.numMismatches}};function bm(i){return i.split(";").filter(t=>t.length>0).map(t=>new Wl(t))}var m2=1,b2=2,w2=4,v2=8,_2=16,y2=32,x2=64,k2=128,S2=256,C2=512,E2=1024,A2=2048,T2={c:1,C:1,s:2,S:2,i:4,I:4,f:4},Mu=50,Tn=class{constructor(){this.hidden=!1}isMapped(){return(this.flags&w2)===0}isPaired(){return(this.flags&m2)!==0}isProperPair(){return(this.flags&b2)!==0}isFirstOfPair(){return(this.flags&x2)!==0}isSecondOfPair(){return(this.flags&k2)!==0}isSecondary(){return(this.flags&S2)!==0}isSupplementary(){return(this.flags&A2)!==0}isFailsVendorQualityCheck(){return(this.flags&C2)!==0}isDuplicate(){return(this.flags&E2)!==0}isMateMapped(){return(this.flags&v2)===0}isNegativeStrand(){return(this.flags&_2)!==0}isMateNegativeStrand(){return(this.flags&y2)!==0}hasTag(e){return(this.tagDict||Iu(this.tagBA)).hasOwnProperty(e)}tags(){return this.tagDict||(this.tagBA?(this.tagDict=Iu(this.tagBA),this.tagBA=void 0):this.tagDict={}),this.tagDict}containsLocation(e,t){let n=t?this.scStart:this.start,s=t?this.scLengthOnRef:this.lengthOnRef;return e>=n&&e<=n+s}popupData(e){let t=[];if(e=Math.floor(e),this.insertions){let l=this.seq;for(let c of this.insertions){var n=c.start;if(e===n||e===n-1)return t.push({name:"Insertion",value:l.substr(c.seqOffset,c.len)}),t.push({name:"Location",value:n}),t}}t.push({name:"Read Name",value:this.readName}),t.push("<hr/>"),t.push({name:"Alignment Start",value:De(1+this.start),borderTop:!0}),t.push({name:"Read Strand",value:this.strand===!0?"(+)":"(-)",borderTop:!0});let s=this.cigar;if(s&&s.length>Mu){let l=Mu/2;s=`${s.substring(0,l-2)} ... ${s.substring(s.length-l+2)}`}t.push({name:"Cigar",value:s}),t.push({name:"Mapping Quality",value:this.mq}),t.push({name:"Secondary",value:o(this.isSecondary())}),t.push({name:"Supplementary",value:o(this.isSupplementary())}),t.push({name:"Duplicate",value:o(this.isDuplicate())}),t.push({name:"Failed QC",value:o(this.isFailsVendorQualityCheck())}),this.isPaired()&&(t.push("<hr/>"),t.push({name:"First in Pair",value:!this.isSecondOfPair(),borderTop:!0}),t.push({name:"Mate is Mapped",value:o(this.isMateMapped())}),this.pairOrientation&&t.push({name:"Pair Orientation",value:this.pairOrientation}),this.isMateMapped()&&(t.push({name:"Mate Chromosome",value:this.mate.chr}),t.push({name:"Mate Start",value:this.mate.position+1}),t.push({name:"Mate Strand",value:this.mate.strand===!0?"(+)":"(-)"}),t.push({name:"Insert Size",value:this.fragmentLength})));let r=this.tags();if(r.hasOwnProperty("SA")){t.push("<hr/>"),t.push({name:"Supplementary Alignments",value:""});let l=bm(r.SA);if(l){t.push("<ul>");for(let c of l)t.push(`<li>${c.printString()}</li>`);t.push("</ul>")}}let a=new Set(["SA","MD"]);t.push("<hr/>");for(let l in r)a.has(l)||t.push({name:l,value:r[l]});return t.push({name:"Hidden Tags",value:"SA, MD"}),t.push("<hr/>"),t.push({name:"Genomic Location: ",value:De(1+e)}),t.push({name:"Read Base:",value:this.readBaseAt(e)}),t.push({name:"Base Quality:",value:this.readBaseQualityAt(e)}),t;function o(l){return l?"Yes":"No"}}readBaseAt(e){let t=Ru(this.blocks,e);if(t){if(this.seq==="*")return"*";{let n=t.seqIndexAt(e);return this.seq[n]}}else return}readBaseQualityAt(e){let t=Ru(this.blocks,e);if(t){if(this.qual==="*")return 30;{let n=t.seqIndexAt(e);return n>=0&&this.qual&&n<this.qual.length?this.qual[n]:30}}else return}gapSizeAt(e){if(this.gaps){for(let t of this.gaps)if(e>=t.start&&e<t.start+t.len)return t.len}return 0}softClippedBlocks(){let e,t,n;for(let s of this.blocks)s.type==="S"?n?t=s:e=s:s.type!=="H"&&(n=!0);return{left:e,right:t}}};function Ru(i,e){for(let t=0;t<i.length;t++){let n=i[t];if(e>=n.start&&e<n.start+n.len)return n}}function Iu(i){let e=0,t=i.length,n={};for(;e<t;){let r=String.fromCharCode(i[e])+String.fromCharCode(i[e+1]);e+=2;let a=String.fromCharCode(i[e++]),o;if(a==="A")o=String.fromCharCode(i[e]),e++;else if(a==="i"||a==="I")o=Lu(i,e),e+=4;else if(a==="c")o=I2(i,e),e++;else if(a==="C")o=L2(i,e),e++;else if(a==="s"||a==="S")o=M2(i,e),e+=2;else if(a==="f")o=R2(i,e),e+=4;else if(a==="Z")for(o="";;){var s=i[e++];if(s===0)break;o+=String.fromCharCode(s)}else if(a==="B"){let l=String.fromCharCode(i[e++]),c=T2[l];if(c===void 0){n[r]=`Error: unknown element type '${l}'`;break}let h=Lu(i,e);e+=4+h*c,o="[not shown]"}else{o="Error unknown type: "+a,n[r]=o;break}n[r]=o}return n}function Lu(i,e){return i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e]}function M2(i,e){return i[e+1]<<8|i[e]}function R2(i,e){return new DataView(i.buffer).getFloat32(e)}function I2(i,e){return new DataView(i.buffer).getInt8(e)}function L2(i,e){return new DataView(i.buffer).getUint8(e)}var Gt=class{constructor(e){e&&Object.assign(this,e)}seqIndexAt(e){return Math.floor(e)-this.start+this.seqOffset}},Ks=class{constructor(e){e||(e={}),this.vendorFailed=e.vendorFailed===void 0?!0:e.vendorFailed,this.duplicates=e.duplicates===void 0?!0:e.duplicates,this.secondary=e.secondary||!1,this.supplementary=e.supplementary||!1,this.mqThreshold=e.mqThreshold===void 0?0:e.mqThreshold,e.readgroups&&(this.readgroups=new Set(e.readgroups))}pass(e){if(this.vendorFailed&&e.isFailsVendorQualityCheck()||this.duplicates&&e.isDuplicate()||this.secondary&&e.isSecondary()||this.supplementary&&e.isSupplementary()||e.mq<this.mqThreshold)return!1;if(this.readgroups){var t=e.tags().RG;return this.readgroups.has(t)}return!0}},Nu=["=","A","C","x","G","x","x","x","T","x","x","x","x","x","x","N"],Fu=["M","I","D","N","S","H","P","=","X","?","?","?","?","?","?","?"],Du=16,Ou=32,N2=new Uint8Array([66,65,77,1]),F2=pt(N2,0),D2=.2,O2=100,B2=500,so=1e4,_t={readHeader:function(i,e,t){return Ce.loadArrayBuffer(i,e).then(function(n){var s,r,a;return r=bi(n),a=r,s=_t.decodeBamHeader(a,t),s})},decodeBamHeader:function(i,e){var t,n,s,r,a,o,l;if(t=pt(i,0),t!==F2)throw new Error("BAM header errror: bad magic number.  This could be caused by either a corrupt or missing file.");n=pt(i,4),s="";for(var c=0;c<n;++c)s+=String.fromCharCode(i[c+8]);var h=pt(i,n+8),d=n+12;for(r={},a=[],o={},c=0;c<h;++c){for(var f=pt(i,d),u="",g=0;g<f-1;++g)u+=String.fromCharCode(i[d+4+g]);pt(i,d+f+4),r[u]=c,a[c]=u,e&&(l=e.getChromosomeName(u),o[l]=u),d=d+8+f}return{magicNumber:t,size:d,chrNames:a,chrToIndex:r,chrAliasTable:o}},bam_tag2cigar:function(i,e,t,n,s,r){function a(v){return v==="C"||v==="c"||v==="A"?1:v==="S"||v==="s"?2:v==="I"||v==="i"||v==="f"?4:0}if(r.length!==1||s.start<0)return!1;for(var o=t+(n+1>>1)+n;o+4<e;){var l=String.fromCharCode(i[o])+String.fromCharCode(i[o+1]);if(l==="CG")break;var c=String.fromCharCode(i[o+2]);if(c==="B"){c=String.fromCharCode(i[o+3]);var h=a(c),d=pt(i,o+4);o+=8+h*d}else if(c==="Z"||c==="H")for(o+=3;i[o++]!==0;);else o+=3+a(c)}if(o>=e||String.fromCharCode(i[o+2])!=="B"||String.fromCharCode(i[o+3])!=="I")return!1;var f=pt(i,o+4),u=o+8;if(u+f*4>e)return!1;var g="",_=0;r.length=0,o=u;for(var b=0;b<f;++b,o+=4){var w=pt(i,o),p=w>>4,m=Fu[w&15];(m==="M"||m==="EQ"||m==="X"||m==="D"||m==="N"||m==="=")&&(_+=p),g=g+p+m,r.push({len:p,ltr:m})}return s.cigar=g,s.lengthOnRef=_,!0},decodeBamRecords:function(i,e,t,n,s,r,a,o){for(;e<i.length;){let f=pt(i,e),u=e+f+4,g=new Tn,_=pt(i,e+4),b=pt(i,e+8);if(u>i.length)return;if(_<0){e=u;continue}else{if(s!==void 0&&(_>s||b>a))return!0;if(s!==void 0&&_<s){e=u;continue}}let w=pt(i,e+12),p=(w&65280)>>8,m=w&255,v=pt(i,e+16),x=(v&4294901760)>>16,R=v&65535,M=pt(i,e+20),C=pt(i,e+24),L=pt(i,e+28),y=pt(i,e+32),E=[];for(let S=0;S<m-1;++S)E.push(String.fromCharCode(i[e+36+S]));E=E.join("");let k=0,A="",I=e+36+m,F=[],X;for(let S=0;S<R;++S){var l=pt(i,I),c=l>>4,h=Fu[l&15];(h==="M"||h==="EQ"||h==="X"||h==="D"||h==="N"||h==="=")&&(k+=c),A=A+c+h,I+=4,X={len:c,ltr:h},F.push(X)}if(g.chr=n[_],g.start=b,g.flags=x,g.strand=!(x&Du),g.readName=E,g.cigar=A,g.lengthOnRef=k,g.fragmentLength=y,g.mq=p,_t.bam_tag2cigar(i,u,I,M,g,F),g.end=g.start+g.lengthOnRef,g.end<r){e=u;continue}let U=[],V=M+1>>1;for(let S=0;S<V;++S){var d=i[I+S];U.push(Nu[(d&240)>>4]),U.push(Nu[d&15])}U=U.slice(0,M).join(""),I+=V;let q=[];for(let S=0;S<M;++S)q.push(i[I+S]);I+=M,C>=0&&(g.mate={chr:n[C],position:L,strand:!(x&Ou)}),g.seq=U,g.qual=q,g.tagBA=new Uint8Array(i.buffer.slice(I,u)),this.setPairOrientation(g),(o===void 0||o.pass(g))&&(Bu(g,F),t.push(g)),e=u}},decodeSamRecords:function(i,e,t,n,s,r){var a,o,l,c,h,d,f,u,g,_,b;for(a=Ji(i),c=a.length,b=!1,o=0;o<c;o++)if(h=a[o].split("	"),g=new Tn,g.chr=h[2],g.start=Number.parseInt(h[3])-1,g.flags=Number.parseInt(h[1]),g.readName=h[0],g.strand=!(g.flags&Du),g.mq=Number.parseInt(h[4]),g.cigar=h[5],g.fragmentLength=Number.parseInt(h[8]),g.seq=h[9],!(g.chr==="*"||!g.isMapped())){if(g.chr!==t){if(b)break;continue}else if(g.start>s)break;if(u=0,_=P2(g.cigar),_.forEach(function(w){var p=w.len,m=w.ltr;(m==="M"||m==="EQ"||m==="X"||m==="D"||m==="N"||m==="=")&&(u+=p)}),g.lengthOnRef=u,!(g.start+u<n)){for(d=h[10],g.qual=[],l=0;l<d.length;l++)g.qual[l]=d.charCodeAt(l)-33;g.tagDict=h.length<11?{}:H2(h.slice(11)),g.isMateMapped()&&(f=h[6],g.mate={chr:f==="="?g.chr:f,position:Number.parseInt(h[7]),strand:!(g.flags&Ou)}),this.setPairOrientation(g),(r===void 0||r.pass(g))&&(Bu(g,_),e.push(g))}}},setReaderDefaults:function(i,e){i.filter=new Ks(e.filter),e.readgroup&&(i.filter.readgroups=new Set([e.readgroup])),i.alleleFreqThreshold=e.alleleFreqThreshold===void 0?D2:e.alleleFreqThreshold,i.samplingWindowSize=e.samplingWindowSize===void 0?O2:e.samplingWindowSize,i.samplingDepth=e.samplingDepth===void 0?B2:e.samplingDepth,i.samplingDepth>so&&(console.log("Warning: attempt to set sampling depth > maximum value of "+so),i.samplingDepth=so),e.viewAsPairs?i.pairsSupported=!0:i.pairsSupported=e.pairsSupported===void 0?!0:e.pairsSupported},setPairOrientation:function(i){if(i.isMapped()&&i.mate&&i.isMateMapped()&&i.mate.chr===i.chr){var e=i.strand?"F":"R",t=i.mate,n=t.strand?"F":"R",s=" ",r=" ";i.isFirstOfPair()?(s="1",r="2"):i.isSecondOfPair()&&(s="2",r="1");var a=[],o=i.fragmentLength,l=i.end-i.start;if(o===0){var c=i.start<t.position?t.position+l:t.position-l;o=c-i.start}o>0?(a[0]=e,a[1]=s,a[2]=n,a[3]=r):(a[2]=e,a[3]=s,a[0]=n,a[1]=r),i.pairOrientation=a.join("")}},computeLengthOnReference:function(i){let e=0,t="";for(let n=0;n<i.length;n++){let s=i.charCodeAt(n);if(s>47&&s<58)t+=i.charAt(n);else{switch(s){case 78:case 68:case 77:case 61:case 88:e+=parseInt(t.toString())}t=""}}return e}};function Bu(i,e){let t=[],n,s,r=0,a=i.start;i.scStart=i.start,i.scLengthOnRef=i.lengthOnRef;for(let o of e){let l;switch(o.ltr){case"H":break;case"P":break;case"S":l=a,i.scLengthOnRef+=o.len,t.length===0&&(i.scStart-=o.len,l-=o.len),t.push(new Gt({start:l,seqOffset:r,len:o.len,type:"S"})),r+=o.len;break;case"N":case"D":s===void 0&&(s=[]),s.push({start:a,len:o.len,type:o.ltr}),a+=o.len;break;case"I":n===void 0&&(n=[]),n.push(new Gt({start:a,len:o.len,seqOffset:r,type:"I"})),r+=o.len;break;case"M":case"EQ":case"=":case"X":t.push(new Gt({start:a,seqOffset:r,len:o.len,type:"M"})),r+=o.len,a+=o.len;break;default:console.log("Error processing cigar element: "+o.len+o.ltr)}}i.blocks=t,i.insertions=n,i.gaps=s}function pt(i,e){return i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e]}function P2(i){var e,t,n,s,r,a,o,l;for(e=[],t=[],r=null,s=i.length,n=0;n<s;n++)a=i.charAt(n),z2(a)?t.push(a):(o=a,l=Number.parseInt(t.join("")),t=[],r!==null&&r.ltr===o?r.len+=l:(r={len:l,ltr:o},e.push(r)));return e}function z2(i){var e=i.charCodeAt(0);return e>=48&&e<=57}function H2(i){var e={};return i.forEach(function(t){var n=t.split(":");e[n[0]]=n[2]}),e}var jl=class{constructor(e,t){this.config=e,this.genome=t,this.bamPath=e.url,this.isDataUri=oi(e.url),_t.setReaderDefaults(this,e)}async readAlignments(e,t,n){if(this.alignmentCache){let s=this.header,r=s.chrAliasTable.hasOwnProperty(e)?s.chrAliasTable[e]:e,a=this.alignmentCache.queryFeatures(r,t,n),o=new li(e,t,n,this.config);for(let l of a)o.push(l);return o.finish(),o}else if(this.isDataUri){let s=U2(this.bamPath),r=bi(s.buffer);return this.parseAlignments(r),this.fetchAlignments(e,t,n)}else{let s=await Ce.loadArrayBuffer(this.bamPath,Oe(this.config)),r=bi(s);return this.parseAlignments(r),this.fetchAlignments(e,t,n)}}parseAlignments(e){let t=[];this.header=_t.decodeBamHeader(e),_t.decodeBamRecords(e,this.header.size,t,this.header.chrNames),this.alignmentCache=new Wi(t,this.genome)}fetchAlignments(e,t,n){let s=this.header.chrAliasTable.hasOwnProperty(e)?this.header.chrAliasTable[e]:e,r=this.alignmentCache.queryFeatures(s,t,n),a=new li(e,t,n,this.config);for(let o of r)a.push(o);return a.finish(),a}};function U2(i){let e=i.split(","),t=e[0].split(":")[1],n=e[1];t.indexOf("base64")>=0?n=atob(n):n=decodeURI(n);let s=new Uint8Array(n.length);for(var r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return s}var Js=class{constructor(e,t){this.config=e,this.genome=t,this.bamPath=e.url,this.baiPath=e.indexURL,_t.setReaderDefaults(this,e),this._blockLoader=new Vs(e)}async readAlignments(e,t,n){let s=await this.getChrIndex(),r=this.chrAliasTable.hasOwnProperty(e)?this.chrAliasTable[e]:e,a=s[r],o=new li(e,t,n,this.config);if(a===void 0)return o;{let c=(await this.getIndex()).chunksForRange(a,t,n);if(!c||c.length===0)return o;for(let h of c){let d=await this._blockLoader.getData(h.minv,h.maxv);if(_t.decodeBamRecords(d,h.minv.offset,o,this.indexToChr,a,t,n,this.filter))break}return o.finish(),o}}async getHeader(){if(!this.header){let e=this.genome,t=await this.getIndex(),n;if(t.firstBlockPosition){let r=Oe(this.config,{range:{start:t.firstBlockPosition,size:26}}),a=await Ce.loadArrayBuffer(this.bamPath,r),o=Rg(a);n=t.firstBlockPosition+o}else n=64e3;let s=Oe(this.config,{range:{start:0,size:n}});this.header=await _t.readHeader(this.bamPath,s,e)}return this.header}async getIndex(){let e=this.genome;return this.index||(this.index=await am(this.baiPath,this.config,e)),this.index}async getChrIndex(){if(this.chrToIndex)return this.chrToIndex;{let e=await this.getHeader();return this.chrToIndex=e.chrToIndex,this.indexToChr=e.chrNames,this.chrAliasTable=e.chrAliasTable,this.chrToIndex}}},Gl=class{constructor(e,t){this.config=e,this.genome=t;let n={};e.sources.sequences.forEach(function(s){let r=t?t.getChromosomeName(s):s;n[r]=$2(e,t,s)}),this.bamReaders=n,_t.setReaderDefaults(this,e)}async readAlignments(e,t,n){return this.bamReaders.hasOwnProperty(e)?await this.bamReaders[e].readAlignments(e,t,n):new li(e,t,n,this.config)}};function $2(i,e,t){let n={url:i.sources.url.replace("$CHR",t)};i.sources.indexURL&&(n.indexURL=i.sources.indexURL.replace("$CHR",t));let s=Object.assign(i,n);return new Js(s,e)}var wm=function(i,e){this.config=i,this.genome=e,_t.setReaderDefaults(this,i)};wm.prototype.readAlignments=function(i,e,t){var n=this;return V2.call(n).then(function(s){var r,a;return r=s.chrAliasTable.hasOwnProperty(i)?s.chrAliasTable[i]:i,a=n.config.url+"?reference="+n.config.referenceFile+"&file="+n.config.alignmentFile+"&region="+r+":"+e+"-"+t,Ce.loadString(a,Oe(n.config)).then(function(o){var l;return s.chrToIndex[r],l=new li(i,e,t,n.config),_t.decodeSamRecords(o,l,r,e,t,n.filter),l})})};function V2(){let i=this,e=this.genome;if(this.header)return Promise.resolve(this.header);{let t=this.config.url+"?file="+this.config.alignmentFile+"&options=-b,-H",n=Oe(this.config);return _t.readHeader(t,n,e).then(function(s){return i.header=s,s})}}var Zl=class extends Cr{constructor(e,t){super(e,t),_t.setReaderDefaults(this,e)}async readAlignments(e,t,n){if(!this.header){let c=await this.readHeaderData(),h=bi(c.buffer);this.header=_t.decodeBamHeader(h,this.genome),this.chrAliasTable=new Map;for(let d of Object.keys(this.header.chrAliasTable))this.chrAliasTable.set(d,this.header.chrAliasTable[d])}let s=this.chrAliasTable.has(e)?this.chrAliasTable.get(e):e,r=await this.readData(s,t,n),a=bi(r.buffer),o=this.header.chrToIndex[e],l=new li(e,t,n,this.config);return _t.decodeBamRecords(a,this.header.size,l,this.header.chrNames,o,t,n),l.finish(),l}};var q2=()=>{var i={368:function(s,r,a){var o=this&&this.__awaiter||function(_,b,w,p){return new(w||(w=Promise))(function(m,v){function x(C){try{M(p.next(C))}catch(L){v(L)}}function R(C){try{M(p.throw(C))}catch(L){v(L)}}function M(C){var L;C.done?m(C.value):(L=C.value,L instanceof w?L:new w(function(y){y(L)})).then(x,R)}M((p=p.apply(_,b||[])).next())})},l=this&&this.__importDefault||function(_){return _&&_.__esModule?_:{default:_}};Object.defineProperty(r,"__esModule",{value:!0});let c=l(a(4105)),h=l(a(1269)),d=a(597),f=a(3427),u=a(8577);function g(_,b){if(b.some(M=>M===void 0))throw new u.CramMalformedError("invalid .crai index file");let[w,p,m,v,x,R]=b;_[w]||(_[w]=[]),_[w].push({start:p,span:m,containerStart:v,sliceStart:x,sliceBytes:R})}r.default=class{constructor(_){this.filehandle=(0,f.open)(_.url,_.path,_.filehandle),this._parseCache=new c.default({cache:new h.default({maxSize:1}),fill:(b,w)=>this.parseIndex()})}parseIndex(){let _={};return this.filehandle.readFile().then(b=>b[0]===31&&b[1]===139?(0,d.unzip)(b):b).then(b=>{if(b.length>4&&b.readUInt32LE(0)===21578050)throw new u.CramMalformedError("invalid .crai index file. note: file appears to be a .bai index. this is technically legal but please open a github issue if you need support");let w=[],p="";for(let m=0;m<b.length;m+=1){let v=b[m];if(v>=48&&v<=57||!p&&v===45)p+=String.fromCharCode(v);else if(v===9)w.push(Number.parseInt(p,10)),p="";else if(v===10)w.push(Number.parseInt(p,10)),p="",g(_,w),w=[];else if(v!==13&&v!==32)throw new u.CramMalformedError("invalid .crai index file")}return p&&w.push(Number.parseInt(p,10)),w.length===6&&g(_,w),Object.entries(_).forEach(([m,v])=>{_[m]=v.sort((x,R)=>x.start-R.start||x.span-R.span)}),_})}getIndex(_={}){return this._parseCache.get("index",null,_.signal)}hasDataForReferenceSequence(_){return o(this,void 0,void 0,function*(){return!!(yield this.getIndex())[_]})}getEntriesForRange(_,b,w){return o(this,void 0,void 0,function*(){let p=(yield this.getIndex())[_];if(!p)return[];let m=x=>{let R=x.start,M=x.start+x.span;return R>w?-1:M<=b?1:0},v=[];for(let x=0;x<p.length;x+=1)m(p[x])===0&&v.push(p[x]);return v})}}},1050:(s,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.default=class{constructor(a,o){this.parameters=a,this.dataType=o}}},4863:function(s,r,a){var o=this&&this.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(r,"__esModule",{value:!0});let l=a(8577),c=o(a(1050)),h=a(1074);class d extends c.default{constructor(u,g){if(super(u,g),this.dataType!=="int")throw new l.CramUnimplementedError(`${this.dataType} decoding not yet implemented by BETA codec`)}decode(u,g,_,b){return(0,h.getBits)(g.content,b.coreBlock,this.parameters.length)-this.parameters.offset}}r.default=d},1738:function(s,r,a){var o=this&&this.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(r,"__esModule",{value:!0});let l=a(9488),c=o(a(1050));class h extends c.default{constructor(f,u,g){if(super(f,u),this.instantiateCodec=g,u!=="byteArray")throw new TypeError(`byteArrayLength does not support data type ${u}`)}decode(f,u,g,_){let b=this._getLengthCodec().decode(f,u,g,_),w=this._getDataCodec(),p=new Uint8Array(b);for(let m=0;m<b;m+=1)p[m]=w.decode(f,u,g,_);return p}_getLengthCodec(){let f=this.parameters.lengthsEncoding;return this.instantiateCodec(f,"int")}_getDataCodec(){let f=this.parameters.valuesEncoding;return this.instantiateCodec(f,"byte")}}r.default=h,"_getLengthCodec _getDataCodec".split(" ").forEach(d=>(0,l.tinyMemoize)(h,d))},1405:function(s,r,a){var o=this&&this.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(r,"__esModule",{value:!0});let l=a(8577),c=o(a(1050)),h=a(1074);class d extends c.default{constructor(u,g){if(super(u,g),g!=="byteArray")throw new TypeError(`byteArrayStop codec does not support data type ${g}`)}decode(u,g,_,b){let{blockContentId:w}=this.parameters,p=_[w];if(!p)throw new l.CramMalformedError(`no block found with content ID ${w}`);let m=b.externalBlocks.getCursor(w);return this._decodeByteArray(p,m)}_decodeByteArray(u,g){let _=u.content,{stopByte:b}=this.parameters,w=g.bytePosition,p=g.bytePosition;for(;_[p]!==b&&p<_.length;){if(p===_.length)throw new h.CramBufferOverrunError("byteArrayStop reading beyond length of data buffer?");p+=1}return g.bytePosition=p+1,_.subarray(w,p)}}r.default=d},5844:function(s,r,a){var o=this&&this.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(r,"__esModule",{value:!0});let l=a(8577),c=o(a(1050)),h=a(9488),d=a(1074);class f extends c.default{constructor(g,_){if(super(g,_),this.dataType==="int")this._decodeData=this._decodeInt;else{if(this.dataType!=="byte")throw new l.CramUnimplementedError(`${this.dataType} decoding not yet implemented by EXTERNAL codec`);this._decodeData=this._decodeByte}}decode(g,_,b,w){let{blockContentId:p}=this.parameters,m=b[p];if(!m)throw new l.CramMalformedError(`no block found with content ID ${p}`);let v=w.externalBlocks.getCursor(p);return this._decodeData(m,v)}_decodeInt(g,_){let[b,w]=(0,h.parseItf8)(g.content,_.bytePosition);return _.bytePosition=_.bytePosition+w,b}_decodeByte(g,_){if(_.bytePosition>=g.content.length)throw new d.CramBufferOverrunError("attempted to read beyond end of block. this file seems truncated.");return g.content[_.bytePosition++]}}r.default=f},4229:function(s,r,a){var o=this&&this.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(r,"__esModule",{value:!0});let l=a(8577),c=o(a(1050)),h=a(1074);class d extends c.default{constructor(u,g){if(super(u,g),this.dataType!=="int")throw new l.CramUnimplementedError(`${this.dataType} decoding not yet implemented by GAMMA codec`)}decode(u,g,_,b){let w=1;for(;(0,h.getBits)(g.content,b.coreBlock,1)===0;)w+=1;return((0,h.getBits)(g.content,b.coreBlock,w-1)|1<<w-1)-this.parameters.offset}}r.default=d},1074:(s,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.getBits=r.CramBufferOverrunError=void 0;class a extends Error{}r.CramBufferOverrunError=a,r.getBits=function(o,l,c){let h=0;if(l.bytePosition+(7-l.bitPosition+c)/8>o.length)throw new a("read error during decoding. the file seems to be truncated.");for(let d=c;d;d--)h<<=1,h|=o[l.bytePosition]>>l.bitPosition&1,l.bitPosition-=1,l.bitPosition<0&&(l.bytePosition+=1),l.bitPosition&=7;return h}},2082:function(s,r,a){var o=this&&this.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(r,"__esModule",{value:!0});let l=a(8577),c=o(a(1050)),h=a(1074);class d extends c.default{constructor(u,g){if(super(u,g),this.codes={},this.codeBook={},this.sortedByValue=[],this.sortedCodes=[],this.sortedValuesByBitCode=[],this.sortedBitCodes=[],this.sortedBitLengthsByBitCode=[],this.bitCodeToValue=[],!["byte","int"].includes(this.dataType))throw new TypeError(`${this.dataType} decoding not yet implemented by HUFFMAN_INT codec`);this.buildCodeBook(),this.buildCodes(),this.buildCaches(),this.sortedCodes[0].bitLength===0&&(this._decode=this._decodeZeroLengthCode)}buildCodeBook(){let u=new Array(this.parameters.numCodes);for(let g=0;g<this.parameters.numCodes;g+=1)u[g]={symbol:this.parameters.symbols[g],bitLength:this.parameters.bitLengths[g]};u=u.sort((g,_)=>g.bitLength-_.bitLength||g.symbol-_.symbol),this.codeBook={},u.forEach(g=>{this.codeBook[g.bitLength]||(this.codeBook[g.bitLength]=[]),this.codeBook[g.bitLength].push(g.symbol)})}buildCodes(){this.codes={};let u=0,g=-1;Object.entries(this.codeBook).forEach(([_,b])=>{let w=parseInt(_,10);b.forEach(p=>{let m={bitLength:w,value:p,bitCode:0};g+=1;let v=w-u;if(g<<=v,m.bitCode=g,u+=v,function(x){let R=x-(x>>1)&1431655765;return R=(858993459&R)+(R>>2&858993459),16843009*(R+(R>>4)&252645135)>>24}(g)>w)throw new l.CramMalformedError("Symbol out of range");this.codes[p]=m})})}buildCaches(){this.sortedCodes=Object.values(this.codes).sort((g,_)=>g.bitLength-_.bitLength||g.bitCode-_.bitCode),this.sortedByValue=Object.values(this.codes).sort((g,_)=>g.value-_.value),this.sortedValuesByBitCode=this.sortedCodes.map(g=>g.value),this.sortedBitCodes=this.sortedCodes.map(g=>g.bitCode),this.sortedBitLengthsByBitCode=this.sortedCodes.map(g=>g.bitLength);let u=Math.max(...this.sortedBitCodes);this.bitCodeToValue=new Array(u+1).fill(-1);for(let g=0;g<this.sortedBitCodes.length;g+=1)this.bitCodeToValue[this.sortedCodes[g].bitCode]=g}decode(u,g,_,b){return this._decode(u,g,b.coreBlock)}_decodeZeroLengthCode(){return this.sortedCodes[0].value}_decode(u,g,_){let b=g.content,w=0,p=0;for(let m=0;m<this.sortedCodes.length;m+=1){let v=this.sortedCodes[m].bitLength;p<<=v-w,p|=(0,h.getBits)(b,_,v-w),w=v;{let x=this.bitCodeToValue[p];if(x>-1&&this.sortedBitLengthsByBitCode[x]===v)return this.sortedValuesByBitCode[x];for(let R=m;this.sortedCodes[R+1].bitLength===v&&R<this.sortedCodes.length;R+=1)m+=1}}throw new l.CramMalformedError("Huffman symbol not found.")}}r.default=d},8772:function(s,r,a){var o=this&&this.__importDefault||function(w){return w&&w.__esModule?w:{default:w}};Object.defineProperty(r,"__esModule",{value:!0}),r.instantiateCodec=void 0;let l=a(8577),c=o(a(2082)),h=o(a(5844)),d=o(a(1405)),f=o(a(1738)),u=o(a(4863)),g=o(a(4229)),_=o(a(8821)),b={1:h.default,3:c.default,4:f.default,5:d.default,6:u.default,7:_.default,9:g.default};r.instantiateCodec=function w(p,m){let v=(x=m==="ignore"?0:p.codecId,b[x]);var x;if(!v)throw new l.CramUnimplementedError(`no codec implemented for codec ID ${p.codecId}`);return new v(p.parameters,m,w)}},8821:function(s,r,a){var o=this&&this.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(r,"__esModule",{value:!0});let l=a(8577),c=o(a(1050)),h=a(1074);class d extends c.default{constructor(u,g){if(super(u,g),this.dataType!=="int")throw new l.CramUnimplementedError(`${this.dataType} decoding not yet implemented by SUBEXP codec`)}decode(u,g,_,b){let w,p,m=0;for(;(0,h.getBits)(g.content,b.coreBlock,1);)m+=1;return m===0?(w=this.parameters.K,p=(0,h.getBits)(g.content,b.coreBlock,w)):(w=m+this.parameters.K-1,p=1<<w|(0,h.getBits)(g.content,b.coreBlock,w)),p-this.parameters.offset}}r.default=d},2615:(s,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.default={CRAM_FLAG_PRESERVE_QUAL_SCORES:1,CRAM_FLAG_DETACHED:2,CRAM_FLAG_MATE_DOWNSTREAM:4,CRAM_FLAG_NO_SEQ:8,CRAM_FLAG_MASK:15,CRAM_M_REVERSE:1,CRAM_M_UNMAP:2,BAM_FPAIRED:1,BAM_FPROPER_PAIR:2,BAM_FUNMAP:4,BAM_FMUNMAP:8,BAM_FREVERSE:16,BAM_FMREVERSE:32,BAM_FREAD1:64,BAM_FREAD2:128,BAM_FSECONDARY:256,BAM_FQCFAIL:512,BAM_FDUP:1024,BAM_FSUPPLEMENTARY:2048,BAM_CMATCH:0,BAM_CINS:1,BAM_CDEL:2,BAM_CREF_SKIP:3,BAM_CSOFT_CLIP:4,BAM_CHARD_CLIP:5,BAM_CPAD:6,BAM_CEQUAL:7,BAM_CDIFF:8,BAM_CBACK:9,BAM_CIGAR_STR:"MIDNSHP:XB",BAM_CIGAR_SHIFT:4,BAM_CIGAR_MASK:15,BAM_CIGAR_TYPE:246183}},8543:(s,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0});let o=a(8772),l=a(8577),c={BF:"int",CF:"int",RI:"int",RL:"int",AP:"int",RG:"int",MF:"int",NS:"int",NP:"int",TS:"int",NF:"int",TC:"byte",TN:"int",FN:"int",FC:"byte",FP:"int",BS:"byte",IN:"byteArray",SC:"byteArray",DL:"int",BA:"byte",BB:"byteArray",RS:"int",PD:"int",HC:"int",MQ:"int",RN:"byteArray",QS:"byte",QQ:"byteArray",TL:"int"};r.default=class{constructor(h){this.dataSeriesCodecCache={},this.tagCodecCache={},this.tagEncoding={},this.readNamesIncluded=h.preservation.RN,this.APdelta=h.preservation.AP,this.referenceRequired=!!h.preservation.RR,this.tagIdsDictionary=h.preservation.TD,this.substitutionMatrix=function(d){let f=new Array(5);for(let u=0;u<5;u+=1)f[u]=new Array(4);return f[0][d[0]>>6&3]="C",f[0][d[0]>>4&3]="G",f[0][d[0]>>2&3]="T",f[0][d[0]>>0&3]="N",f[1][d[1]>>6&3]="A",f[1][d[1]>>4&3]="G",f[1][d[1]>>2&3]="T",f[1][d[1]>>0&3]="N",f[2][d[2]>>6&3]="A",f[2][d[2]>>4&3]="C",f[2][d[2]>>2&3]="T",f[2][d[2]>>0&3]="N",f[3][d[3]>>6&3]="A",f[3][d[3]>>4&3]="C",f[3][d[3]>>2&3]="G",f[3][d[3]>>0&3]="N",f[4][d[4]>>6&3]="A",f[4][d[4]>>4&3]="C",f[4][d[4]>>2&3]="G",f[4][d[4]>>0&3]="T",f}(h.preservation.SM),this.dataSeriesEncoding=h.dataSeriesEncoding,this.tagEncoding=h.tagEncoding,this.preservation=h.preservation,this._size=h._size,this._endPosition=h._endPosition}getCodecForTag(h){if(!this.tagCodecCache[h]){let d=this.tagEncoding[h];d&&(this.tagCodecCache[h]=(0,o.instantiateCodec)(d,"byteArray"))}return this.tagCodecCache[h]}getTagNames(h){return this.tagIdsDictionary[h]}getCodecForDataSeries(h){let d=this.dataSeriesCodecCache[h];if(d===void 0){let f=this.dataSeriesEncoding[h];if(f){let u=c[h];if(!u)throw new l.CramMalformedError(`data series name ${h} not defined in file compression header`);d=(0,o.instantiateCodec)(f,u),this.dataSeriesCodecCache[h]=d}}return d}toJSON(){let h={};return Object.keys(this).forEach(d=>{/Cache$/.test(d)||(h[d]=this[d])}),h}}},6284:function(s,r,a){var o=this&&this.__awaiter||function(g,_,b,w){return new(b||(b=Promise))(function(p,m){function v(M){try{R(w.next(M))}catch(C){m(C)}}function x(M){try{R(w.throw(M))}catch(C){m(C)}}function R(M){var C;M.done?p(M.value):(C=M.value,C instanceof b?C:new b(function(L){L(C)})).then(v,x)}R((w=w.apply(g,_||[])).next())})},l=this&&this.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(r,"__esModule",{value:!0});let c=a(8577),h=a(9488),d=l(a(6601)),f=l(a(8543));class u{constructor(_,b){this.file=_,this.filePosition=b}getHeader(){return this._readContainerHeader(this.filePosition)}getCompressionHeaderBlock(){return o(this,void 0,void 0,function*(){if(!(yield this.getHeader()).numRecords)return null;let _=yield this.file.getSectionParsers(),b=yield this.getFirstBlock();if(b===void 0)return;if(b.contentType!=="COMPRESSION_HEADER")throw new c.CramMalformedError(`invalid content type ${b.contentType} in what is supposed to be the compression header block`);let w=(0,h.parseItem)(b.content,_.cramCompressionHeader.parser,0,b.contentPosition);return Object.assign(Object.assign({},b),{parsedContent:w})})}getFirstBlock(){return o(this,void 0,void 0,function*(){let _=yield this.getHeader();return this.file.readBlock(_._endPosition)})}getCompressionScheme(){return o(this,void 0,void 0,function*(){let _=yield this.getCompressionHeaderBlock();if(_)return new f.default(_.parsedContent)})}getSlice(_,b){return new d.default(this,_,b)}_readContainerHeader(_){return o(this,void 0,void 0,function*(){let b=yield this.file.getSectionParsers(),{cramContainerHeader1:w,cramContainerHeader2:p}=b,{size:m}=yield this.file.stat();if(_>=m)return;let v=__Buffer$.allocUnsafe(w.maxLength);yield this.file.read(v,0,w.maxLength,_);let x=(0,h.parseItem)(v,w.parser),R=(0,h.itf8Size)(x.numLandmarks);if(_+x.length>=m)return void console.warn(`${this.file}: container header at ${_} indicates that the container has length ${x.length}, which extends beyond the length of the file. Skipping this container.`);let M=__Buffer$.allocUnsafe(p.maxLength(x.numLandmarks));yield this.file.read(M,0,p.maxLength(x.numLandmarks),_+x._size-R);let C=(0,h.parseItem)(M,p.parser);return this.file.validateChecksums&&C.crc32!==void 0&&(yield this.file.checkCrc32(_,x._size+C._size-R-4,C.crc32,`container header beginning at position ${_}`)),Object.assign(x,C,{_size:x._size+C._size-R,_endPosition:x._size+C._size-R+_})})}}r.default=u,"getHeader getCompressionHeaderBlock getCompressionScheme".split(" ").forEach(g=>(0,h.tinyMemoize)(u,g))},5457:function(s,r,a){var o=this&&this.__awaiter||function(x,R,M,C){return new(M||(M=Promise))(function(L,y){function E(I){try{A(C.next(I))}catch(F){y(F)}}function k(I){try{A(C.throw(I))}catch(F){y(F)}}function A(I){var F;I.done?L(I.value):(F=I.value,F instanceof M?F:new M(function(X){X(F)})).then(E,k)}A((C=C.apply(x,R||[])).next())})},l=this&&this.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(r,"__esModule",{value:!0});let c=a(597),h=l(a(2779)),d=l(a(1269)),f=a(8577),u=l(a(9675)),g=a(6141),_=l(a(3498)),b=l(a(6284)),w=a(3427),p=a(9488),m=a(7578);class v{constructor(R){var M;if(this.file=(0,w.open)(R.url,R.path,R.filehandle),this.validateChecksums=!0,this.fetchReferenceSequenceCallback=R.seqFetch,this.options={checkSequenceMD5:R.checkSequenceMD5,cacheSize:(M=R.cacheSize)!==null&&M!==void 0?M:2e4},this.featureCache=new d.default({maxSize:this.options.cacheSize}),function(){let C=new Uint32Array([287454020]),L=new Uint8Array(C.buffer);return L[0]===68?0:L[0]===17?1:2}()>0)throw new Error("Detected big-endian machine, may be unable to run")}read(R,M,C,L){return this.file.read(R,M,C,L)}stat(){return this.file.stat()}getDefinition(){return o(this,void 0,void 0,function*(){let R=__Buffer$.allocUnsafe(g.cramFileDefinition.maxLength);yield this.file.read(R,0,g.cramFileDefinition.maxLength,0);let M=g.cramFileDefinition.parser.parse(R).result;if(M.majorVersion!==2&&M.majorVersion!==3)throw new f.CramUnimplementedError(`CRAM version ${M.majorVersion} not supported`);return M})}getSamHeader(){return o(this,void 0,void 0,function*(){let R=yield this.getContainerById(0);if(!R)throw new f.CramMalformedError("file contains no containers");let M=yield R.getFirstBlock();if(M===void 0)return(0,m.parseHeaderText)("");let C=M.content,L=C.readInt32LE(0),y=C.toString("utf8",4,4+L);return this.header=y,(0,m.parseHeaderText)(y)})}getHeaderText(){return o(this,void 0,void 0,function*(){return yield this.getSamHeader(),this.header})}getSectionParsers(){return o(this,void 0,void 0,function*(){let{majorVersion:R}=yield this.getDefinition();return(0,g.getSectionParsers)(R)})}getContainerById(R){return o(this,void 0,void 0,function*(){let M=yield this.getSectionParsers(),C=M.cramFileDefinition.maxLength,{size:L}=yield this.file.stat(),{cramContainerHeader1:y}=M,E;for(let k=0;k<=R;k+=1){if(C+y.maxLength+8>=L)return;E=this.getContainerAtPosition(C);let A=yield E.getHeader();if(!A)throw new f.CramMalformedError(`container ${R} not found in file`);if(k===0){C=A._endPosition;for(let I=0;I<A.numBlocks;I+=1){let F=yield this.readBlock(C);if(F===void 0)return;C=F._endPosition}}else C+=A._size+A.length}return E})}checkCrc32(R,M,C,L){return o(this,void 0,void 0,function*(){let y=__Buffer$.allocUnsafe(M);yield this.file.read(y,0,M,R);let E=h.default.unsigned(y);if(E!==C)throw new f.CramMalformedError(`crc mismatch in ${L}: recorded CRC32 = ${C}, but calculated CRC32 = ${E}`)})}containerCount(){return o(this,void 0,void 0,function*(){let R=yield this.getSectionParsers(),{size:M}=yield this.file.stat(),{cramContainerHeader1:C}=R,L=0,y=R.cramFileDefinition.maxLength;for(;y+C.maxLength+8<M;){let E=yield this.getContainerAtPosition(y).getHeader();if(!E)break;if(L===0){y=E._endPosition;for(let k=0;k<E.numBlocks;k+=1){let A=yield this.readBlock(y);if(A===void 0)return;y=A._endPosition}}else y+=E._size+E.length;L+=1}return L})}getContainerAtPosition(R){return new b.default(this,R)}readBlockHeader(R){return o(this,void 0,void 0,function*(){let M=yield this.getSectionParsers(),{cramBlockHeader:C}=M,{size:L}=yield this.file.stat();if(R+C.maxLength>=L)return;let y=__Buffer$.allocUnsafe(C.maxLength);return yield this.file.read(y,0,C.maxLength,R),(0,p.parseItem)(y,C.parser,0,R)})}_parseSection(R,M,C=R.maxLength,L){return o(this,void 0,void 0,function*(){let y;if(L)y=L;else{let{size:k}=yield this.file.stat();if(M+C>=k)return;y=__Buffer$.allocUnsafe(C),yield this.file.read(y,0,C,M)}let E=(0,p.parseItem)(y,R.parser,0,M);if(E._size!==C)throw new f.CramMalformedError(`section read error: requested size ${C} does not equal parsed size ${E._size}`);return E})}_uncompress(R,M,C){if(R==="gzip")(0,c.unzip)(M).copy(C);else if(R==="bzip2"){let L=bzip2.array(M),y,E=bzip2.header(L),k=0;do y=bzip2.decompress(L,E),y!=-1&&(__Buffer$.from(y).copy(C,k),k+=y.length,E-=y.length);while(y!=-1)}else if(R==="rans")(0,u.default)(M,C);else if(R==="rans4x16")_.default.r4x16_uncompress(M,C);else if(R==="arith")_.default.arith_uncompress(M,C);else if(R==="fqzcomp")_.default.fqzcomp_uncompress(M,C);else{if(R!=="tok3")throw new f.CramUnimplementedError(`${R} decompression not yet implemented`);_.default.tok3_uncompress(M,C)}}readBlock(R){return o(this,void 0,void 0,function*(){let{majorVersion:M}=yield this.getDefinition(),C=yield this.getSectionParsers(),L=yield this.readBlockHeader(R);if(L===void 0)return;let y=L._endPosition,E=__Buffer$.allocUnsafe(L.uncompressedSize),k=Object.assign(Object.assign({},L),{_endPosition:y,contentPosition:y,content:E});if(L.compressionMethod!=="raw"){let A=__Buffer$.allocUnsafe(L.compressedSize);yield this.read(A,0,L.compressedSize,y),this._uncompress(L.compressionMethod,A,E)}else yield this.read(E,0,L.uncompressedSize,y);if(M>=3){let A=yield this._parseSection(C.cramBlockCrc32,y+L.compressedSize);if(A===void 0)return;k.crc32=A.crc32,this.validateChecksums&&(yield this.checkCrc32(R,L._size+L.compressedSize,A.crc32,"block data")),k._endPosition=A._endPosition,k._size=k.compressedSize+C.cramBlockCrc32.maxLength}else k._endPosition=y+k.compressedSize,k._size=k.compressedSize;return k})}}r.default=v,"getDefinition getSectionParsers getSamHeader".split(" ").forEach(x=>(0,p.tinyMemoize)(v,x))},8222:function(s,r,a){var o=this&&this.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(r,"__esModule",{value:!0}),r.CramRecord=void 0;let l=o(a(5457));var c=a(8631);Object.defineProperty(r,"CramRecord",{enumerable:!0,get:function(){return o(c).default}}),r.default=l.default},8631:function(s,r,a){var o=this&&this.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(r,"__esModule",{value:!0}),r.MateFlagsDecoder=r.CramFlagsDecoder=r.BamFlagsDecoder=r.MateFlags=r.CramFlags=r.BamFlags=void 0;let l=o(a(2615)),c={a:0,A:0,c:1,C:1,g:2,G:2,t:3,T:3,n:4,N:4};function h(d){let f={};for(let[u,g]of d)f["is"+g]=_=>!!(_&u),f["set"+g]=_=>_|u;return f}r.BamFlags=[[1,"Paired"],[2,"ProperlyPaired"],[4,"SegmentUnmapped"],[8,"MateUnmapped"],[16,"ReverseComplemented"],[32,"MateReverseComplemented"],[64,"Read1"],[128,"Read2"],[256,"Secondary"],[512,"FailedQc"],[1024,"Duplicate"],[2048,"Supplementary"]],r.CramFlags=[[1,"PreservingQualityScores"],[2,"Detached"],[4,"WithMateDownstream"],[8,"DecodeSequenceAsStar"]],r.MateFlags=[[1,"OnNegativeStrand"],[2,"Unmapped"]],r.BamFlagsDecoder=h(r.BamFlags),r.CramFlagsDecoder=h(r.CramFlags),r.MateFlagsDecoder=h(r.MateFlags),r.default=class{constructor({flags:d,cramFlags:f,readLength:u,mappingQuality:g,lengthOnRef:_,qualityScores:b,mateRecordNumber:w,readBases:p,readFeatures:m,mateToUse:v,readGroupId:x,readName:R,sequenceId:M,uniqueId:C,templateSize:L,alignmentStart:y,tags:E}){this.flags=d,this.cramFlags=f,this.readLength=u,this.mappingQuality=g,this.lengthOnRef=_,this.qualityScores=b,p&&(this.readBases=p),this.readGroupId=x,this.readName=R,this.sequenceId=M,this.uniqueId=C,this.templateSize=L,this.alignmentStart=y,this.tags=E,m&&(this.readFeatures=m),v&&(this.mate={flags:v.mateFlags,readName:v.mateReadName,sequenceId:v.mateSequenceId,alignmentStart:v.mateAlignmentStart}),w&&(this.mateRecordNumber=w)}isPaired(){return!!(this.flags&l.default.BAM_FPAIRED)}isProperlyPaired(){return!!(this.flags&l.default.BAM_FPROPER_PAIR)}isSegmentUnmapped(){return!!(this.flags&l.default.BAM_FUNMAP)}isMateUnmapped(){return!!(this.flags&l.default.BAM_FMUNMAP)}isReverseComplemented(){return!!(this.flags&l.default.BAM_FREVERSE)}isMateReverseComplemented(){return!!(this.flags&l.default.BAM_FMREVERSE)}isRead1(){return!!(this.flags&l.default.BAM_FREAD1)}isRead2(){return!!(this.flags&l.default.BAM_FREAD2)}isSecondary(){return!!(this.flags&l.default.BAM_FSECONDARY)}isFailedQc(){return!!(this.flags&l.default.BAM_FQCFAIL)}isDuplicate(){return!!(this.flags&l.default.BAM_FDUP)}isSupplementary(){return!!(this.flags&l.default.BAM_FSUPPLEMENTARY)}isDetached(){return!!(this.cramFlags&l.default.CRAM_FLAG_DETACHED)}hasMateDownStream(){return!!(this.cramFlags&l.default.CRAM_FLAG_MATE_DOWNSTREAM)}isPreservingQualityScores(){return!!(this.cramFlags&l.default.CRAM_FLAG_PRESERVE_QUAL_SCORES)}isUnknownBases(){return!!(this.cramFlags&l.default.CRAM_FLAG_NO_SEQ)}getReadBases(){if(!this.readBases&&this._refRegion){let d=function(f,u){if(!f.lengthOnRef&&!f.readLength||f.isUnknownBases())return null;let g=f.alignmentStart-u.start;if(!f.readFeatures)return u.seq.substr(g,f.lengthOnRef).toUpperCase();let _="",b=g,w=0;for(;_.length<f.readLength;)if(w<f.readFeatures.length){let p=f.readFeatures[w];if(p.code==="Q"||p.code==="q")w+=1;else if(p.pos===_.length+1)if(w+=1,p.code==="b"){let m=p.data;_+=m,b+=m.length}else p.code==="B"?(_+=p.data[0],b+=1):p.code==="X"?(_+=p.sub,b+=1):p.code==="I"?_+=p.data:p.code==="D"?b+=p.data:p.code==="i"?_+=p.data:p.code==="N"?b+=p.data:p.code==="S"?_+=p.data:p.code==="P"||p.code;else if(w<f.readFeatures.length){let m=u.seq.substr(b,f.readFeatures[w].pos-_.length-1);_+=m,b+=m.length}}else{let p=u.seq.substr(b,f.readLength-_.length);_+=p,b+=p.length}return _.toUpperCase()}(this,this._refRegion);d&&(this.readBases=d)}return this.readBases}getPairOrientation(){if(!this.isSegmentUnmapped()&&this.isPaired()&&!this.isMateUnmapped()&&this.mate&&this.sequenceId===this.mate.sequenceId){let d=this.isReverseComplemented()?"R":"F",f=this.isMateReverseComplemented()?"R":"F",u=" ",g=" ";this.isRead1()?(u="1",g="2"):this.isRead2()&&(u="2",g="1");let _=[],b=this.templateLength||this.templateSize;if(b===void 0)throw new Error("One of templateSize and templateLength must be set");return this.alignmentStart>this.mate.alignmentStart&&b>0&&(b=-b),b>0?(_[0]=d,_[1]=u,_[2]=f,_[3]=g):(_[2]=d,_[3]=u,_[0]=f,_[1]=g),_.join("")}return null}addReferenceSequence(d,f){this.readFeatures&&this.readFeatures.forEach(u=>{u.code==="X"&&function(g,_,b,w){if(!_)return;let p=w.refPos-_.start,m=_.seq.charAt(p);m&&(w.ref=m);let v=c[m];v===void 0&&(v=4);let x=b.substitutionMatrix[v][w.data];x&&(w.sub=x)}(0,d,f,u)}),!this.readBases&&d.start<=this.alignmentStart&&d.end>=this.alignmentStart+(this.lengthOnRef||this.readLength)-1&&(this._refRegion=d)}toJSON(){let d={};return Object.keys(this).forEach(f=>{f.charAt(0)!=="_"&&(d[f]=this[f])}),d.readBases=this.getReadBases(),d}}},6141:(s,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.getSectionParsers=r.cramFileDefinition=r.isMappedSliceHeader=void 0;let o=a(9996),l=new o.Parser().itf8(),c={parser:new o.Parser().string("magic",{length:4}).uint8("majorVersion").uint8("minorVersion").string("fileId",{length:20,stripNull:!0}),maxLength:26};r.cramFileDefinition=c;let h={parser:new o.Parser().uint8("compressionMethod",{formatter:p=>{let m=["raw","gzip","bzip2","lzma","rans","rans4x16","arith","fqzcomp","tok3"][p];if(!m)throw new Error(`compression method number ${p} not implemented`);return m}}).uint8("contentType",{formatter:p=>{let m=["FILE_HEADER","COMPRESSION_HEADER","MAPPED_SLICE_HEADER","UNMAPPED_SLICE_HEADER","EXTERNAL_DATA","CORE_DATA"][p];if(!m)throw new Error(`invalid block content type id ${p}`);return m}}).itf8("contentId").itf8("compressedSize").itf8("uncompressedSize"),maxLength:17},d={parser:new o.Parser().uint32("crc32"),maxLength:4},f=new o.Parser().itf8("size").buffer("ents",{length:"size",formatter:p=>{function m(M,C){let L=p.toString("utf8",M,C),y=[];for(let E=0;E<L.length;E+=3)y.push(L.substr(E,3));return y}var v,x=[],R=0;for(v=0;v<p.length;v+=1)p[v]||(x.push(m(R,v)),R=v+1);return v>R&&x.push(m(R,v)),x}}),u=new o.Parser().uint8(null,{formatter:p=>!!p}),g=new o.Parser().itf8("mapSize").itf8("mapCount").array("ents",{length:"mapCount",type:new o.Parser().string("key",{length:2,stripNull:!1}).choice("value",{tag:"key",choices:{MI:u,UI:u,PI:u,RN:u,AP:u,RR:u,SM:new o.Parser().array(null,{type:"uint8",length:5}),TD:new o.Parser().nest(null,{type:f,formatter:p=>p.ents})}})});function _(p){let m={};for(let v=0;v<p.ents.length;v+=1){let{key:x,value:R}=p.ents[v];m[x]&&console.warn(`duplicate key ${x} in map`),m[x]=R}return m}let b={cramFileDefinition:c,cramBlockHeader:h,cramBlockCrc32:d};r.isMappedSliceHeader=function(p){return typeof p.refSeqId=="number"};let w={cramUnmappedSliceHeader(p){let m=0,v=new o.Parser().itf8("numRecords");return m+=5,p>=3?(v=v.ltf8("recordCounter"),m+=9):p===2&&(v=v.itf8("recordCounter"),m+=5),v=v.itf8("numBlocks").itf8("numContentIds").array("contentIds",{type:l,length:"numContentIds"}),m+=10,p>=2&&(v=v.array("md5",{type:"uint8",length:16}),m+=16),{parser:v,maxLength:x=>m+5*x}},cramMappedSliceHeader(p){let m=new o.Parser().itf8("refSeqId").itf8("refSeqStart").itf8("refSeqSpan").itf8("numRecords"),v=20;return p>=3?(m=m.ltf8("recordCounter"),v+=9):p===2&&(m=m.itf8("recordCounter"),v+=5),m=m.itf8("numBlocks").itf8("numContentIds").array("contentIds",{type:l,length:"numContentIds"}).itf8("refBaseBlockId"),v+=15,p>=2&&(m=m.array("md5",{type:"uint8",length:16}),v+=16),{parser:m,maxLength:x=>v+5*x}},cramEncoding:p=>({parser:new o.Parser().namely("cramEncoding").itf8("codecId").itf8("parametersBytes").choice("parameters",{tag:"codecId",choices:{0:new o.Parser,1:new o.Parser().itf8("blockContentId"),2:new o.Parser().itf8("offset").itf8("M"),3:o.Parser.start().itf8("numCodes").array("symbols",{length:"numCodes",type:l}).itf8("numLengths").array("bitLengths",{length:"numLengths",type:l}),4:o.Parser.start().nest("lengthsEncoding",{type:"cramEncoding"}).nest("valuesEncoding",{type:"cramEncoding"}),5:new o.Parser().uint8("stopByte").itf8("blockContentId"),6:new o.Parser().itf8("offset").itf8("length"),7:new o.Parser().itf8("offset").itf8("K"),8:new o.Parser().itf8("offset").itf8("log2m"),9:new o.Parser().itf8("offset")}})}),cramDataSeriesEncodingMap(p){return new o.Parser().itf8("mapSize").itf8("mapCount").array("ents",{length:"mapCount",type:new o.Parser().string("key",{length:2,stripNull:!1}).nest("value",{type:this.cramEncoding(p).parser})})},cramTagEncodingMap(p){return new o.Parser().itf8("mapSize").itf8("mapCount").array("ents",{length:"mapCount",type:new o.Parser().itf8("key",{formatter:m=>String.fromCharCode(m>>16&255)+String.fromCharCode(m>>8&255)+String.fromCharCode(255&m)}).nest("value",{type:this.cramEncoding(p).parser})})},cramCompressionHeader(p){let m=new o.Parser;return m=m.nest("preservation",{type:g,formatter:_}).nest("dataSeriesEncoding",{type:this.cramDataSeriesEncodingMap(p),formatter:_}).nest("tagEncoding",{type:this.cramTagEncodingMap(p),formatter:_}),{parser:m}},cramContainerHeader1(p){let m=new o.Parser().int32("length").itf8("refSeqId").itf8("refSeqStart").itf8("alignmentSpan").itf8("numRecords"),v=24;return p>=3?(m=m.ltf8("recordCounter"),v+=9):p===2&&(m=m.itf8("recordCounter"),v+=5),p>1&&(m=m.ltf8("numBases"),v+=9),m=m.itf8("numBlocks").itf8("numLandmarks"),v+=10,{parser:m,maxLength:v}},cramContainerHeader2(p){let m=new o.Parser().itf8("numLandmarks").array("landmarks",{type:new o.Parser().itf8(),length:"numLandmarks"}),v=0;return p>=3&&(m=m.uint32("crc32"),v=4),{parser:m,maxLength:x=>5+5*x+v}}};r.getSectionParsers=function(p){let m=Object.assign({},b);return Object.keys(w).forEach(v=>{m[v]=w[v](p)}),m}},3757:function(s,r,a){var o=this&&this.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(r,"__esModule",{value:!0});let l=o(a(3720)),c=a(8577),h=a(8631),d=a(6141);function f(g){let _="";for(let b=0;b<g.length&&g[b]!==0;b++)_+=String.fromCharCode(g[b]);return _}function u(g,_){if(g==="Z")return f(_);if(g==="A")return String.fromCharCode(_[0]);if(g==="I")return l.default.fromBytesLE(_).toNumber();if(g==="i")return new Int32Array(_.buffer)[0];if(g==="s")return new Int16Array(_.buffer)[0];if(g==="S")return new Uint16Array(_.buffer)[0];if(g==="c")return new Int8Array(_.buffer)[0];if(g==="C")return _[0];if(g==="f")return new Float32Array(_.buffer)[0];if(g==="H")return Number.parseInt(f(_).replace(/^0x/,""),16);if(g==="B")return function(b){let w=String.fromCharCode(b[0]),p=Int32Array.from(b.slice(1))[0],m=new Array(p);if(b=b.slice(5),w==="c"){let v=new Int8Array(b.buffer);for(let x=0;x<p;x+=1)m[x]=v[x]}else if(w==="C"){let v=new Uint8Array(b.buffer);for(let x=0;x<p;x+=1)m[x]=v[x]}else if(w==="s"){let v=new Int16Array(b.buffer);for(let x=0;x<p;x+=1)m[x]=v[x]}else if(w==="S"){let v=new Uint16Array(b.buffer);for(let x=0;x<p;x+=1)m[x]=v[x]}else if(w==="i"){let v=new Int32Array(b.buffer);for(let x=0;x<p;x+=1)m[x]=v[x]}else if(w==="I"){let v=new Uint32Array(b.buffer);for(let x=0;x<p;x+=1)m[x]=v[x]}else{if(w!=="f")throw new Error("unknown type: "+w);{let v=new Float32Array(b.buffer);for(let x=0;x<p;x+=1)m[x]=v[x]}}return m}(_);throw new c.CramMalformedError(`Unrecognized tag type ${g}`)}r.default=function(g,_,b,w,p,m,v,x,R){let M=_("BF"),C=_("CF");if(!(0,d.isMappedSliceHeader)(w.parsedContent))throw new Error;let L;L=x>1&&w.parsedContent.refSeqId===-2?_("RI"):w.parsedContent.refSeqId;let y=_("RL"),E=_("AP");b.APdelta&&(E+=v.lastAlignmentStart),v.lastAlignmentStart=E;let k=_("RG"),A,I,F,X;if(b.readNamesIncluded&&(A=f(_("RN"))),h.CramFlagsDecoder.isDetached(C)){let j=_("MF"),G;b.readNamesIncluded||(G=f(_("RN")),A=G);let Z=_("NS"),te=_("NP");(j||Z>-1)&&(I={mateFlags:j,mateSequenceId:Z,mateAlignmentStart:te,mateReadName:G}),F=_("TS"),h.MateFlagsDecoder.isUnmapped(j)&&(M=h.BamFlagsDecoder.setMateUnmapped(M)),h.MateFlagsDecoder.isOnNegativeStrand(j)&&(M=h.BamFlagsDecoder.setMateReverseComplemented(M))}else h.CramFlagsDecoder.isWithMateDownstream(C)&&(X=_("NF")+R+1);let U=_("TL");if(U<0)throw new c.CramMalformedError("invalid TL index");let V={},q=b.getTagNames(U),S=q.length;for(let j=0;j<S;j+=1){let G=q[j],Z=G.substr(0,2),te=G.substr(2,1),se=b.getCodecForTag(G);if(!se)throw new c.CramMalformedError(`no codec defined for auxiliary tag ${G}`);let re=se.decode(g,p,m,v);V[Z]=u(te,re)}let P,H,D,O,W;if(h.BamFlagsDecoder.isSegmentUnmapped(M))if(h.CramFlagsDecoder.isDecodeSequenceAsStar(C))W=null,O=null;else{let j=new Array(y);for(let G=0;G<j.length;G+=1)j[G]=_("BA");if(W=String.fromCharCode(...j),h.CramFlagsDecoder.isPreservingQualityScores(C)){O=new Array(y);for(let G=0;G<j.length;G+=1)O[G]=_("QS")}}else{let j=_("FN");if(j&&(P=function(G,Z,te,se,re){let ae=0,me=G-1,ue=new Array(Z);function Se([_e,ge]){let ke=te(ge);if(_e==="character")return String.fromCharCode(ke);if(_e==="string"){let Te="";for(let Fe=0;Fe<ke.byteLength;Fe++)Te+=String.fromCharCode(ke[Fe]);return Te}return _e==="numArray"?ke.toArray():ke}for(let _e=0;_e<Z;_e+=1){let ge=String.fromCharCode(te("FC")),ke=te("FP"),Te={B:["character","BA"],S:["string",re>1?"SC":"IN"],X:["number","BS"],D:["number","DL"],I:["string","IN"],i:["character","BA"],b:["string","BB"],q:["numArray","QQ"],Q:["number","QS"],H:["number","HC"],P:["number","PD"],N:["number","RS"]}[ge];if(!Te)throw new c.CramMalformedError(`invalid read feature code "${ge}"`);let Fe=Se(Te),Ie={B:["number","QS"]}[ge];Ie&&(Fe=[Fe,Se(Ie)]),ae+=ke;let T=ae;me+=ke;let N=me;ge==="D"||ge==="N"?me+=Fe:ge==="I"||ge==="S"?me-=Fe.length:ge==="i"&&(me-=1),ue[_e]={code:ge,pos:T,refPos:N,data:Fe}}return ue}(E,j,_,0,x)),H=y,P)for(let{code:G,data:Z}of P)G==="D"||G==="N"?H+=Z:G==="I"||G==="S"?H-=Z.length:G==="i"&&(H-=1);if(Number.isNaN(H)&&(console.warn(`${A||`${L}:${E}`} record has invalid read features`),H=y),D=_("MQ"),h.CramFlagsDecoder.isPreservingQualityScores(C)){O=new Array(y);for(let G=0;G<O.length;G++)O[G]=_("QS")}}return{readLength:y,sequenceId:L,cramFlags:C,flags:M,alignmentStart:E,readGroupId:k,readName:A,mateToUse:I,templateSize:F,mateRecordNumber:X,readFeatures:P,lengthOnRef:H,mappingQuality:D,qualityScores:O,readBases:W,tags:V}}},6601:function(s,r,a){var o=this&&this.__awaiter||function(p,m,v,x){return new(v||(v=Promise))(function(R,M){function C(E){try{y(x.next(E))}catch(k){M(k)}}function L(E){try{y(x.throw(E))}catch(k){M(k)}}function y(E){var k;E.done?R(E.value):(k=E.value,k instanceof v?k:new v(function(A){A(k)})).then(C,L)}y((x=x.apply(p,m||[])).next())})},l=this&&this.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(r,"__esModule",{value:!0});let c=a(8577),h=a(9488),d=l(a(2615)),f=l(a(3757)),u=l(a(8631)),g=a(6141),_=a(1074);function b(p,m,v,x){if(!x)throw new c.CramMalformedError("could not resolve intra-slice mate pairs, file seems truncated or malformed");let R=!!(x.mate||x.mateRecordNumber!==void 0&&x.mateRecordNumber!==m);v.readName||(v.readName=String(v.uniqueId),x.readName=v.readName),v.mate={sequenceId:x.sequenceId,alignmentStart:x.alignmentStart,uniqueId:x.uniqueId},x.readName&&(v.mate.readName=x.readName),x.mate||x.mateRecordNumber!==void 0||(x.mate={sequenceId:v.sequenceId,alignmentStart:v.alignmentStart,uniqueId:v.uniqueId},v.readName&&(x.mate.readName=v.readName)),v.flags|=d.default.BAM_FPAIRED,x.flags&d.default.BAM_FUNMAP&&(v.flags|=d.default.BAM_FMUNMAP),v.flags&d.default.BAM_FUNMAP&&(x.flags|=d.default.BAM_FMUNMAP),x.flags&d.default.BAM_FREVERSE&&(v.flags|=d.default.BAM_FMREVERSE),v.flags&d.default.BAM_FREVERSE&&(x.flags|=d.default.BAM_FMREVERSE),v.templateLength===void 0&&(R?function(M,C,L){let y=function I(F){let X=[F];if(F.mateRecordNumber!==void 0&&F.mateRecordNumber>=0){let U=M[F.mateRecordNumber];if(!U)throw new c.CramMalformedError("intra-slice mate record not found, this file seems malformed");X.push(...I(U))}return X}(L),E=y.map(I=>I.alignmentStart),k=y.map(I=>I.alignmentStart+I.readLength-1),A=Math.max(...k)-Math.min(...E)+1;A>=0&&y.forEach(I=>{if(I.templateLength!==void 0)throw new c.CramMalformedError("mate pair group has some members that have template lengths already, this file seems malformed");I.templateLength=A})}(p,0,v):function(M,C){let L=Math.min(M.alignmentStart,C.alignmentStart),y=Math.max(M.alignmentStart+M.readLength-1,C.alignmentStart+C.readLength-1)-L+1;M.templateLength=y,C.templateLength=y}(v,x)),delete v.mateRecordNumber}class w{constructor(m,v,x){this.container=m,this.containerPosition=v,this.file=m.file}getHeader(){return o(this,void 0,void 0,function*(){let m=yield this.file.getSectionParsers(),v=yield this.container.getHeader(),x=yield this.file.readBlock(v._endPosition+this.containerPosition);if(x===void 0)throw new Error;if(x.contentType==="MAPPED_SLICE_HEADER"){let R=(0,h.parseItem)(x.content,m.cramMappedSliceHeader.parser,0,v._endPosition);return Object.assign(Object.assign({},x),{parsedContent:R})}if(x.contentType==="UNMAPPED_SLICE_HEADER"){let R=(0,h.parseItem)(x.content,m.cramUnmappedSliceHeader.parser,0,v._endPosition);return Object.assign(Object.assign({},x),{parsedContent:R})}throw new c.CramMalformedError(`error reading slice header block, invalid content type ${x.contentType}`)})}getBlocks(){return o(this,void 0,void 0,function*(){let m=yield this.getHeader(),v=m._endPosition,x=new Array(m.parsedContent.numBlocks);for(let R=0;R<x.length;R+=1){let M=yield this.file.readBlock(v);if(M===void 0)throw new Error;x[R]=M,v=x[R]._endPosition}return x})}getCoreDataBlock(){return o(this,void 0,void 0,function*(){return(yield this.getBlocks())[0]})}_getBlocksContentIdIndex(){return o(this,void 0,void 0,function*(){let m=yield this.getBlocks(),v={};return m.forEach(x=>{x.contentType==="EXTERNAL_DATA"&&(v[x.contentId]=x)}),v})}getBlockByContentId(m){return o(this,void 0,void 0,function*(){return(yield this._getBlocksContentIdIndex())[m]})}getReferenceRegion(){return o(this,void 0,void 0,function*(){let m=(yield this.getHeader()).parsedContent;if(!(0,g.isMappedSliceHeader)(m))throw new Error;if(m.refSeqId<0)return;let v=yield this.container.getCompressionScheme();if(v===void 0)throw new Error;if(m.refBaseBlockId>=0){let x=yield this.getBlockByContentId(m.refBaseBlockId);if(!x)throw new c.CramMalformedError("embedded reference specified, but reference block does not exist");return{seq:x.data.toString("utf8"),start:m.refSeqStart,end:m.refSeqStart+m.refSeqSpan-1,span:m.refSeqSpan}}if(v.referenceRequired||this.file.fetchReferenceSequenceCallback){if(!this.file.fetchReferenceSequenceCallback)throw new Error("reference sequence not embedded, and seqFetch callback not provided, cannot fetch reference sequence");let x=yield this.file.fetchReferenceSequenceCallback(m.refSeqId,m.refSeqStart,m.refSeqStart+m.refSeqSpan-1);if(x.length!==m.refSeqSpan)throw new c.CramArgumentError("seqFetch callback returned a reference sequence of the wrong length");return{seq:x,start:m.refSeqStart,end:m.refSeqStart+m.refSeqSpan-1,span:m.refSeqSpan}}})}getAllRecords(){return this.getRecords(()=>!0)}_fetchRecords(){return o(this,void 0,void 0,function*(){let{majorVersion:m}=yield this.file.getDefinition(),v=yield this.container.getCompressionScheme();if(v===void 0)throw new Error;let x=yield this.getHeader();if(x===void 0)throw new Error;let R=yield this._getBlocksContentIdIndex();if(m>1&&this.file.options.checkSequenceMD5&&(0,g.isMappedSliceHeader)(x.parsedContent)&&x.parsedContent.refSeqId>=0&&x.parsedContent.md5.join("")!=="0000000000000000"){let E=yield this.getReferenceRegion();if(E){let{seq:k,start:A,end:I}=E,F=(0,h.sequenceMD5)(k),X=x.parsedContent.md5.map(U=>(U<16?"0":"")+U.toString(16)).join("");if(F!==X)throw new c.CramMalformedError(`MD5 checksum reference mismatch for ref ${x.parsedContent.refSeqId} pos ${A}..${I}. recorded MD5: ${X}, calculated MD5: ${F}`)}}let M=yield this.getCoreDataBlock(),C={lastAlignmentStart:(0,g.isMappedSliceHeader)(x.parsedContent)?x.parsedContent.refSeqStart:0,coreBlock:{bitPosition:7,bytePosition:0},externalBlocks:{map:new Map,getCursor(E){let k=this.map.get(E);return k===void 0&&(k={bitPosition:7,bytePosition:0},this.map.set(E,k)),k}}},L=E=>{let k=v.getCodecForDataSeries(E);if(!k)throw new c.CramMalformedError(`no codec defined for ${E} data series`);return k.decode(this,M,R,C)},y=new Array(x.parsedContent.numRecords);for(let E=0;E<y.length;E+=1)try{let k=(0,f.default)(this,L,v,x,M,R,C,m,E);y[E]=new u.default(Object.assign(Object.assign({},k),{uniqueId:x.contentPosition+x.parsedContent.recordCounter+E+1}))}catch(k){if(k instanceof _.CramBufferOverrunError){console.warn("read attempted beyond end of buffer, file seems truncated."),y=y.filter(A=>!!A);break}throw k}for(let E=0;E<y.length;E+=1){let{mateRecordNumber:k}=y[E];k!==void 0&&k>=0&&b(y,E,y[E],y[k])}return y})}getRecords(m){return o(this,void 0,void 0,function*(){let v=this.container.filePosition+this.containerPosition,x=this.file.featureCache.get(v.toString());x||(x=this._fetchRecords(),this.file.featureCache.set(v.toString(),x));let R=(yield x).filter(m);if(R.length&&this.file.fetchReferenceSequenceCallback){let M=yield this.getHeader();if((0,g.isMappedSliceHeader)(M.parsedContent)&&(M.parsedContent.refSeqId>=0||M.parsedContent.refSeqId===-2)){let C=M.parsedContent.refSeqId>=0?M.parsedContent.refSeqId:void 0,L=yield this.container.getCompressionScheme();if(L===void 0)throw new Error;let y={};for(let E=0;E<R.length;E+=1){let k=C!==void 0?C:R[E].sequenceId,A=y[k];A||(A={id:k,start:R[E].alignmentStart,end:-1/0,seq:null},y[k]=A);let I=R[E].alignmentStart+(R[E].lengthOnRef||R[E].readLength)-1;I>A.end&&(A.end=I),R[E].alignmentStart<A.start&&(A.start=R[E].alignmentStart)}yield Promise.all(Object.values(y).map(E=>o(this,void 0,void 0,function*(){E.id!==-1&&E.start<=E.end&&(E.seq=yield this.file.fetchReferenceSequenceCallback(E.id,E.start,E.end))})));for(let E=0;E<R.length;E+=1){let k=y[C!==void 0?C:R[E].sequenceId];if(k&&k.seq){let A=k.seq;R[E].addReferenceSequence(Object.assign(Object.assign({},k),{seq:A}),L)}}}}return R})}}r.default=w,"getHeader getBlocks _getBlocksContentIdIndex".split(" ").forEach(p=>(0,h.tinyMemoize)(w,p))},9488:function(s,r,a){var o=this&&this.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(r,"__esModule",{value:!0}),r.sequenceMD5=r.tinyMemoize=r.parseItem=r.parseItf8=r.itf8Size=void 0;let l=o(a(2568)),c=a(1074);r.itf8Size=function(h){return-128&h?-16384&h?-2097152&h?-268435456&h?5:4:3:2:1},r.parseItf8=function(h,d){let f=d,u=h[f],g;if(u<128?(g=u,f+=1):u<192?(g=16383&(u<<8|h[f+1]),f+=2):u<224?(g=2097151&(u<<16|h[f+1]<<8|h[f+2]),f+=3):u<240?(g=268435455&(u<<24|h[f+1]<<16|h[f+2]<<8|h[f+3]),f+=4):(g=(15&u)<<28|h[f+1]<<20|h[f+2]<<12|h[f+3]<<4|15&h[f+4],f+=5),f>h.length)throw new c.CramBufferOverrunError("Attempted to read beyond end of buffer; this file seems truncated.");return[g,f-d]},r.parseItem=function(h,d,f=0,u=0){let{offset:g,result:_}=d.parse(h);return Object.assign(Object.assign({},_),{_endPosition:g+u,_size:g-f})},r.tinyMemoize=function(h,d){let f=h.prototype[d],u=`_memo_${d}`;h.prototype[d]=function(){if(!(u in this)){let g=f.call(this);this[u]=g,Promise.resolve(g).catch(()=>{delete this[u]})}return this[u]}},r.sequenceMD5=function(h){return(0,l.default)(h.toUpperCase().replace(/[^\x21-\x7e]/g,""))}},8577:(s,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.CramArgumentError=r.CramSizeLimitError=r.CramMalformedError=r.CramUnimplementedError=r.CramError=void 0;class a extends Error{}r.CramError=a;class o extends Error{}r.CramUnimplementedError=o,r.CramMalformedError=class extends a{},r.CramSizeLimitError=class extends a{},r.CramArgumentError=class extends a{}},5590:function(s,r,a){var o=this&&this.__createBinding||(Object.create?function(g,_,b,w){w===void 0&&(w=b);var p=Object.getOwnPropertyDescriptor(_,b);p&&!("get"in p?!_.__esModule:p.writable||p.configurable)||(p={enumerable:!0,get:function(){return _[b]}}),Object.defineProperty(g,w,p)}:function(g,_,b,w){w===void 0&&(w=b),g[w]=_[b]}),l=this&&this.__setModuleDefault||(Object.create?function(g,_){Object.defineProperty(g,"default",{enumerable:!0,value:_})}:function(g,_){g.default=_}),c=this&&this.__importStar||function(g){if(g&&g.__esModule)return g;var _={};if(g!=null)for(var b in g)b!=="default"&&Object.prototype.hasOwnProperty.call(g,b)&&o(_,g,b);return l(_,g),_},h=this&&this.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(r,"__esModule",{value:!0}),r.CramRecord=r.CraiIndex=r.IndexedCramFile=r.CramFile=void 0;let d=c(a(8222));r.CramFile=d.default,Object.defineProperty(r,"CramRecord",{enumerable:!0,get:function(){return d.CramRecord}});let f=h(a(946));r.IndexedCramFile=f.default;let u=h(a(368));r.CraiIndex=u.default},946:function(s,r,a){var o=this&&this.__awaiter||function(d,f,u,g){return new(u||(u=Promise))(function(_,b){function w(v){try{m(g.next(v))}catch(x){b(x)}}function p(v){try{m(g.throw(v))}catch(x){b(x)}}function m(v){var x;v.done?_(v.value):(x=v.value,x instanceof u?x:new u(function(R){R(x)})).then(w,p)}m((g=g.apply(d,f||[])).next())})},l=this&&this.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(r,"__esModule",{value:!0});let c=a(8577),h=l(a(8222));r.default=class{constructor(d){if(d.cram?this.cram=d.cram:this.cram=new h.default({url:d.cramUrl,path:d.cramPath,filehandle:d.cramFilehandle,seqFetch:d.seqFetch,checkSequenceMD5:d.checkSequenceMD5,cacheSize:d.cacheSize}),!(this.cram instanceof h.default))throw new Error("invalid arguments: no cramfile");if(this.index=d.index,!this.index.getEntriesForRange)throw new Error("invalid arguments: not an index");this.fetchSizeLimit=d.fetchSizeLimit||3e6}getRecordsForRange(d,f,u,g={}){return o(this,void 0,void 0,function*(){if(g.viewAsPairs=g.viewAsPairs||!1,g.pairAcrossChr=g.pairAcrossChr||!1,g.maxInsertSize=g.maxInsertSize||2e5,typeof d=="string")throw new c.CramUnimplementedError("string sequence names not yet supported");let _=d,b=yield this.index.getEntriesForRange(_,f,u),w=b.map(x=>x.sliceBytes).reduce((x,R)=>x+R,0);if(w>this.fetchSizeLimit)throw new c.CramSizeLimitError(`data size of ${w.toLocaleString()} bytes exceeded fetch size limit of ${this.fetchSizeLimit.toLocaleString()} bytes`);let p=x=>x.sequenceId===d&&x.alignmentStart<=u&&x.lengthOnRef!==void 0&&x.alignmentStart+x.lengthOnRef-1>=f,m=yield Promise.all(b.map(x=>this.getRecordsInSlice(x,p))),v=Array.prototype.concat(...m);if(g.viewAsPairs){let x={},R={};for(let I=0;I<v.length;I+=1){let F=v[I].readName;if(F===void 0)throw new Error;let X=v[I].uniqueId;x[F]||(x[F]=0),x[F]+=1,R[X]=1}let M={};Object.entries(x).forEach(([I,F])=>{F===1&&(M[I]=!0)});let C=[];for(let I=0;I<v.length;I+=1){let F=v[I],X=F.readName;if(X===void 0)throw new Error;if(M[X]&&F.mate&&(F.mate.sequenceId===_||g.pairAcrossChr)&&Math.abs(F.alignmentStart-F.mate.alignmentStart)<g.maxInsertSize){let U=this.index.getEntriesForRange(F.mate.sequenceId,F.mate.alignmentStart,F.mate.alignmentStart+1);C.push(U)}}let L=yield Promise.all(C),y=[];for(let I=0;I<L.length;I+=1)y.push(...L[I]);y=y.sort((I,F)=>I.toString().localeCompare(F.toString())).filter((I,F,X)=>!F||I.toString()!==X[F-1].toString());let E=[],k=y.map(I=>I.sliceBytes).reduce((I,F)=>I+F,0);if(k>this.fetchSizeLimit)throw new Error(`mate data size of ${k.toLocaleString()} bytes exceeded fetch size limit of ${this.fetchSizeLimit.toLocaleString()} bytes`);y.forEach(I=>{let F=this.cram.featureCache.get(I.toString());F||(F=this.getRecordsInSlice(I,()=>!0),this.cram.featureCache.set(I.toString(),F));let X=F.then(U=>{let V=[];for(let q=0;q<U.length;q+=1){let S=U[q];if(S.readName===void 0)throw new Error;M[S.readName]&&!R[S.uniqueId]&&V.push(S)}return V});E.push(X)});let A=yield Promise.all(E);if(A.length){let I=A.reduce((F,X)=>F.concat(X));v=v.concat(I)}}return v})}getRecordsInSlice({containerStart:d,sliceStart:f,sliceBytes:u},g){return this.cram.getContainerAtPosition(d).getSlice(f,u).getRecords(g)}hasDataForReferenceSequence(d){return this.index.hasDataForReferenceSequence(d)}}},3427:function(s,r,a){var o=this&&this.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(r,"__esModule",{value:!0}),r.open=r.fromUrl=r.RemoteFile=r.LocalFile=void 0;let l=o(a(8575)),c=a(4319),h=a(2949);function d(f){let{protocol:u,pathname:g}=l.default.parse(f);return u==="file:"?new h.LocalFile(unescape((0,c.ensureNotNullish)(g))):new h.RemoteFile(f)}Object.defineProperty(r,"LocalFile",{enumerable:!0,get:function(){return h.LocalFile}}),Object.defineProperty(r,"RemoteFile",{enumerable:!0,get:function(){return h.RemoteFile}}),r.fromUrl=d,r.open=function(f,u,g){if(g)return g;if(f)return d(f);if(u)return new h.LocalFile(u);throw new Error("no url, path, or filehandle provided, cannot open")}},5702:(s,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.RANS_BYTE_L=r.TOTFREQ=r.TF_SHIFT=void 0,r.TF_SHIFT=12,r.TOTFREQ=4096,r.RANS_BYTE_L=8388608},6484:function(s,r,a){var o=this&&this.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(r,"__esModule",{value:!0});let l=a(8577),c=a(5702),h=o(a(7634));r.default=function(d,f,u,g){let _=d.getInt(),b=d.getInt(),w=d.getInt(),p=d.getInt(),m=g.remaining(),v=-4&m;for(let R=0;R<v;R+=4){let M=f.R[h.default.get(_,c.TF_SHIFT)],C=f.R[h.default.get(b,c.TF_SHIFT)],L=f.R[h.default.get(w,c.TF_SHIFT)],y=f.R[h.default.get(p,c.TF_SHIFT)];g.putAt(R,M),g.putAt(R+1,C),g.putAt(R+2,L),g.putAt(R+3,y),_=h.default.advanceSymbolStep(_,u[255&M],c.TF_SHIFT),b=h.default.advanceSymbolStep(b,u[255&C],c.TF_SHIFT),w=h.default.advanceSymbolStep(w,u[255&L],c.TF_SHIFT),p=h.default.advanceSymbolStep(p,u[255&y],c.TF_SHIFT),_=h.default.renormalize(_,d),b=h.default.renormalize(b,d),w=h.default.renormalize(w,d),p=h.default.renormalize(p,d)}let x;switch(g.setPosition(v),3&m){case 0:break;case 1:x=f.R[h.default.get(_,c.TF_SHIFT)],h.default.advanceSymbol(_,d,u[255&x],c.TF_SHIFT),g.put(x);break;case 2:x=f.R[h.default.get(_,c.TF_SHIFT)],h.default.advanceSymbol(_,d,u[255&x],c.TF_SHIFT),g.put(x),x=f.R[h.default.get(b,c.TF_SHIFT)],h.default.advanceSymbol(b,d,u[255&x],c.TF_SHIFT),g.put(x);break;case 3:x=f.R[h.default.get(_,c.TF_SHIFT)],h.default.advanceSymbol(_,d,u[255&x],c.TF_SHIFT),g.put(x),x=f.R[h.default.get(b,c.TF_SHIFT)],h.default.advanceSymbol(b,d,u[255&x],c.TF_SHIFT),g.put(x),x=f.R[h.default.get(w,c.TF_SHIFT)],h.default.advanceSymbol(w,d,u[255&x],c.TF_SHIFT),g.put(x);break;default:throw new l.CramMalformedError("invalid output size encountered during rANS decoding")}g.setPosition(0)}},7121:function(s,r,a){var o=this&&this.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(r,"__esModule",{value:!0});let l=a(5702),c=o(a(7634));r.default=function(h,d,f,u){let g=d.remaining(),_=h.getInt(),b=h.getInt(),w=h.getInt(),p=h.getInt(),m=g>>2,v=0,x=m,R=2*m,M=3*m,C=0,L=0,y=0,E=0;for(;v<m;v+=1,x+=1,R+=1,M+=1){let k=255&f[C].R[c.default.get(_,l.TF_SHIFT)],A=255&f[L].R[c.default.get(b,l.TF_SHIFT)],I=255&f[y].R[c.default.get(w,l.TF_SHIFT)],F=255&f[E].R[c.default.get(p,l.TF_SHIFT)];d.putAt(v,k),d.putAt(x,A),d.putAt(R,I),d.putAt(M,F),_=c.default.advanceSymbolStep(_,u[C][k],l.TF_SHIFT),b=c.default.advanceSymbolStep(b,u[L][A],l.TF_SHIFT),w=c.default.advanceSymbolStep(w,u[y][I],l.TF_SHIFT),p=c.default.advanceSymbolStep(p,u[E][F],l.TF_SHIFT),_=c.default.renormalize(_,h),b=c.default.renormalize(b,h),w=c.default.renormalize(w,h),p=c.default.renormalize(p,h),C=k,L=A,y=I,E=F}for(;M<g;M+=1){let k=255&f[E].R[c.default.get(p,l.TF_SHIFT)];d.putAt(M,k),p=c.default.advanceSymbol(p,h,u[E][k],l.TF_SHIFT),E=k}}},7634:(s,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0});let o=a(8577),l=a(5702);class c{constructor(){this.F=void 0,this.C=void 0}}function h(f,u,g,_){return g*(f>>_)+(f&(1<<_)-1)-u}let d={FC:c,AriDecoder:class{constructor(){this.fc=new Array(256);for(let f=0;f<this.fc.length;f+=1)this.fc[f]=new c;this.R=null}},Symbol:class{constructor(){this.start=void 0,this.freq=void 0}},symbolInit:function(f,u,g){if(!(u<=65536))throw new o.CramMalformedError("assertion failed: start <= 1<<16");if(!(g<=65536-u))throw new o.CramMalformedError("assertion failed: freq <= 1<<16");f.start=u,f.freq=g},advanceStep:h,advanceSymbolStep:function(f,u,g){return h(f,u.start,u.freq,g)},get:function(f,u){return f&(1<<u)-1},advanceSymbol:function(f,u,g,_){return function(b,w,p,m,v){if((b=m*(b>>v)+(b&(1<<v)-1)-p)<l.RANS_BYTE_L)do b=b<<8|255&w.get();while(b<l.RANS_BYTE_L);return b}(f,u,g.start,g.freq,_)},renormalize:function(f,u){if(f<l.RANS_BYTE_L)do f=f<<8|255&u.get();while(f<l.RANS_BYTE_L);return f}};r.default=d},696:function(s,r,a){var o=this&&this.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(r,"__esModule",{value:!0}),r.readStatsO1=r.readStatsO0=void 0;let l=a(8577),c=a(5702),h=o(a(7634));function d(f){if(!f)throw new l.CramMalformedError("assertion failed")}r.readStatsO0=function(f,u,g){let _=0,b=0,w=255&f.get();do u.fc[w]==null&&(u.fc[w]=new h.default.FC),u.fc[w].F=255&f.get(),u.fc[w].F>=128&&(u.fc[w].F&=-129,u.fc[w].F=(127&u.fc[w].F)<<8|255&f.get()),u.fc[w].C=b,h.default.symbolInit(g[w],u.fc[w].C,u.fc[w].F),u.R||(u.R=new Array(c.TOTFREQ)),u.R.fill(w,b,b+u.fc[w].F),b+=u.fc[w].F,_===0&&w+1===(255&f.getByteAt(f.position()))?(w=255&f.get(),_=255&f.get()):_!==0?(_-=1,w+=1):w=255&f.get();while(w!==0);d(b<c.TOTFREQ)},r.readStatsO1=function(f,u,g){let _=0,b=255&f.get();do{let w=0,p=0,m=255&f.get();u[b]==null&&(u[b]=new h.default.AriDecoder);do u[b].fc[m]==null&&(u[b].fc[m]=new h.default.FC),u[b].fc[m].F=255&f.get(),u[b].fc[m].F>=128&&(u[b].fc[m].F&=-129,u[b].fc[m].F=(127&u[b].fc[m].F)<<8|255&f.get()),u[b].fc[m].C=p,u[b].fc[m].F===0&&(u[b].fc[m].F=c.TOTFREQ),g[b][m]==null&&(g[b][m]=new h.default.RansDecSymbol),h.default.symbolInit(g[b][m],u[b].fc[m].C,u[b].fc[m].F),u[b].R==null&&(u[b].R=new Array(c.TOTFREQ)),u[b].R.fill(m,p,p+u[b].fc[m].F),p+=u[b].fc[m].F,d(p<=c.TOTFREQ),w===0&&m+1===(255&f.getByteAt(f.position()))?(m=255&f.get(),w=255&f.get()):w!==0?(w-=1,m+=1):m=255&f.get();while(m!==0);_===0&&b+1===(255&f.getByteAt(f.position()))?(b=255&f.get(),_=255&f.get()):_!==0?(_-=1,b+=1):b=255&f.get()}while(b!==0)}},9675:function(s,r,a){var o=this&&this.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(r,"__esModule",{value:!0});let l=a(8577),c=o(a(7634)),h=a(696),d=o(a(6484)),f=o(a(7121));class u{constructor(_,b=0){this._buffer=_,this._position=b,this.length=_.length}get(){let _=this._buffer[this._position];return this._position+=1,_}getByte(){return this.get()}getByteAt(_){return this._buffer[_]}position(){return this._position}put(_){return this._buffer[this._position]=_,this._position+=1,_}putAt(_,b){return this._buffer[_]=b,b}setPosition(_){return this._position=_,_}getInt(){let _=this._buffer.readInt32LE(this._position);return this._position+=4,_}remaining(){return this._buffer.length-this._position}}r.default=function(g,_,b=0){if(g.length===0)return _.fill(0),_;let w=new u(g,b),p=w.get();if(p!==0&&p!==1)throw new l.CramMalformedError(`Invalid rANS order ${p}`);if(w.getInt()!==w.remaining()-4)throw new l.CramMalformedError("Incorrect input length.");let m=w.getInt(),v=new u(_||__Buffer$.allocUnsafe(m));if(v.length<m)throw new l.CramMalformedError(`Output buffer too small to fit ${m} bytes.`);switch(p){case 0:return function(x,R){let M=new c.default.AriDecoder,C=new Array(256);for(let L=0;L<C.length;L+=1)C[L]=new c.default.Symbol;return(0,h.readStatsO0)(x,M,C),(0,d.default)(x,M,C,R),R}(w,v);case 1:return function(x,R){let M=new Array(256);for(let L=0;L<M.length;L+=1)M[L]=new c.default.AriDecoder;let C=new Array(256);for(let L=0;L<C.length;L+=1){C[L]=new Array(256);for(let y=0;y<C[L].length;y+=1)C[L][y]=new c.default.Symbol}return(0,h.readStatsO1)(x,M,C),(0,f.default)(x,R,M,C),R}(w,v);default:throw new l.CramMalformedError(`Invalid rANS order: ${p}`)}}},7578:(s,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.parseHeaderText=void 0,r.parseHeaderText=function(a){let o=a.split(/\r?\n/),l=[];return o.forEach(c=>{let[h,...d]=c.split(/\t/),f=d.map(u=>{let[g,_]=u.split(":",2);return{tag:g,value:_}});h&&l.push({tag:h.substr(1),data:f})}),l}},4319:(s,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ensureNotNullish=void 0,r.ensureNotNullish=function(a){if(a==null)throw new Error("Value must not be nullish.");return a}},597:(s,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.unzip=void 0;let o=a(9591);r.unzip=function(l){return __Buffer$.from((0,o.inflate)(l))}},9996:(s,r,a)=>{function o(p){return o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},o(p)}var l=a(8764).Buffer,c=a(22),h=a(2961)._,d=a(3720);typeof window<"u"&&(window.Buffer=l),typeof self<"u"&&(self.Buffer=l);var f={UInt8:1,UInt16LE:2,UInt16BE:2,UInt32LE:4,UInt32BE:4,Int8:1,Int16LE:2,Int16BE:2,Int32LE:4,Int32BE:4,FloatLE:4,FloatBE:4,DoubleLE:8,DoubleBE:8,UInt64:8,Int64:8},u={},g="___parser_",_=[];(function(){var p;for(p=1;p<=32;p++)_.push(p)})();var b={};Object.keys(f).concat(Object.keys({String:null,Buffer:null,Array:null,Skip:null,Choice:null,Nest:null,Bit:null,Itf8:null,Ltf8:null})).forEach(function(p){b[p.toLowerCase()]=p});var w=function(){this.varName="",this.type="",this.options={},this.next=null,this.head=null,this.compiled=null,this.endian="le",this.constructorFn=null,this.alias=null};w.start=function(){return new w},Object.keys(f).forEach(function(p){w.prototype[p.toLowerCase()]=function(v,x){return this.setNextParser(p.toLowerCase(),v,x)};var m=p.replace(/BE|LE/,"").toLowerCase();m in w.prototype||(w.prototype[m]=function(v,x){return this[m+this.endian](v,x)})}),_.forEach(function(p){w.prototype["bit".concat(p.toString())]=function(m,v){return v||(v={}),v.length=p,this.setNextParser("bit",m,v)}}),w.prototype.namely=function(p){return u[p]=this,this.alias=p,this},w.prototype.skip=function(p,m){if(m&&m.assert)throw new Error("assert option on skip is not allowed.");return this.setNextParser("skip","",{length:p})},w.prototype.string=function(p,m){if(!m.zeroTerminated&&!m.length&&!m.greedy)throw new Error("Neither length, zeroTerminated, nor greedy is defined for string.");if((m.zeroTerminated||m.length)&&m.greedy)throw new Error("greedy is mutually exclusive with length and zeroTerminated for string.");if(m.stripNull&&!m.length&&!m.greedy)throw new Error("Length or greedy must be defined if stripNull is defined.");return m.encoding=m.encoding||"utf8",this.setNextParser("string",p,m)},w.prototype.buffer=function(p,m){if(!m.length&&!m.readUntil)throw new Error("Length nor readUntil is defined in buffer parser");return this.setNextParser("buffer",p,m)},w.prototype.array=function(p,m){if(!m.readUntil&&!m.length&&!m.lengthInBytes)throw new Error("Length option of array is not defined.");if(!m.type)throw new Error("Type option of array is not defined.");if(typeof m.type=="string"&&!u[m.type]&&Object.keys(f).indexOf(b[m.type])<0)throw new Error('Specified primitive type "'.concat(m.type,'" is not supported.'));return this.setNextParser("array",p,m)},w.prototype.choice=function(p,m){if(arguments.length===1&&o(p)==="object"&&(m=p,p=null),!m.tag)throw new Error("Tag option of array is not defined.");if(!m.choices)throw new Error("Choices option of array is not defined.");return Object.keys(m.choices).forEach(function(v){if(!m.choices[v])throw new Error("Choice Case ".concat(v," of ").concat(p," is not valid."));if(typeof m.choices[v]=="string"&&!u[m.choices[v]]&&Object.keys(f).indexOf(b[m.choices[v]])<0)throw new Error('Specified primitive type "'.concat(m.choices[v],'" is not supported.'))},this),this.setNextParser("choice",p,m)},w.prototype.nest=function(p,m){if(arguments.length===1&&o(p)==="object"&&(m=p,p=null),!m.type)throw new Error("Type option of nest is not defined.");if(!(m.type instanceof w||u[m.type]))throw new Error("Type option of nest must be a Parser object.");if(!(m.type instanceof w||p))throw new Error("options.type must be a object if variable name is omitted.");return this.setNextParser("nest",p,m)},w.prototype.endianess=function(p){switch(p.toLowerCase()){case"little":this.endian="le";break;case"big":this.endian="be";break;default:throw new Error("Invalid endianess: ".concat(p))}return this},w.prototype.create=function(p){if(!(p instanceof Function))throw new Error("Constructor must be a Function object.");return this.constructorFn=p,this},w.prototype.getCode=function(){var p=new h;return p.pushCode("if (!Buffer.isBuffer(buffer)) {"),p.generateError('"argument buffer is not a Buffer object"'),p.pushCode("}"),this.alias?this.addAliasedCode(p):this.addRawCode(p),this.alias?p.pushCode("return {0}(0)",g+this.alias):p.pushCode("return { offset: offset, result: vars };"),p.code},w.prototype.addRawCode=function(p){p.pushCode("var offset = 0;"),this.constructorFn?p.pushCode("var vars = new constructorFn();"):p.pushCode("var vars = {};"),this.generate(p),this.resolveReferences(p),p.pushCode("return { offset: offset, result: vars };")},w.prototype.addAliasedCode=function(p){return p.pushCode("function {0}(offset) {",g+this.alias),this.constructorFn?p.pushCode("var vars = new constructorFn();"):p.pushCode("var vars = {};"),this.generate(p),p.markResolved(this.alias),this.resolveReferences(p),p.pushCode("return { offset: offset, result: vars };"),p.pushCode("}"),p},w.prototype.resolveReferences=function(p){var m=p.getUnresolvedReferences();p.markRequested(m),m.forEach(function(v){u[v].addAliasedCode(p)})},w.prototype.compile=function(){var p="(function(buffer, constructorFn, Long) { ".concat(this.getCode()," })");this.compiled=c.runInThisContext(p)},w.prototype.sizeOf=function(){var p=NaN;if(Object.keys(f).indexOf(this.type)>=0)p=f[this.type];else if(this.type==="String"&&typeof this.options.length=="number")p=this.options.length;else if(this.type==="Buffer"&&typeof this.options.length=="number")p=this.options.length;else if(this.type==="Array"&&typeof this.options.length=="number"){var m=NaN;typeof this.options.type=="string"?m=f[b[this.options.type]]:this.options.type instanceof w&&(m=this.options.type.sizeOf()),p=this.options.length*m}else this.type==="Skip"?p=this.options.length:this.type==="Nest"?p=this.options.type.sizeOf():this.type||(p=0);return this.next&&(p+=this.next.sizeOf()),p},w.prototype.parse=function(p){return this.compiled||this.compile(),this.compiled(p,this.constructorFn,d)},w.prototype.setNextParser=function(p,m,v){var x=new w;return x.type=b[p],x.varName=m,x.options=v||x.options,x.endian=this.endian,this.head?this.head.next=x:this.next=x,this.head=x,this},w.prototype.generate=function(p){this.type&&(this["generate".concat(this.type)](p),this.generateAssert(p));var m=p.generateVariable(this.varName);return this.options.formatter&&this.generateFormatter(p,m,this.options.formatter),this.generateNext(p)},w.prototype.generateAssert=function(p){if(this.options.assert){var m=p.generateVariable(this.varName);switch(o(this.options.assert)){case"function":p.pushCode("if (!({0}).call(vars, {1})) {",this.options.assert,m);break;case"number":p.pushCode("if ({0} !== {1}) {",this.options.assert,m);break;case"string":p.pushCode('if ("{0}" !== {1}) {',this.options.assert,m);break;default:throw new Error("Assert option supports only strings, numbers and assert functions.")}p.generateError('"Assert error: {0} is " + {0}',m),p.pushCode("}")}},w.prototype.generateNext=function(p){return this.next&&(p=this.next.generate(p)),p},Object.keys(f).forEach(function(p){w.prototype["generate".concat(p)]=function(m){p==="UInt64"?m.pushCode("{0} = Long.fromBytes(buffer.slice(offset,offset+8), true, this.endian === 'le').toNumber();",m.generateVariable(this.varName),p):p==="Int64"?m.pushCode("{0} = Long.fromBytes(buffer.slice(offset,offset+8), false, this.endian === 'le').toNumber();",m.generateVariable(this.varName),p):m.pushCode("{0} = buffer.read{1}(offset);",m.generateVariable(this.varName),p),m.pushCode("offset += {0};",f[p])}}),w.prototype.generateBit=function(p){var m=JSON.parse(JSON.stringify(this));if(m.varName=p.generateVariable(m.varName),p.bitFields.push(m),!this.next||this.next&&["Bit","Nest"].indexOf(this.next.type)<0){var v=0;p.bitFields.forEach(function(y){v+=y.options.length});var x=p.generateTmpVariable();if(v<=8)p.pushCode("var {0} = buffer.readUInt8(offset);",x),v=8;else if(v<=16)p.pushCode("var {0} = buffer.readUInt16BE(offset);",x),v=16;else if(v<=24){var R=p.generateTmpVariable(),M=p.generateTmpVariable();p.pushCode("var {0} = buffer.readUInt16BE(offset);",R),p.pushCode("var {0} = buffer.readUInt8(offset + 2);",M),p.pushCode("var {2} = ({0} << 8) | {1};",R,M,x),v=24}else{if(!(v<=32))throw new Error("Currently, bit field sequence longer than 4-bytes is not supported.");p.pushCode("var {0} = buffer.readUInt32BE(offset);",x),v=32}p.pushCode("offset += {0};",v/8);var C=0,L=this.endian==="be";p.bitFields.forEach(function(y){p.pushCode("{0} = {1} >> {2} & {3};",y.varName,x,L?v-C-y.options.length:C,(1<<y.options.length)-1),C+=y.options.length}),p.bitFields=[]}},w.prototype.generateSkip=function(p){var m=p.generateOption(this.options.length);p.pushCode("offset += {0};",m)},w.prototype.generateString=function(p){var m=p.generateVariable(this.varName),v=p.generateTmpVariable();this.options.length&&this.options.zeroTerminated?(p.pushCode("var {0} = offset;",v),p.pushCode("while(buffer.readUInt8(offset++) !== 0 && offset - {0}  < {1});",v,this.options.length),p.pushCode("{0} = buffer.toString('{1}', {2}, offset - {2} < {3} ? offset - 1 : offset);",m,this.options.encoding,v,this.options.length)):this.options.length?(p.pushCode("{0} = buffer.toString('{1}', offset, offset + {2});",m,this.options.encoding,p.generateOption(this.options.length)),p.pushCode("offset += {0};",p.generateOption(this.options.length))):this.options.zeroTerminated?(p.pushCode("var {0} = offset;",v),p.pushCode("while(buffer.readUInt8(offset++) !== 0);"),p.pushCode("{0} = buffer.toString('{1}', {2}, offset - 1);",m,this.options.encoding,v)):this.options.greedy&&(p.pushCode("var {0} = offset;",v),p.pushCode("while(buffer.length > offset++);"),p.pushCode("{0} = buffer.toString('{1}', {2}, offset);",m,this.options.encoding,v)),this.options.stripNull&&p.pushCode("{0} = {0}.replace(/\\x00+$/g, '')",m)},w.prototype.generateBuffer=function(p){this.options.readUntil==="eof"?p.pushCode("{0} = buffer.slice(offset);",p.generateVariable(this.varName)):(p.pushCode("{0} = buffer.slice(offset, offset + {1});",p.generateVariable(this.varName),p.generateOption(this.options.length)),p.pushCode("offset += {0};",p.generateOption(this.options.length))),this.options.clone&&p.pushCode("{0} = Buffer.from({0});",p.generateVariable(this.varName))},w.prototype.generateArray=function(p){var m=p.generateOption(this.options.length),v=p.generateOption(this.options.lengthInBytes),x=this.options.type,R=p.generateTmpVariable(),M=p.generateVariable(this.varName),C=p.generateTmpVariable(),L=this.options.key,y=typeof L=="string";if(y?p.pushCode("{0} = {};",M):p.pushCode("{0} = [];",M),typeof this.options.readUntil=="function"?p.pushCode("do {"):this.options.readUntil==="eof"?p.pushCode("for (var {0} = 0; offset < buffer.length; {0}++) {",R):v!==void 0?p.pushCode("for (var {0} = offset; offset - {0} < {1}; ) {",R,v):p.pushCode("for (var {0} = 0; {0} < {1}; {0}++) {",R,m),typeof x=="string")if(u[x]){var E=p.generateTmpVariable();p.pushCode("var {0} = {1}(offset);",E,g+x),p.pushCode("var {0} = {1}.result; offset = {1}.offset;",C,E),x!==this.alias&&p.addReference(x)}else p.pushCode("var {0} = buffer.read{1}(offset);",C,b[x]),p.pushCode("offset += {0};",f[b[x]]);else x instanceof w&&(p.pushCode("var {0} = {};",C),p.pushScope(C),x.generate(p),p.popScope());y?p.pushCode("{0}[{2}.{1}] = {2};",M,L,C):p.pushCode("{0}.push({1});",M,C),p.pushCode("}"),typeof this.options.readUntil=="function"&&p.pushCode(" while (!({0}).call(this, {1}, buffer.slice(offset)));",this.options.readUntil,C)},w.prototype.generateChoiceCase=function(p,m,v){if(typeof v=="string")if(u[v]){var x=p.generateTmpVariable();p.pushCode("var {0} = {1}(offset);",x,g+v),p.pushCode("{0} = {1}.result; offset = {1}.offset;",p.generateVariable(this.varName),x),v!==this.alias&&p.addReference(v)}else p.pushCode("{0} = buffer.read{1}(offset);",p.generateVariable(this.varName),b[v]),p.pushCode("offset += {0};",f[b[v]]);else v instanceof w&&(p.pushPath(m),v.generate(p),p.popPath(m))},w.prototype.generateChoice=function(p){var m=p.generateOption(this.options.tag);this.varName&&p.pushCode("{0} = {};",p.generateVariable(this.varName)),p.pushCode("switch({0}) {",m),Object.keys(this.options.choices).forEach(function(v){var x=this.options.choices[v];Number.isNaN(parseInt(v,10))?p.pushCode("case '{0}':",v):p.pushCode("case {0}:",v),this.generateChoiceCase(p,this.varName,x),p.pushCode("break;")},this),p.pushCode("default:"),this.options.defaultChoice?this.generateChoiceCase(p,this.varName,this.options.defaultChoice):p.generateError('"Met undefined tag value " + {0} + " at choice"',m),p.pushCode("}")},w.prototype.generateNest=function(p){var m=p.generateVariable(this.varName);if(this.options.type instanceof w)this.varName&&p.pushCode("{0} = {};",m),p.pushPath(this.varName),this.options.type.generate(p),p.popPath(this.varName);else if(u[this.options.type]){var v=p.generateTmpVariable();p.pushCode("var {0} = {1}(offset);",v,g+this.options.type),p.pushCode("{0} = {1}.result; offset = {1}.offset;",m,v),this.options.type!==this.alias&&p.addReference(this.options.type)}},w.prototype.generateFormatter=function(p,m,v){typeof v=="function"&&p.pushCode("{0} = ({1}).call(this, {0});",m,v)},w.prototype.isInteger=function(){return!!this.type.match(/U?Int[8|16|32][BE|LE]?|Bit\d+/)},w.prototype.itf8=function(p,m){return this.setNextParser("itf8",p,m)},w.prototype.itf8=function(p,m){return this.setNextParser("itf8",p,m)},w.prototype.generateItf8=function(p){var m=p.generateVariable(this.varName),v=p.generateTmpVariable();p.pushCode(`
    var `.concat(v,` = buffer[offset];
    if (`).concat(v,` < 0x80) {
      `).concat(m," = ").concat(v,`;
      offset += 1;
    } else if (`).concat(v,` < 0xc0) {
      `).concat(m," = ((").concat(v,`<<8) | buffer[offset+1]) & 0x3fff;
      offset += 2;
    } else if (`).concat(v,` < 0xe0) {
      `).concat(m," = ((").concat(v,`<<16) | (buffer[offset+1]<< 8) |  buffer[offset+2]) & 0x1fffff;
      offset += 3;
    } else if (`).concat(v,` < 0xf0) {
      `).concat(m," = ((").concat(v,`<<24) | (buffer[offset+1]<<16) | (buffer[offset+2]<<8) | buffer[offset+3]) & 0x0fffffff;
      offset += 4
    } else {
      `).concat(m," = ((").concat(v,` & 0x0f)<<28) | (buffer[offset+1]<<20) | (buffer[offset+2]<<12) | (buffer[offset+3]<<4) | (buffer[offset+4] & 0x0f);
      // x=((0xff & 0x0f)<<28) | (0xff<<20) | (0xff<<12) | (0xff<<4) | (0x0f & 0x0f);
      // TODO *val_p = uv < 0x80000000UL ? uv : -((int32_t) (0xffffffffUL - uv)) - 1;
      offset += 5
    }
  `))},w.prototype.ltf8=function(p,m){return this.setNextParser("ltf8",p,m)},w.prototype.generateLtf8=function(p){var m=p.generateVariable(this.varName),v=p.generateTmpVariable();p.pushCode(`
  var `.concat(v,` = buffer[offset];
  if (`).concat(v,` < 0x80) {
    `).concat(m," = ").concat(v,`;
    offset += 1;
  } else if (`).concat(v,` < 0xc0) {
    `).concat(m,` = ((buffer[offset]<<8) | buffer[offset+1]) & 0x3fff;
    offset += 2;
  } else if (`).concat(v,` < 0xe0) {
    `).concat(m,` = ((buffer[offset]<<16) | (buffer[offset+1]<<8) | buffer[offset+2]) & 0x1fffff;
    `).concat(m," = (((").concat(v,` & 63) << 16) | buffer.readUInt16LE(offset + 1));
    offset += 3;
  } else if (`).concat(v,` < 0xf0) {
    `).concat(m,` = ((buffer[offset]<<24) | (buffer[offset+1]<<16) | (buffer[offset+2]<<8) | buffer[offset+3]) & 0x0fffffff;
    offset += 4;
  } else if (`).concat(v,` < 0xf8) {
    `).concat(m,` = (((buffer[offset] & 15) * Math.pow(2,32))) +
      (buffer[offset+1]<<24) | (buffer[offset+2]<<16 | buffer[offset+3]<<8 | buffer[offset+4])
    // TODO *val_p = uv < 0x80000000UL ? uv : -((int32_t) (0xffffffffUL - uv)) - 1;
    offset += 5;
  } else if (`).concat(v,` < 0xfc) {
    `).concat(m,` = ((((buffer[offset] & 7) << 8) | buffer[offset+1] )) * Math.pow(2,32) +
      (buffer[offset+2]<<24) | (buffer[offset+3]<<16 | buffer[offset+4]<<8 | buffer[offset+5])
    offset += 6;
  } else if (`).concat(v,` < 0xfe) {
    `).concat(m,` = ((((buffer[offset] & 3) << 16) | buffer[offset+1]<<8 | buffer[offset+2])) * Math.pow(2,32) +
      (buffer[offset+3]<<24) | (buffer[offset+4]<<16 | buffer[offset+5]<<8 | buffer[offset+6])
    offset += 7;
  } else if (`).concat(v,` < 0xff) {
    `).concat(m,` = Long.fromBytesBE(buffer.slice(offset+1,offset+8));
    if (`).concat(m,".greaterThan(Number.MAX_SAFE_INTEGER) || ").concat(m,`.lessThan(Number.MIN_SAFE_INTEGER))
      throw new Error('integer overflow')
    `).concat(m," = ").concat(m,`.toNumber()
    offset += 8;
  } else {
    `).concat(m,` = Long.fromBytesBE(buffer.slice(offset+1,offset+9));
    if (`).concat(m,".greaterThan(Number.MAX_SAFE_INTEGER) || ").concat(m,`.lessThan(Number.MIN_SAFE_INTEGER))
      throw new Error('integer overflow')
    `).concat(m," = ").concat(m,`.toNumber()
    offset += 9;
  }
  `))},r.Parser=w},2961:(s,r)=>{function a(l){return a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},a(l)}var o=function(){this.code="",this.scopes=[["vars"]],this.isAsync=!1,this.bitFields=[],this.tmpVariableCount=0,this.references={}};o.prototype.generateVariable=function(l){var c=[];for(Array.prototype.push.apply(c,this.scopes[this.scopes.length-1]);/^\$parent\./.test(l);)c.pop(),l=l.replace(/^\$parent\./,"");return l&&c.push(l),c.join(".")},o.prototype.generateOption=function(l){switch(a(l)){case"number":return l.toString();case"string":return this.generateVariable(l);case"function":return"(".concat(l,").call(").concat(this.generateVariable(),", vars)");default:return}},o.prototype.generateError=function(){var l=Array.prototype.slice.call(arguments),c=o.interpolate.apply(this,l);this.isAsync?this.pushCode("return process.nextTick(function() { callback(new Error(".concat(c,"), vars); });")):this.pushCode("throw new Error(".concat(c,");"))},o.prototype.generateTmpVariable=function(){return"$tmp".concat(this.tmpVariableCount++)},o.prototype.pushCode=function(){var l=Array.prototype.slice.call(arguments);this.code+="".concat(o.interpolate.apply(this,l),`
`)},o.prototype.pushPath=function(l){l&&this.scopes[this.scopes.length-1].push(l)},o.prototype.popPath=function(l){l&&this.scopes[this.scopes.length-1].pop()},o.prototype.pushScope=function(l){this.scopes.push([l])},o.prototype.popScope=function(){this.scopes.pop()},o.prototype.addReference=function(l){this.references[l]||(this.references[l]={resolved:!1,requested:!1})},o.prototype.markResolved=function(l){this.references[l].resolved=!0},o.prototype.markRequested=function(l){l.forEach(function(c){this.references[c].requested=!0}.bind(this))},o.prototype.getUnresolvedReferences=function(){var l=this.references;return Object.keys(this.references).filter(function(c){return!l[c].resolved&&!l[c].requested})},o.interpolate=function(l){var c=/{\d+}/g,h=l.match(c),d=Array.prototype.slice.call(arguments,1);return h&&h.forEach(function(f){var u=parseInt(f.substr(1,f.length-2),10);l=l.replace(f,d[u].toString())}),l},r._=o},22:s=>{s.exports.runInThisContext=function(r){return new Function("code","return eval(code);").call(globalThis,r)}},445:(s,r,a)=>{let o=a(7381),l=a(9260),c=a(576),h=a(4693),d=128;s.exports=class{decode(f){return this.stream=new l(f),this.decodeStream(this.stream)}decodeStream(f,u=0){var g=this.stream.ReadByte();16&g||(u=this.stream.ReadUint7());var _,b=u,w=1&g;if(8&g)return this.decodeStripe(this.stream,u);if(g&d&&([_,b]=this.decodePackMeta(this.stream)),32&g)var p=this.decodeCat(this.stream,b);else p=4&g?this.decodeExt(this.stream,b):64&g?w?this.decodeRLE1(this.stream,b):this.decodeRLE0(this.stream,b):w?this.decode1(this.stream,b):this.decode0(this.stream,b);return g&d&&(p=this.decodePack(p,_,u)),p}encode(f,u){if(this.stream=new l("",0,1.1*f.length+100),this.stream.WriteByte(u),16&u||this.stream.WriteUint7(f.length),8&u)return __Buffer$.concat([this.stream.buf.slice(0,this.stream.pos),this.encodeStripe(this.stream,f,u>>8)]);var g,_=1&u,b=f.length;return u&d&&([g,f,b]=this.encodePack(f)),u&d&&this.stream.WriteStream(g),64&u?_?this.encodeRLE1(f,b,this.stream):this.encodeRLE0(f,b,this.stream):_?this.encode1(f,b,this.stream):this.encode0(f,b,this.stream)}decode0(f,u){var g=new __Buffer$.allocUnsafe(u),_=f.ReadByte();_==0&&(_=256);var b=new c(_),w=new o(f);w.RangeStartDecode(f);for(var p=0;p<u;p++)g[p]=b.ModelDecode(f,w);return g}encode0(f,u,g){for(var _=0,b=0;b<u;b++)_<f[b]&&(_=f[b]);_++;var w=new c(_);g.WriteByte(_);var p=new o(g);for(b=0;b<u;b++)w.ModelEncode(g,p,f[b]);return p.RangeFinishEncode(g),g.buf.slice(0,g.pos)}decode1(f,u){var g=new __Buffer$.allocUnsafe(u),_=f.ReadByte();_==0&&(_=256);for(var b=new Array(_),w=0;w<_;w++)b[w]=new c(_);var p=new o(f);p.RangeStartDecode(f);var m=0;for(w=0;w<u;w++)g[w]=b[m].ModelDecode(f,p),m=g[w];return g}encode1(f,u,g){for(var _=0,b=0;b<u;b++)_<f[b]&&(_=f[b]);_++;var w=new Array(_);for(b=0;b<_;b++)w[b]=new c(_);g.WriteByte(_);var p=new o(g),m=0;for(b=0;b<u;b++)w[m].ModelEncode(g,p,f[b]),m=f[b];return p.RangeFinishEncode(g),g.buf.slice(0,g.pos)}decodeExt(f,u){var g=new __Buffer$.allocUnsafe(u),_=h.array(f.buf.slice(f.pos)),b=h.header(_),w=0;do{var p=h.decompress(_,b);p!=-1&&(__Buffer$.from(p).copy(g,w),w+=p.length,b-=p.length)}while(p!=-1);return g}encodeExt(f,u){}decodeRLE0(f,u){var g=new __Buffer$.allocUnsafe(u),_=f.ReadByte();_==0&&(_=256);for(var b=new c(_),w=new Array(258),p=0;p<=257;p++)w[p]=new c(4);var m=new o(f);for(m.RangeStartDecode(f),p=0;p<u;){g[p]=b.ModelDecode(f,m);for(var v=w[g[p]].ModelDecode(f,m),x=v,R=256;v==3;)v=w[R].ModelDecode(f,m),R=257,x+=v;for(var M=1;M<=x;M++)g[p+M]=g[p];p+=x+1}return g}encodeRLE0(f,u,g){for(var _=0,b=0;b<u;b++)_<f[b]&&(_=f[b]);_++;var w=new c(_),p=new Array(258);for(b=0;b<=257;b++)p[b]=new c(4);g.WriteByte(_);var m=new o(g);for(b=0;b<u;){w.ModelEncode(g,m,f[b]);for(var v=1;b+v<u&&f[b+v]==f[b];)v++;v--;var x=f[b];f[b],b+=v+1;var R=v>=3?3:v;for(p[x].ModelEncode(g,m,R),v-=R,x=256;R==3;)R=v>=3?3:v,p[x].ModelEncode(g,m,R),x=257,v-=R}return m.RangeFinishEncode(g),g.buf.slice(0,g.pos)}decodeRLE1(f,u){var g=new __Buffer$.allocUnsafe(u),_=f.ReadByte();_==0&&(_=256);for(var b=new Array(_),w=0;w<_;w++)b[w]=new c(_);var p=new Array(258);for(w=0;w<=257;w++)p[w]=new c(4);var m=new o(f);m.RangeStartDecode(f);var v=0;for(w=0;w<u;){g[w]=b[v].ModelDecode(f,m),v=g[w];for(var x=p[g[w]].ModelDecode(f,m),R=x,M=256;x==3;)x=p[M].ModelDecode(f,m),M=257,R+=x;for(var C=1;C<=R;C++)g[w+C]=g[w];w+=R+1}return g}encodeRLE1(f,u,g){for(var _=0,b=0;b<u;b++)_<f[b]&&(_=f[b]);_++;var w=new Array(_);for(b=0;b<_;b++)w[b]=new c(_);var p=new Array(258);for(b=0;b<=257;b++)p[b]=new c(4);g.WriteByte(_);for(var m=new o(g),v=(b=0,0);b<u;){w[v].ModelEncode(g,m,f[b]);for(var x=1;b+x<u&&f[b+x]==f[b];)x++;x--;var R=f[b];v=f[b],b+=x+1;var M=x>=3?3:x;for(p[R].ModelEncode(g,m,M),x-=M,R=256;M==3;)M=x>=3?3:x,p[R].ModelEncode(g,m,M),R=257,x-=M}return m.RangeFinishEncode(g),g.buf.slice(0,g.pos)}decodePackMeta(f){this.nsym=f.ReadByte();for(var u=new Array(this.nsym),g=0;g<this.nsym;g++)u[g]=f.ReadByte();return[u,f.ReadUint7()]}decodePack(f,u,g){var _=new __Buffer$.allocUnsafe(g);if(this.nsym<=1)for(var b=0;b<g;b++)_[b]=u[0];else if(this.nsym<=2){b=0;for(var w=0;b<g;b++){if(b%8==0)var p=f[w++];_[b]=u[1&p],p>>=1}}else if(this.nsym<=4)for(b=0,w=0;b<g;b++)b%4==0&&(p=f[w++]),_[b]=u[3&p],p>>=2;else{if(!(this.nsym<=16))return f;for(b=0,w=0;b<g;b++)b%2==0&&(p=f[w++]),_[b]=u[15&p],p>>=4}return _}packMeta(f){for(var u=new l("",0,1024),g=new Array(256),_=0;_<f.length;_++)g[f[_]]=1;var b=0;for(_=0;_<256;_++)g[_]&&(g[_]=++b);for(u.WriteByte(b),_=0;_<256;_++)g[_]&&(u.WriteByte(_),g[_]--);return[u,g,b]}encodePack(f){var u,g,_;[u,g,_]=this.packMeta(f);var b=f.length,w=0;if(_<=1)return u.WriteUint7(0),[u,new __Buffer$.allocUnsafe(0),0];if(_<=2){for(var p=new __Buffer$.allocUnsafe(Math.floor((b+7)/8)),m=(w=0,0);w<(-8&b);w+=8,m++)p[m]=(g[f[w+0]]<<0)+(g[f[w+1]]<<1)+(g[f[w+2]]<<2)+(g[f[w+3]]<<3)+(g[f[w+4]]<<4)+(g[f[w+5]]<<5)+(g[f[w+6]]<<6)+(g[f[w+7]]<<7);if(w<b){p[m]=0;for(var v=0;w<b;)p[m]|=g[f[w++]]<<v,v++;m++}return u.WriteUint7(m),[u,p,p.length]}if(_<=4){for(p=new __Buffer$.allocUnsafe(Math.floor((b+3)/4)),w=0,m=0;w<(-4&b);w+=4,m++)p[m]=(g[f[w+0]]<<0)+(g[f[w+1]]<<2)+(g[f[w+2]]<<4)+(g[f[w+3]]<<6);if(w<b){for(p[m]=0,v=0;w<b;)p[m]|=g[f[w++]]<<v,v+=2;m++}return u.WriteUint7(m),[u,p,p.length]}if(_<=16){for(p=new __Buffer$.allocUnsafe(Math.floor((b+1)/2)),w=0,m=0;w<(-2&b);w+=2,m++)p[m]=(g[f[w+0]]<<0)+(g[f[w+1]]<<4);return w<b&&(p[m++]=g[f[w++]]),u.WriteUint7(m),[u,p,p.length]}return u.WriteUint7(f.length),[u,f,f.length]}encodeStripe(f,u,g){g==0&&(g=4);for(var _=new Array(g),b=new Array(g),w=0;w<g;w++)b[w]=Math.floor(u.length/g)+(u.length%g>w),_[w]=new Array(b[w]);for(var p=0,m=0;m<u.length;m+=g,p++)for(var v=0;v<g;v++)p<_[v].length&&(_[v][p]=u[m+v]);var x=new Array(g),R=0;for(w=0;w<g;w++){var M=this.encode(_[w],0),C=this.encode(_[w],1);x[w]=C.length<M.length?C:M,R+=x[w].length}var L=new l("",0,R+5*g+1);for(L.WriteByte(g),w=0;w<g;w++)L.WriteUint7(x[w].length);for(w=0;w<g;w++)L.WriteData(x[w],x[w].length);return L.buf.slice(0,L.buf.pos)}decodeStripe(f,u){for(var g=f.ReadByte(),_=new Array(g),b=new Array(g),w=0;w<g;w++)_[w]=f.ReadUint7();var p=new Array(g);for(w=0;w<g;w++)b[w]=Math.floor(u/g)+(u%g>w),p[w]=this.decodeStream(f,b[w]);var m=new __Buffer$.allocUnsafe(u);for(w=0;w<g;w++)for(var v=0;v<b[w];v++)m[v*g+w]=p[w][v];return m}decodeCat(f,u){for(var g=new __Buffer$.allocUnsafe(u),_=0;_<u;_++)g[_]=f.ReadByte();return g}}},7381:s=>{s.exports=class{constructor(r){this.low=0,this.range=4294967295,this.code=0,this.FFnum=0,this.carry=0,this.cache=0}RangeStartDecode(r){for(var a=0;a<5;a++)this.code=(this.code<<8)+r.ReadByte();this.code&=4294967295,this.code>>>=0}RangeGetFrequency(r){return this.range=Math.floor(this.range/r),Math.floor(this.code/this.range)}RangeDecode(r,a,o,l){for(this.code-=a*this.range,this.range*=o;this.range<16777216;)this.range*=256,this.code=256*this.code+r.ReadByte()}RangeShiftLow(r){if(this.low<4278190080|this.carry){for(r.WriteByte(this.cache+this.carry);this.FFnum;)r.WriteByte(this.carry-1),this.FFnum--;this.cache=this.low>>>24,this.carry=0}else this.FFnum++;this.low<<=8,this.low>>>=0}RangeEncode(r,a,o,l){var c=this.low;for(this.range=Math.floor(this.range/l),this.low+=a*this.range,this.low>>>=0,this.range*=o,this.low<c&&(this.carry!=0&&console.log("ERROR: Multiple carry"),this.carry=1);this.range<16777216;)this.range*=256,this.RangeShiftLow(r)}RangeFinishEncode(r){for(var a=0;a<5;a++)this.RangeShiftLow(r)}}},576:s=>{s.exports=class{constructor(r=256){this.total_freq=r,this.max_sym=r-1,this.S=new Array,this.F=new Array;for(var a=0;a<=this.max_sym;a++)this.S[a]=a,this.F[a]=1}ModelDecode(r,a){for(var o=a.RangeGetFrequency(this.total_freq),l=0,c=0;l+this.F[c]<=o;)l+=this.F[c++];a.RangeDecode(r,l,this.F[c],this.total_freq),this.F[c]+=16,this.total_freq+=16,this.total_freq>65519&&this.ModelRenormalise();var h=this.S[c];if(c>0&&this.F[c]>this.F[c-1]){var d=this.F[c];this.F[c]=this.F[c-1],this.F[c-1]=d,d=this.S[c],this.S[c]=this.S[c-1],this.S[c-1]=d}return h}ModelRenormalise(){this.total_freq=0;for(var r=0;r<=this.max_sym;r++)this.F[r]-=Math.floor(this.F[r]/2),this.total_freq+=this.F[r]}ModelEncode(r,a,o){for(var l=0,c=0;this.S[c]!=o;c++)l+=this.F[c];if(a.RangeEncode(r,l,this.F[c],this.total_freq),this.F[c]+=16,this.total_freq+=16,this.total_freq>65519&&this.ModelRenormalise(),o=this.S[c],c>0&&this.F[c]>this.F[c-1]){var h=this.F[c];this.F[c]=this.F[c-1],this.F[c-1]=h,h=this.S[c],this.S[c]=this.S[c-1],this.S[c-1]=h}}}},5260:(s,r,a)=>{let o=a(9260),l=a(576),c=a(7381);function h(_,b,w){for(var p=0,m=0,v=-1,x=new Array(1024);m<w;){var R=_.ReadByte();if(x[p++]=R,m+=R,R==v){var M=_.ReadByte();for(m+=R*M;M--;)x[p++]=R}v=R}var C=0;for(p=0,m=0;m<w;){var L=0;do{var y=x[p++];L+=y}while(y==255);for(;L--;)b[m++]=C;C++}}function d(_,b,w){var p=_.context;return b.qctx=(b.qctx<<_.qshift)+_.qtab[w],p+=(b.qctx&(1<<_.qbits)-1)<<_.qloc,_.do_pos&&(p+=_.ptab[Math.min(b.p,1023)]<<_.ploc),_.do_delta&&(p+=_.dtab[Math.min(b.delta,255)]<<_.dloc,b.delta+=b.prevq!=w?1:0,b.prevq=w),_.do_sel&&(p+=b.s<<_.sloc),b.p--,65535&p}function f(_){var b={};b.context=_.ReadUint16(),b.pflags=_.ReadByte(),b.do_dedup=2&b.pflags,b.fixed_len=4&b.pflags,b.do_sel=8&b.pflags,b.do_qmap=16&b.pflags,b.do_pos=32&b.pflags,b.do_delta=64&b.pflags,b.do_qtab=128&b.pflags,b.max_sym=_.ReadByte();var w=_.ReadByte();if(b.qbits=w>>4,b.qshift=15&w,w=_.ReadByte(),b.qloc=w>>4,b.sloc=15&w,w=_.ReadByte(),b.ploc=w>>4,b.dloc=15&w,b.qmap=new Array(256),16&b.pflags)for(var p=0;p<b.max_sym;p++)b.qmap[p]=_.ReadByte();else for(p=0;p<256;p++)b.qmap[p]=p;if(b.qtab=new Array(1024),b.qbits>0&&128&b.pflags)h(_,b.qtab,256);else for(p=0;p<256;p++)b.qtab[p]=p;return b.ptab=new Array(1024),32&b.pflags&&h(_,b.ptab,1024),b.dtab=new Array(256),64&b.pflags&&h(_,b.dtab,256),b}function u(_,b,w,p,m,v){w.max_sel>0?m.s=p.sel.ModelDecode(_,b):m.s=0,m.x=w.stab[m.s];var x=w.params[m.x];if(x.fixed_len>=0){var R=p.len[0].ModelDecode(_,b);R|=p.len[1].ModelDecode(_,b)<<8,R|=p.len[2].ModelDecode(_,b)<<16,R|=p.len[3].ModelDecode(_,b)<<24,x.fixed_len>0&&(x.fixed_len=-R)}else R=-x.fixed_len;m.len=R,w.do_rev&&(v[m.rec]=p.rev.ModelDecode(_,b)),m.is_dup=0,2&x.pflags&&p.dup.ModelDecode(_,b)&&(m.is_dup=1),m.p=R,m.delta=0,m.qctx=0,m.prevq=0,m.rec++}function g(_,b,w){for(var p=0,m=0,v=new Array(2*w),x=0;p<w;){for(var R=p;p<w&&b[p]==m;)p++;var M=p-R;do{var C=Math.min(255,M);v[x++]=C,M-=C}while(C==255);m++}var L=-1,y=new Array(2*w),E=0;for(p=0;p<x;){var k=v[p++];if(y[E++]=k,k==L){for(R=p;p<x&&v[p]==L&&p-R<255;)p++;y[E++]=p-R}else L=k}_.WriteData(y,E)}s.exports={decode:function(_,b){return function(w,p){var m=w.ReadUint7(),v=function(F){var X={max_sym:0};if(F.ReadByte()==5){var U=F.ReadByte(),V=1&U?F.ReadByte():1,q=U.nparam>1?U.nparam-1:0,S=new Array(256);if(2&U)q=F.ReadByte(),h(F,S,256);else{for(var P=0;P<V;P++)S[P]=P;for(;P<256;P++)S[P]=V-1}X.do_rev=4&U,X.stab=S,X.max_sel=q,X.params=new Array(X.nparam);for(var H=0;H<V;H++)X.params[H]=f(F),X.max_sym<X.params[H].max_sym&&(X.max_sym=X.params[H].max_sym);return X}console.error("Invalid FQZComp version number")}(w);if(v){var x=v.params,R=new Array(p.length),M=function(F){var X={};X.qual=new Array(65536);for(var U=0;U<65536;U++)X.qual[U]=new l(F.max_sym+1);for(X.len=new Array(4),U=0;U<4;U++)X.len[U]=new l(256);return X.rev=new l(2),X.dup=new l(2),F.max_sel>0&&(X.sel=new l(F.max_sel+1)),X}(v),C=new c(w);C.RangeStartDecode(w);for(var L=new __Buffer$.allocUnsafe(m),y={qctx:0,prevq:0,delta:0,p:0,s:0,x:0,len:0,is_dup:0,rec:0},E=0;E<m;){if(y.p==0){if(u(w,C,v,M,y,R),y.is_dup>0&&M.dup.ModelDecode(w,C)){for(var k=0;k<len;k++)L[E+k]=L[E+k-y.len];E+=y.len,y.p=0;continue}p.push(y.len);var A=(x=v.params[y.x]).context}var I=M.qual[A].ModelDecode(w,C);L[E++]=x.qmap[I],A=d(x,y,I)}return v.do_rev&&function(F,X,U,V){for(var q=0,S=0;S<X;){if(U[q])for(var P=0,H=V[q]-1;P<H;){var D=F[S+P];F[S+P]=F[S+H],F[S+H]=D,P++,H--}S+=V[q++]}}(L,m,R,p),L}}(new o(_),b)},encode:function(_,b,w){for(var p=new Array(2),m=new Array(2),v=new Array(2),x=new Array(2),R=new Array(256),M=0;M<2;M++)p[M]=new Array(256),m[M]=new Array(256),v[M]=new Array(1024),x[M]=new Array(256);(L=new o("",0,1.1*_.length+100)).WriteUint7(_.length);var C=function(y,E,k,A){for(var I=k[0],F=0;F<k.length&&k[F]==I;F++);var X=F==k.length?1:0,U=0,V=0;for(F=0;F<256;F++)A[0][F]=0;var q=0,S=0;for(F=0;F<y.length;F++)S==0&&(S=E[q<E.length-1?q++:q]),A[0][y[F]]++,S--;for(F=0;F<256;F++)A[0][F]&&(V<F&&(V=F),U++);var P=5,H=0;return U<=16&&(H=1,P=U<=2?1:U<=4?2:U<=8?3:4),[{qbits:8+(P>4),qshift:P,qloc:7,pbits:7,pshift:E[0]>128?1:0,ploc:0,dbits:P>4?0:1,dshift:3,dloc:15,sbits:0,sloc:15,do_stab:0,context:0,max_sym:V,nsym:U,do_qmap:H,do_dedup:0,fixed_len:E.length==1?1:0,do_sel:0,do_rev:0,do_pos:1,do_delta:P<=4?1:0,do_qtab:0,qbits:8+(P>4)-(X==0),sbits:1,sloc:15-(P<=4),do_stab:1,do_sel:1}]}(_,b,w,p),L=function(y,E,k,A,I,F,X){for(var U=[0,1,1,1,2,2,2,2,2,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],V=0;V<E.length;V++)X[V]=V;for(;V<256;V++)X[V]=E.length-1;y.WriteByte(5);var q=(E.length>1?1:0)|(E[0].do_stab?2:0);if(y.WriteByte(q),1&q&&y.WriteByte(E.length),2&q){var S=1<<E[0].sbits;S>0&&S--,y.WriteByte(S),g(y,X,256)}for(var P=0;P<E.length;P++){if(y.WriteUint16(E[P].context),y.WriteByte((E[P].do_qtab?128:0)|(E[P].do_delta?64:0)|(E[P].do_pos?32:0)|(E[P].do_qmap?16:0)|(E[P].do_sel?8:0)|(E[P].fixed_len?4:0)|(E[P].do_dedup?2:0)),E[P].do_qmap?y.WriteByte(E[P].nsym):y.WriteByte(E[P].max_sym),y.WriteByte(E[P].qbits<<4|E[P].qshift),y.WriteByte(E[P].qloc<<4|E[P].sloc),y.WriteByte(E[P].ploc<<4|E[P].dloc),E[P].do_qmap){E[P].max_sym=E[P].nsym;var H=0;for(V=0;V<256;V++)k[P][V]&&(y.WriteByte(V),k[P][V]=H++);for(;H<E[P].nsym;H++)y.WriteByte(0)}else for(V=0;V<256;V++)k[P][V]=V;if(E[P].qbits>0){for(V=0;V<256;V++)A[P][V]=V;E[P].do_qtab&&g(y,A[P],256)}if(E[P].pbits>0){for(V=0;V<1024;V++)I[P][V]=Math.min((1<<E[P].pbits)-1,V>>E[P].pshift);g(y,I[P],1024)}if(E[P].dbits>0){for(V=0;V<256;V++)U[V]>(1<<E[P].dbits)-1&&(U[V]=(1<<E[P].dbits)-1);for(V=0;V<256;V++)F[P][V]=U[Math.min(U.length-1,V>>E[P].dshift)];g(y,F[P],256)}}return y}(L,C,p,m,v,x,R);return function(y,E,k,A,I,F,X,U,V,q){var S=1<<I[0].sbits;S>0&&S--;for(var P=E.length,H=0,D=0;D<I.length;D++)H<I[D].max_sym&&(H=I[D].max_sym);for(var O=new Array(65536),W=0;W<65536;W++)O[W]=new l(H+1);var j=new Array(4);for(W=0;W<4;W++)j[W]=new l(256);new l(2),new l(2);for(var G=new l(S+1),Z=new c(E),te=(D=0,W=0,0);W<P;){if(D==0){var se=A[te];I[0].sbits>0&&G.ModelEncode(y,Z,se);var re=q[se],ae=k[Math.min(k.length-1,te++)];I[re].fixed_len?I[re].fixed_len>0&&(j[0].ModelEncode(y,Z,255&ae),j[1].ModelEncode(y,Z,ae>>8&255),j[2].ModelEncode(y,Z,ae>>16&255),j[3].ModelEncode(y,Z,ae>>24&255),I[re].fixed_len=-1):(j[0].ModelEncode(y,Z,255&ae),j[1].ModelEncode(y,Z,ae>>8&255),j[2].ModelEncode(y,Z,ae>>16&255),j[3].ModelEncode(y,Z,ae>>24&255)),I[re].do_dedup&&__Process$.exit(1),D=ae;var me=0,ue=I[re].context,Se=0,_e=0}var ge=E[W++],ke=F[re][ge];O[ue].ModelEncode(y,Z,ke),Se=(Se<<I[re].qshift)+X[re][ke],ue=I[re].context,ue+=(Se&(1<<I[re].qbits)-1)<<I[re].qloc,I[re].pbits>0&&(ue+=U[re][Math.min(D,1023)]<<I[re].ploc),I[re].dbits>0&&(ue+=V[re][Math.min(me,255)]<<I[re].dloc,me+=_e!=ke?1:0,_e=ke),I[re].do_sel&&(ue+=se<<I[re].sloc),ue&=65535,D--}return Z.RangeFinishEncode(y),y.buf.slice(0,y.pos)}(L,_,b,w,C,p,m,v,x,R)}}},3498:(s,r,a)=>{var o=a(4459),l=a(594),c=a(445),h=a(5260),d=a(2881);s.exports={r4x8_uncompress:function(f,u){o.decode(f).copy(u,0,0)},r4x16_uncompress:function(f,u){l.decode(f).copy(u,0,0)},arith_uncompress:function(f,u){c.decode(f).copy(u,0,0)},fqzcomp_uncompress:function(f,u){var g=new Array;h.decode(f,g).copy(u,0,0)},tok3_uncompress:function(f,u){var g=d.decode(f,0,"\0");__Buffer$.from(g,"binary").copy(u,0,0)}}},9260:s=>{s.exports=class{constructor(r,a=0,o=0){o!=0?(this.buf=__Buffer$.allocUnsafe(o),this.length=o):(this.buf=r,this.length=r.length),this.pos=a}EOF(){return this.pos>=this.length}ReadData(r){var a=this.buf.slice(this.pos,this.pos+r);return this.pos+=r,a}ReadByte(){let r=this.buf[this.pos];return this.pos++,r}ReadChar(){let r=this.buf[this.pos];return this.pos++,String.fromCharCode(r)}ReadUint16(){return this.ReadByte()|this.ReadByte()<<8}ReadUint32(){let r=this.buf.readInt32LE(this.pos);return this.pos+=4,r}ReadString(){var r="";do{var a=this.buf[this.pos++];a&&(r+=String.fromCharCode(a))}while(a);return r}ReadUint7(){var r=0;do{var a=this.ReadByte();r=r<<7|127&a}while(128&a);return r}ReadITF8(){var r=this.buf[this.pos];return this.pos++,r>=240?(r=(15&r)<<28,r+=(this.buf[this.pos+0]<<20)+(this.buf[this.pos+1]<<12)+(this.buf[this.pos+2]<<4)+(this.buf[this.pos+3]>>4),this.pos+=4):r>=224?(r=(15&r)<<24,r+=(this.buf[this.pos+0]<<16)+(this.buf[this.pos+1]<<8)+(this.buf[this.pos+2]<<0),this.pos+=3):r>=192?(r=(31&r)<<16,r+=(this.buf[this.pos+0]<<8)+(this.buf[this.pos+1]<<0),this.pos+=2):r>=128&&(r=(63&r)<<8,r+=this.buf[this.pos],this.pos++),r}WriteByte(r){this.buf[this.pos++]=r}WriteChar(r){this.buf[this.pos++]=r.charCodeAt(0)}WriteString(r){for(var a=0;a<r.length;a++)this.buf[this.pos++]=r.charCodeAt(a);this.buf[this.pos++]=0}WriteData(r,a){for(var o=0;o<a;o++)this.buf[this.pos++]=r[o]}WriteStream(r){this.WriteData(r.buf,r.pos)}WriteUint16(r){this.WriteByte(255&r),this.WriteByte(r>>8&255)}WriteUint32(r){this.buf.writeInt32LE(r,this.pos),this.pos+=4}WriteUint7(r){var a=0,o=r;do a+=7,o>>=7;while(o>0);do a-=7,this.WriteByte((r>>a&127)+((a>0)<<7));while(a>0)}WriteITF8(r){r<0&&(r=1+r),r<=127?this.buf[this.pos++]=r:r<=16383?(this.buf[this.pos++]=128|Math.floor(r/256),this.buf[this.pos++]=255&r):r<131071?(this.buf[this.pos++]=192|Math.floor(r/65536),this.buf[this.pos++]=255&Math.floor(r/256),this.buf[this.pos++]=255&r):r<268435455?(this.buf[this.pos++]=224|Math.floor(r/16777216),this.buf[this.pos++]=255&Math.floor(r/65536),this.buf[this.pos++]=255&Math.floor(r/256),this.buf[this.pos++]=255&r):(this.buf[this.pos++]=240|Math.floor(r/268435456),this.buf[this.pos++]=255&Math.floor(r/1048576),this.buf[this.pos++]=255&Math.floor(r/4096),this.buf[this.pos++]=255&Math.floor(r/4),this.buf[this.pos++]=15&r)}WriteByteNeg(r){this.buf[--this.pos]=r}}},4459:(s,r,a)=>{let o=a(9260);function l(p){return 4095&p}function c(p,m){for(var v=0;m>=p[v+1];)v++;return v}function h(p){for(var m=new Array(4096),v=0,x=0;x<4096;x++){for(;x>=p[v+1];)v++;m[x]=v}return m}function d(p,m,v){return v*(p>>12)+(4095&p)-m}function f(p,m){for(;m<8388608;)m=(m<<8)+p.ReadByte();return m}function u(p,m){m.WriteByteNeg(p>>24&255),m.WriteByteNeg(p>>16&255),m.WriteByteNeg(p>>8&255),m.WriteByteNeg(p>>0&255)}function g(p,m,v,x,R){return p=function(M,C,L,y){for(var E=(8388608>>y<<8)*L;M>=E;)C.WriteByteNeg(255&M),M>>=8;return M}(p,m,x,R),(Math.floor(p/x)<<R)+p%x+v}function _(p,m,v){for(var x=0;x<256;x++)m[x]=0;var R=p.ReadByte(),M=R,C=0;do{var L=p.ReadITF8();m[R]=L,C>0?(C--,R++):(R=p.ReadByte())==M+1&&(C=p.ReadByte()),M=R}while(R!=0);for(v[0]=0,x=0;x<=255;x++)v[x+1]=v[x]+m[x]}function b(p){for(var m=0,v=0;v<256;v++)m+=p[v];let x=4096;var R=x/m;do{var M=0,C=0,L=0;for(m=0,v=0;v<256;v++)p[v]!=0&&(M<p[v]&&(M=p[v],C=v),p[v]=Math.floor(p[v]*R),p[v]==0&&(p[v]=1),m+=p[v]);m<x?p[C]+=x-m:m-x<p[C]/2&&p[C]>2?p[C]-=m-x:m!=x&&(R*=.99,L=1)}while(L)}function w(p,m){for(var v=0,x=0;x<256;x++)if(m[x]){if(v>0)v--;else if(p.WriteByte(x),x>0&&m[x-1]>0){for(v=x+1;v<256&&m[v];v++);v-=x+1,p.WriteByte(v)}p.WriteITF8(m[x])}p.WriteByte(0)}s.exports={decode:function(p){var m=new o(p),v=m.ReadByte(),x=(m.ReadUint32(),m.ReadUint32());return v==0?function(R,M){var C=new Array(256),L=new Array(256);_(R,C,L);for(var y=h(L),E=new Array(4),k=0;k<4;k++)E[k]=R.ReadUint32();var A=new __Buffer$.allocUnsafe(M);for(k=0;k<M;k++){var I=k%4,F=y[l(E[I])];A[k]=F,E[I]=d(E[I],L[F],C[F]),E[I]=f(R,E[I])}return A}(m,x):function(R,M){var C=new Array(256),L=new Array(256);(function(q,S,P){for(var H=0;H<256;H++){S[H]=new Array(256),P[H]=new Array(256);for(var D=0;D<256;D++)S[H][D]=0}var O=q.ReadByte(),W=O,j=0;do _(q,S[O],P[O]),j>0?(j--,O++):(O=q.ReadByte())==W+1&&(j=q.ReadByte()),W=O;while(O!=0)})(R,C,L);for(var y=new Array(256),E=0;E<256;E++)y[E]=h(L[E]);for(var k=new Array(4),A=new Array(4),I=0;I<4;I++)k[I]=R.ReadUint32(),A[I]=0;var F=new __Buffer$.allocUnsafe(M),X=Math.floor(M/4);for(E=0;E<X;E++)for(I=0;I<4;I++){var U=l(k[I]),V=y[A[I]][U];F[E+I*X]=V,k[I]=d(k[I],L[A[I]][V],C[A[I]][V]),k[I]=f(R,k[I]),A[I]=V}for(E*=4;E<M;)U=l(k[3]),V=c(L[A[3]],U),F[E++]=V,k[3]=d(k[3],L[A[3]][V],C[A[3]][V]),k[3]=f(R,k[3]),A[3]=V;return F}(m,x)},encode:function(p,m){return m==0?function(v){let x=v.length;var R=new o("",0,780);R.WriteByte(0),R.WriteUint32(0),R.WriteUint32(0);var M=new Array(256);(function(I,F){for(var X=0;X<256;X++)F[X]=0;for(X=0;X<I.length;X++)F[I[X]]++})(v,M),b(M),w(R,M);var C=new Array(256);C[0]=0;for(var L=1;L<256;L++)C[L]=C[L-1]+M[L-1];var y=new Array(4);for(L=0;L<4;L++)y[L]=8388608;var E=Math.floor(1.05*x+100),k=new o("",E,E);for(L=x-1;L>=0;L--)y[L%4]=g(y[L%4],k,C[v[L]],M[v[L]],12);for(L=3;L>=0;L--)u(y[L],k);var A=R.pos;return R.buf.writeInt32LE(A-9+(k.length-k.pos),1),R.buf.writeInt32LE(x,5),__Buffer$.concat([R.buf.slice(0,R.pos),k.buf.slice(k.pos,k.length)],R.pos+k.length-k.pos)}(p):function(v){let x=v.length;var R=new o("",0,198156);R.WriteByte(1),R.WriteUint32(0),R.WriteUint32(0);for(var M=new Array(256),C=new Array(256),L=new Array(256),y=0;y<256;y++)C[y]=new Array(256),L[y]=new Array(256);for(function(S,P,H){for(var D=0;D<256;D++){H[D]=0;for(var O=0;O<256;O++)P[D][O]=0}var W=0;for(D=0;D<S.length;D++)H[S[D]]++,P[W][S[D]]++,W=S[D];P[0][S[1*(S.length>>2)]]++,P[0][S[2*(S.length>>2)]]++,P[0][S[3*(S.length>>2)]]++,H[0]+=3}(v,C,M),function(S,P){for(var H=0;H<256;H++)P[H]&&b(S[H])}(C,M),function(S,P,H){for(var D=0,O=0;O<256;O++)if(H[O]){if(D>0)D--;else if(S.WriteByte(O),O>0&&H[O-1]>0){for(D=O+1;D<256&&H[D];D++);D-=O+1,S.WriteByte(D)}w(S,P[O])}S.WriteByte(0)}(R,C,M),y=0;y<256;y++)if(M[y]){L[y][0]=0;for(var E=1;E<256;E++)L[y][E]=L[y][E-1]+C[y][E-1]}var k=new Array(4),A=new Array(4);for(E=0;E<4;E++)k[E]=8388608,A[E]=0;var I=new o("",x,x),F=Math.floor(x/4),X=new Array(4),U=new Array(4);for(E=0;E<4;E++)X[E]=(E+1)*F-2,U[E]=v[X[E]+1];for(U[3]=v[x-1],y=x-2;y>4*F-2;y--)k[3]=g(k[3],I,L[v[y]][U[3]],C[v[y]][U[3]],12),U[3]=v[y];for(;X[0]>=0;)for(E=3;E>=0;E--){var V=v[X[E]];k[E]=g(k[E],I,L[V][U[E]],C[V][U[E]],12),U[E]=V,X[E]--}for(E=3;E>=0;E--)k[E]=g(k[E],I,L[0][U[E]],C[0][U[E]],12);for(y=3;y>=0;y--)u(k[y],I);var q=R.pos;return R.buf.writeInt32LE(q-9+(I.length-I.pos),1),R.buf.writeInt32LE(x,5),__Buffer$.concat([R.buf.slice(0,R.pos),I.buf.slice(I.pos,I.length)],R.pos+I.length-I.pos)}(p)}}},594:(s,r,a)=>{let o=a(9260);function l(C,L){return C&(1<<L)-1}function c(C,L){for(var y=0;L>=C[y+1];)y++;return y}function h(C,L){for(var y=1<<L,E=new Array(y),k=0,A=0;A<y;A++){for(;A>=C[k+1];)k++;E[A]=k}return E}function d(C,L,y,E){return y*(C>>E)+(C&(1<<E)-1)-L}function f(C,L){return L<32768&&(L=(L<<16)+C.ReadUint16()),L}function u(C,L){L.WriteByteNeg(C>>24&255),L.WriteByteNeg(C>>16&255),L.WriteByteNeg(C>>8&255),L.WriteByteNeg(C>>0&255)}function g(C,L,y,E,k){return C=function(A,I,F,X){for(var U=(1<<31-X)*F;A>=U;)I.WriteByteNeg(A>>8&255),I.WriteByteNeg(255&A),A>>=16;return A}(C,L,E,k),(Math.floor(C/E)<<k)+C%E+y}function _(C,L,y){y==0&&(y=4);for(var E=new Array(y),k=new Array(y),A=0;A<y;A++)k[A]=Math.floor(L.length/y)+(L.length%y>A),E[A]=new Array(k[A]);for(var I=0,F=0;F<L.length;F+=y,I++)for(var X=0;X<y;X++)I<E[X].length&&(E[X][I]=L[F+X]);var U=new Array(y),V=0;for(A=0;A<y;A++){var q=w(E[A],0),S=w(E[A],1);U[A]=S.length<q.length?S:q,V+=U[A].length}var P=new o("",0,V+5*y+1);for(P.WriteByte(y),A=0;A<y;A++)P.WriteUint7(U[A].length);for(A=0;A<y;A++)P.WriteData(U[A],U[A].length);return P.buf.slice(0,P.buf.pos)}function b(C,H){var y=C.ReadByte(),E=1&y,k=8&y,A=32&y,I=64&y,F=128&y;if(16&y||(H=C.ReadUint7()),k)return function(O,W){for(var j=O.ReadByte(),G=new Array(j),Z=new Array(j),te=0;te<j;te++)G[te]=O.ReadUint7();var se=new Array(j);for(te=0;te<j;te++)Z[te]=Math.floor(W/j)+(W%j>te),se[te]=b(O,Z[te]);var re=new __Buffer$.allocUnsafe(W);for(te=0;te<j;te++)for(var ae=0;ae<Z[te];ae++)re[ae*j+te]=se[te][ae];return re}(C,H);if(F)var X=H,[U,V,H]=function(O){for(var W=O.ReadByte(),j=new Array(W),G=0;G<W;G++)j[G]=O.ReadByte();return[j,W,O.ReadUint7()]}(C);if(I)var q=H,[S,P,H]=function(O){var W=O.ReadUint7(),j=O.ReadUint7();if(1&W)var G=O.ReadData((W-1)/2);else{var Z=O.ReadUint7();G=O.ReadData(Z),G=m(new o(G),W/2)}G=new o(G);var te=new Array(256),se=G.ReadByte();se==0&&(se=256);for(var re=0;re<se;re++)te[G.ReadByte()]=1;return[te,G,j]}(C);if(A)var D=C.ReadData(H);else D=E==0?m(C,H):function(O,W){var j=(se=O.ReadByte())>>4,G=O;if(1&se){var Z=O.ReadUint7(),te=O.ReadUint7(),se=new o(O.ReadData(te));G=new o(m(se,Z))}var re=new Array(256),ae=new Array(256);(function(T,N,z,Q){for(var K=0;K<256;K++){N[K]=new Array(256),z[K]=new Array(256);for(var ie=0;ie<256;ie++)N[K][ie]=0}var ce=p(T);for(K=0;K<256;K++)if(ce[K]){var Me=0;for(ie=0;ie<256;ie++)ce[ie]&&(Me>0?Me--:(N[K][ie]=T.ReadUint7(),N[K][ie]==0&&(Me=T.ReadByte())));for(x(N[K],Q),z[K][0]=0,ie=0;ie<256;ie++)z[K][ie+1]=z[K][ie]+N[K][ie]}})(G,re,ae,j);for(var me=new Array(256),ue=0;ue<256;ue++)me[ue]=h(ae[ue],j);for(var Se=new Array(4),_e=new Array(4),ge=0;ge<4;ge++)Se[ge]=O.ReadUint32(),_e[ge]=0;var ke=new __Buffer$.allocUnsafe(W),Te=Math.floor(W/4);for(ue=0;ue<Te;ue++)for(ge=0;ge<4;ge++){var Fe=l(Se[ge],j),Ie=me[_e[ge]][Fe];ke[ue+ge*Te]=Ie,Se[ge]=d(Se[ge],ae[_e[ge]][Ie],re[_e[ge]][Ie],j),Se[ge]=f(O,Se[ge]),_e[ge]=Ie}for(ue*=4;ue<W;)Fe=l(Se[3],j),Ie=c(ae[_e[3]],Fe),ke[ue++]=Ie,Se[3]=d(Se[3],ae[_e[3]][Ie],re[_e[3]][Ie],j),Se[3]=f(O,Se[3]),_e[3]=Ie;return ke}(C,H);return I&&(D=function(O,W,j,G){new o(O);for(var Z=new __Buffer$.allocUnsafe(G),te=0,se=0;te<G;se++){var re=O[se];if(W[re])for(var ae=j.ReadUint7(),me=0;me<=ae;me++)Z[te++]=re;else Z[te++]=re}return Z}(D,S,P,q)),F&&(D=function(O,W,j,G){var Z=new __Buffer$.allocUnsafe(G),te=0;if(j<=1)for(var se=0;se<G;se++)Z[se]=W[0];else if(j<=2)for(se=0;se<G;se++){if(se%8==0)var re=O[te++];Z[se]=W[1&re],re>>=1}else if(j<=4)for(se=0;se<G;se++)se%4==0&&(re=O[te++]),Z[se]=W[3&re],re>>=2;else if(j<=16)for(se=0;se<G;se++)se%2==0&&(re=O[te++]),Z[se]=W[15&re],re>>=4;return Z}(D,U,V,X)),D}function w(C,L){var y=new o("",0,10);y.WriteByte(L);var E=1&L,k=8&L,A=32&L,I=64&L,F=128&L,X=L>>8;if(16&L||y.WriteUint7(C.length),k)return __Buffer$.concat([y.buf.slice(0,y.pos),_(0,C,X)]);var U=new __Buffer$.alloc(0);F&&([U,C]=function(S){for(var P=new Array(256),H=0;H<256;H++)P[H]=0;for(H=0;H<S.length;H++)P[S[H]]++;var D=new Array(256),O=0;for(H=0;H<256;H++)P[H]>0&&(D[H]=O++);if(!(O>16)){if(O<=1)var W=new __Buffer$.allocUnsafe(0);else if(O<=2){W=new __Buffer$.allocUnsafe(Math.ceil(S.length/8));var j=-1;for(H=0;H<S.length;H++)H%8==0&&(W[++j]=0),W[j]+=D[S[H]]<<H%8}else if(O<=4)for(W=new __Buffer$.allocUnsafe(Math.ceil(S.length/4)),j=-1,H=0;H<S.length;H++)H%4==0&&(W[++j]=0),W[j]+=D[S[H]]<<H%4*2;else for(W=new __Buffer$.allocUnsafe(Math.ceil(S.length/2)),j=-1,H=0;H<S.length;H++)H%2==0&&(W[++j]=0),W[j]+=D[S[H]]<<H%2*4;var G=new o("",0,O+5);for(G.WriteByte(O),j=0,H=0;H<256;H++)P[H]>0&&(P[H]=j++,G.WriteByte(H));return G.WriteUint7(W.length),[G.buf.slice(0,G.pos),W]}}(C));var V=new __Buffer$.alloc(0);if(I&&([V,C]=function(S){for(var P=new Array(256),H=0;H<256;H++)P[H]=0;var D=-1;for(H=0;H<S.length;H++)P[S[H]]+=S[H]==D?1:-1,D=S[H];var O=0;for(H=0;H<256;H++)P[H]>0&&O++;for(O||(O=1,P[0]=1),(Z=new o("",0,O+1+S.length)).WriteByte(O),H=0;H<256;H++)P[H]>0&&Z.WriteByte(H);var W=new __Buffer$.allocUnsafe(S.length),j=0;for(H=0;H<S.length;H++)if(W[j++]=S[H],P[S[H]]>0){D=S[H];for(var G=0;H+G+1<S.length&&S[H+G+1]==D;)G++;Z.WriteUint7(G),H+=G}var Z,te=M(Z.buf.slice(0,Z.pos)),se=new o("",0,16);return se.WriteUint7(2*Z.pos),se.WriteUint7(j),se.WriteUint7(te.length),[Z=__Buffer$.concat([se.buf.slice(0,se.pos),te]),W.slice(0,j)]}(C)),C.length<4&&E==1&&(E=0,y.buf[0]&=-2),A)var q=C;else q=E==0?M(C):function(S){let P=S.length;for(var H=new o("",0,198156),D=new Array(256),O=new Array(256),W=new Array(256),j=0;j<256;j++)O[j]=new Array(256),W[j]=new Array(256);var G=12;(function(ke,Te,Fe){for(var Ie=0;Ie<256;Ie++){Fe[Ie]=0;for(var T=0;T<256;T++)Te[Ie][T]=0}var N=0;for(Ie=0;Ie<ke.length;Ie++)Fe[N]++,Te[N][ke[Ie]]++,N=ke[Ie];Fe[N]++,Te[0][ke[1*(ke.length>>2)]]++,Te[0][ke[2*(ke.length>>2)]]++,Te[0][ke[3*(ke.length>>2)]]++,Fe[0]+=3})(S,O,D),function(ke,Te,Fe){for(var Ie=0;Ie<256;Ie++)if(Te[Ie]){var T=Math.ceil(Math.log2(Te[Ie]));T>12&&(T=12),v(ke[Ie],T)}}(O,D);var Z=new o("",0,198156);(function(ke,Te,Fe){R(ke,Fe);for(var Ie=0;Ie<256;Ie++)if(Fe[Ie]){for(var T=0,N=0;N<256;N++)if(Fe[N]){if(T)T--;else if(ke.WriteUint7(Te[Ie][N]),!Te[Ie][N]){for(var z=N+1;z<256;z++)if(Fe[z]){if(Te[Ie][z]!=0)break;T++}ke.WriteByte(T)}}}})(Z,O,D);var te=M(Z.buf.slice(0,Z.pos));for(te.length<Z.pos?(H.WriteByte(193),H.WriteUint7(Z.pos),H.WriteUint7(te.length),H.WriteData(te,te.length)):(H.WriteByte(192),H.WriteData(Z.buf,Z.pos)),function(ke,Te,Fe){for(var Ie=0;Ie<256;Ie++)Te[Ie]&&x(ke[Ie],12)}(O,D),j=0;j<256;j++)if(D[j]){W[j][0]=0;for(var se=1;se<256;se++)W[j][se]=W[j][se-1]+O[j][se-1]}var re=new Array(4),ae=new Array(4);for(se=0;se<4;se++)re[se]=32768,ae[se]=0;var me=new o("",1.05*P+100>>0,1.05*P+100>>0),ue=Math.floor(P/4),Se=new Array(4),_e=new Array(4);for(se=0;se<4;se++)Se[se]=(se+1)*ue-2,_e[se]=S[Se[se]+1];for(_e[3]=S[P-1],j=P-2;j>4*ue-2;j--)re[3]=g(re[3],me,W[S[j]][_e[3]],O[S[j]][_e[3]],G),_e[3]=S[j];for(;Se[0]>=0;)for(se=3;se>=0;se--){var ge=S[Se[se]];re[se]=g(re[se],me,W[ge][_e[se]],O[ge][_e[se]],G),_e[se]=ge,Se[se]--}for(se=3;se>=0;se--)re[se]=g(re[se],me,W[0][_e[se]],O[0][_e[se]],G);for(j=3;j>=0;j--)u(re[j],me);return __Buffer$.concat([H.buf.slice(0,H.pos),me.buf.slice(me.pos,me.length)],H.pos+me.length-me.pos)}(C);return __Buffer$.concat([y.buf.slice(0,y.pos),U,V,q])}function p(C){for(var L=new Array(256),y=0;y<256;y++)L[y]=0;var E=0,k=C.ReadByte(),A=k;do L[k]=1,E>0?(E--,k++):(k=C.ReadByte())==A+1&&(E=C.ReadByte()),A=k;while(k!=0);return L}function m(C,L){var y=new Array(256),E=new Array(256);(function(V,q,S){for(var P=0;P<256;P++)q[P]=0;var H=p(V);for(P=0;P<256;P++)H[P]>0&&(q[P]=V.ReadUint7());for(x(q,12),S[0]=0,P=0;P<=255;P++)S[P+1]=S[P]+q[P]})(C,y,E);for(var k=h(E,12),A=new Array(4),I=0;I<4;I++)A[I]=C.ReadUint32();var F=new __Buffer$.allocUnsafe(L);for(I=0;I<L;I++){var X=I%4,U=k[l(A[X],12)];F[I]=U,A[X]=d(A[X],E[U],y[U],12),A[X]=f(C,A[X])}return F}function v(C,L){for(var y=0,E=0;E<256;E++)y+=C[E];let k=1<<L;var A=k/y;do{var I=0,F=0,X=0;for(y=0,E=0;E<256;E++)C[E]!=0&&(I<C[E]&&(I=C[E],F=E),C[E]=Math.floor(C[E]*A),C[E]==0&&(C[E]=1),y+=C[E]);y<k?C[F]+=k-y:y-k<C[F]/2&&C[F]>2?C[F]-=y-k:y!=k&&(A=k/y,X=1)}while(X)}function x(C,L){for(var y=0,E=0;E<256;E++)y+=C[E];if(y!=0&&y!=1<<L){for(var k=0;y<1<<L;)y*=2,k++;for(E=0;E<256;E++)C[E]<<=k}}function R(C,L){for(var y=0,E=0;E<256;E++)if(L[E]){if(y>0)y--;else if(C.WriteByte(E),E>0&&L[E-1]>0){for(y=E+1;y<256&&L[y];y++);y-=E+1,C.WriteByte(y)}}C.WriteByte(0)}function M(C){let L=C.length;var y=new o("",0,780),E=new Array(256);(function(U,V){for(var q=0;q<256;q++)V[q]=0;for(q=0;q<U.length;q++)V[U[q]]++})(C,E);var k=Math.ceil(Math.log2(L));k>12&&(k=12),v(E,k),function(U,V){R(U,V);for(var q=0;q<256;q++)V[q]&&U.WriteUint7(V[q])}(y,E),v(E,12);var A=new Array(256);A[0]=0;for(var I=1;I<256;I++)A[I]=A[I-1]+E[I-1];var F=new Array(4);for(I=0;I<4;I++)F[I]=32768;var X=new o("",1.05*L+100>>0,1.05*L+100>>0);for(I=L-1;I>=0;I--)F[I%4]=g(F[I%4],X,A[C[I]],E[C[I]],12);for(I=3;I>=0;I--)u(F[I],X);return __Buffer$.concat([y.buf.slice(0,y.pos),X.buf.slice(X.pos,X.length)],y.pos+X.length-X.pos)}s.exports={decode:function(C){return b(new o(C),0)},encode:w}},2881:(s,r,a)=>{let o=a(9260),l=a(594);var c=new(a(445));function h(b,w){for(var p=b+"";p.length<w;)p="0"+p;return p}function d(b,w,p,m){var v=b[0][0].ReadByte(),x=m-b[0][v].ReadUint32();if(v==5)return w[m]=w[x],p[m]=p[x],w[m];var R=1;w[m]="",p[m]=new Array(256);do{switch(v=b[R][0].ReadByte()){case 2:p[m][R]=b[R][2].ReadChar();break;case 1:p[m][R]=b[R][1].ReadString();break;case 7:p[m][R]=b[R][7].ReadUint32();break;case 3:var M=b[R][3].ReadUint32(),C=b[R][4].ReadByte();p[m][R]=h(M,C);break;case 8:p[m][R]=(p[x][R]>>0)+b[R][8].ReadByte();break;case 9:M=(p[x][R]>>0)+b[R][9].ReadByte(),C=p[x][R].length,p[m][R]=h(M,C);break;case 10:p[m][R]=p[x][R];break;default:p[m][R]=""}w[m]+=p[m][R++]}while(v!=12);return w[m]}function f(b,w,p,m,v,x){for(var R=0;R<m.length;R++)if(!(p>0&&w[R][0].type==5)&&w[R][p])switch(b[0].WriteByte(w[R][p].type),w[R][p].type){case 6:b[6].WriteUint32(w[R][p].val);break;case 5:b[5].WriteUint32(w[R][p].val);break;case 1:b[1].WriteString(w[R][p].val);break;case 2:b[2].WriteChar(w[R][p].val);break;case 7:b[7].WriteUint32(w[R][p].val);break;case 3:b[3].WriteUint32(w[R][p].val),b[4].WriteByte(w[R][p].val.length);break;case 8:case 9:b[w[R][p].type].WriteByte(w[R][p].val)}}function u(b,w,p,m){for(var v=0;v<=12;v++)if(!(b[v].pos<=0)){m.WriteByte(v+(v==0?128:0)),b[v]=b[v].buf.slice(0,b[v].pos);var x=g(b[v],p);m.WriteUint7(x.length),m.WriteData(x,x.length)}}function g(b,w){var p,m=1073741824,v=[0,1,64,65,128,129,201];for(var x in v){var R=v[x];if(!(1&R&&b.length<100||8&R&&b.length%4!=0)){try{var M=w?c.encode(b,R):l.encode(b,R)}catch{M=0}M&&m>M.length&&(m=M.length,p=M)}}return p}function _(b,w,p,m,v){var x=0,R=v-1;b[v]=new Array(256),w[m]?b[v][0]={type:5,val:v-w[m]}:b[v][0]={type:6,val:v==0?0:1},w[m]=v;for(var M=m.match(/([a-zA-Z0-9]{1,9})|([^a-zA-Z0-9]+)/g),C=0;C<M.length;C++){var L=C+1,y=1,E=M[C];if(M[C].match(/^0+[0-9]*$/g)?y=3:M[C].match(/^[0-9]+$/g)?y=7:M[C].length==1&&(y=2),R>=0&&b[R][L])if(b[R][L].str==M[C])y=10,E="";else if(b[R][L].type==7||b[R][L].type==8){var k=E-b[R][L].str;p[L]++,k>=0&&k<256&&p[L]>v/2&&(y=8,E=k)}else b[R][L].type!=3&&b[R][L].type!=9||b[R][L].str.length!=E.length||(k=E-b[R][L].str,p[L]++,k>=0&&k<256&&p[L]>v/2&&(y=9,E=k));b[v][L]={str:M[C],val:E,type:y},x<b[v][L].val.length+3&&(x=b[v][L].val.length+3)}return b[v][++L]={type:12},[L+1,x]}s.exports={encode:function(b,w){var p=b.toString();p[p.length-1]==`
`&&(p=p.substring(0,p.length-1));var m=p.split(`
`),v=new o("",0,2*p.length+1e4);v.WriteUint32(p.length),v.WriteUint32(m.length),v.WriteByte(w);for(var x=new Array(m.length),R={},M=new Array(256).fill(0),C=0,L=0,y=0;y<m.length;y++){var[E,k]=_(x,R,M,m[y],y);C<E&&(C=E),L<k&&(L=k)}for(var A=0;A<C;A++){for(var I=new Array(13),F=0;F<=12;F++)I[F]=new o("",0,m.length*L);f(I,x,A,m),u(I,0,w,v)}return v.buf.slice(0,v.pos)},decode:function(b,w,p){(b=new o(b)).ReadUint32();var m=b.ReadUint32(),v=b.ReadByte(),x=function(y,E,k,A){for(var I=-1,F=new Array(256);!y.EOF();){var X=y.ReadByte(),U=128&X,V=64&X,q=63&X;if(U&&(F[++I]=new Array(13)),q!=0&&U){var S=new Array(A-1).fill(10);F[I][0]=new o(__Buffer$.from([q].concat(S)))}if(V){var P=y.ReadByte(),H=y.ReadByte();F[I][q]=new o(F[P][H].buf)}else{var D=y.ReadUint7(),O=y.ReadData(D);F[I][q]=k?c.decode(O):l.decode(O),F[I][q]=new o(F[I][q])}}return F}(b,0,v,m),R=new Array(m),M=new Array(m),C="";p===void 0&&(p=`
`);for(var L=0;L<m;L++)C+=d(x,R,M,L)+p;return C}}},1422:function(s,r,a){var o=this&&this.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(r,"__esModule",{value:!0});let l=a(8904),c=o(a(9049)),h=o(a(450));class d{constructor({fill:u,cache:g}){if(typeof u!="function")throw new TypeError("must pass a fill function");if(typeof g!="object")throw new TypeError("must pass a cache object");if(typeof g.get!="function"||typeof g.set!="function"||typeof g.delete!="function")throw new TypeError("cache must implement get(key), set(key, val), and and delete(key)");this.cache=g,this.fillCallback=u}static isAbortException(u){return u.name==="AbortError"||u.code==="ERR_ABORTED"||u.message==="AbortError: aborted"||u.message==="Error: aborted"}evict(u,g){this.cache.get(u)===g&&this.cache.delete(u)}fill(u,g,_,b){let w=new c.default,p=new h.default;p.addCallback(b);let m={aborter:w,promise:this.fillCallback(g,w.signal,v=>{p.callback(v)}),settled:!1,statusReporter:p,get aborted(){return this.aborter.signal.aborted}};m.aborter.addSignal(_),m.aborter.signal.addEventListener("abort",()=>{m.settled||this.evict(u,m)}),m.promise.then(()=>{m.settled=!0},()=>{m.settled=!0,this.evict(u,m)}).catch(v=>{throw console.error(v),v}),this.cache.set(u,m)}static checkSinglePromise(u,g){function _(){if(g&&g.aborted)throw Object.assign(new Error("aborted"),{code:"ERR_ABORTED"})}return u.then(b=>(_(),b),b=>{throw _(),b})}has(u){return this.cache.has(u)}get(u,g,_,b){if(!_&&g instanceof l.AbortSignal)throw new TypeError("second get argument appears to be an AbortSignal, perhaps you meant to pass `null` for the fill data?");let w=this.cache.get(u);return w?w.aborted&&!w.settled?(this.evict(u,w),this.get(u,g,_,b)):w.settled?w.promise:(w.aborter.addSignal(_),w.statusReporter.addCallback(b),d.checkSinglePromise(w.promise,_)):(this.fill(u,g,_,b),d.checkSinglePromise(this.cache.get(u).promise,_))}delete(u){let g=this.cache.get(u);g&&(g.settled||g.aborter.abort(),this.cache.delete(u))}clear(){let u=this.cache.keys(),g=0;for(let _=u.next();!_.done;_=u.next())this.delete(_.value),g+=1;return g}}r.default=d},9049:(s,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0});let o=a(8904);class l{}r.default=class{constructor(){this.signals=new Set,this.abortController=new o.AbortController}addSignal(c=new l){if(this.signal.aborted)throw new Error("cannot add a signal, already aborted!");this.signals.add(c),c.aborted?this.handleAborted(c):typeof c.addEventListener=="function"&&c.addEventListener("abort",()=>{this.handleAborted(c)})}handleAborted(c){this.signals.delete(c),this.signals.size===0&&this.abortController.abort()}get signal(){return this.abortController.signal}abort(){this.abortController.abort()}}},450:(s,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.default=class{constructor(){this.callbacks=new Set}addCallback(a=()=>{}){this.callbacks.add(a),a(this.currentMessage)}callback(a){this.currentMessage=a,this.callbacks.forEach(o=>{o(a)})}}},8904:(s,r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.AbortSignal=r.AbortController=void 0;let o=a(5988);var l=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(a.g!==void 0)return a.g;throw new Error("unable to locate global object")};let c=l().AbortController===void 0?o.AbortController:l().AbortController;r.AbortController=c;let h=l().AbortController===void 0?o.AbortSignal:l().AbortSignal;r.AbortSignal=h},4105:function(s,r,a){var o=this&&this.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(r,"__esModule",{value:!0});let l=o(a(1422));r.default=l.default},5988:(s,r)=>{function a(p,m){if(!(p instanceof m))throw new TypeError("Cannot call a class as a function")}function o(p,m){for(var v=0;v<m.length;v++){var x=m[v];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(p,x.key,x)}}function l(p,m,v){return m&&o(p.prototype,m),v&&o(p,v),Object.defineProperty(p,"prototype",{writable:!1}),p}function c(p){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(m){return m.__proto__||Object.getPrototypeOf(m)},c(p)}function h(p,m){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(v,x){return v.__proto__=x,v},h(p,m)}function d(p){if(p===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p}function f(p,m){if(m&&(typeof m=="object"||typeof m=="function"))return m;if(m!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return d(p)}function u(p,m){for(;!Object.prototype.hasOwnProperty.call(p,m)&&(p=c(p))!==null;);return p}function g(){return g=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(p,m,v){var x=u(p,m);if(x){var R=Object.getOwnPropertyDescriptor(x,m);return R.get?R.get.call(arguments.length<3?p:v):R.value}},g.apply(this,arguments)}Object.defineProperty(r,"__esModule",{value:!0});var _=function(){function p(){a(this,p),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return l(p,[{key:"addEventListener",value:function(m,v,x){m in this.listeners||(this.listeners[m]=[]),this.listeners[m].push({callback:v,options:x})}},{key:"removeEventListener",value:function(m,v){if(m in this.listeners){for(var x=this.listeners[m],R=0,M=x.length;R<M;R++)if(x[R].callback===v)return void x.splice(R,1)}}},{key:"dispatchEvent",value:function(m){if(m.type in this.listeners){for(var v=this.listeners[m.type].slice(),x=0,R=v.length;x<R;x++){var M=v[x];try{M.callback.call(this,m)}catch(C){Promise.resolve().then(function(){throw C})}M.options&&M.options.once&&this.removeEventListener(m.type,M.callback)}return!m.defaultPrevented}}}]),p}(),b=function(p){(function(M,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function");M.prototype=Object.create(C&&C.prototype,{constructor:{value:M,writable:!0,configurable:!0}}),Object.defineProperty(M,"prototype",{writable:!1}),C&&h(M,C)})(R,p);var m,v,x=(m=R,v=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var M,C=c(m);if(v){var L=c(this).constructor;M=Reflect.construct(C,arguments,L)}else M=C.apply(this,arguments);return f(this,M)});function R(){var M;return a(this,R),(M=x.call(this)).listeners||_.call(d(M)),Object.defineProperty(d(M),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(d(M),"onabort",{value:null,writable:!0,configurable:!0}),Object.defineProperty(d(M),"reason",{value:void 0,writable:!0,configurable:!0}),M}return l(R,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(M){M.type==="abort"&&(this.aborted=!0,typeof this.onabort=="function"&&this.onabort.call(this,M)),g(c(R.prototype),"dispatchEvent",this).call(this,M)}}]),R}(_),w=function(){function p(){a(this,p),Object.defineProperty(this,"signal",{value:new b,writable:!0,configurable:!0})}return l(p,[{key:"abort",value:function(m){var v;try{v=new Event("abort")}catch{typeof document<"u"?document.createEvent?(v=document.createEvent("Event")).initEvent("abort",!1,!1):(v=document.createEventObject()).type="abort":v={type:"abort",bubbles:!1,cancelable:!1}}var x=m;if(x===void 0)if(typeof document>"u")(x=new Error("This operation was aborted")).name="AbortError";else try{x=new DOMException("signal is aborted without reason")}catch{(x=new Error("This operation was aborted")).name="AbortError"}this.signal.reason=x,this.signal.dispatchEvent(v)}},{key:"toString",value:function(){return"[object AbortController]"}}]),p}();typeof Symbol<"u"&&Symbol.toStringTag&&(w.prototype[Symbol.toStringTag]="AbortController",b.prototype[Symbol.toStringTag]="AbortSignal"),r.AbortController=w,r.AbortSignal=b,r.abortableFetch=function(p){typeof p=="function"&&(p={fetch:p});var m=p,v=m.fetch,x=m.Request,R=x===void 0?v.Request:x,M=m.AbortController,C=m.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL,L=C!==void 0&&C;if(!function(k){return k.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):typeof k.Request=="function"&&!k.Request.prototype.hasOwnProperty("signal")||!k.AbortController}({fetch:v,Request:R,AbortController:M,__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL:L}))return{fetch:v,Request:y};var y=R;(y&&!y.prototype.hasOwnProperty("signal")||L)&&((y=function(k,A){var I;A&&A.signal&&(I=A.signal,delete A.signal);var F=new R(k,A);return I&&Object.defineProperty(F,"signal",{writable:!1,enumerable:!1,configurable:!0,value:I}),F}).prototype=R.prototype);var E=v;return{fetch:function(k,A){var I=y&&y.prototype.isPrototypeOf(k)?k.signal:A?A.signal:void 0;if(I){var F;try{F=new DOMException("Aborted","AbortError")}catch{(F=new Error("Aborted")).name="AbortError"}if(I.aborted)return Promise.reject(F);var X=new Promise(function(U,V){I.addEventListener("abort",function(){return V(F)},{once:!0})});return A&&A.signal&&delete A.signal,Promise.race([X,E(k,A)])}return E(k,A)},Request:y}}},9742:(s,r)=>{r.byteLength=function(g){var _=f(g),b=_[0],w=_[1];return 3*(b+w)/4-w},r.toByteArray=function(g){var _,b,w=f(g),p=w[0],m=w[1],v=new l(function(M,C,L){return 3*(C+L)/4-L}(0,p,m)),x=0,R=m>0?p-4:p;for(b=0;b<R;b+=4)_=o[g.charCodeAt(b)]<<18|o[g.charCodeAt(b+1)]<<12|o[g.charCodeAt(b+2)]<<6|o[g.charCodeAt(b+3)],v[x++]=_>>16&255,v[x++]=_>>8&255,v[x++]=255&_;return m===2&&(_=o[g.charCodeAt(b)]<<2|o[g.charCodeAt(b+1)]>>4,v[x++]=255&_),m===1&&(_=o[g.charCodeAt(b)]<<10|o[g.charCodeAt(b+1)]<<4|o[g.charCodeAt(b+2)]>>2,v[x++]=_>>8&255,v[x++]=255&_),v},r.fromByteArray=function(g){for(var _,b=g.length,w=b%3,p=[],m=16383,v=0,x=b-w;v<x;v+=m)p.push(u(g,v,v+m>x?x:v+m));return w===1?(_=g[b-1],p.push(a[_>>2]+a[_<<4&63]+"==")):w===2&&(_=(g[b-2]<<8)+g[b-1],p.push(a[_>>10]+a[_>>4&63]+a[_<<2&63]+"=")),p.join("")};for(var a=[],o=[],l=typeof Uint8Array<"u"?Uint8Array:Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,d=c.length;h<d;++h)a[h]=c[h],o[c.charCodeAt(h)]=h;function f(g){var _=g.length;if(_%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var b=g.indexOf("=");return b===-1&&(b=_),[b,b===_?0:4-b%4]}function u(g,_,b){for(var w,p,m=[],v=_;v<b;v+=3)w=(g[v]<<16&16711680)+(g[v+1]<<8&65280)+(255&g[v+2]),m.push(a[(p=w)>>18&63]+a[p>>12&63]+a[p>>6&63]+a[63&p]);return m.join("")}o[45]=62,o[95]=63},2779:(s,r,a)=>{var o=a(8764).Buffer,l=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];function c(u){if(o.isBuffer(u))return u;var g=typeof o.alloc=="function"&&typeof o.from=="function";if(typeof u=="number")return g?o.alloc(u):new o(u);if(typeof u=="string")return g?o.from(u):new o(u);throw new Error("input must be buffer, number, or string, received "+typeof u)}function h(u){var g=c(4);return g.writeInt32BE(u,0),g}function d(u,g){u=c(u),o.isBuffer(g)&&(g=g.readUInt32BE(0));for(var _=-1^~~g,b=0;b<u.length;b++)_=l[255&(_^u[b])]^_>>>8;return-1^_}function f(){return h(d.apply(null,arguments))}typeof Int32Array<"u"&&(l=new Int32Array(l)),f.signed=function(){return d.apply(null,arguments)},f.unsigned=function(){return d.apply(null,arguments)>>>0},s.exports=f},8764:(s,r,a)=>{let o=a(9742),l=a(645),c=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=f,r.SlowBuffer=function(T){return+T!=T&&(T=0),f.alloc(+T)},r.INSPECT_MAX_BYTES=50;let h=2147483647;function d(T){if(T>h)throw new RangeError('The value "'+T+'" is invalid for option "size"');let N=new Uint8Array(T);return Object.setPrototypeOf(N,f.prototype),N}function f(T,N,z){if(typeof T=="number"){if(typeof N=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return _(T)}return u(T,N,z)}function u(T,N,z){if(typeof T=="string")return function(ie,ce){if(typeof ce=="string"&&ce!==""||(ce="utf8"),!f.isEncoding(ce))throw new TypeError("Unknown encoding: "+ce);let Me=0|m(ie,ce),Be=d(Me),He=Be.write(ie,ce);return He!==Me&&(Be=Be.slice(0,He)),Be}(T,N);if(ArrayBuffer.isView(T))return function(ie){if(ge(ie,Uint8Array)){let ce=new Uint8Array(ie);return w(ce.buffer,ce.byteOffset,ce.byteLength)}return b(ie)}(T);if(T==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof T);if(ge(T,ArrayBuffer)||T&&ge(T.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ge(T,SharedArrayBuffer)||T&&ge(T.buffer,SharedArrayBuffer)))return w(T,N,z);if(typeof T=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let Q=T.valueOf&&T.valueOf();if(Q!=null&&Q!==T)return f.from(Q,N,z);let K=function(ie){if(f.isBuffer(ie)){let ce=0|p(ie.length),Me=d(ce);return Me.length===0||ie.copy(Me,0,0,ce),Me}return ie.length!==void 0?typeof ie.length!="number"||ke(ie.length)?d(0):b(ie):ie.type==="Buffer"&&Array.isArray(ie.data)?b(ie.data):void 0}(T);if(K)return K;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof T[Symbol.toPrimitive]=="function")return f.from(T[Symbol.toPrimitive]("string"),N,z);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof T)}function g(T){if(typeof T!="number")throw new TypeError('"size" argument must be of type number');if(T<0)throw new RangeError('The value "'+T+'" is invalid for option "size"')}function _(T){return g(T),d(T<0?0:0|p(T))}function b(T){let N=T.length<0?0:0|p(T.length),z=d(N);for(let Q=0;Q<N;Q+=1)z[Q]=255&T[Q];return z}function w(T,N,z){if(N<0||T.byteLength<N)throw new RangeError('"offset" is outside of buffer bounds');if(T.byteLength<N+(z||0))throw new RangeError('"length" is outside of buffer bounds');let Q;return Q=N===void 0&&z===void 0?new Uint8Array(T):z===void 0?new Uint8Array(T,N):new Uint8Array(T,N,z),Object.setPrototypeOf(Q,f.prototype),Q}function p(T){if(T>=h)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+h.toString(16)+" bytes");return 0|T}function m(T,N){if(f.isBuffer(T))return T.length;if(ArrayBuffer.isView(T)||ge(T,ArrayBuffer))return T.byteLength;if(typeof T!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof T);let z=T.length,Q=arguments.length>2&&arguments[2]===!0;if(!Q&&z===0)return 0;let K=!1;for(;;)switch(N){case"ascii":case"latin1":case"binary":return z;case"utf8":case"utf-8":return ue(T).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*z;case"hex":return z>>>1;case"base64":return Se(T).length;default:if(K)return Q?-1:ue(T).length;N=(""+N).toLowerCase(),K=!0}}function v(T,N,z){let Q=!1;if((N===void 0||N<0)&&(N=0),N>this.length||((z===void 0||z>this.length)&&(z=this.length),z<=0)||(z>>>=0)<=(N>>>=0))return"";for(T||(T="utf8");;)switch(T){case"hex":return V(this,N,z);case"utf8":case"utf-8":return I(this,N,z);case"ascii":return X(this,N,z);case"latin1":case"binary":return U(this,N,z);case"base64":return A(this,N,z);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q(this,N,z);default:if(Q)throw new TypeError("Unknown encoding: "+T);T=(T+"").toLowerCase(),Q=!0}}function x(T,N,z){let Q=T[N];T[N]=T[z],T[z]=Q}function R(T,N,z,Q,K){if(T.length===0)return-1;if(typeof z=="string"?(Q=z,z=0):z>2147483647?z=2147483647:z<-2147483648&&(z=-2147483648),ke(z=+z)&&(z=K?0:T.length-1),z<0&&(z=T.length+z),z>=T.length){if(K)return-1;z=T.length-1}else if(z<0){if(!K)return-1;z=0}if(typeof N=="string"&&(N=f.from(N,Q)),f.isBuffer(N))return N.length===0?-1:M(T,N,z,Q,K);if(typeof N=="number")return N&=255,typeof Uint8Array.prototype.indexOf=="function"?K?Uint8Array.prototype.indexOf.call(T,N,z):Uint8Array.prototype.lastIndexOf.call(T,N,z):M(T,[N],z,Q,K);throw new TypeError("val must be string, number or Buffer")}function M(T,N,z,Q,K){let ie,ce=1,Me=T.length,Be=N.length;if(Q!==void 0&&((Q=String(Q).toLowerCase())==="ucs2"||Q==="ucs-2"||Q==="utf16le"||Q==="utf-16le")){if(T.length<2||N.length<2)return-1;ce=2,Me/=2,Be/=2,z/=2}function He(Pe,et){return ce===1?Pe[et]:Pe.readUInt16BE(et*ce)}if(K){let Pe=-1;for(ie=z;ie<Me;ie++)if(He(T,ie)===He(N,Pe===-1?0:ie-Pe)){if(Pe===-1&&(Pe=ie),ie-Pe+1===Be)return Pe*ce}else Pe!==-1&&(ie-=ie-Pe),Pe=-1}else for(z+Be>Me&&(z=Me-Be),ie=z;ie>=0;ie--){let Pe=!0;for(let et=0;et<Be;et++)if(He(T,ie+et)!==He(N,et)){Pe=!1;break}if(Pe)return ie}return-1}function C(T,N,z,Q){z=Number(z)||0;let K=T.length-z;Q?(Q=Number(Q))>K&&(Q=K):Q=K;let ie=N.length,ce;for(Q>ie/2&&(Q=ie/2),ce=0;ce<Q;++ce){let Me=parseInt(N.substr(2*ce,2),16);if(ke(Me))return ce;T[z+ce]=Me}return ce}function L(T,N,z,Q){return _e(ue(N,T.length-z),T,z,Q)}function y(T,N,z,Q){return _e(function(K){let ie=[];for(let ce=0;ce<K.length;++ce)ie.push(255&K.charCodeAt(ce));return ie}(N),T,z,Q)}function E(T,N,z,Q){return _e(Se(N),T,z,Q)}function k(T,N,z,Q){return _e(function(K,ie){let ce,Me,Be,He=[];for(let Pe=0;Pe<K.length&&!((ie-=2)<0);++Pe)ce=K.charCodeAt(Pe),Me=ce>>8,Be=ce%256,He.push(Be),He.push(Me);return He}(N,T.length-z),T,z,Q)}function A(T,N,z){return N===0&&z===T.length?o.fromByteArray(T):o.fromByteArray(T.slice(N,z))}function I(T,N,z){z=Math.min(T.length,z);let Q=[],K=N;for(;K<z;){let ie=T[K],ce=null,Me=ie>239?4:ie>223?3:ie>191?2:1;if(K+Me<=z){let Be,He,Pe,et;switch(Me){case 1:ie<128&&(ce=ie);break;case 2:Be=T[K+1],(192&Be)==128&&(et=(31&ie)<<6|63&Be,et>127&&(ce=et));break;case 3:Be=T[K+1],He=T[K+2],(192&Be)==128&&(192&He)==128&&(et=(15&ie)<<12|(63&Be)<<6|63&He,et>2047&&(et<55296||et>57343)&&(ce=et));break;case 4:Be=T[K+1],He=T[K+2],Pe=T[K+3],(192&Be)==128&&(192&He)==128&&(192&Pe)==128&&(et=(15&ie)<<18|(63&Be)<<12|(63&He)<<6|63&Pe,et>65535&&et<1114112&&(ce=et))}}ce===null?(ce=65533,Me=1):ce>65535&&(ce-=65536,Q.push(ce>>>10&1023|55296),ce=56320|1023&ce),Q.push(ce),K+=Me}return function(ie){let ce=ie.length;if(ce<=F)return String.fromCharCode.apply(String,ie);let Me="",Be=0;for(;Be<ce;)Me+=String.fromCharCode.apply(String,ie.slice(Be,Be+=F));return Me}(Q)}r.kMaxLength=h,f.TYPED_ARRAY_SUPPORT=function(){try{let T=new Uint8Array(1),N={foo:function(){return 42}};return Object.setPrototypeOf(N,Uint8Array.prototype),Object.setPrototypeOf(T,N),T.foo()===42}catch{return!1}}(),f.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(f.prototype,"parent",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.buffer}}),Object.defineProperty(f.prototype,"offset",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.byteOffset}}),f.poolSize=8192,f.from=function(T,N,z){return u(T,N,z)},Object.setPrototypeOf(f.prototype,Uint8Array.prototype),Object.setPrototypeOf(f,Uint8Array),f.alloc=function(T,N,z){return function(Q,K,ie){return g(Q),Q<=0?d(Q):K!==void 0?typeof ie=="string"?d(Q).fill(K,ie):d(Q).fill(K):d(Q)}(T,N,z)},f.allocUnsafe=function(T){return _(T)},f.allocUnsafeSlow=function(T){return _(T)},f.isBuffer=function(T){return T!=null&&T._isBuffer===!0&&T!==f.prototype},f.compare=function(T,N){if(ge(T,Uint8Array)&&(T=f.from(T,T.offset,T.byteLength)),ge(N,Uint8Array)&&(N=f.from(N,N.offset,N.byteLength)),!f.isBuffer(T)||!f.isBuffer(N))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(T===N)return 0;let z=T.length,Q=N.length;for(let K=0,ie=Math.min(z,Q);K<ie;++K)if(T[K]!==N[K]){z=T[K],Q=N[K];break}return z<Q?-1:Q<z?1:0},f.isEncoding=function(T){switch(String(T).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(T,N){if(!Array.isArray(T))throw new TypeError('"list" argument must be an Array of Buffers');if(T.length===0)return f.alloc(0);let z;if(N===void 0)for(N=0,z=0;z<T.length;++z)N+=T[z].length;let Q=f.allocUnsafe(N),K=0;for(z=0;z<T.length;++z){let ie=T[z];if(ge(ie,Uint8Array))K+ie.length>Q.length?(f.isBuffer(ie)||(ie=f.from(ie)),ie.copy(Q,K)):Uint8Array.prototype.set.call(Q,ie,K);else{if(!f.isBuffer(ie))throw new TypeError('"list" argument must be an Array of Buffers');ie.copy(Q,K)}K+=ie.length}return Q},f.byteLength=m,f.prototype._isBuffer=!0,f.prototype.swap16=function(){let T=this.length;if(T%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let N=0;N<T;N+=2)x(this,N,N+1);return this},f.prototype.swap32=function(){let T=this.length;if(T%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let N=0;N<T;N+=4)x(this,N,N+3),x(this,N+1,N+2);return this},f.prototype.swap64=function(){let T=this.length;if(T%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let N=0;N<T;N+=8)x(this,N,N+7),x(this,N+1,N+6),x(this,N+2,N+5),x(this,N+3,N+4);return this},f.prototype.toString=function(){let T=this.length;return T===0?"":arguments.length===0?I(this,0,T):v.apply(this,arguments)},f.prototype.toLocaleString=f.prototype.toString,f.prototype.equals=function(T){if(!f.isBuffer(T))throw new TypeError("Argument must be a Buffer");return this===T||f.compare(this,T)===0},f.prototype.inspect=function(){let T="",N=r.INSPECT_MAX_BYTES;return T=this.toString("hex",0,N).replace(/(.{2})/g,"$1 ").trim(),this.length>N&&(T+=" ... "),"<Buffer "+T+">"},c&&(f.prototype[c]=f.prototype.inspect),f.prototype.compare=function(T,N,z,Q,K){if(ge(T,Uint8Array)&&(T=f.from(T,T.offset,T.byteLength)),!f.isBuffer(T))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof T);if(N===void 0&&(N=0),z===void 0&&(z=T?T.length:0),Q===void 0&&(Q=0),K===void 0&&(K=this.length),N<0||z>T.length||Q<0||K>this.length)throw new RangeError("out of range index");if(Q>=K&&N>=z)return 0;if(Q>=K)return-1;if(N>=z)return 1;if(this===T)return 0;let ie=(K>>>=0)-(Q>>>=0),ce=(z>>>=0)-(N>>>=0),Me=Math.min(ie,ce),Be=this.slice(Q,K),He=T.slice(N,z);for(let Pe=0;Pe<Me;++Pe)if(Be[Pe]!==He[Pe]){ie=Be[Pe],ce=He[Pe];break}return ie<ce?-1:ce<ie?1:0},f.prototype.includes=function(T,N,z){return this.indexOf(T,N,z)!==-1},f.prototype.indexOf=function(T,N,z){return R(this,T,N,z,!0)},f.prototype.lastIndexOf=function(T,N,z){return R(this,T,N,z,!1)},f.prototype.write=function(T,N,z,Q){if(N===void 0)Q="utf8",z=this.length,N=0;else if(z===void 0&&typeof N=="string")Q=N,z=this.length,N=0;else{if(!isFinite(N))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");N>>>=0,isFinite(z)?(z>>>=0,Q===void 0&&(Q="utf8")):(Q=z,z=void 0)}let K=this.length-N;if((z===void 0||z>K)&&(z=K),T.length>0&&(z<0||N<0)||N>this.length)throw new RangeError("Attempt to write outside buffer bounds");Q||(Q="utf8");let ie=!1;for(;;)switch(Q){case"hex":return C(this,T,N,z);case"utf8":case"utf-8":return L(this,T,N,z);case"ascii":case"latin1":case"binary":return y(this,T,N,z);case"base64":return E(this,T,N,z);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,T,N,z);default:if(ie)throw new TypeError("Unknown encoding: "+Q);Q=(""+Q).toLowerCase(),ie=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};let F=4096;function X(T,N,z){let Q="";z=Math.min(T.length,z);for(let K=N;K<z;++K)Q+=String.fromCharCode(127&T[K]);return Q}function U(T,N,z){let Q="";z=Math.min(T.length,z);for(let K=N;K<z;++K)Q+=String.fromCharCode(T[K]);return Q}function V(T,N,z){let Q=T.length;(!N||N<0)&&(N=0),(!z||z<0||z>Q)&&(z=Q);let K="";for(let ie=N;ie<z;++ie)K+=Te[T[ie]];return K}function q(T,N,z){let Q=T.slice(N,z),K="";for(let ie=0;ie<Q.length-1;ie+=2)K+=String.fromCharCode(Q[ie]+256*Q[ie+1]);return K}function S(T,N,z){if(T%1!=0||T<0)throw new RangeError("offset is not uint");if(T+N>z)throw new RangeError("Trying to access beyond buffer length")}function P(T,N,z,Q,K,ie){if(!f.isBuffer(T))throw new TypeError('"buffer" argument must be a Buffer instance');if(N>K||N<ie)throw new RangeError('"value" argument is out of bounds');if(z+Q>T.length)throw new RangeError("Index out of range")}function H(T,N,z,Q,K){se(N,Q,K,T,z,7);let ie=Number(N&BigInt(4294967295));T[z++]=ie,ie>>=8,T[z++]=ie,ie>>=8,T[z++]=ie,ie>>=8,T[z++]=ie;let ce=Number(N>>BigInt(32)&BigInt(4294967295));return T[z++]=ce,ce>>=8,T[z++]=ce,ce>>=8,T[z++]=ce,ce>>=8,T[z++]=ce,z}function D(T,N,z,Q,K){se(N,Q,K,T,z,7);let ie=Number(N&BigInt(4294967295));T[z+7]=ie,ie>>=8,T[z+6]=ie,ie>>=8,T[z+5]=ie,ie>>=8,T[z+4]=ie;let ce=Number(N>>BigInt(32)&BigInt(4294967295));return T[z+3]=ce,ce>>=8,T[z+2]=ce,ce>>=8,T[z+1]=ce,ce>>=8,T[z]=ce,z+8}function O(T,N,z,Q,K,ie){if(z+Q>T.length)throw new RangeError("Index out of range");if(z<0)throw new RangeError("Index out of range")}function W(T,N,z,Q,K){return N=+N,z>>>=0,K||O(T,0,z,4),l.write(T,N,z,Q,23,4),z+4}function j(T,N,z,Q,K){return N=+N,z>>>=0,K||O(T,0,z,8),l.write(T,N,z,Q,52,8),z+8}f.prototype.slice=function(T,N){let z=this.length;(T=~~T)<0?(T+=z)<0&&(T=0):T>z&&(T=z),(N=N===void 0?z:~~N)<0?(N+=z)<0&&(N=0):N>z&&(N=z),N<T&&(N=T);let Q=this.subarray(T,N);return Object.setPrototypeOf(Q,f.prototype),Q},f.prototype.readUintLE=f.prototype.readUIntLE=function(T,N,z){T>>>=0,N>>>=0,z||S(T,N,this.length);let Q=this[T],K=1,ie=0;for(;++ie<N&&(K*=256);)Q+=this[T+ie]*K;return Q},f.prototype.readUintBE=f.prototype.readUIntBE=function(T,N,z){T>>>=0,N>>>=0,z||S(T,N,this.length);let Q=this[T+--N],K=1;for(;N>0&&(K*=256);)Q+=this[T+--N]*K;return Q},f.prototype.readUint8=f.prototype.readUInt8=function(T,N){return T>>>=0,N||S(T,1,this.length),this[T]},f.prototype.readUint16LE=f.prototype.readUInt16LE=function(T,N){return T>>>=0,N||S(T,2,this.length),this[T]|this[T+1]<<8},f.prototype.readUint16BE=f.prototype.readUInt16BE=function(T,N){return T>>>=0,N||S(T,2,this.length),this[T]<<8|this[T+1]},f.prototype.readUint32LE=f.prototype.readUInt32LE=function(T,N){return T>>>=0,N||S(T,4,this.length),(this[T]|this[T+1]<<8|this[T+2]<<16)+16777216*this[T+3]},f.prototype.readUint32BE=f.prototype.readUInt32BE=function(T,N){return T>>>=0,N||S(T,4,this.length),16777216*this[T]+(this[T+1]<<16|this[T+2]<<8|this[T+3])},f.prototype.readBigUInt64LE=Fe(function(T){re(T>>>=0,"offset");let N=this[T],z=this[T+7];N!==void 0&&z!==void 0||ae(T,this.length-8);let Q=N+256*this[++T]+65536*this[++T]+this[++T]*2**24,K=this[++T]+256*this[++T]+65536*this[++T]+z*2**24;return BigInt(Q)+(BigInt(K)<<BigInt(32))}),f.prototype.readBigUInt64BE=Fe(function(T){re(T>>>=0,"offset");let N=this[T],z=this[T+7];N!==void 0&&z!==void 0||ae(T,this.length-8);let Q=N*2**24+65536*this[++T]+256*this[++T]+this[++T],K=this[++T]*2**24+65536*this[++T]+256*this[++T]+z;return(BigInt(Q)<<BigInt(32))+BigInt(K)}),f.prototype.readIntLE=function(T,N,z){T>>>=0,N>>>=0,z||S(T,N,this.length);let Q=this[T],K=1,ie=0;for(;++ie<N&&(K*=256);)Q+=this[T+ie]*K;return K*=128,Q>=K&&(Q-=Math.pow(2,8*N)),Q},f.prototype.readIntBE=function(T,N,z){T>>>=0,N>>>=0,z||S(T,N,this.length);let Q=N,K=1,ie=this[T+--Q];for(;Q>0&&(K*=256);)ie+=this[T+--Q]*K;return K*=128,ie>=K&&(ie-=Math.pow(2,8*N)),ie},f.prototype.readInt8=function(T,N){return T>>>=0,N||S(T,1,this.length),128&this[T]?-1*(255-this[T]+1):this[T]},f.prototype.readInt16LE=function(T,N){T>>>=0,N||S(T,2,this.length);let z=this[T]|this[T+1]<<8;return 32768&z?4294901760|z:z},f.prototype.readInt16BE=function(T,N){T>>>=0,N||S(T,2,this.length);let z=this[T+1]|this[T]<<8;return 32768&z?4294901760|z:z},f.prototype.readInt32LE=function(T,N){return T>>>=0,N||S(T,4,this.length),this[T]|this[T+1]<<8|this[T+2]<<16|this[T+3]<<24},f.prototype.readInt32BE=function(T,N){return T>>>=0,N||S(T,4,this.length),this[T]<<24|this[T+1]<<16|this[T+2]<<8|this[T+3]},f.prototype.readBigInt64LE=Fe(function(T){re(T>>>=0,"offset");let N=this[T],z=this[T+7];N!==void 0&&z!==void 0||ae(T,this.length-8);let Q=this[T+4]+256*this[T+5]+65536*this[T+6]+(z<<24);return(BigInt(Q)<<BigInt(32))+BigInt(N+256*this[++T]+65536*this[++T]+this[++T]*16777216)}),f.prototype.readBigInt64BE=Fe(function(T){re(T>>>=0,"offset");let N=this[T],z=this[T+7];N!==void 0&&z!==void 0||ae(T,this.length-8);let Q=(N<<24)+65536*this[++T]+256*this[++T]+this[++T];return(BigInt(Q)<<BigInt(32))+BigInt(this[++T]*16777216+65536*this[++T]+256*this[++T]+z)}),f.prototype.readFloatLE=function(T,N){return T>>>=0,N||S(T,4,this.length),l.read(this,T,!0,23,4)},f.prototype.readFloatBE=function(T,N){return T>>>=0,N||S(T,4,this.length),l.read(this,T,!1,23,4)},f.prototype.readDoubleLE=function(T,N){return T>>>=0,N||S(T,8,this.length),l.read(this,T,!0,52,8)},f.prototype.readDoubleBE=function(T,N){return T>>>=0,N||S(T,8,this.length),l.read(this,T,!1,52,8)},f.prototype.writeUintLE=f.prototype.writeUIntLE=function(T,N,z,Q){T=+T,N>>>=0,z>>>=0,Q||P(this,T,N,z,Math.pow(2,8*z)-1,0);let K=1,ie=0;for(this[N]=255&T;++ie<z&&(K*=256);)this[N+ie]=T/K&255;return N+z},f.prototype.writeUintBE=f.prototype.writeUIntBE=function(T,N,z,Q){T=+T,N>>>=0,z>>>=0,Q||P(this,T,N,z,Math.pow(2,8*z)-1,0);let K=z-1,ie=1;for(this[N+K]=255&T;--K>=0&&(ie*=256);)this[N+K]=T/ie&255;return N+z},f.prototype.writeUint8=f.prototype.writeUInt8=function(T,N,z){return T=+T,N>>>=0,z||P(this,T,N,1,255,0),this[N]=255&T,N+1},f.prototype.writeUint16LE=f.prototype.writeUInt16LE=function(T,N,z){return T=+T,N>>>=0,z||P(this,T,N,2,65535,0),this[N]=255&T,this[N+1]=T>>>8,N+2},f.prototype.writeUint16BE=f.prototype.writeUInt16BE=function(T,N,z){return T=+T,N>>>=0,z||P(this,T,N,2,65535,0),this[N]=T>>>8,this[N+1]=255&T,N+2},f.prototype.writeUint32LE=f.prototype.writeUInt32LE=function(T,N,z){return T=+T,N>>>=0,z||P(this,T,N,4,4294967295,0),this[N+3]=T>>>24,this[N+2]=T>>>16,this[N+1]=T>>>8,this[N]=255&T,N+4},f.prototype.writeUint32BE=f.prototype.writeUInt32BE=function(T,N,z){return T=+T,N>>>=0,z||P(this,T,N,4,4294967295,0),this[N]=T>>>24,this[N+1]=T>>>16,this[N+2]=T>>>8,this[N+3]=255&T,N+4},f.prototype.writeBigUInt64LE=Fe(function(T,N=0){return H(this,T,N,BigInt(0),BigInt("0xffffffffffffffff"))}),f.prototype.writeBigUInt64BE=Fe(function(T,N=0){return D(this,T,N,BigInt(0),BigInt("0xffffffffffffffff"))}),f.prototype.writeIntLE=function(T,N,z,Q){if(T=+T,N>>>=0,!Q){let Me=Math.pow(2,8*z-1);P(this,T,N,z,Me-1,-Me)}let K=0,ie=1,ce=0;for(this[N]=255&T;++K<z&&(ie*=256);)T<0&&ce===0&&this[N+K-1]!==0&&(ce=1),this[N+K]=(T/ie>>0)-ce&255;return N+z},f.prototype.writeIntBE=function(T,N,z,Q){if(T=+T,N>>>=0,!Q){let Me=Math.pow(2,8*z-1);P(this,T,N,z,Me-1,-Me)}let K=z-1,ie=1,ce=0;for(this[N+K]=255&T;--K>=0&&(ie*=256);)T<0&&ce===0&&this[N+K+1]!==0&&(ce=1),this[N+K]=(T/ie>>0)-ce&255;return N+z},f.prototype.writeInt8=function(T,N,z){return T=+T,N>>>=0,z||P(this,T,N,1,127,-128),T<0&&(T=255+T+1),this[N]=255&T,N+1},f.prototype.writeInt16LE=function(T,N,z){return T=+T,N>>>=0,z||P(this,T,N,2,32767,-32768),this[N]=255&T,this[N+1]=T>>>8,N+2},f.prototype.writeInt16BE=function(T,N,z){return T=+T,N>>>=0,z||P(this,T,N,2,32767,-32768),this[N]=T>>>8,this[N+1]=255&T,N+2},f.prototype.writeInt32LE=function(T,N,z){return T=+T,N>>>=0,z||P(this,T,N,4,2147483647,-2147483648),this[N]=255&T,this[N+1]=T>>>8,this[N+2]=T>>>16,this[N+3]=T>>>24,N+4},f.prototype.writeInt32BE=function(T,N,z){return T=+T,N>>>=0,z||P(this,T,N,4,2147483647,-2147483648),T<0&&(T=4294967295+T+1),this[N]=T>>>24,this[N+1]=T>>>16,this[N+2]=T>>>8,this[N+3]=255&T,N+4},f.prototype.writeBigInt64LE=Fe(function(T,N=0){return H(this,T,N,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),f.prototype.writeBigInt64BE=Fe(function(T,N=0){return D(this,T,N,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),f.prototype.writeFloatLE=function(T,N,z){return W(this,T,N,!0,z)},f.prototype.writeFloatBE=function(T,N,z){return W(this,T,N,!1,z)},f.prototype.writeDoubleLE=function(T,N,z){return j(this,T,N,!0,z)},f.prototype.writeDoubleBE=function(T,N,z){return j(this,T,N,!1,z)},f.prototype.copy=function(T,N,z,Q){if(!f.isBuffer(T))throw new TypeError("argument should be a Buffer");if(z||(z=0),Q||Q===0||(Q=this.length),N>=T.length&&(N=T.length),N||(N=0),Q>0&&Q<z&&(Q=z),Q===z||T.length===0||this.length===0)return 0;if(N<0)throw new RangeError("targetStart out of bounds");if(z<0||z>=this.length)throw new RangeError("Index out of range");if(Q<0)throw new RangeError("sourceEnd out of bounds");Q>this.length&&(Q=this.length),T.length-N<Q-z&&(Q=T.length-N+z);let K=Q-z;return this===T&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(N,z,Q):Uint8Array.prototype.set.call(T,this.subarray(z,Q),N),K},f.prototype.fill=function(T,N,z,Q){if(typeof T=="string"){if(typeof N=="string"?(Q=N,N=0,z=this.length):typeof z=="string"&&(Q=z,z=this.length),Q!==void 0&&typeof Q!="string")throw new TypeError("encoding must be a string");if(typeof Q=="string"&&!f.isEncoding(Q))throw new TypeError("Unknown encoding: "+Q);if(T.length===1){let ie=T.charCodeAt(0);(Q==="utf8"&&ie<128||Q==="latin1")&&(T=ie)}}else typeof T=="number"?T&=255:typeof T=="boolean"&&(T=Number(T));if(N<0||this.length<N||this.length<z)throw new RangeError("Out of range index");if(z<=N)return this;let K;if(N>>>=0,z=z===void 0?this.length:z>>>0,T||(T=0),typeof T=="number")for(K=N;K<z;++K)this[K]=T;else{let ie=f.isBuffer(T)?T:f.from(T,Q),ce=ie.length;if(ce===0)throw new TypeError('The value "'+T+'" is invalid for argument "value"');for(K=0;K<z-N;++K)this[K+N]=ie[K%ce]}return this};let G={};function Z(T,N,z){G[T]=class extends z{constructor(){super(),Object.defineProperty(this,"message",{value:N.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${T}]`,this.stack,delete this.name}get code(){return T}set code(Q){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Q,writable:!0})}toString(){return`${this.name} [${T}]: ${this.message}`}}}function te(T){let N="",z=T.length,Q=T[0]==="-"?1:0;for(;z>=Q+4;z-=3)N=`_${T.slice(z-3,z)}${N}`;return`${T.slice(0,z)}${N}`}function se(T,N,z,Q,K,ie){if(T>z||T<N){let ce=typeof N=="bigint"?"n":"",Me;throw Me=ie>3?N===0||N===BigInt(0)?`>= 0${ce} and < 2${ce} ** ${8*(ie+1)}${ce}`:`>= -(2${ce} ** ${8*(ie+1)-1}${ce}) and < 2 ** ${8*(ie+1)-1}${ce}`:`>= ${N}${ce} and <= ${z}${ce}`,new G.ERR_OUT_OF_RANGE("value",Me,T)}(function(ce,Me,Be){re(Me,"offset"),ce[Me]!==void 0&&ce[Me+Be]!==void 0||ae(Me,ce.length-(Be+1))})(Q,K,ie)}function re(T,N){if(typeof T!="number")throw new G.ERR_INVALID_ARG_TYPE(N,"number",T)}function ae(T,N,z){throw Math.floor(T)!==T?(re(T,z),new G.ERR_OUT_OF_RANGE(z||"offset","an integer",T)):N<0?new G.ERR_BUFFER_OUT_OF_BOUNDS:new G.ERR_OUT_OF_RANGE(z||"offset",`>= ${z?1:0} and <= ${N}`,T)}Z("ERR_BUFFER_OUT_OF_BOUNDS",function(T){return T?`${T} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Z("ERR_INVALID_ARG_TYPE",function(T,N){return`The "${T}" argument must be of type number. Received type ${typeof N}`},TypeError),Z("ERR_OUT_OF_RANGE",function(T,N,z){let Q=`The value of "${T}" is out of range.`,K=z;return Number.isInteger(z)&&Math.abs(z)>4294967296?K=te(String(z)):typeof z=="bigint"&&(K=String(z),(z>BigInt(2)**BigInt(32)||z<-(BigInt(2)**BigInt(32)))&&(K=te(K)),K+="n"),Q+=` It must be ${N}. Received ${K}`,Q},RangeError);let me=/[^+/0-9A-Za-z-_]/g;function ue(T,N){let z;N=N||1/0;let Q=T.length,K=null,ie=[];for(let ce=0;ce<Q;++ce){if(z=T.charCodeAt(ce),z>55295&&z<57344){if(!K){if(z>56319){(N-=3)>-1&&ie.push(239,191,189);continue}if(ce+1===Q){(N-=3)>-1&&ie.push(239,191,189);continue}K=z;continue}if(z<56320){(N-=3)>-1&&ie.push(239,191,189),K=z;continue}z=65536+(K-55296<<10|z-56320)}else K&&(N-=3)>-1&&ie.push(239,191,189);if(K=null,z<128){if((N-=1)<0)break;ie.push(z)}else if(z<2048){if((N-=2)<0)break;ie.push(z>>6|192,63&z|128)}else if(z<65536){if((N-=3)<0)break;ie.push(z>>12|224,z>>6&63|128,63&z|128)}else{if(!(z<1114112))throw new Error("Invalid code point");if((N-=4)<0)break;ie.push(z>>18|240,z>>12&63|128,z>>6&63|128,63&z|128)}}return ie}function Se(T){return o.toByteArray(function(N){if((N=(N=N.split("=")[0]).trim().replace(me,"")).length<2)return"";for(;N.length%4!=0;)N+="=";return N}(T))}function _e(T,N,z,Q){let K;for(K=0;K<Q&&!(K+z>=N.length||K>=T.length);++K)N[K+z]=T[K];return K}function ge(T,N){return T instanceof N||T!=null&&T.constructor!=null&&T.constructor.name!=null&&T.constructor.name===N.name}function ke(T){return T!=T}let Te=function(){let T="0123456789abcdef",N=new Array(256);for(let z=0;z<16;++z){let Q=16*z;for(let K=0;K<16;++K)N[Q+K]=T[z]+T[K]}return N}();function Fe(T){return typeof BigInt>"u"?Ie:T}function Ie(){throw new Error("BigInt not supported")}},4693:s=>{var r={array:function(a){var o=0,l=0,c=[0,1,3,7,15,31,63,127,255];return function(h){for(var d=0;h>0;){var f=8-o;h>=f?(d<<=f,d|=c[f]&a[l++],o=0,h-=f):(d<<=h,d|=(a[l]&c[h]<<8-h-o)>>8-h-o,o+=h,h=0)}return d}},simple:function(a){var o,l,c=r.header(a),h=[],d=0;do(l=r.decompress(a,c))!=-1&&(h.push(l),d+=l.byteLength);while(l!=-1);o=new Uint8Array(d),d=0;for(var f=0;f<h.length;++f)l=h[f],o.set(l,d),d+=l.byteLength;return o},header:function(a){if(a(24)!=4348520)throw"No magic number found";var o=a(8)-48;if(o<1||o>9)throw"Not a BZIP archive";return o},decompress:function(a,o,l){for(var c=9e5,h="",d=0;d<6;d++)h+=a(8).toString(16);if(h=="177245385090")return-1;if(h!="314159265359")throw"eek not valid bzip data";if(a(32),a(1))throw"unsupported obsolete version";var f=a(24);if(f>c)throw"Initial position larger than buffer size";var u=a(16),g=new Uint8Array(256),_=0;for(d=0;d<16;d++)if(u&1<<15-d){var b=a(16);for(x=0;x<16;x++)b&1<<15-x&&(g[_++]=16*d+x)}var w=a(3);if(w<2||w>6)throw"another error";var p=a(15);if(p==0)throw"meh";var m=[];for(d=0;d<w;d++)m[d]=d;var v=new Uint8Array(32768);for(d=0;d<p;d++){for(var x=0;a(1);x++)if(x>=w)throw"whoops another error";var R=m[x];m.splice(x,1),m.splice(0,0,R),v[d]=R}var M=_+2,C=[];for(x=0;x<w;x++){var L,y,E,k=new Uint8Array(258),A=new Uint8Array(21);for(u=a(5),d=0;d<M;d++){for(;;){if(u<1||u>20)throw"I gave up a while ago on writing error messages";if(!a(1))break;a(1)?u--:u++}k[d]=u}for(L=y=k[0],d=1;d<M;d++)k[d]>y?y=k[d]:k[d]<L&&(L=k[d]);(E=C[x]={}).permute=new Uint32Array(258),E.limit=new Uint32Array(21),E.base=new Uint32Array(21),E.minLen=L,E.maxLen=y;var I=E.base.subarray(1),F=E.limit.subarray(1),X=0;for(d=L;d<=y;d++)for(u=0;u<M;u++)k[u]==d&&(E.permute[X++]=u);for(d=L;d<=y;d++)A[d]=F[d]=0;for(d=0;d<M;d++)A[k[d]]++;for(X=u=0,d=L;d<y;d++)X+=A[d],F[d]=X-1,X<<=1,I[d+1]=X-(u+=A[d]);F[y]=X+A[y]-1,I[L]=0}var U,V,q,S=new Uint32Array(256);for(d=0;d<256;d++)m[d]=d;U=V=M=q=0;for(var P=new Uint32Array(c);;){if(!M--){if(M=49,q>=p)throw"meow i'm a kitty, that's an error";I=(E=C[v[q++]]).base.subarray(1),F=E.limit.subarray(1)}for(x=a(d=E.minLen);;){if(d>E.maxLen)throw"rawr i'm a dinosaur";if(x<=F[d])break;d++,x=x<<1|a(1)}if((x-=I[d])<0||x>=258)throw"moo i'm a cow";var H=E.permute[x];if(H!=0&&H!=1){if(U){if(U=0,V+u>=c)throw"Boom.";for(S[R=g[m[0]]]+=u;u--;)P[V++]=R}if(H>_)break;if(V>=c)throw"I can't think of anything. Error";R=m[d=H-1],m.splice(d,1),m.splice(0,0,R),S[R=g[R]]++,P[V++]=R}else U||(U=1,u=0),u+=H==0?U:2*U,U<<=1}if(f<0||f>=V)throw"I'm a monkey and I'm throwing something at someone, namely you";for(x=0,d=0;d<256;d++)b=x+S[d],S[d]=x,x=b;for(d=0;d<V;d++)P[S[R=255&P[d]]]|=d<<8,S[R]++;var D=0,O=0,W=0;V&&(O=255&(D=P[f]),D>>=8,W=-1);var j,G,Z,te=new Uint8Array(c),se=0;for(l||(l=1/0);V;){for(V--,G=O,O=255&(D=P[D]),D>>=8,W++==3?(j=O,Z=G,O=-1):(j=1,Z=O);j--;)if(te[se++]=Z,!--l)return te;O!=G&&(W=0)}return te.subarray(0,se)}};s.exports=r},487:s=>{var r={utf8:{stringToBytes:function(a){return r.bin.stringToBytes(unescape(encodeURIComponent(a)))},bytesToString:function(a){return decodeURIComponent(escape(r.bin.bytesToString(a)))}},bin:{stringToBytes:function(a){for(var o=[],l=0;l<a.length;l++)o.push(255&a.charCodeAt(l));return o},bytesToString:function(a){for(var o=[],l=0;l<a.length;l++)o.push(String.fromCharCode(a[l]));return o.join("")}}};s.exports=r},1012:s=>{var r,a;r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a={rotl:function(o,l){return o<<l|o>>>32-l},rotr:function(o,l){return o<<32-l|o>>>l},endian:function(o){if(o.constructor==Number)return 16711935&a.rotl(o,8)|4278255360&a.rotl(o,24);for(var l=0;l<o.length;l++)o[l]=a.endian(o[l]);return o},randomBytes:function(o){for(var l=[];o>0;o--)l.push(Math.floor(256*Math.random()));return l},bytesToWords:function(o){for(var l=[],c=0,h=0;c<o.length;c++,h+=8)l[h>>>5]|=o[c]<<24-h%32;return l},wordsToBytes:function(o){for(var l=[],c=0;c<32*o.length;c+=8)l.push(o[c>>>5]>>>24-c%32&255);return l},bytesToHex:function(o){for(var l=[],c=0;c<o.length;c++)l.push((o[c]>>>4).toString(16)),l.push((15&o[c]).toString(16));return l.join("")},hexToBytes:function(o){for(var l=[],c=0;c<o.length;c+=2)l.push(parseInt(o.substr(c,2),16));return l},bytesToBase64:function(o){for(var l=[],c=0;c<o.length;c+=3)for(var h=o[c]<<16|o[c+1]<<8|o[c+2],d=0;d<4;d++)8*c+6*d<=8*o.length?l.push(r.charAt(h>>>6*(3-d)&63)):l.push("=");return l.join("")},base64ToBytes:function(o){o=o.replace(/[^A-Z0-9+\/]/gi,"");for(var l=[],c=0,h=0;c<o.length;h=++c%4)h!=0&&l.push((r.indexOf(o.charAt(c-1))&Math.pow(2,-2*h+8)-1)<<2*h|r.indexOf(o.charAt(c))>>>6-2*h);return l}},s.exports=a},2949:(s,r,a)=>{a.r(r),a.d(r,{BlobFile:()=>u,LocalFile:()=>l(),RemoteFile:()=>d,fromUrl:()=>g,open:()=>_});var o=a(7067),l=a.n(o),c=a(8764);let h=typeof window<"u"?window:typeof self<"u"?self:{fetch:void 0};class d{constructor(w,p={}){this.baseOverrides={},this.url=w;let m=p.fetch||h.fetch&&h.fetch.bind(h);if(!m)throw new TypeError("no fetch function supplied, and none found in global environment");p.overrides&&(this.baseOverrides=p.overrides),this.fetchImplementation=m}async getBufferFromResponse(w){if(typeof w.buffer=="function")return w.buffer();if(typeof w.arrayBuffer=="function"){let p=await w.arrayBuffer();return c.Buffer.from(p)}throw new TypeError("invalid HTTP response object, has no buffer method, and no arrayBuffer method")}async fetch(w,p){let m;try{m=await this.fetchImplementation(w,p)}catch(v){if(!`${v}`.includes("Failed to fetch"))throw v;console.warn(`generic-filehandle: refetching ${w} to attempt to work around chrome CORS header caching bug`),m=await this.fetchImplementation(w,{...p,cache:"reload"})}return m}async read(w,p=0,m,v=0,x={}){let{headers:R={},signal:M,overrides:C={}}=x;m<1/0?R.range=`bytes=${v}-${v+m}`:m===1/0&&v!==0&&(R.range=`bytes=${v}-`);let L={...this.baseOverrides,...C,headers:{...R,...C.headers,...this.baseOverrides.headers},method:"GET",redirect:"follow",mode:"cors",signal:M},y=await this.fetch(this.url,L);if(!y.ok)throw new Error(`HTTP ${y.status} ${y.statusText} ${this.url}`);if(y.status===200&&v===0||y.status===206){let E=await this.getBufferFromResponse(y),k=E.copy(w,p,0,Math.min(m,E.length)),A=y.headers.get("content-range"),I=/\/(\d+)$/.exec(A||"");return I&&I[1]&&(this._stat={size:parseInt(I[1],10)}),{bytesRead:k,buffer:w}}throw y.status===200?new Error("${this.url} fetch returned status 200, expected 206"):new Error(`HTTP ${y.status} fetching ${this.url}`)}async readFile(w={}){let p,m;typeof w=="string"?(p=w,m={}):(p=w.encoding,m=w,delete m.encoding);let{headers:v={},signal:x,overrides:R={}}=m,M={headers:v,method:"GET",redirect:"follow",mode:"cors",signal:x,...this.baseOverrides,...R},C=await this.fetch(this.url,M);if(!C)throw new Error("generic-filehandle failed to fetch");if(C.status!==200)throw Object.assign(new Error(`HTTP ${C.status} fetching ${this.url}`),{status:C.status});if(p==="utf8")return C.text();if(p)throw new Error(`unsupported encoding: ${p}`);return this.getBufferFromResponse(C)}async stat(){if(!this._stat){let w=c.Buffer.allocUnsafe(10);if(await this.read(w,0,10,0),!this._stat)throw new Error(`unable to determine size of file at ${this.url}`)}return this._stat}async close(){}}function f(b){let w=new FileReader;return new Promise((p,m)=>{w.onerror=()=>{w.abort(),m(new Error("problem reading blob"))},w.onabort=()=>{m(new Error("blob reading was aborted"))},w.onload=()=>{w.result&&typeof w.result!="string"?p(w.result):m(new Error("unknown error reading blob"))},w.readAsArrayBuffer(b)})}class u{constructor(w){this.blob=w,this.size=w.size}async read(w,p=0,m,v=0){if(!m)return{bytesRead:0,buffer:w};let x=v,R=x+m,M=await f(this.blob.slice(x,R)),C=c.Buffer.from(M);return{bytesRead:C.copy(w,p),buffer:C}}async readFile(w){let p;if(p=typeof w=="string"?w:w&&w.encoding,p==="utf8")return function(v){let x=new FileReader;return new Promise((R,M)=>{x.onerror=()=>{x.abort(),M(new Error("problem reading blob"))},x.onabort=()=>{M(new Error("blob reading was aborted"))},x.onload=()=>{x.result&&typeof x.result=="string"?R(x.result):M(new Error("unknown error reading blob"))},x.readAsText(v)})}(this.blob);if(p)throw new Error(`unsupported encoding: ${p}`);let m=await f(this.blob);return c.Buffer.from(m)}async stat(){return{size:this.size}}async close(){}}function g(b,w={}){return new d(b,w)}function _(b,w,p,m={}){if(p!==void 0)return p;if(b!==void 0)return g(b,m);if(w!==void 0)return new(l())(w,m);throw new Error("no url, path, or filehandle provided, cannot open")}},645:(s,r)=>{r.read=function(a,o,l,c,h){var d,f,u=8*h-c-1,g=(1<<u)-1,_=g>>1,b=-7,w=l?h-1:0,p=l?-1:1,m=a[o+w];for(w+=p,d=m&(1<<-b)-1,m>>=-b,b+=u;b>0;d=256*d+a[o+w],w+=p,b-=8);for(f=d&(1<<-b)-1,d>>=-b,b+=c;b>0;f=256*f+a[o+w],w+=p,b-=8);if(d===0)d=1-_;else{if(d===g)return f?NaN:1/0*(m?-1:1);f+=Math.pow(2,c),d-=_}return(m?-1:1)*f*Math.pow(2,d-c)},r.write=function(a,o,l,c,h,d){var f,u,g,_=8*d-h-1,b=(1<<_)-1,w=b>>1,p=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,m=c?0:d-1,v=c?1:-1,x=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(u=isNaN(o)?1:0,f=b):(f=Math.floor(Math.log(o)/Math.LN2),o*(g=Math.pow(2,-f))<1&&(f--,g*=2),(o+=f+w>=1?p/g:p*Math.pow(2,1-w))*g>=2&&(f++,g/=2),f+w>=b?(u=0,f=b):f+w>=1?(u=(o*g-1)*Math.pow(2,h),f+=w):(u=o*Math.pow(2,w-1)*Math.pow(2,h),f=0));h>=8;a[l+m]=255&u,m+=v,u/=256,h-=8);for(f=f<<h|u,_+=h;_>0;a[l+m]=255&f,m+=v,f/=256,_-=8);a[l+m-v]|=128*x}},8738:s=>{function r(a){return!!a.constructor&&typeof a.constructor.isBuffer=="function"&&a.constructor.isBuffer(a)}s.exports=function(a){return a!=null&&(r(a)||function(o){return typeof o.readFloatLE=="function"&&typeof o.slice=="function"&&r(o.slice(0,0))}(a)||!!a._isBuffer)}},3720:s=>{s.exports=a;var r=null;try{r=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function a(A,I,F){this.low=0|A,this.high=0|I,this.unsigned=!!F}function o(A){return(A&&A.__isLong__)===!0}a.prototype.__isLong__,Object.defineProperty(a.prototype,"__isLong__",{value:!0}),a.isLong=o;var l={},c={};function h(A,I){var F,X,U;return I?(U=0<=(A>>>=0)&&A<256)&&(X=c[A])?X:(F=f(A,(0|A)<0?-1:0,!0),U&&(c[A]=F),F):(U=-128<=(A|=0)&&A<128)&&(X=l[A])?X:(F=f(A,A<0?-1:0,!1),U&&(l[A]=F),F)}function d(A,I){if(isNaN(A))return I?x:v;if(I){if(A<0)return x;if(A>=w)return y}else{if(A<=-p)return E;if(A+1>=p)return L}return A<0?d(-A,I).neg():f(A%b|0,A/b|0,I)}function f(A,I,F){return new a(A,I,F)}a.fromInt=h,a.fromNumber=d,a.fromBits=f;var u=Math.pow;function g(A,I,F){if(A.length===0)throw Error("empty string");if(A==="NaN"||A==="Infinity"||A==="+Infinity"||A==="-Infinity")return v;if(typeof I=="number"?(F=I,I=!1):I=!!I,(F=F||10)<2||36<F)throw RangeError("radix");var X;if((X=A.indexOf("-"))>0)throw Error("interior hyphen");if(X===0)return g(A.substring(1),I,F).neg();for(var U=d(u(F,8)),V=v,q=0;q<A.length;q+=8){var S=Math.min(8,A.length-q),P=parseInt(A.substring(q,q+S),F);if(S<8){var H=d(u(F,S));V=V.mul(H).add(d(P))}else V=(V=V.mul(U)).add(d(P))}return V.unsigned=I,V}function _(A,I){return typeof A=="number"?d(A,I):typeof A=="string"?g(A,I):f(A.low,A.high,typeof I=="boolean"?I:A.unsigned)}a.fromString=g,a.fromValue=_;var b=4294967296,w=b*b,p=w/2,m=h(1<<24),v=h(0);a.ZERO=v;var x=h(0,!0);a.UZERO=x;var R=h(1);a.ONE=R;var M=h(1,!0);a.UONE=M;var C=h(-1);a.NEG_ONE=C;var L=f(-1,2147483647,!1);a.MAX_VALUE=L;var y=f(-1,-1,!0);a.MAX_UNSIGNED_VALUE=y;var E=f(0,-2147483648,!1);a.MIN_VALUE=E;var k=a.prototype;k.toInt=function(){return this.unsigned?this.low>>>0:this.low},k.toNumber=function(){return this.unsigned?(this.high>>>0)*b+(this.low>>>0):this.high*b+(this.low>>>0)},k.toString=function(A){if((A=A||10)<2||36<A)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(E)){var I=d(A),F=this.div(I),X=F.mul(I).sub(this);return F.toString(A)+X.toInt().toString(A)}return"-"+this.neg().toString(A)}for(var U=d(u(A,6),this.unsigned),V=this,q="";;){var S=V.div(U),P=(V.sub(S.mul(U)).toInt()>>>0).toString(A);if((V=S).isZero())return P+q;for(;P.length<6;)P="0"+P;q=""+P+q}},k.getHighBits=function(){return this.high},k.getHighBitsUnsigned=function(){return this.high>>>0},k.getLowBits=function(){return this.low},k.getLowBitsUnsigned=function(){return this.low>>>0},k.getNumBitsAbs=function(){if(this.isNegative())return this.eq(E)?64:this.neg().getNumBitsAbs();for(var A=this.high!=0?this.high:this.low,I=31;I>0&&!(A&1<<I);I--);return this.high!=0?I+33:I+1},k.isZero=function(){return this.high===0&&this.low===0},k.eqz=k.isZero,k.isNegative=function(){return!this.unsigned&&this.high<0},k.isPositive=function(){return this.unsigned||this.high>=0},k.isOdd=function(){return(1&this.low)==1},k.isEven=function(){return(1&this.low)==0},k.equals=function(A){return o(A)||(A=_(A)),(this.unsigned===A.unsigned||this.high>>>31!=1||A.high>>>31!=1)&&this.high===A.high&&this.low===A.low},k.eq=k.equals,k.notEquals=function(A){return!this.eq(A)},k.neq=k.notEquals,k.ne=k.notEquals,k.lessThan=function(A){return this.comp(A)<0},k.lt=k.lessThan,k.lessThanOrEqual=function(A){return this.comp(A)<=0},k.lte=k.lessThanOrEqual,k.le=k.lessThanOrEqual,k.greaterThan=function(A){return this.comp(A)>0},k.gt=k.greaterThan,k.greaterThanOrEqual=function(A){return this.comp(A)>=0},k.gte=k.greaterThanOrEqual,k.ge=k.greaterThanOrEqual,k.compare=function(A){if(o(A)||(A=_(A)),this.eq(A))return 0;var I=this.isNegative(),F=A.isNegative();return I&&!F?-1:!I&&F?1:this.unsigned?A.high>>>0>this.high>>>0||A.high===this.high&&A.low>>>0>this.low>>>0?-1:1:this.sub(A).isNegative()?-1:1},k.comp=k.compare,k.negate=function(){return!this.unsigned&&this.eq(E)?E:this.not().add(R)},k.neg=k.negate,k.add=function(A){o(A)||(A=_(A));var I=this.high>>>16,F=65535&this.high,X=this.low>>>16,U=65535&this.low,V=A.high>>>16,q=65535&A.high,S=A.low>>>16,P=0,H=0,D=0,O=0;return D+=(O+=U+(65535&A.low))>>>16,H+=(D+=X+S)>>>16,P+=(H+=F+q)>>>16,P+=I+V,f((D&=65535)<<16|(O&=65535),(P&=65535)<<16|(H&=65535),this.unsigned)},k.subtract=function(A){return o(A)||(A=_(A)),this.add(A.neg())},k.sub=k.subtract,k.multiply=function(A){if(this.isZero())return v;if(o(A)||(A=_(A)),r)return f(r.mul(this.low,this.high,A.low,A.high),r.get_high(),this.unsigned);if(A.isZero())return v;if(this.eq(E))return A.isOdd()?E:v;if(A.eq(E))return this.isOdd()?E:v;if(this.isNegative())return A.isNegative()?this.neg().mul(A.neg()):this.neg().mul(A).neg();if(A.isNegative())return this.mul(A.neg()).neg();if(this.lt(m)&&A.lt(m))return d(this.toNumber()*A.toNumber(),this.unsigned);var I=this.high>>>16,F=65535&this.high,X=this.low>>>16,U=65535&this.low,V=A.high>>>16,q=65535&A.high,S=A.low>>>16,P=65535&A.low,H=0,D=0,O=0,W=0;return O+=(W+=U*P)>>>16,D+=(O+=X*P)>>>16,O&=65535,D+=(O+=U*S)>>>16,H+=(D+=F*P)>>>16,D&=65535,H+=(D+=X*S)>>>16,D&=65535,H+=(D+=U*q)>>>16,H+=I*P+F*S+X*q+U*V,f((O&=65535)<<16|(W&=65535),(H&=65535)<<16|(D&=65535),this.unsigned)},k.mul=k.multiply,k.divide=function(A){if(o(A)||(A=_(A)),A.isZero())throw Error("division by zero");var I,F,X;if(r)return this.unsigned||this.high!==-2147483648||A.low!==-1||A.high!==-1?f((this.unsigned?r.div_u:r.div_s)(this.low,this.high,A.low,A.high),r.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?x:v;if(this.unsigned){if(A.unsigned||(A=A.toUnsigned()),A.gt(this))return x;if(A.gt(this.shru(1)))return M;X=x}else{if(this.eq(E))return A.eq(R)||A.eq(C)?E:A.eq(E)?R:(I=this.shr(1).div(A).shl(1)).eq(v)?A.isNegative()?R:C:(F=this.sub(A.mul(I)),X=I.add(F.div(A)));if(A.eq(E))return this.unsigned?x:v;if(this.isNegative())return A.isNegative()?this.neg().div(A.neg()):this.neg().div(A).neg();if(A.isNegative())return this.div(A.neg()).neg();X=v}for(F=this;F.gte(A);){I=Math.max(1,Math.floor(F.toNumber()/A.toNumber()));for(var U=Math.ceil(Math.log(I)/Math.LN2),V=U<=48?1:u(2,U-48),q=d(I),S=q.mul(A);S.isNegative()||S.gt(F);)S=(q=d(I-=V,this.unsigned)).mul(A);q.isZero()&&(q=R),X=X.add(q),F=F.sub(S)}return X},k.div=k.divide,k.modulo=function(A){return o(A)||(A=_(A)),r?f((this.unsigned?r.rem_u:r.rem_s)(this.low,this.high,A.low,A.high),r.get_high(),this.unsigned):this.sub(this.div(A).mul(A))},k.mod=k.modulo,k.rem=k.modulo,k.not=function(){return f(~this.low,~this.high,this.unsigned)},k.and=function(A){return o(A)||(A=_(A)),f(this.low&A.low,this.high&A.high,this.unsigned)},k.or=function(A){return o(A)||(A=_(A)),f(this.low|A.low,this.high|A.high,this.unsigned)},k.xor=function(A){return o(A)||(A=_(A)),f(this.low^A.low,this.high^A.high,this.unsigned)},k.shiftLeft=function(A){return o(A)&&(A=A.toInt()),(A&=63)==0?this:A<32?f(this.low<<A,this.high<<A|this.low>>>32-A,this.unsigned):f(0,this.low<<A-32,this.unsigned)},k.shl=k.shiftLeft,k.shiftRight=function(A){return o(A)&&(A=A.toInt()),(A&=63)==0?this:A<32?f(this.low>>>A|this.high<<32-A,this.high>>A,this.unsigned):f(this.high>>A-32,this.high>=0?0:-1,this.unsigned)},k.shr=k.shiftRight,k.shiftRightUnsigned=function(A){if(o(A)&&(A=A.toInt()),(A&=63)==0)return this;var I=this.high;return A<32?f(this.low>>>A|I<<32-A,I>>>A,this.unsigned):f(A===32?I:I>>>A-32,0,this.unsigned)},k.shru=k.shiftRightUnsigned,k.shr_u=k.shiftRightUnsigned,k.toSigned=function(){return this.unsigned?f(this.low,this.high,!1):this},k.toUnsigned=function(){return this.unsigned?this:f(this.low,this.high,!0)},k.toBytes=function(A){return A?this.toBytesLE():this.toBytesBE()},k.toBytesLE=function(){var A=this.high,I=this.low;return[255&I,I>>>8&255,I>>>16&255,I>>>24,255&A,A>>>8&255,A>>>16&255,A>>>24]},k.toBytesBE=function(){var A=this.high,I=this.low;return[A>>>24,A>>>16&255,A>>>8&255,255&A,I>>>24,I>>>16&255,I>>>8&255,255&I]},a.fromBytes=function(A,I,F){return F?a.fromBytesLE(A,I):a.fromBytesBE(A,I)},a.fromBytesLE=function(A,I){return new a(A[0]|A[1]<<8|A[2]<<16|A[3]<<24,A[4]|A[5]<<8|A[6]<<16|A[7]<<24,I)},a.fromBytesBE=function(A,I){return new a(A[4]<<24|A[5]<<16|A[6]<<8|A[7],A[0]<<24|A[1]<<16|A[2]<<8|A[3],I)}},2568:(s,r,a)=>{var o,l,c,h,d;o=a(1012),l=a(487).utf8,c=a(8738),h=a(487).bin,(d=function(f,u){f.constructor==String?f=u&&u.encoding==="binary"?h.stringToBytes(f):l.stringToBytes(f):c(f)?f=Array.prototype.slice.call(f,0):Array.isArray(f)||f.constructor===Uint8Array||(f=f.toString());for(var g=o.bytesToWords(f),_=8*f.length,b=1732584193,w=-271733879,p=-1732584194,m=271733878,v=0;v<g.length;v++)g[v]=16711935&(g[v]<<8|g[v]>>>24)|4278255360&(g[v]<<24|g[v]>>>8);g[_>>>5]|=128<<_%32,g[14+(_+64>>>9<<4)]=_;var x=d._ff,R=d._gg,M=d._hh,C=d._ii;for(v=0;v<g.length;v+=16){var L=b,y=w,E=p,k=m;b=x(b,w,p,m,g[v+0],7,-680876936),m=x(m,b,w,p,g[v+1],12,-389564586),p=x(p,m,b,w,g[v+2],17,606105819),w=x(w,p,m,b,g[v+3],22,-1044525330),b=x(b,w,p,m,g[v+4],7,-176418897),m=x(m,b,w,p,g[v+5],12,1200080426),p=x(p,m,b,w,g[v+6],17,-1473231341),w=x(w,p,m,b,g[v+7],22,-45705983),b=x(b,w,p,m,g[v+8],7,1770035416),m=x(m,b,w,p,g[v+9],12,-1958414417),p=x(p,m,b,w,g[v+10],17,-42063),w=x(w,p,m,b,g[v+11],22,-1990404162),b=x(b,w,p,m,g[v+12],7,1804603682),m=x(m,b,w,p,g[v+13],12,-40341101),p=x(p,m,b,w,g[v+14],17,-1502002290),b=R(b,w=x(w,p,m,b,g[v+15],22,1236535329),p,m,g[v+1],5,-165796510),m=R(m,b,w,p,g[v+6],9,-1069501632),p=R(p,m,b,w,g[v+11],14,643717713),w=R(w,p,m,b,g[v+0],20,-373897302),b=R(b,w,p,m,g[v+5],5,-701558691),m=R(m,b,w,p,g[v+10],9,38016083),p=R(p,m,b,w,g[v+15],14,-660478335),w=R(w,p,m,b,g[v+4],20,-405537848),b=R(b,w,p,m,g[v+9],5,568446438),m=R(m,b,w,p,g[v+14],9,-1019803690),p=R(p,m,b,w,g[v+3],14,-187363961),w=R(w,p,m,b,g[v+8],20,1163531501),b=R(b,w,p,m,g[v+13],5,-1444681467),m=R(m,b,w,p,g[v+2],9,-51403784),p=R(p,m,b,w,g[v+7],14,1735328473),b=M(b,w=R(w,p,m,b,g[v+12],20,-1926607734),p,m,g[v+5],4,-378558),m=M(m,b,w,p,g[v+8],11,-2022574463),p=M(p,m,b,w,g[v+11],16,1839030562),w=M(w,p,m,b,g[v+14],23,-35309556),b=M(b,w,p,m,g[v+1],4,-1530992060),m=M(m,b,w,p,g[v+4],11,1272893353),p=M(p,m,b,w,g[v+7],16,-155497632),w=M(w,p,m,b,g[v+10],23,-1094730640),b=M(b,w,p,m,g[v+13],4,681279174),m=M(m,b,w,p,g[v+0],11,-358537222),p=M(p,m,b,w,g[v+3],16,-722521979),w=M(w,p,m,b,g[v+6],23,76029189),b=M(b,w,p,m,g[v+9],4,-640364487),m=M(m,b,w,p,g[v+12],11,-421815835),p=M(p,m,b,w,g[v+15],16,530742520),b=C(b,w=M(w,p,m,b,g[v+2],23,-995338651),p,m,g[v+0],6,-198630844),m=C(m,b,w,p,g[v+7],10,1126891415),p=C(p,m,b,w,g[v+14],15,-1416354905),w=C(w,p,m,b,g[v+5],21,-57434055),b=C(b,w,p,m,g[v+12],6,1700485571),m=C(m,b,w,p,g[v+3],10,-1894986606),p=C(p,m,b,w,g[v+10],15,-1051523),w=C(w,p,m,b,g[v+1],21,-2054922799),b=C(b,w,p,m,g[v+8],6,1873313359),m=C(m,b,w,p,g[v+15],10,-30611744),p=C(p,m,b,w,g[v+6],15,-1560198380),w=C(w,p,m,b,g[v+13],21,1309151649),b=C(b,w,p,m,g[v+4],6,-145523070),m=C(m,b,w,p,g[v+11],10,-1120210379),p=C(p,m,b,w,g[v+2],15,718787259),w=C(w,p,m,b,g[v+9],21,-343485551),b=b+L>>>0,w=w+y>>>0,p=p+E>>>0,m=m+k>>>0}return o.endian([b,w,p,m])})._ff=function(f,u,g,_,b,w,p){var m=f+(u&g|~u&_)+(b>>>0)+p;return(m<<w|m>>>32-w)+u},d._gg=function(f,u,g,_,b,w,p){var m=f+(u&_|g&~_)+(b>>>0)+p;return(m<<w|m>>>32-w)+u},d._hh=function(f,u,g,_,b,w,p){var m=f+(u^g^_)+(b>>>0)+p;return(m<<w|m>>>32-w)+u},d._ii=function(f,u,g,_,b,w,p){var m=f+(g^(u|~_))+(b>>>0)+p;return(m<<w|m>>>32-w)+u},d._blocksize=16,d._digestsize=16,s.exports=function(f,u){if(f==null)throw new Error("Illegal argument "+f);var g=o.wordsToBytes(d(f,u));return u&&u.asBytes?g:u&&u.asString?h.bytesToString(g):o.bytesToHex(g)}},9591:(s,r,a)=>{var o={};(0,a(4236).assign)(o,a(4555),a(8843),a(1619)),s.exports=o},4555:(s,r,a)=>{var o=a(405),l=a(4236),c=a(9373),h=a(8898),d=a(2292),f=Object.prototype.toString;function u(_){if(!(this instanceof u))return new u(_);this.options=l.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},_||{});var b=this.options;b.raw&&b.windowBits>0?b.windowBits=-b.windowBits:b.gzip&&b.windowBits>0&&b.windowBits<16&&(b.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var w=o.deflateInit2(this.strm,b.level,b.method,b.windowBits,b.memLevel,b.strategy);if(w!==0)throw new Error(h[w]);if(b.header&&o.deflateSetHeader(this.strm,b.header),b.dictionary){var p;if(p=typeof b.dictionary=="string"?c.string2buf(b.dictionary):f.call(b.dictionary)==="[object ArrayBuffer]"?new Uint8Array(b.dictionary):b.dictionary,(w=o.deflateSetDictionary(this.strm,p))!==0)throw new Error(h[w]);this._dict_set=!0}}function g(_,b){var w=new u(b);if(w.push(_,!0),w.err)throw w.msg||h[w.err];return w.result}u.prototype.push=function(_,b){var w,p,m=this.strm,v=this.options.chunkSize;if(this.ended)return!1;p=b===~~b?b:b===!0?4:0,typeof _=="string"?m.input=c.string2buf(_):f.call(_)==="[object ArrayBuffer]"?m.input=new Uint8Array(_):m.input=_,m.next_in=0,m.avail_in=m.input.length;do{if(m.avail_out===0&&(m.output=new l.Buf8(v),m.next_out=0,m.avail_out=v),(w=o.deflate(m,p))!==1&&w!==0)return this.onEnd(w),this.ended=!0,!1;m.avail_out!==0&&(m.avail_in!==0||p!==4&&p!==2)||(this.options.to==="string"?this.onData(c.buf2binstring(l.shrinkBuf(m.output,m.next_out))):this.onData(l.shrinkBuf(m.output,m.next_out)))}while((m.avail_in>0||m.avail_out===0)&&w!==1);return p===4?(w=o.deflateEnd(this.strm),this.onEnd(w),this.ended=!0,w===0):p!==2||(this.onEnd(0),m.avail_out=0,!0)},u.prototype.onData=function(_){this.chunks.push(_)},u.prototype.onEnd=function(_){_===0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg},r.Deflate=u,r.deflate=g,r.deflateRaw=function(_,b){return(b=b||{}).raw=!0,g(_,b)},r.gzip=function(_,b){return(b=b||{}).gzip=!0,g(_,b)}},8843:(s,r,a)=>{var o=a(7948),l=a(4236),c=a(9373),h=a(1619),d=a(8898),f=a(2292),u=a(2401),g=Object.prototype.toString;function _(w){if(!(this instanceof _))return new _(w);this.options=l.assign({chunkSize:16384,windowBits:0,to:""},w||{});var p=this.options;p.raw&&p.windowBits>=0&&p.windowBits<16&&(p.windowBits=-p.windowBits,p.windowBits===0&&(p.windowBits=-15)),!(p.windowBits>=0&&p.windowBits<16)||w&&w.windowBits||(p.windowBits+=32),p.windowBits>15&&p.windowBits<48&&!(15&p.windowBits)&&(p.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var m=o.inflateInit2(this.strm,p.windowBits);if(m!==h.Z_OK)throw new Error(d[m]);if(this.header=new u,o.inflateGetHeader(this.strm,this.header),p.dictionary&&(typeof p.dictionary=="string"?p.dictionary=c.string2buf(p.dictionary):g.call(p.dictionary)==="[object ArrayBuffer]"&&(p.dictionary=new Uint8Array(p.dictionary)),p.raw&&(m=o.inflateSetDictionary(this.strm,p.dictionary))!==h.Z_OK))throw new Error(d[m])}function b(w,p){var m=new _(p);if(m.push(w,!0),m.err)throw m.msg||d[m.err];return m.result}_.prototype.push=function(w,p){var m,v,x,R,M,C=this.strm,L=this.options.chunkSize,y=this.options.dictionary,E=!1;if(this.ended)return!1;v=p===~~p?p:p===!0?h.Z_FINISH:h.Z_NO_FLUSH,typeof w=="string"?C.input=c.binstring2buf(w):g.call(w)==="[object ArrayBuffer]"?C.input=new Uint8Array(w):C.input=w,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new l.Buf8(L),C.next_out=0,C.avail_out=L),(m=o.inflate(C,h.Z_NO_FLUSH))===h.Z_NEED_DICT&&y&&(m=o.inflateSetDictionary(this.strm,y)),m===h.Z_BUF_ERROR&&E===!0&&(m=h.Z_OK,E=!1),m!==h.Z_STREAM_END&&m!==h.Z_OK)return this.onEnd(m),this.ended=!0,!1;C.next_out&&(C.avail_out!==0&&m!==h.Z_STREAM_END&&(C.avail_in!==0||v!==h.Z_FINISH&&v!==h.Z_SYNC_FLUSH)||(this.options.to==="string"?(x=c.utf8border(C.output,C.next_out),R=C.next_out-x,M=c.buf2string(C.output,x),C.next_out=R,C.avail_out=L-R,R&&l.arraySet(C.output,C.output,x,R,0),this.onData(M)):this.onData(l.shrinkBuf(C.output,C.next_out)))),C.avail_in===0&&C.avail_out===0&&(E=!0)}while((C.avail_in>0||C.avail_out===0)&&m!==h.Z_STREAM_END);return m===h.Z_STREAM_END&&(v=h.Z_FINISH),v===h.Z_FINISH?(m=o.inflateEnd(this.strm),this.onEnd(m),this.ended=!0,m===h.Z_OK):v!==h.Z_SYNC_FLUSH||(this.onEnd(h.Z_OK),C.avail_out=0,!0)},_.prototype.onData=function(w){this.chunks.push(w)},_.prototype.onEnd=function(w){w===h.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=w,this.msg=this.strm.msg},r.Inflate=_,r.inflate=b,r.inflateRaw=function(w,p){return(p=p||{}).raw=!0,b(w,p)},r.ungzip=b},4236:(s,r)=>{var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function o(h,d){return Object.prototype.hasOwnProperty.call(h,d)}r.assign=function(h){for(var d=Array.prototype.slice.call(arguments,1);d.length;){var f=d.shift();if(f){if(typeof f!="object")throw new TypeError(f+"must be non-object");for(var u in f)o(f,u)&&(h[u]=f[u])}}return h},r.shrinkBuf=function(h,d){return h.length===d?h:h.subarray?h.subarray(0,d):(h.length=d,h)};var l={arraySet:function(h,d,f,u,g){if(d.subarray&&h.subarray)h.set(d.subarray(f,f+u),g);else for(var _=0;_<u;_++)h[g+_]=d[f+_]},flattenChunks:function(h){var d,f,u,g,_,b;for(u=0,d=0,f=h.length;d<f;d++)u+=h[d].length;for(b=new Uint8Array(u),g=0,d=0,f=h.length;d<f;d++)_=h[d],b.set(_,g),g+=_.length;return b}},c={arraySet:function(h,d,f,u,g){for(var _=0;_<u;_++)h[g+_]=d[f+_]},flattenChunks:function(h){return[].concat.apply([],h)}};r.setTyped=function(h){h?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,l)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,c))},r.setTyped(a)},9373:(s,r,a)=>{var o=a(4236),l=!0,c=!0;try{String.fromCharCode.apply(null,[0])}catch{l=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{c=!1}for(var h=new o.Buf8(256),d=0;d<256;d++)h[d]=d>=252?6:d>=248?5:d>=240?4:d>=224?3:d>=192?2:1;function f(u,g){if(g<65534&&(u.subarray&&c||!u.subarray&&l))return String.fromCharCode.apply(null,o.shrinkBuf(u,g));for(var _="",b=0;b<g;b++)_+=String.fromCharCode(u[b]);return _}h[254]=h[254]=1,r.string2buf=function(u){var g,_,b,w,p,m=u.length,v=0;for(w=0;w<m;w++)(64512&(_=u.charCodeAt(w)))==55296&&w+1<m&&(64512&(b=u.charCodeAt(w+1)))==56320&&(_=65536+(_-55296<<10)+(b-56320),w++),v+=_<128?1:_<2048?2:_<65536?3:4;for(g=new o.Buf8(v),p=0,w=0;p<v;w++)(64512&(_=u.charCodeAt(w)))==55296&&w+1<m&&(64512&(b=u.charCodeAt(w+1)))==56320&&(_=65536+(_-55296<<10)+(b-56320),w++),_<128?g[p++]=_:_<2048?(g[p++]=192|_>>>6,g[p++]=128|63&_):_<65536?(g[p++]=224|_>>>12,g[p++]=128|_>>>6&63,g[p++]=128|63&_):(g[p++]=240|_>>>18,g[p++]=128|_>>>12&63,g[p++]=128|_>>>6&63,g[p++]=128|63&_);return g},r.buf2binstring=function(u){return f(u,u.length)},r.binstring2buf=function(u){for(var g=new o.Buf8(u.length),_=0,b=g.length;_<b;_++)g[_]=u.charCodeAt(_);return g},r.buf2string=function(u,g){var _,b,w,p,m=g||u.length,v=new Array(2*m);for(b=0,_=0;_<m;)if((w=u[_++])<128)v[b++]=w;else if((p=h[w])>4)v[b++]=65533,_+=p-1;else{for(w&=p===2?31:p===3?15:7;p>1&&_<m;)w=w<<6|63&u[_++],p--;p>1?v[b++]=65533:w<65536?v[b++]=w:(w-=65536,v[b++]=55296|w>>10&1023,v[b++]=56320|1023&w)}return f(v,b)},r.utf8border=function(u,g){var _;for((g=g||u.length)>u.length&&(g=u.length),_=g-1;_>=0&&(192&u[_])==128;)_--;return _<0||_===0?g:_+h[u[_]]>g?_:g}},6069:s=>{s.exports=function(r,a,o,l){for(var c=65535&r|0,h=r>>>16&65535|0,d=0;o!==0;){o-=d=o>2e3?2e3:o;do h=h+(c=c+a[l++]|0)|0;while(--d);c%=65521,h%=65521}return c|h<<16|0}},1619:s=>{s.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},2869:s=>{var r=function(){for(var a,o=[],l=0;l<256;l++){a=l;for(var c=0;c<8;c++)a=1&a?3988292384^a>>>1:a>>>1;o[l]=a}return o}();s.exports=function(a,o,l,c){var h=r,d=c+l;a^=-1;for(var f=c;f<d;f++)a=a>>>8^h[255&(a^o[f])];return-1^a}},405:(s,r,a)=>{var o,l=a(4236),c=a(342),h=a(6069),d=a(2869),f=a(8898),u=-2,g=258,_=262,b=103,w=113,p=666;function m(S,P){return S.msg=f[P],P}function v(S){return(S<<1)-(S>4?9:0)}function x(S){for(var P=S.length;--P>=0;)S[P]=0}function R(S){var P=S.state,H=P.pending;H>S.avail_out&&(H=S.avail_out),H!==0&&(l.arraySet(S.output,P.pending_buf,P.pending_out,H,S.next_out),S.next_out+=H,P.pending_out+=H,S.total_out+=H,S.avail_out-=H,P.pending-=H,P.pending===0&&(P.pending_out=0))}function M(S,P){c._tr_flush_block(S,S.block_start>=0?S.block_start:-1,S.strstart-S.block_start,P),S.block_start=S.strstart,R(S.strm)}function C(S,P){S.pending_buf[S.pending++]=P}function L(S,P){S.pending_buf[S.pending++]=P>>>8&255,S.pending_buf[S.pending++]=255&P}function y(S,P,H,D){var O=S.avail_in;return O>D&&(O=D),O===0?0:(S.avail_in-=O,l.arraySet(P,S.input,S.next_in,O,H),S.state.wrap===1?S.adler=h(S.adler,P,O,H):S.state.wrap===2&&(S.adler=d(S.adler,P,O,H)),S.next_in+=O,S.total_in+=O,O)}function E(S,P){var H,D,O=S.max_chain_length,W=S.strstart,j=S.prev_length,G=S.nice_match,Z=S.strstart>S.w_size-_?S.strstart-(S.w_size-_):0,te=S.window,se=S.w_mask,re=S.prev,ae=S.strstart+g,me=te[W+j-1],ue=te[W+j];S.prev_length>=S.good_match&&(O>>=2),G>S.lookahead&&(G=S.lookahead);do if(te[(H=P)+j]===ue&&te[H+j-1]===me&&te[H]===te[W]&&te[++H]===te[W+1]){W+=2,H++;do;while(te[++W]===te[++H]&&te[++W]===te[++H]&&te[++W]===te[++H]&&te[++W]===te[++H]&&te[++W]===te[++H]&&te[++W]===te[++H]&&te[++W]===te[++H]&&te[++W]===te[++H]&&W<ae);if(D=g-(ae-W),W=ae-g,D>j){if(S.match_start=P,j=D,D>=G)break;me=te[W+j-1],ue=te[W+j]}}while((P=re[P&se])>Z&&--O!=0);return j<=S.lookahead?j:S.lookahead}function k(S){var P,H,D,O,W,j=S.w_size;do{if(O=S.window_size-S.lookahead-S.strstart,S.strstart>=j+(j-_)){l.arraySet(S.window,S.window,j,j,0),S.match_start-=j,S.strstart-=j,S.block_start-=j,P=H=S.hash_size;do D=S.head[--P],S.head[P]=D>=j?D-j:0;while(--H);P=H=j;do D=S.prev[--P],S.prev[P]=D>=j?D-j:0;while(--H);O+=j}if(S.strm.avail_in===0)break;if(H=y(S.strm,S.window,S.strstart+S.lookahead,O),S.lookahead+=H,S.lookahead+S.insert>=3)for(W=S.strstart-S.insert,S.ins_h=S.window[W],S.ins_h=(S.ins_h<<S.hash_shift^S.window[W+1])&S.hash_mask;S.insert&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[W+3-1])&S.hash_mask,S.prev[W&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=W,W++,S.insert--,!(S.lookahead+S.insert<3)););}while(S.lookahead<_&&S.strm.avail_in!==0)}function A(S,P){for(var H,D;;){if(S.lookahead<_){if(k(S),S.lookahead<_&&P===0)return 1;if(S.lookahead===0)break}if(H=0,S.lookahead>=3&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+3-1])&S.hash_mask,H=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart),H!==0&&S.strstart-H<=S.w_size-_&&(S.match_length=E(S,H)),S.match_length>=3)if(D=c._tr_tally(S,S.strstart-S.match_start,S.match_length-3),S.lookahead-=S.match_length,S.match_length<=S.max_lazy_match&&S.lookahead>=3){S.match_length--;do S.strstart++,S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+3-1])&S.hash_mask,H=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart;while(--S.match_length!=0);S.strstart++}else S.strstart+=S.match_length,S.match_length=0,S.ins_h=S.window[S.strstart],S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+1])&S.hash_mask;else D=c._tr_tally(S,0,S.window[S.strstart]),S.lookahead--,S.strstart++;if(D&&(M(S,!1),S.strm.avail_out===0))return 1}return S.insert=S.strstart<2?S.strstart:2,P===4?(M(S,!0),S.strm.avail_out===0?3:4):S.last_lit&&(M(S,!1),S.strm.avail_out===0)?1:2}function I(S,P){for(var H,D,O;;){if(S.lookahead<_){if(k(S),S.lookahead<_&&P===0)return 1;if(S.lookahead===0)break}if(H=0,S.lookahead>=3&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+3-1])&S.hash_mask,H=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart),S.prev_length=S.match_length,S.prev_match=S.match_start,S.match_length=2,H!==0&&S.prev_length<S.max_lazy_match&&S.strstart-H<=S.w_size-_&&(S.match_length=E(S,H),S.match_length<=5&&(S.strategy===1||S.match_length===3&&S.strstart-S.match_start>4096)&&(S.match_length=2)),S.prev_length>=3&&S.match_length<=S.prev_length){O=S.strstart+S.lookahead-3,D=c._tr_tally(S,S.strstart-1-S.prev_match,S.prev_length-3),S.lookahead-=S.prev_length-1,S.prev_length-=2;do++S.strstart<=O&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+3-1])&S.hash_mask,H=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart);while(--S.prev_length!=0);if(S.match_available=0,S.match_length=2,S.strstart++,D&&(M(S,!1),S.strm.avail_out===0))return 1}else if(S.match_available){if((D=c._tr_tally(S,0,S.window[S.strstart-1]))&&M(S,!1),S.strstart++,S.lookahead--,S.strm.avail_out===0)return 1}else S.match_available=1,S.strstart++,S.lookahead--}return S.match_available&&(D=c._tr_tally(S,0,S.window[S.strstart-1]),S.match_available=0),S.insert=S.strstart<2?S.strstart:2,P===4?(M(S,!0),S.strm.avail_out===0?3:4):S.last_lit&&(M(S,!1),S.strm.avail_out===0)?1:2}function F(S,P,H,D,O){this.good_length=S,this.max_lazy=P,this.nice_length=H,this.max_chain=D,this.func=O}function X(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new l.Buf16(1146),this.dyn_dtree=new l.Buf16(122),this.bl_tree=new l.Buf16(78),x(this.dyn_ltree),x(this.dyn_dtree),x(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new l.Buf16(16),this.heap=new l.Buf16(573),x(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new l.Buf16(573),x(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function U(S){var P;return S&&S.state?(S.total_in=S.total_out=0,S.data_type=2,(P=S.state).pending=0,P.pending_out=0,P.wrap<0&&(P.wrap=-P.wrap),P.status=P.wrap?42:w,S.adler=P.wrap===2?0:1,P.last_flush=0,c._tr_init(P),0):m(S,u)}function V(S){var P,H=U(S);return H===0&&((P=S.state).window_size=2*P.w_size,x(P.head),P.max_lazy_match=o[P.level].max_lazy,P.good_match=o[P.level].good_length,P.nice_match=o[P.level].nice_length,P.max_chain_length=o[P.level].max_chain,P.strstart=0,P.block_start=0,P.lookahead=0,P.insert=0,P.match_length=P.prev_length=2,P.match_available=0,P.ins_h=0),H}function q(S,P,H,D,O,W){if(!S)return u;var j=1;if(P===-1&&(P=6),D<0?(j=0,D=-D):D>15&&(j=2,D-=16),O<1||O>9||H!==8||D<8||D>15||P<0||P>9||W<0||W>4)return m(S,u);D===8&&(D=9);var G=new X;return S.state=G,G.strm=S,G.wrap=j,G.gzhead=null,G.w_bits=D,G.w_size=1<<G.w_bits,G.w_mask=G.w_size-1,G.hash_bits=O+7,G.hash_size=1<<G.hash_bits,G.hash_mask=G.hash_size-1,G.hash_shift=~~((G.hash_bits+3-1)/3),G.window=new l.Buf8(2*G.w_size),G.head=new l.Buf16(G.hash_size),G.prev=new l.Buf16(G.w_size),G.lit_bufsize=1<<O+6,G.pending_buf_size=4*G.lit_bufsize,G.pending_buf=new l.Buf8(G.pending_buf_size),G.d_buf=1*G.lit_bufsize,G.l_buf=3*G.lit_bufsize,G.level=P,G.strategy=W,G.method=H,V(S)}o=[new F(0,0,0,0,function(S,P){var H=65535;for(H>S.pending_buf_size-5&&(H=S.pending_buf_size-5);;){if(S.lookahead<=1){if(k(S),S.lookahead===0&&P===0)return 1;if(S.lookahead===0)break}S.strstart+=S.lookahead,S.lookahead=0;var D=S.block_start+H;if((S.strstart===0||S.strstart>=D)&&(S.lookahead=S.strstart-D,S.strstart=D,M(S,!1),S.strm.avail_out===0)||S.strstart-S.block_start>=S.w_size-_&&(M(S,!1),S.strm.avail_out===0))return 1}return S.insert=0,P===4?(M(S,!0),S.strm.avail_out===0?3:4):(S.strstart>S.block_start&&(M(S,!1),S.strm.avail_out),1)}),new F(4,4,8,4,A),new F(4,5,16,8,A),new F(4,6,32,32,A),new F(4,4,16,16,I),new F(8,16,32,32,I),new F(8,16,128,128,I),new F(8,32,128,256,I),new F(32,128,258,1024,I),new F(32,258,258,4096,I)],r.deflateInit=function(S,P){return q(S,P,8,15,8,0)},r.deflateInit2=q,r.deflateReset=V,r.deflateResetKeep=U,r.deflateSetHeader=function(S,P){return S&&S.state?S.state.wrap!==2?u:(S.state.gzhead=P,0):u},r.deflate=function(S,P){var H,D,O,W;if(!S||!S.state||P>5||P<0)return S?m(S,u):u;if(D=S.state,!S.output||!S.input&&S.avail_in!==0||D.status===p&&P!==4)return m(S,S.avail_out===0?-5:u);if(D.strm=S,H=D.last_flush,D.last_flush=P,D.status===42)if(D.wrap===2)S.adler=0,C(D,31),C(D,139),C(D,8),D.gzhead?(C(D,(D.gzhead.text?1:0)+(D.gzhead.hcrc?2:0)+(D.gzhead.extra?4:0)+(D.gzhead.name?8:0)+(D.gzhead.comment?16:0)),C(D,255&D.gzhead.time),C(D,D.gzhead.time>>8&255),C(D,D.gzhead.time>>16&255),C(D,D.gzhead.time>>24&255),C(D,D.level===9?2:D.strategy>=2||D.level<2?4:0),C(D,255&D.gzhead.os),D.gzhead.extra&&D.gzhead.extra.length&&(C(D,255&D.gzhead.extra.length),C(D,D.gzhead.extra.length>>8&255)),D.gzhead.hcrc&&(S.adler=d(S.adler,D.pending_buf,D.pending,0)),D.gzindex=0,D.status=69):(C(D,0),C(D,0),C(D,0),C(D,0),C(D,0),C(D,D.level===9?2:D.strategy>=2||D.level<2?4:0),C(D,3),D.status=w);else{var j=8+(D.w_bits-8<<4)<<8;j|=(D.strategy>=2||D.level<2?0:D.level<6?1:D.level===6?2:3)<<6,D.strstart!==0&&(j|=32),j+=31-j%31,D.status=w,L(D,j),D.strstart!==0&&(L(D,S.adler>>>16),L(D,65535&S.adler)),S.adler=1}if(D.status===69)if(D.gzhead.extra){for(O=D.pending;D.gzindex<(65535&D.gzhead.extra.length)&&(D.pending!==D.pending_buf_size||(D.gzhead.hcrc&&D.pending>O&&(S.adler=d(S.adler,D.pending_buf,D.pending-O,O)),R(S),O=D.pending,D.pending!==D.pending_buf_size));)C(D,255&D.gzhead.extra[D.gzindex]),D.gzindex++;D.gzhead.hcrc&&D.pending>O&&(S.adler=d(S.adler,D.pending_buf,D.pending-O,O)),D.gzindex===D.gzhead.extra.length&&(D.gzindex=0,D.status=73)}else D.status=73;if(D.status===73)if(D.gzhead.name){O=D.pending;do{if(D.pending===D.pending_buf_size&&(D.gzhead.hcrc&&D.pending>O&&(S.adler=d(S.adler,D.pending_buf,D.pending-O,O)),R(S),O=D.pending,D.pending===D.pending_buf_size)){W=1;break}W=D.gzindex<D.gzhead.name.length?255&D.gzhead.name.charCodeAt(D.gzindex++):0,C(D,W)}while(W!==0);D.gzhead.hcrc&&D.pending>O&&(S.adler=d(S.adler,D.pending_buf,D.pending-O,O)),W===0&&(D.gzindex=0,D.status=91)}else D.status=91;if(D.status===91)if(D.gzhead.comment){O=D.pending;do{if(D.pending===D.pending_buf_size&&(D.gzhead.hcrc&&D.pending>O&&(S.adler=d(S.adler,D.pending_buf,D.pending-O,O)),R(S),O=D.pending,D.pending===D.pending_buf_size)){W=1;break}W=D.gzindex<D.gzhead.comment.length?255&D.gzhead.comment.charCodeAt(D.gzindex++):0,C(D,W)}while(W!==0);D.gzhead.hcrc&&D.pending>O&&(S.adler=d(S.adler,D.pending_buf,D.pending-O,O)),W===0&&(D.status=b)}else D.status=b;if(D.status===b&&(D.gzhead.hcrc?(D.pending+2>D.pending_buf_size&&R(S),D.pending+2<=D.pending_buf_size&&(C(D,255&S.adler),C(D,S.adler>>8&255),S.adler=0,D.status=w)):D.status=w),D.pending!==0){if(R(S),S.avail_out===0)return D.last_flush=-1,0}else if(S.avail_in===0&&v(P)<=v(H)&&P!==4)return m(S,-5);if(D.status===p&&S.avail_in!==0)return m(S,-5);if(S.avail_in!==0||D.lookahead!==0||P!==0&&D.status!==p){var G=D.strategy===2?function(Z,te){for(var se;;){if(Z.lookahead===0&&(k(Z),Z.lookahead===0)){if(te===0)return 1;break}if(Z.match_length=0,se=c._tr_tally(Z,0,Z.window[Z.strstart]),Z.lookahead--,Z.strstart++,se&&(M(Z,!1),Z.strm.avail_out===0))return 1}return Z.insert=0,te===4?(M(Z,!0),Z.strm.avail_out===0?3:4):Z.last_lit&&(M(Z,!1),Z.strm.avail_out===0)?1:2}(D,P):D.strategy===3?function(Z,te){for(var se,re,ae,me,ue=Z.window;;){if(Z.lookahead<=g){if(k(Z),Z.lookahead<=g&&te===0)return 1;if(Z.lookahead===0)break}if(Z.match_length=0,Z.lookahead>=3&&Z.strstart>0&&(re=ue[ae=Z.strstart-1])===ue[++ae]&&re===ue[++ae]&&re===ue[++ae]){me=Z.strstart+g;do;while(re===ue[++ae]&&re===ue[++ae]&&re===ue[++ae]&&re===ue[++ae]&&re===ue[++ae]&&re===ue[++ae]&&re===ue[++ae]&&re===ue[++ae]&&ae<me);Z.match_length=g-(me-ae),Z.match_length>Z.lookahead&&(Z.match_length=Z.lookahead)}if(Z.match_length>=3?(se=c._tr_tally(Z,1,Z.match_length-3),Z.lookahead-=Z.match_length,Z.strstart+=Z.match_length,Z.match_length=0):(se=c._tr_tally(Z,0,Z.window[Z.strstart]),Z.lookahead--,Z.strstart++),se&&(M(Z,!1),Z.strm.avail_out===0))return 1}return Z.insert=0,te===4?(M(Z,!0),Z.strm.avail_out===0?3:4):Z.last_lit&&(M(Z,!1),Z.strm.avail_out===0)?1:2}(D,P):o[D.level].func(D,P);if(G!==3&&G!==4||(D.status=p),G===1||G===3)return S.avail_out===0&&(D.last_flush=-1),0;if(G===2&&(P===1?c._tr_align(D):P!==5&&(c._tr_stored_block(D,0,0,!1),P===3&&(x(D.head),D.lookahead===0&&(D.strstart=0,D.block_start=0,D.insert=0))),R(S),S.avail_out===0))return D.last_flush=-1,0}return P!==4?0:D.wrap<=0?1:(D.wrap===2?(C(D,255&S.adler),C(D,S.adler>>8&255),C(D,S.adler>>16&255),C(D,S.adler>>24&255),C(D,255&S.total_in),C(D,S.total_in>>8&255),C(D,S.total_in>>16&255),C(D,S.total_in>>24&255)):(L(D,S.adler>>>16),L(D,65535&S.adler)),R(S),D.wrap>0&&(D.wrap=-D.wrap),D.pending!==0?0:1)},r.deflateEnd=function(S){var P;return S&&S.state?(P=S.state.status)!==42&&P!==69&&P!==73&&P!==91&&P!==b&&P!==w&&P!==p?m(S,u):(S.state=null,P===w?m(S,-3):0):u},r.deflateSetDictionary=function(S,P){var H,D,O,W,j,G,Z,te,se=P.length;if(!S||!S.state||(W=(H=S.state).wrap)===2||W===1&&H.status!==42||H.lookahead)return u;for(W===1&&(S.adler=h(S.adler,P,se,0)),H.wrap=0,se>=H.w_size&&(W===0&&(x(H.head),H.strstart=0,H.block_start=0,H.insert=0),te=new l.Buf8(H.w_size),l.arraySet(te,P,se-H.w_size,H.w_size,0),P=te,se=H.w_size),j=S.avail_in,G=S.next_in,Z=S.input,S.avail_in=se,S.next_in=0,S.input=P,k(H);H.lookahead>=3;){D=H.strstart,O=H.lookahead-2;do H.ins_h=(H.ins_h<<H.hash_shift^H.window[D+3-1])&H.hash_mask,H.prev[D&H.w_mask]=H.head[H.ins_h],H.head[H.ins_h]=D,D++;while(--O);H.strstart=D,H.lookahead=2,k(H)}return H.strstart+=H.lookahead,H.block_start=H.strstart,H.insert=H.lookahead,H.lookahead=0,H.match_length=H.prev_length=2,H.match_available=0,S.next_in=G,S.input=Z,S.avail_in=j,H.wrap=W,0},r.deflateInfo="pako deflate (from Nodeca project)"},2401:s=>{s.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},4264:s=>{s.exports=function(r,a){var o,l,c,h,d,f,u,g,_,b,w,p,m,v,x,R,M,C,L,y,E,k,A,I,F;o=r.state,l=r.next_in,I=r.input,c=l+(r.avail_in-5),h=r.next_out,F=r.output,d=h-(a-r.avail_out),f=h+(r.avail_out-257),u=o.dmax,g=o.wsize,_=o.whave,b=o.wnext,w=o.window,p=o.hold,m=o.bits,v=o.lencode,x=o.distcode,R=(1<<o.lenbits)-1,M=(1<<o.distbits)-1;e:do{m<15&&(p+=I[l++]<<m,m+=8,p+=I[l++]<<m,m+=8),C=v[p&R];t:for(;;){if(p>>>=L=C>>>24,m-=L,(L=C>>>16&255)==0)F[h++]=65535&C;else{if(!(16&L)){if(!(64&L)){C=v[(65535&C)+(p&(1<<L)-1)];continue t}if(32&L){o.mode=12;break e}r.msg="invalid literal/length code",o.mode=30;break e}y=65535&C,(L&=15)&&(m<L&&(p+=I[l++]<<m,m+=8),y+=p&(1<<L)-1,p>>>=L,m-=L),m<15&&(p+=I[l++]<<m,m+=8,p+=I[l++]<<m,m+=8),C=x[p&M];i:for(;;){if(p>>>=L=C>>>24,m-=L,!(16&(L=C>>>16&255))){if(!(64&L)){C=x[(65535&C)+(p&(1<<L)-1)];continue i}r.msg="invalid distance code",o.mode=30;break e}if(E=65535&C,m<(L&=15)&&(p+=I[l++]<<m,(m+=8)<L&&(p+=I[l++]<<m,m+=8)),(E+=p&(1<<L)-1)>u){r.msg="invalid distance too far back",o.mode=30;break e}if(p>>>=L,m-=L,E>(L=h-d)){if((L=E-L)>_&&o.sane){r.msg="invalid distance too far back",o.mode=30;break e}if(k=0,A=w,b===0){if(k+=g-L,L<y){y-=L;do F[h++]=w[k++];while(--L);k=h-E,A=F}}else if(b<L){if(k+=g+b-L,(L-=b)<y){y-=L;do F[h++]=w[k++];while(--L);if(k=0,b<y){y-=L=b;do F[h++]=w[k++];while(--L);k=h-E,A=F}}}else if(k+=b-L,L<y){y-=L;do F[h++]=w[k++];while(--L);k=h-E,A=F}for(;y>2;)F[h++]=A[k++],F[h++]=A[k++],F[h++]=A[k++],y-=3;y&&(F[h++]=A[k++],y>1&&(F[h++]=A[k++]))}else{k=h-E;do F[h++]=F[k++],F[h++]=F[k++],F[h++]=F[k++],y-=3;while(y>2);y&&(F[h++]=F[k++],y>1&&(F[h++]=F[k++]))}break}}break}}while(l<c&&h<f);l-=y=m>>3,p&=(1<<(m-=y<<3))-1,r.next_in=l,r.next_out=h,r.avail_in=l<c?c-l+5:5-(l-c),r.avail_out=h<f?f-h+257:257-(h-f),o.hold=p,o.bits=m}},7948:(s,r,a)=>{var o=a(4236),l=a(6069),c=a(2869),h=a(4264),d=a(9241),f=-2,u=12,g=30;function _(y){return(y>>>24&255)+(y>>>8&65280)+((65280&y)<<8)+((255&y)<<24)}function b(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function w(y){var E;return y&&y.state?(E=y.state,y.total_in=y.total_out=E.total=0,y.msg="",E.wrap&&(y.adler=1&E.wrap),E.mode=1,E.last=0,E.havedict=0,E.dmax=32768,E.head=null,E.hold=0,E.bits=0,E.lencode=E.lendyn=new o.Buf32(852),E.distcode=E.distdyn=new o.Buf32(592),E.sane=1,E.back=-1,0):f}function p(y){var E;return y&&y.state?((E=y.state).wsize=0,E.whave=0,E.wnext=0,w(y)):f}function m(y,E){var k,A;return y&&y.state?(A=y.state,E<0?(k=0,E=-E):(k=1+(E>>4),E<48&&(E&=15)),E&&(E<8||E>15)?f:(A.window!==null&&A.wbits!==E&&(A.window=null),A.wrap=k,A.wbits=E,p(y))):f}function v(y,E){var k,A;return y?(A=new b,y.state=A,A.window=null,(k=m(y,E))!==0&&(y.state=null),k):f}var x,R,M=!0;function C(y){if(M){var E;for(x=new o.Buf32(512),R=new o.Buf32(32),E=0;E<144;)y.lens[E++]=8;for(;E<256;)y.lens[E++]=9;for(;E<280;)y.lens[E++]=7;for(;E<288;)y.lens[E++]=8;for(d(1,y.lens,0,288,x,0,y.work,{bits:9}),E=0;E<32;)y.lens[E++]=5;d(2,y.lens,0,32,R,0,y.work,{bits:5}),M=!1}y.lencode=x,y.lenbits=9,y.distcode=R,y.distbits=5}function L(y,E,k,A){var I,F=y.state;return F.window===null&&(F.wsize=1<<F.wbits,F.wnext=0,F.whave=0,F.window=new o.Buf8(F.wsize)),A>=F.wsize?(o.arraySet(F.window,E,k-F.wsize,F.wsize,0),F.wnext=0,F.whave=F.wsize):((I=F.wsize-F.wnext)>A&&(I=A),o.arraySet(F.window,E,k-A,I,F.wnext),(A-=I)?(o.arraySet(F.window,E,k-A,A,0),F.wnext=A,F.whave=F.wsize):(F.wnext+=I,F.wnext===F.wsize&&(F.wnext=0),F.whave<F.wsize&&(F.whave+=I))),0}r.inflateReset=p,r.inflateReset2=m,r.inflateResetKeep=w,r.inflateInit=function(y){return v(y,15)},r.inflateInit2=v,r.inflate=function(y,E){var k,A,I,F,X,U,V,q,S,P,H,D,O,W,j,G,Z,te,se,re,ae,me,ue,Se,_e=0,ge=new o.Buf8(4),ke=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!y||!y.state||!y.output||!y.input&&y.avail_in!==0)return f;(k=y.state).mode===u&&(k.mode=13),X=y.next_out,I=y.output,V=y.avail_out,F=y.next_in,A=y.input,U=y.avail_in,q=k.hold,S=k.bits,P=U,H=V,me=0;e:for(;;)switch(k.mode){case 1:if(k.wrap===0){k.mode=13;break}for(;S<16;){if(U===0)break e;U--,q+=A[F++]<<S,S+=8}if(2&k.wrap&&q===35615){k.check=0,ge[0]=255&q,ge[1]=q>>>8&255,k.check=c(k.check,ge,2,0),q=0,S=0,k.mode=2;break}if(k.flags=0,k.head&&(k.head.done=!1),!(1&k.wrap)||(((255&q)<<8)+(q>>8))%31){y.msg="incorrect header check",k.mode=g;break}if((15&q)!=8){y.msg="unknown compression method",k.mode=g;break}if(S-=4,ae=8+(15&(q>>>=4)),k.wbits===0)k.wbits=ae;else if(ae>k.wbits){y.msg="invalid window size",k.mode=g;break}k.dmax=1<<ae,y.adler=k.check=1,k.mode=512&q?10:u,q=0,S=0;break;case 2:for(;S<16;){if(U===0)break e;U--,q+=A[F++]<<S,S+=8}if(k.flags=q,(255&k.flags)!=8){y.msg="unknown compression method",k.mode=g;break}if(57344&k.flags){y.msg="unknown header flags set",k.mode=g;break}k.head&&(k.head.text=q>>8&1),512&k.flags&&(ge[0]=255&q,ge[1]=q>>>8&255,k.check=c(k.check,ge,2,0)),q=0,S=0,k.mode=3;case 3:for(;S<32;){if(U===0)break e;U--,q+=A[F++]<<S,S+=8}k.head&&(k.head.time=q),512&k.flags&&(ge[0]=255&q,ge[1]=q>>>8&255,ge[2]=q>>>16&255,ge[3]=q>>>24&255,k.check=c(k.check,ge,4,0)),q=0,S=0,k.mode=4;case 4:for(;S<16;){if(U===0)break e;U--,q+=A[F++]<<S,S+=8}k.head&&(k.head.xflags=255&q,k.head.os=q>>8),512&k.flags&&(ge[0]=255&q,ge[1]=q>>>8&255,k.check=c(k.check,ge,2,0)),q=0,S=0,k.mode=5;case 5:if(1024&k.flags){for(;S<16;){if(U===0)break e;U--,q+=A[F++]<<S,S+=8}k.length=q,k.head&&(k.head.extra_len=q),512&k.flags&&(ge[0]=255&q,ge[1]=q>>>8&255,k.check=c(k.check,ge,2,0)),q=0,S=0}else k.head&&(k.head.extra=null);k.mode=6;case 6:if(1024&k.flags&&((D=k.length)>U&&(D=U),D&&(k.head&&(ae=k.head.extra_len-k.length,k.head.extra||(k.head.extra=new Array(k.head.extra_len)),o.arraySet(k.head.extra,A,F,D,ae)),512&k.flags&&(k.check=c(k.check,A,D,F)),U-=D,F+=D,k.length-=D),k.length))break e;k.length=0,k.mode=7;case 7:if(2048&k.flags){if(U===0)break e;D=0;do ae=A[F+D++],k.head&&ae&&k.length<65536&&(k.head.name+=String.fromCharCode(ae));while(ae&&D<U);if(512&k.flags&&(k.check=c(k.check,A,D,F)),U-=D,F+=D,ae)break e}else k.head&&(k.head.name=null);k.length=0,k.mode=8;case 8:if(4096&k.flags){if(U===0)break e;D=0;do ae=A[F+D++],k.head&&ae&&k.length<65536&&(k.head.comment+=String.fromCharCode(ae));while(ae&&D<U);if(512&k.flags&&(k.check=c(k.check,A,D,F)),U-=D,F+=D,ae)break e}else k.head&&(k.head.comment=null);k.mode=9;case 9:if(512&k.flags){for(;S<16;){if(U===0)break e;U--,q+=A[F++]<<S,S+=8}if(q!==(65535&k.check)){y.msg="header crc mismatch",k.mode=g;break}q=0,S=0}k.head&&(k.head.hcrc=k.flags>>9&1,k.head.done=!0),y.adler=k.check=0,k.mode=u;break;case 10:for(;S<32;){if(U===0)break e;U--,q+=A[F++]<<S,S+=8}y.adler=k.check=_(q),q=0,S=0,k.mode=11;case 11:if(k.havedict===0)return y.next_out=X,y.avail_out=V,y.next_in=F,y.avail_in=U,k.hold=q,k.bits=S,2;y.adler=k.check=1,k.mode=u;case u:if(E===5||E===6)break e;case 13:if(k.last){q>>>=7&S,S-=7&S,k.mode=27;break}for(;S<3;){if(U===0)break e;U--,q+=A[F++]<<S,S+=8}switch(k.last=1&q,S-=1,3&(q>>>=1)){case 0:k.mode=14;break;case 1:if(C(k),k.mode=20,E===6){q>>>=2,S-=2;break e}break;case 2:k.mode=17;break;case 3:y.msg="invalid block type",k.mode=g}q>>>=2,S-=2;break;case 14:for(q>>>=7&S,S-=7&S;S<32;){if(U===0)break e;U--,q+=A[F++]<<S,S+=8}if((65535&q)!=(q>>>16^65535)){y.msg="invalid stored block lengths",k.mode=g;break}if(k.length=65535&q,q=0,S=0,k.mode=15,E===6)break e;case 15:k.mode=16;case 16:if(D=k.length){if(D>U&&(D=U),D>V&&(D=V),D===0)break e;o.arraySet(I,A,F,D,X),U-=D,F+=D,V-=D,X+=D,k.length-=D;break}k.mode=u;break;case 17:for(;S<14;){if(U===0)break e;U--,q+=A[F++]<<S,S+=8}if(k.nlen=257+(31&q),q>>>=5,S-=5,k.ndist=1+(31&q),q>>>=5,S-=5,k.ncode=4+(15&q),q>>>=4,S-=4,k.nlen>286||k.ndist>30){y.msg="too many length or distance symbols",k.mode=g;break}k.have=0,k.mode=18;case 18:for(;k.have<k.ncode;){for(;S<3;){if(U===0)break e;U--,q+=A[F++]<<S,S+=8}k.lens[ke[k.have++]]=7&q,q>>>=3,S-=3}for(;k.have<19;)k.lens[ke[k.have++]]=0;if(k.lencode=k.lendyn,k.lenbits=7,ue={bits:k.lenbits},me=d(0,k.lens,0,19,k.lencode,0,k.work,ue),k.lenbits=ue.bits,me){y.msg="invalid code lengths set",k.mode=g;break}k.have=0,k.mode=19;case 19:for(;k.have<k.nlen+k.ndist;){for(;G=(_e=k.lencode[q&(1<<k.lenbits)-1])>>>16&255,Z=65535&_e,!((j=_e>>>24)<=S);){if(U===0)break e;U--,q+=A[F++]<<S,S+=8}if(Z<16)q>>>=j,S-=j,k.lens[k.have++]=Z;else{if(Z===16){for(Se=j+2;S<Se;){if(U===0)break e;U--,q+=A[F++]<<S,S+=8}if(q>>>=j,S-=j,k.have===0){y.msg="invalid bit length repeat",k.mode=g;break}ae=k.lens[k.have-1],D=3+(3&q),q>>>=2,S-=2}else if(Z===17){for(Se=j+3;S<Se;){if(U===0)break e;U--,q+=A[F++]<<S,S+=8}S-=j,ae=0,D=3+(7&(q>>>=j)),q>>>=3,S-=3}else{for(Se=j+7;S<Se;){if(U===0)break e;U--,q+=A[F++]<<S,S+=8}S-=j,ae=0,D=11+(127&(q>>>=j)),q>>>=7,S-=7}if(k.have+D>k.nlen+k.ndist){y.msg="invalid bit length repeat",k.mode=g;break}for(;D--;)k.lens[k.have++]=ae}}if(k.mode===g)break;if(k.lens[256]===0){y.msg="invalid code -- missing end-of-block",k.mode=g;break}if(k.lenbits=9,ue={bits:k.lenbits},me=d(1,k.lens,0,k.nlen,k.lencode,0,k.work,ue),k.lenbits=ue.bits,me){y.msg="invalid literal/lengths set",k.mode=g;break}if(k.distbits=6,k.distcode=k.distdyn,ue={bits:k.distbits},me=d(2,k.lens,k.nlen,k.ndist,k.distcode,0,k.work,ue),k.distbits=ue.bits,me){y.msg="invalid distances set",k.mode=g;break}if(k.mode=20,E===6)break e;case 20:k.mode=21;case 21:if(U>=6&&V>=258){y.next_out=X,y.avail_out=V,y.next_in=F,y.avail_in=U,k.hold=q,k.bits=S,h(y,H),X=y.next_out,I=y.output,V=y.avail_out,F=y.next_in,A=y.input,U=y.avail_in,q=k.hold,S=k.bits,k.mode===u&&(k.back=-1);break}for(k.back=0;G=(_e=k.lencode[q&(1<<k.lenbits)-1])>>>16&255,Z=65535&_e,!((j=_e>>>24)<=S);){if(U===0)break e;U--,q+=A[F++]<<S,S+=8}if(G&&!(240&G)){for(te=j,se=G,re=Z;G=(_e=k.lencode[re+((q&(1<<te+se)-1)>>te)])>>>16&255,Z=65535&_e,!(te+(j=_e>>>24)<=S);){if(U===0)break e;U--,q+=A[F++]<<S,S+=8}q>>>=te,S-=te,k.back+=te}if(q>>>=j,S-=j,k.back+=j,k.length=Z,G===0){k.mode=26;break}if(32&G){k.back=-1,k.mode=u;break}if(64&G){y.msg="invalid literal/length code",k.mode=g;break}k.extra=15&G,k.mode=22;case 22:if(k.extra){for(Se=k.extra;S<Se;){if(U===0)break e;U--,q+=A[F++]<<S,S+=8}k.length+=q&(1<<k.extra)-1,q>>>=k.extra,S-=k.extra,k.back+=k.extra}k.was=k.length,k.mode=23;case 23:for(;G=(_e=k.distcode[q&(1<<k.distbits)-1])>>>16&255,Z=65535&_e,!((j=_e>>>24)<=S);){if(U===0)break e;U--,q+=A[F++]<<S,S+=8}if(!(240&G)){for(te=j,se=G,re=Z;G=(_e=k.distcode[re+((q&(1<<te+se)-1)>>te)])>>>16&255,Z=65535&_e,!(te+(j=_e>>>24)<=S);){if(U===0)break e;U--,q+=A[F++]<<S,S+=8}q>>>=te,S-=te,k.back+=te}if(q>>>=j,S-=j,k.back+=j,64&G){y.msg="invalid distance code",k.mode=g;break}k.offset=Z,k.extra=15&G,k.mode=24;case 24:if(k.extra){for(Se=k.extra;S<Se;){if(U===0)break e;U--,q+=A[F++]<<S,S+=8}k.offset+=q&(1<<k.extra)-1,q>>>=k.extra,S-=k.extra,k.back+=k.extra}if(k.offset>k.dmax){y.msg="invalid distance too far back",k.mode=g;break}k.mode=25;case 25:if(V===0)break e;if(D=H-V,k.offset>D){if((D=k.offset-D)>k.whave&&k.sane){y.msg="invalid distance too far back",k.mode=g;break}D>k.wnext?(D-=k.wnext,O=k.wsize-D):O=k.wnext-D,D>k.length&&(D=k.length),W=k.window}else W=I,O=X-k.offset,D=k.length;D>V&&(D=V),V-=D,k.length-=D;do I[X++]=W[O++];while(--D);k.length===0&&(k.mode=21);break;case 26:if(V===0)break e;I[X++]=k.length,V--,k.mode=21;break;case 27:if(k.wrap){for(;S<32;){if(U===0)break e;U--,q|=A[F++]<<S,S+=8}if(H-=V,y.total_out+=H,k.total+=H,H&&(y.adler=k.check=k.flags?c(k.check,I,H,X-H):l(k.check,I,H,X-H)),H=V,(k.flags?q:_(q))!==k.check){y.msg="incorrect data check",k.mode=g;break}q=0,S=0}k.mode=28;case 28:if(k.wrap&&k.flags){for(;S<32;){if(U===0)break e;U--,q+=A[F++]<<S,S+=8}if(q!==(4294967295&k.total)){y.msg="incorrect length check",k.mode=g;break}q=0,S=0}k.mode=29;case 29:me=1;break e;case g:me=-3;break e;case 31:return-4;default:return f}return y.next_out=X,y.avail_out=V,y.next_in=F,y.avail_in=U,k.hold=q,k.bits=S,(k.wsize||H!==y.avail_out&&k.mode<g&&(k.mode<27||E!==4))&&L(y,y.output,y.next_out,H-y.avail_out)?(k.mode=31,-4):(P-=y.avail_in,H-=y.avail_out,y.total_in+=P,y.total_out+=H,k.total+=H,k.wrap&&H&&(y.adler=k.check=k.flags?c(k.check,I,H,y.next_out-H):l(k.check,I,H,y.next_out-H)),y.data_type=k.bits+(k.last?64:0)+(k.mode===u?128:0)+(k.mode===20||k.mode===15?256:0),(P===0&&H===0||E===4)&&me===0&&(me=-5),me)},r.inflateEnd=function(y){if(!y||!y.state)return f;var E=y.state;return E.window&&(E.window=null),y.state=null,0},r.inflateGetHeader=function(y,E){var k;return y&&y.state&&2&(k=y.state).wrap?(k.head=E,E.done=!1,0):f},r.inflateSetDictionary=function(y,E){var k,A=E.length;return y&&y.state?(k=y.state).wrap!==0&&k.mode!==11?f:k.mode===11&&l(1,E,A,0)!==k.check?-3:L(y,E,A,A)?(k.mode=31,-4):(k.havedict=1,0):f},r.inflateInfo="pako inflate (from Nodeca project)"},9241:(s,r,a)=>{var o=a(4236),l=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],c=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],h=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],d=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];s.exports=function(f,u,g,_,b,w,p,m){var v,x,R,M,C,L,y,E,k,A=m.bits,I=0,F=0,X=0,U=0,V=0,q=0,S=0,P=0,H=0,D=0,O=null,W=0,j=new o.Buf16(16),G=new o.Buf16(16),Z=null,te=0;for(I=0;I<=15;I++)j[I]=0;for(F=0;F<_;F++)j[u[g+F]]++;for(V=A,U=15;U>=1&&j[U]===0;U--);if(V>U&&(V=U),U===0)return b[w++]=20971520,b[w++]=20971520,m.bits=1,0;for(X=1;X<U&&j[X]===0;X++);for(V<X&&(V=X),P=1,I=1;I<=15;I++)if(P<<=1,(P-=j[I])<0)return-1;if(P>0&&(f===0||U!==1))return-1;for(G[1]=0,I=1;I<15;I++)G[I+1]=G[I]+j[I];for(F=0;F<_;F++)u[g+F]!==0&&(p[G[u[g+F]]++]=F);if(f===0?(O=Z=p,L=19):f===1?(O=l,W-=257,Z=c,te-=257,L=256):(O=h,Z=d,L=-1),D=0,F=0,I=X,C=w,q=V,S=0,R=-1,M=(H=1<<V)-1,f===1&&H>852||f===2&&H>592)return 1;for(;;){y=I-S,p[F]<L?(E=0,k=p[F]):p[F]>L?(E=Z[te+p[F]],k=O[W+p[F]]):(E=96,k=0),v=1<<I-S,X=x=1<<q;do b[C+(D>>S)+(x-=v)]=y<<24|E<<16|k|0;while(x!==0);for(v=1<<I-1;D&v;)v>>=1;if(v!==0?(D&=v-1,D+=v):D=0,F++,--j[I]==0){if(I===U)break;I=u[g+p[F]]}if(I>V&&(D&M)!==R){for(S===0&&(S=V),C+=X,P=1<<(q=I-S);q+S<U&&!((P-=j[q+S])<=0);)q++,P<<=1;if(H+=1<<q,f===1&&H>852||f===2&&H>592)return 1;b[R=D&M]=V<<24|q<<16|C-w|0}}return D!==0&&(b[C+D]=I-S<<24|4194304|0),m.bits=V,0}},8898:s=>{s.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},342:(s,r,a)=>{var o=a(4236);function l(O){for(var W=O.length;--W>=0;)O[W]=0}var c=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],h=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],f=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],u=new Array(576);l(u);var g=new Array(60);l(g);var _=new Array(512);l(_);var b=new Array(256);l(b);var w=new Array(29);l(w);var p,m,v,x=new Array(30);function R(O,W,j,G,Z){this.static_tree=O,this.extra_bits=W,this.extra_base=j,this.elems=G,this.max_length=Z,this.has_stree=O&&O.length}function M(O,W){this.dyn_tree=O,this.max_code=0,this.stat_desc=W}function C(O){return O<256?_[O]:_[256+(O>>>7)]}function L(O,W){O.pending_buf[O.pending++]=255&W,O.pending_buf[O.pending++]=W>>>8&255}function y(O,W,j){O.bi_valid>16-j?(O.bi_buf|=W<<O.bi_valid&65535,L(O,O.bi_buf),O.bi_buf=W>>16-O.bi_valid,O.bi_valid+=j-16):(O.bi_buf|=W<<O.bi_valid&65535,O.bi_valid+=j)}function E(O,W,j){y(O,j[2*W],j[2*W+1])}function k(O,W){var j=0;do j|=1&O,O>>>=1,j<<=1;while(--W>0);return j>>>1}function A(O,W,j){var G,Z,te=new Array(16),se=0;for(G=1;G<=15;G++)te[G]=se=se+j[G-1]<<1;for(Z=0;Z<=W;Z++){var re=O[2*Z+1];re!==0&&(O[2*Z]=k(te[re]++,re))}}function I(O){var W;for(W=0;W<286;W++)O.dyn_ltree[2*W]=0;for(W=0;W<30;W++)O.dyn_dtree[2*W]=0;for(W=0;W<19;W++)O.bl_tree[2*W]=0;O.dyn_ltree[512]=1,O.opt_len=O.static_len=0,O.last_lit=O.matches=0}function F(O){O.bi_valid>8?L(O,O.bi_buf):O.bi_valid>0&&(O.pending_buf[O.pending++]=O.bi_buf),O.bi_buf=0,O.bi_valid=0}function X(O,W,j,G){var Z=2*W,te=2*j;return O[Z]<O[te]||O[Z]===O[te]&&G[W]<=G[j]}function U(O,W,j){for(var G=O.heap[j],Z=j<<1;Z<=O.heap_len&&(Z<O.heap_len&&X(W,O.heap[Z+1],O.heap[Z],O.depth)&&Z++,!X(W,G,O.heap[Z],O.depth));)O.heap[j]=O.heap[Z],j=Z,Z<<=1;O.heap[j]=G}function V(O,W,j){var G,Z,te,se,re=0;if(O.last_lit!==0)do G=O.pending_buf[O.d_buf+2*re]<<8|O.pending_buf[O.d_buf+2*re+1],Z=O.pending_buf[O.l_buf+re],re++,G===0?E(O,Z,W):(E(O,(te=b[Z])+256+1,W),(se=c[te])!==0&&y(O,Z-=w[te],se),E(O,te=C(--G),j),(se=h[te])!==0&&y(O,G-=x[te],se));while(re<O.last_lit);E(O,256,W)}function q(O,W){var j,G,Z,te=W.dyn_tree,se=W.stat_desc.static_tree,re=W.stat_desc.has_stree,ae=W.stat_desc.elems,me=-1;for(O.heap_len=0,O.heap_max=573,j=0;j<ae;j++)te[2*j]!==0?(O.heap[++O.heap_len]=me=j,O.depth[j]=0):te[2*j+1]=0;for(;O.heap_len<2;)te[2*(Z=O.heap[++O.heap_len]=me<2?++me:0)]=1,O.depth[Z]=0,O.opt_len--,re&&(O.static_len-=se[2*Z+1]);for(W.max_code=me,j=O.heap_len>>1;j>=1;j--)U(O,te,j);Z=ae;do j=O.heap[1],O.heap[1]=O.heap[O.heap_len--],U(O,te,1),G=O.heap[1],O.heap[--O.heap_max]=j,O.heap[--O.heap_max]=G,te[2*Z]=te[2*j]+te[2*G],O.depth[Z]=(O.depth[j]>=O.depth[G]?O.depth[j]:O.depth[G])+1,te[2*j+1]=te[2*G+1]=Z,O.heap[1]=Z++,U(O,te,1);while(O.heap_len>=2);O.heap[--O.heap_max]=O.heap[1],function(ue,Se){var _e,ge,ke,Te,Fe,Ie,T=Se.dyn_tree,N=Se.max_code,z=Se.stat_desc.static_tree,Q=Se.stat_desc.has_stree,K=Se.stat_desc.extra_bits,ie=Se.stat_desc.extra_base,ce=Se.stat_desc.max_length,Me=0;for(Te=0;Te<=15;Te++)ue.bl_count[Te]=0;for(T[2*ue.heap[ue.heap_max]+1]=0,_e=ue.heap_max+1;_e<573;_e++)(Te=T[2*T[2*(ge=ue.heap[_e])+1]+1]+1)>ce&&(Te=ce,Me++),T[2*ge+1]=Te,ge>N||(ue.bl_count[Te]++,Fe=0,ge>=ie&&(Fe=K[ge-ie]),Ie=T[2*ge],ue.opt_len+=Ie*(Te+Fe),Q&&(ue.static_len+=Ie*(z[2*ge+1]+Fe)));if(Me!==0){do{for(Te=ce-1;ue.bl_count[Te]===0;)Te--;ue.bl_count[Te]--,ue.bl_count[Te+1]+=2,ue.bl_count[ce]--,Me-=2}while(Me>0);for(Te=ce;Te!==0;Te--)for(ge=ue.bl_count[Te];ge!==0;)(ke=ue.heap[--_e])>N||(T[2*ke+1]!==Te&&(ue.opt_len+=(Te-T[2*ke+1])*T[2*ke],T[2*ke+1]=Te),ge--)}}(O,W),A(te,me,O.bl_count)}function S(O,W,j){var G,Z,te=-1,se=W[1],re=0,ae=7,me=4;for(se===0&&(ae=138,me=3),W[2*(j+1)+1]=65535,G=0;G<=j;G++)Z=se,se=W[2*(G+1)+1],++re<ae&&Z===se||(re<me?O.bl_tree[2*Z]+=re:Z!==0?(Z!==te&&O.bl_tree[2*Z]++,O.bl_tree[32]++):re<=10?O.bl_tree[34]++:O.bl_tree[36]++,re=0,te=Z,se===0?(ae=138,me=3):Z===se?(ae=6,me=3):(ae=7,me=4))}function P(O,W,j){var G,Z,te=-1,se=W[1],re=0,ae=7,me=4;for(se===0&&(ae=138,me=3),G=0;G<=j;G++)if(Z=se,se=W[2*(G+1)+1],!(++re<ae&&Z===se)){if(re<me)do E(O,Z,O.bl_tree);while(--re!=0);else Z!==0?(Z!==te&&(E(O,Z,O.bl_tree),re--),E(O,16,O.bl_tree),y(O,re-3,2)):re<=10?(E(O,17,O.bl_tree),y(O,re-3,3)):(E(O,18,O.bl_tree),y(O,re-11,7));re=0,te=Z,se===0?(ae=138,me=3):Z===se?(ae=6,me=3):(ae=7,me=4)}}l(x);var H=!1;function D(O,W,j,G){y(O,0+(G?1:0),3),function(Z,te,se,re){F(Z),L(Z,se),L(Z,~se),o.arraySet(Z.pending_buf,Z.window,te,se,Z.pending),Z.pending+=se}(O,W,j)}r._tr_init=function(O){H||(function(){var W,j,G,Z,te,se=new Array(16);for(G=0,Z=0;Z<28;Z++)for(w[Z]=G,W=0;W<1<<c[Z];W++)b[G++]=Z;for(b[G-1]=Z,te=0,Z=0;Z<16;Z++)for(x[Z]=te,W=0;W<1<<h[Z];W++)_[te++]=Z;for(te>>=7;Z<30;Z++)for(x[Z]=te<<7,W=0;W<1<<h[Z]-7;W++)_[256+te++]=Z;for(j=0;j<=15;j++)se[j]=0;for(W=0;W<=143;)u[2*W+1]=8,W++,se[8]++;for(;W<=255;)u[2*W+1]=9,W++,se[9]++;for(;W<=279;)u[2*W+1]=7,W++,se[7]++;for(;W<=287;)u[2*W+1]=8,W++,se[8]++;for(A(u,287,se),W=0;W<30;W++)g[2*W+1]=5,g[2*W]=k(W,5);p=new R(u,c,257,286,15),m=new R(g,h,0,30,15),v=new R(new Array(0),d,0,19,7)}(),H=!0),O.l_desc=new M(O.dyn_ltree,p),O.d_desc=new M(O.dyn_dtree,m),O.bl_desc=new M(O.bl_tree,v),O.bi_buf=0,O.bi_valid=0,I(O)},r._tr_stored_block=D,r._tr_flush_block=function(O,W,j,G){var Z,te,se=0;O.level>0?(O.strm.data_type===2&&(O.strm.data_type=function(re){var ae,me=4093624447;for(ae=0;ae<=31;ae++,me>>>=1)if(1&me&&re.dyn_ltree[2*ae]!==0)return 0;if(re.dyn_ltree[18]!==0||re.dyn_ltree[20]!==0||re.dyn_ltree[26]!==0)return 1;for(ae=32;ae<256;ae++)if(re.dyn_ltree[2*ae]!==0)return 1;return 0}(O)),q(O,O.l_desc),q(O,O.d_desc),se=function(re){var ae;for(S(re,re.dyn_ltree,re.l_desc.max_code),S(re,re.dyn_dtree,re.d_desc.max_code),q(re,re.bl_desc),ae=18;ae>=3&&re.bl_tree[2*f[ae]+1]===0;ae--);return re.opt_len+=3*(ae+1)+5+5+4,ae}(O),Z=O.opt_len+3+7>>>3,(te=O.static_len+3+7>>>3)<=Z&&(Z=te)):Z=te=j+5,j+4<=Z&&W!==-1?D(O,W,j,G):O.strategy===4||te===Z?(y(O,2+(G?1:0),3),V(O,u,g)):(y(O,4+(G?1:0),3),function(re,ae,me,ue){var Se;for(y(re,ae-257,5),y(re,me-1,5),y(re,ue-4,4),Se=0;Se<ue;Se++)y(re,re.bl_tree[2*f[Se]+1],3);P(re,re.dyn_ltree,ae-1),P(re,re.dyn_dtree,me-1)}(O,O.l_desc.max_code+1,O.d_desc.max_code+1,se+1),V(O,O.dyn_ltree,O.dyn_dtree)),I(O),G&&F(O)},r._tr_tally=function(O,W,j){return O.pending_buf[O.d_buf+2*O.last_lit]=W>>>8&255,O.pending_buf[O.d_buf+2*O.last_lit+1]=255&W,O.pending_buf[O.l_buf+O.last_lit]=255&j,O.last_lit++,W===0?O.dyn_ltree[2*j]++:(O.matches++,W--,O.dyn_ltree[2*(b[j]+256+1)]++,O.dyn_dtree[2*C(W)]++),O.last_lit===O.lit_bufsize-1},r._tr_align=function(O){y(O,2,3),E(O,256,u),function(W){W.bi_valid===16?(L(W,W.bi_buf),W.bi_buf=0,W.bi_valid=0):W.bi_valid>=8&&(W.pending_buf[W.pending++]=255&W.bi_buf,W.bi_buf>>=8,W.bi_valid-=8)}(O)}},2292:s=>{s.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},2587:s=>{function r(a,o){return Object.prototype.hasOwnProperty.call(a,o)}s.exports=function(a,o,l,c){o=o||"&",l=l||"=";var h={};if(typeof a!="string"||a.length===0)return h;var d=/\+/g;a=a.split(o);var f=1e3;c&&typeof c.maxKeys=="number"&&(f=c.maxKeys);var u=a.length;f>0&&u>f&&(u=f);for(var g=0;g<u;++g){var _,b,w,p,m=a[g].replace(d,"%20"),v=m.indexOf(l);v>=0?(_=m.substr(0,v),b=m.substr(v+1)):(_=m,b=""),w=decodeURIComponent(_),p=decodeURIComponent(b),r(h,w)?Array.isArray(h[w])?h[w].push(p):h[w]=[h[w],p]:h[w]=p}return h}},2361:s=>{var r=function(a){switch(typeof a){case"string":return a;case"boolean":return a?"true":"false";case"number":return isFinite(a)?a:"";default:return""}};s.exports=function(a,o,l,c){return o=o||"&",l=l||"=",a===null&&(a=void 0),typeof a=="object"?Object.keys(a).map(function(h){var d=encodeURIComponent(r(h))+l;return Array.isArray(a[h])?a[h].map(function(f){return d+encodeURIComponent(r(f))}).join(o):d+encodeURIComponent(r(a[h]))}).join(o):c?encodeURIComponent(r(c))+l+encodeURIComponent(r(a)):""}},7673:(s,r,a)=>{r.decode=r.parse=a(2587),r.encode=r.stringify=a(2361)},1269:s=>{class r{constructor(o={}){if(!(o.maxSize&&o.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=o.maxSize,this.cache=new Map,this.oldCache=new Map,this._size=0}_set(o,l){this.cache.set(o,l),this._size++,this._size>=this.maxSize&&(this._size=0,this.oldCache=this.cache,this.cache=new Map)}get(o){if(this.cache.has(o))return this.cache.get(o);if(this.oldCache.has(o)){let l=this.oldCache.get(o);return this.oldCache.delete(o),this._set(o,l),l}}set(o,l){return this.cache.has(o)?this.cache.set(o,l):this._set(o,l),this}has(o){return this.cache.has(o)||this.oldCache.has(o)}peek(o){return this.cache.has(o)?this.cache.get(o):this.oldCache.has(o)?this.oldCache.get(o):void 0}delete(o){let l=this.cache.delete(o);return l&&this._size--,this.oldCache.delete(o)||l}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}*keys(){for(let[o]of this)yield o}*values(){for(let[,o]of this)yield o}*[Symbol.iterator](){for(let o of this.cache)yield o;for(let o of this.oldCache){let[l]=o;this.cache.has(l)||(yield o)}}get size(){let o=0;for(let l of this.oldCache.keys())this.cache.has(l)||o++;return this._size+o}}s.exports=r},2511:function(s,r,a){var o;s=a.nmd(s),function(l){r&&r.nodeType,s&&s.nodeType;var c=typeof a.g=="object"&&a.g;c.global!==c&&c.window!==c&&c.self;var h,d=2147483647,f=36,u=/^xn--/,g=/[^\x20-\x7E]/,_=/[\x2E\u3002\uFF0E\uFF61]/g,b={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=Math.floor,p=String.fromCharCode;function m(k){throw RangeError(b[k])}function v(k,A){for(var I=k.length,F=[];I--;)F[I]=A(k[I]);return F}function x(k,A){var I=k.split("@"),F="";return I.length>1&&(F=I[0]+"@",k=I[1]),F+v((k=k.replace(_,".")).split("."),A).join(".")}function R(k){for(var A,I,F=[],X=0,U=k.length;X<U;)(A=k.charCodeAt(X++))>=55296&&A<=56319&&X<U?(64512&(I=k.charCodeAt(X++)))==56320?F.push(((1023&A)<<10)+(1023&I)+65536):(F.push(A),X--):F.push(A);return F}function M(k){return v(k,function(A){var I="";return A>65535&&(I+=p((A-=65536)>>>10&1023|55296),A=56320|1023&A),I+p(A)}).join("")}function C(k,A){return k+22+75*(k<26)-((A!=0)<<5)}function L(k,A,I){var F=0;for(k=I?w(k/700):k>>1,k+=w(k/A);k>455;F+=f)k=w(k/35);return w(F+36*k/(k+38))}function y(k){var A,I,F,X,U,V,q,S,P,H,D,O=[],W=k.length,j=0,G=128,Z=72;for((I=k.lastIndexOf("-"))<0&&(I=0),F=0;F<I;++F)k.charCodeAt(F)>=128&&m("not-basic"),O.push(k.charCodeAt(F));for(X=I>0?I+1:0;X<W;){for(U=j,V=1,q=f;X>=W&&m("invalid-input"),((S=(D=k.charCodeAt(X++))-48<10?D-22:D-65<26?D-65:D-97<26?D-97:f)>=f||S>w((d-j)/V))&&m("overflow"),j+=S*V,!(S<(P=q<=Z?1:q>=Z+26?26:q-Z));q+=f)V>w(d/(H=f-P))&&m("overflow"),V*=H;Z=L(j-U,A=O.length+1,U==0),w(j/A)>d-G&&m("overflow"),G+=w(j/A),j%=A,O.splice(j++,0,G)}return M(O)}function E(k){var A,I,F,X,U,V,q,S,P,H,D,O,W,j,G,Z=[];for(O=(k=R(k)).length,A=128,I=0,U=72,V=0;V<O;++V)(D=k[V])<128&&Z.push(p(D));for(F=X=Z.length,X&&Z.push("-");F<O;){for(q=d,V=0;V<O;++V)(D=k[V])>=A&&D<q&&(q=D);for(q-A>w((d-I)/(W=F+1))&&m("overflow"),I+=(q-A)*W,A=q,V=0;V<O;++V)if((D=k[V])<A&&++I>d&&m("overflow"),D==A){for(S=I,P=f;!(S<(H=P<=U?1:P>=U+26?26:P-U));P+=f)G=S-H,j=f-H,Z.push(p(C(H+G%j,0))),S=w(G/j);Z.push(p(C(S,0))),U=L(I,W,F==X),I=0,++F}++I,++A}return Z.join("")}h={version:"1.3.2",ucs2:{decode:R,encode:M},decode:y,encode:E,toASCII:function(k){return x(k,function(A){return g.test(A)?"xn--"+E(A):A})},toUnicode:function(k){return x(k,function(A){return u.test(A)?y(A.slice(4).toLowerCase()):A})}},(o=function(){return h}.call(r,a,r,s))===void 0||(s.exports=o)}()},8575:(s,r,a)=>{var o=a(2511),l=a(2502);function c(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}r.parse=M,r.resolve=function(C,L){return M(C,!1,!0).resolve(L)},r.resolveObject=function(C,L){return C?M(C,!1,!0).resolveObject(L):L},r.format=function(C){return l.isString(C)&&(C=M(C)),C instanceof c?C.format():c.prototype.format.call(C)},r.Url=c;var h=/^([a-z0-9.+-]+:)/i,d=/:[0-9]*$/,f=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,u=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]),g=["'"].concat(u),_=["%","/","?",";","#"].concat(g),b=["/","?","#"],w=/^[+a-z0-9A-Z_-]{0,63}$/,p=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},v={javascript:!0,"javascript:":!0},x={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},R=a(7673);function M(C,L,y){if(C&&l.isObject(C)&&C instanceof c)return C;var E=new c;return E.parse(C,L,y),E}c.prototype.parse=function(C,L,y){if(!l.isString(C))throw new TypeError("Parameter 'url' must be a string, not "+typeof C);var E=C.indexOf("?"),k=E!==-1&&E<C.indexOf("#")?"?":"#",A=C.split(k);A[0]=A[0].replace(/\\/g,"/");var I=C=A.join(k);if(I=I.trim(),!y&&C.split("#").length===1){var F=f.exec(I);if(F)return this.path=I,this.href=I,this.pathname=F[1],F[2]?(this.search=F[2],this.query=L?R.parse(this.search.substr(1)):this.search.substr(1)):L&&(this.search="",this.query={}),this}var X=h.exec(I);if(X){var U=(X=X[0]).toLowerCase();this.protocol=U,I=I.substr(X.length)}if(y||X||I.match(/^\/\/[^@\/]+@[^@\/]+/)){var V=I.substr(0,2)==="//";!V||X&&v[X]||(I=I.substr(2),this.slashes=!0)}if(!v[X]&&(V||X&&!x[X])){for(var q,S,P=-1,H=0;H<b.length;H++)(D=I.indexOf(b[H]))!==-1&&(P===-1||D<P)&&(P=D);for((S=P===-1?I.lastIndexOf("@"):I.lastIndexOf("@",P))!==-1&&(q=I.slice(0,S),I=I.slice(S+1),this.auth=decodeURIComponent(q)),P=-1,H=0;H<_.length;H++){var D;(D=I.indexOf(_[H]))!==-1&&(P===-1||D<P)&&(P=D)}P===-1&&(P=I.length),this.host=I.slice(0,P),I=I.slice(P),this.parseHost(),this.hostname=this.hostname||"";var O=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!O)for(var W=this.hostname.split(/\./),j=(H=0,W.length);H<j;H++){var G=W[H];if(G&&!G.match(w)){for(var Z="",te=0,se=G.length;te<se;te++)G.charCodeAt(te)>127?Z+="x":Z+=G[te];if(!Z.match(w)){var re=W.slice(0,H),ae=W.slice(H+1),me=G.match(p);me&&(re.push(me[1]),ae.unshift(me[2])),ae.length&&(I="/"+ae.join(".")+I),this.hostname=re.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),O||(this.hostname=o.toASCII(this.hostname));var ue=this.port?":"+this.port:"",Se=this.hostname||"";this.host=Se+ue,this.href+=this.host,O&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),I[0]!=="/"&&(I="/"+I))}if(!m[U])for(H=0,j=g.length;H<j;H++){var _e=g[H];if(I.indexOf(_e)!==-1){var ge=encodeURIComponent(_e);ge===_e&&(ge=escape(_e)),I=I.split(_e).join(ge)}}var ke=I.indexOf("#");ke!==-1&&(this.hash=I.substr(ke),I=I.slice(0,ke));var Te=I.indexOf("?");if(Te!==-1?(this.search=I.substr(Te),this.query=I.substr(Te+1),L&&(this.query=R.parse(this.query)),I=I.slice(0,Te)):L&&(this.search="",this.query={}),I&&(this.pathname=I),x[U]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){ue=this.pathname||"";var Fe=this.search||"";this.path=ue+Fe}return this.href=this.format(),this},c.prototype.format=function(){var C=this.auth||"";C&&(C=(C=encodeURIComponent(C)).replace(/%3A/i,":"),C+="@");var L=this.protocol||"",y=this.pathname||"",E=this.hash||"",k=!1,A="";this.host?k=C+this.host:this.hostname&&(k=C+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(k+=":"+this.port)),this.query&&l.isObject(this.query)&&Object.keys(this.query).length&&(A=R.stringify(this.query));var I=this.search||A&&"?"+A||"";return L&&L.substr(-1)!==":"&&(L+=":"),this.slashes||(!L||x[L])&&k!==!1?(k="//"+(k||""),y&&y.charAt(0)!=="/"&&(y="/"+y)):k||(k=""),E&&E.charAt(0)!=="#"&&(E="#"+E),I&&I.charAt(0)!=="?"&&(I="?"+I),L+k+(y=y.replace(/[?#]/g,function(F){return encodeURIComponent(F)}))+(I=I.replace("#","%23"))+E},c.prototype.resolve=function(C){return this.resolveObject(M(C,!1,!0)).format()},c.prototype.resolveObject=function(C){if(l.isString(C)){var L=new c;L.parse(C,!1,!0),C=L}for(var y=new c,E=Object.keys(this),k=0;k<E.length;k++){var A=E[k];y[A]=this[A]}if(y.hash=C.hash,C.href==="")return y.href=y.format(),y;if(C.slashes&&!C.protocol){for(var I=Object.keys(C),F=0;F<I.length;F++){var X=I[F];X!=="protocol"&&(y[X]=C[X])}return x[y.protocol]&&y.hostname&&!y.pathname&&(y.path=y.pathname="/"),y.href=y.format(),y}if(C.protocol&&C.protocol!==y.protocol){if(!x[C.protocol]){for(var U=Object.keys(C),V=0;V<U.length;V++){var q=U[V];y[q]=C[q]}return y.href=y.format(),y}if(y.protocol=C.protocol,C.host||v[C.protocol])y.pathname=C.pathname;else{for(var S=(C.pathname||"").split("/");S.length&&!(C.host=S.shift()););C.host||(C.host=""),C.hostname||(C.hostname=""),S[0]!==""&&S.unshift(""),S.length<2&&S.unshift(""),y.pathname=S.join("/")}if(y.search=C.search,y.query=C.query,y.host=C.host||"",y.auth=C.auth,y.hostname=C.hostname||C.host,y.port=C.port,y.pathname||y.search){var P=y.pathname||"",H=y.search||"";y.path=P+H}return y.slashes=y.slashes||C.slashes,y.href=y.format(),y}var D=y.pathname&&y.pathname.charAt(0)==="/",O=C.host||C.pathname&&C.pathname.charAt(0)==="/",W=O||D||y.host&&C.pathname,j=W,G=y.pathname&&y.pathname.split("/")||[],Z=(S=C.pathname&&C.pathname.split("/")||[],y.protocol&&!x[y.protocol]);if(Z&&(y.hostname="",y.port=null,y.host&&(G[0]===""?G[0]=y.host:G.unshift(y.host)),y.host="",C.protocol&&(C.hostname=null,C.port=null,C.host&&(S[0]===""?S[0]=C.host:S.unshift(C.host)),C.host=null),W=W&&(S[0]===""||G[0]==="")),O)y.host=C.host||C.host===""?C.host:y.host,y.hostname=C.hostname||C.hostname===""?C.hostname:y.hostname,y.search=C.search,y.query=C.query,G=S;else if(S.length)G||(G=[]),G.pop(),G=G.concat(S),y.search=C.search,y.query=C.query;else if(!l.isNullOrUndefined(C.search))return Z&&(y.hostname=y.host=G.shift(),(me=!!(y.host&&y.host.indexOf("@")>0)&&y.host.split("@"))&&(y.auth=me.shift(),y.host=y.hostname=me.shift())),y.search=C.search,y.query=C.query,l.isNull(y.pathname)&&l.isNull(y.search)||(y.path=(y.pathname?y.pathname:"")+(y.search?y.search:"")),y.href=y.format(),y;if(!G.length)return y.pathname=null,y.search?y.path="/"+y.search:y.path=null,y.href=y.format(),y;for(var te=G.slice(-1)[0],se=(y.host||C.host||G.length>1)&&(te==="."||te==="..")||te==="",re=0,ae=G.length;ae>=0;ae--)(te=G[ae])==="."?G.splice(ae,1):te===".."?(G.splice(ae,1),re++):re&&(G.splice(ae,1),re--);if(!W&&!j)for(;re--;re)G.unshift("..");!W||G[0]===""||G[0]&&G[0].charAt(0)==="/"||G.unshift(""),se&&G.join("/").substr(-1)!=="/"&&G.push("");var me,ue=G[0]===""||G[0]&&G[0].charAt(0)==="/";return Z&&(y.hostname=y.host=ue?"":G.length?G.shift():"",(me=!!(y.host&&y.host.indexOf("@")>0)&&y.host.split("@"))&&(y.auth=me.shift(),y.host=y.hostname=me.shift())),(W=W||y.host&&G.length)&&!ue&&G.unshift(""),G.length?y.pathname=G.join("/"):(y.pathname=null,y.path=null),l.isNull(y.pathname)&&l.isNull(y.search)||(y.path=(y.pathname?y.pathname:"")+(y.search?y.search:"")),y.auth=C.auth||y.auth,y.slashes=y.slashes||C.slashes,y.href=y.format(),y},c.prototype.parseHost=function(){var C=this.host,L=d.exec(C);L&&((L=L[0])!==":"&&(this.port=L.substr(1)),C=C.substr(0,C.length-L.length)),C&&(this.hostname=C)}},2502:s=>{s.exports={isString:function(r){return typeof r=="string"},isObject:function(r){return typeof r=="object"&&r!==null},isNull:function(r){return r===null},isNullOrUndefined:function(r){return r==null}}},7067:()=>{}},e={};function t(s){var r=e[s];if(r!==void 0)return r.exports;var a=e[s]={id:s,loaded:!1,exports:{}};return i[s].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}t.n=s=>{var r=s&&s.__esModule?()=>s.default:()=>s;return t.d(r,{a:r}),r},t.d=(s,r)=>{for(var a in r)t.o(r,a)&&!t.o(s,a)&&Object.defineProperty(s,a,{enumerable:!0,get:r[a]})},t.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),t.o=(s,r)=>Object.prototype.hasOwnProperty.call(s,r),t.r=s=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},t.nmd=s=>(s.paths=[],s.children||(s.children=[]),s);var n=t(5590);return n},ao=q2(),W2=16,j2=32,G2=1,Xl=class{constructor(e,t,n){this.config=e,this.browser=n,this.genome=t,this.cramFile=new ao.CramFile({filehandle:new ea(e.url,e),seqFetch:e.seqFetch||r.bind(this),checkSequenceMD5:e.checkSequenceMD5!==void 0?e.checkSequenceMD5:!0});let s=new ea(e.indexURL,e);this.indexedCramFile=new ao.IndexedCramFile({cram:this.cramFile,index:new ao.CraiIndex({filehandle:s}),fetchSizeLimit:3e7}),_t.setReaderDefaults(this,e);function r(a,o,l){let c=this.genome.sequence,h=this.genome;return this.getHeader().then(function(d){let f=h.getChromosomeName(d.chrNames[a]);return c.getSequence(f,o-1,l)})}}async getHeader(){if(!this.header){let e=this.genome,t=await this.cramFile.getSamHeader(),n={},s=[],r={},a=[];for(let o of t)if(o.tag==="SQ"){for(let l of o.data)if(l.tag==="SN"){let c=l.value;if(n[c]=s.length,s.push(c),e){let h=e.getChromosomeName(c);r[h]=c}break}}else o.tag==="RG"&&a.push(o.data);this.header={chrNames:s,chrToIndex:n,chrAliasTable:r,readGroups:a}}return this.header}async readAlignments(e,t,n){this.browser;let s=await this.getHeader(),r=s.chrAliasTable.hasOwnProperty(e)?s.chrAliasTable[e]:e,a=s.chrToIndex[r],o=new li(e,t,n,this.config);if(a===void 0)return o;try{let h=await this.indexedCramFile.getRecordsForRange(a,t,n);for(let d of h){let f=d.sequenceId,u=d.alignmentStart,g=u+d.lengthOnRef;if(f<0)continue;if(f>a||u>n)return;if(f<a||g<t)continue;let _=l(d,s.chrNames);this.filter.pass(_)&&o.push(_)}return o.finish(),o}catch(h){let d=h.message;throw d&&d.indexOf("MD5")>=0&&(d="Sequence mismatch. Is this the correct genome for the loaded CRAM?"),this.browser.alert.present(new Error(d)),h}function l(h,d){let f=new Tn;if(f.chr=d[h.sequenceId],f.start=h.alignmentStart-1,f.lengthOnRef=h.lengthOnRef,f.flags=h.flags,f.strand=!(h.flags&W2),f.fragmentLength=h.templateLength||h.templateSize,f.mq=h.mappingQuality,f.end=h.alignmentStart+h.lengthOnRef,f.readGroupId=h.readGroupId,h.mate&&h.mate.sequenceId!==void 0){let u=h.mate.flags!==void 0?!(h.mate.flags&G2):!(h.flags&j2);f.mate={chr:d[h.mate.sequenceId],position:h.mate.alignmentStart,strand:u}}return f.seq=h.getReadBases(),f.qual=h.qualityScores,f.tagDict=h.tags,f.readName=h.readName,c(h,f),f.mate&&f.start>f.mate.position&&f.fragmentLength>0&&(f.fragmentLength=-f.fragmentLength),_t.setPairOrientation(f),f}function c(h,d){let f=[],u,g,_=0,b="";if(d.scStart=d.start,d.scLengthOnRef=d.lengthOnRef,h.readFeatures)for(let p of h.readFeatures){let m=p.code,v=p.data,x=p.pos-1,R=p.refPos-1;switch(m){case"S":case"I":case"i":case"N":case"D":if(x>_){let M=x-_;f.push(new Gt({start:R-M,seqOffset:_,len:M,type:"M"})),_+=M,b+=M+"M"}if(m==="S"){let M=R;d.scLengthOnRef+=v.length,x===0&&(d.scStart-=v.length,M-=v.length);let C=v.length;f.push(new Gt({start:M,seqOffset:_,len:C,type:"S"})),_+=C,b+=C+m}else if(m==="I"||m==="i"){u===void 0&&(u=[]);let M=m==="i"?1:v.length;u.push(new Gt({start:R,len:M,seqOffset:_,type:"I"})),_+=M,b+=M+m}else(m==="D"||m==="N")&&(g||(g=[]),g.push({start:R,len:v,type:m}),b+=v+m);break;case"H":case"P":b+=v+m;break}}let w=h.readLength-_;w>0&&(f.push(new Gt({start:h.alignmentStart+h.lengthOnRef-w-1,seqOffset:_,len:w,type:"M"})),b+=w+"M"),d.blocks=f,d.insertions=u,d.gaps=g,d.cigar=b}}},ea=class{constructor(e,t){this.position=0,this.url=e,this.config=t,this.cache=new Yl({fetch:(n,s)=>this._fetch(n,s)})}async _fetch(e,t){let n={start:e,size:t};this._stat={size:void 0};let s=await Ce.loadArrayBuffer(this.url,Oe(this.config,{range:n}));return __Buffer$.from(s)}async read(e,t=0,n=1/0,s=0){let r=s;return r===null&&(r=this.position,this.position+=n),this.cache.get(e,t,n,s)}async readFile(){let e=await Ce.loadArrayBuffer(this.url,Oe(this.config));return __Buffer$.from(e)}async stat(){if(!this._stat){let e=__Buffer$.allocUnsafe(10);if(await this.read(e,0,10,0),!this._stat)throw new Error(`unable to determine size of file at ${this.url}`)}return this._stat}},Yl=class{constructor({fetch:e,size:t=1e7,chunkSize:n=32768}){this.fetch=e,this.chunkSize=n,this.lruCache=new Ql({maxSize:Math.floor(t/n)})}async get(e,t,n,s){if(e.length<t+n)throw new Error("output buffer not big enough for request");let r=Math.floor(s/this.chunkSize),a=Math.floor((s+n)/this.chunkSize),o=new Array(a-r+1);for(let h=r;h<=a;h+=1)o[h-r]=this._getChunk(h).then(d=>({data:d,chunkNumber:h}));let l=await Promise.all(o),c=s-l[0].chunkNumber*this.chunkSize;l.forEach(({data:h,chunkNumber:d})=>{let f=d*this.chunkSize,u=0,g=this.chunkSize,_=t+(d-r)*this.chunkSize-c;d===r&&(_=t,u=c),d===a&&(g=s+n-f),h.copy(e,_,u,g)})}_getChunk(e){let t=this.lruCache.get(e);if(t)return t;let n=this.fetch(e*this.chunkSize,this.chunkSize);return this.lruCache.set(e,n),n}},Ql=class{constructor(e={}){if(!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=e.maxSize,this.cache=new Map,this.oldCache=new Map,this._size=0}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this.oldCache=this.cache,this.cache=new Map)}get(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e)){let t=this.oldCache.get(e);return this._set(e,t),t}}set(e,t){return this.cache.has(e)?this.cache.set(e,t):this._set(e,t),this}has(e){return this.cache.has(e)||this.oldCache.has(e)}peek(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e))return this.oldCache.get(e)}delete(e){let t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}*keys(){for(let[e]of this)yield e}*values(){for(let[,e]of this)yield e}*[Symbol.iterator](){for(let e of this.cache)yield e;for(let e of this.oldCache){let[t]=e;this.cache.has(t)||(yield e)}}get size(){let e=0;for(let t of this.oldCache.keys())this.cache.has(t)||e++;return this._size+e}},Pu={ALIGNMENT_MATCH:"M",INSERT:"I",DELETE:"D",SKIP:"N",CLIP_SOFT:"S",CLIP_HARD:"H",PAD:"P",SEQUENCE_MATCH:"=",SEQUENCE_MISMATCH:"X"},xc=function(i,e){this.config=i,this.genome=e,this.url=i.url,this.filter=new Ks(i.filter),this.readGroupSetIds=i.readGroupSetIds,this.authKey=i.authKey,this.samplingWindowSize=i.samplingWindowSize===void 0?100:i.samplingWindowSize,this.samplingDepth=i.samplingDepth===void 0?1e3:i.samplingDepth,i.viewAsPairs?this.pairsSupported=!0:this.pairsSupported=i.pairsSupported===void 0?!0:i.pairsSupported};xc.prototype.readAlignments=function(i,e,t){let n=this.genome,s=this;return r().then(function(o){var l=o.hasOwnProperty(i)?o[i]:i,c=s.url+"/reads/search";return qs({url:c,body:{readGroupSetIds:[s.readGroupSetIds],referenceName:l,start:e,end:t,pageSize:"10000"},decode:a,results:new li(i,e,t,s.config)})});function r(){return s.chrAliasTable?Promise.resolve(s.chrAliasTable):s.readMetadata().then(function(o){if(s.chrAliasTable={},n&&o.readGroups&&o.readGroups.length>0){var l=o.readGroups[0].referenceSetId;if(l){var c=s.url+"/references/search";return qs({url:c,body:{referenceSetId:l},decode:function(h){return h.references}}).then(function(h){return h.forEach(function(d){var f=d.name,u=n.getChromosomeName(f);s.chrAliasTable[u]=f}),s.chrAliasTable})}else return Z2(s.chrAliasTable,s.config.datasetId),s.chrAliasTable}else return s.chrAliasTable})}function a(o){var l,c=o.alignments,h=c.length,d,f,u,g=[],_,b;for(l=0;l<h;l++){let x=c[l];d=new Tn,d.readName=x.fragmentName,d.properPlacement=x.properPlacement,d.duplicateFragment=x.duplicateFragment,d.numberReads=x.numberReads,d.fragmentLength=x.fragmentLength,d.readNumber=x.readNumber,d.failedVendorQualityChecks=x.failedVendorQualityChecks,d.secondaryAlignment=x.secondaryAlignment,d.supplementaryAlignment=x.supplementaryAlignment,d.seq=x.alignedSequence,d.qual=x.alignedQuality,d.matePos=x.nextMatePosition,d.tagDict=x.info,d.flags=p(),f=x.alignment,f?(d.mapped=!0,d.chr=x.alignment.position.referenceName,n&&(d.chr=n.getChromosomeName(d.chr)),d.start=parseInt(x.alignment.position.position),d.strand=!x.alignment.position.reverseStrand,d.mq=x.alignment.mappingQuality,d.cigar=w(x.alignment.cigar),u=m(x.alignment.cigar),d.lengthOnRef=u.lengthOnRef,b=v(d,u.array),d.blocks=b.blocks,d.insertions=b.insertions):d.mapped=!1,_=x.nextMatePosition,_&&(d.mate={chr:_.referenceFrame,position:parseInt(_.position),strand:!_.reverseStrand}),s.filter.pass(d)&&g.push(d)}return g;function w(x){var R="";return x.forEach(function(M){var C=Pu[M.operation],L=M.operationLength;R=R+(L+C)}),R}function p(x){return 0}function m(x){var R,M,C,L=0,y=[],E;for(E=0;E<x.length;E++)R=x[E],C=Pu[R.operation],M=parseInt(R.operationLength),(C==="M"||C==="EQ"||C==="X"||C==="D"||C==="N"||C==="=")&&(L+=M),y.push({len:M,ltr:C});return{lengthOnRef:L,array:y}}function v(x,R){for(var M=[],C,L,y=0,E=x.start,k=R.length,A,I=0;I<k;I++){var F=R[I];switch(F.ltr){case"H":break;case"P":break;case"S":y+=F.len,A="S";break;case"N":case"D":C===void 0&&(C=[]),C.push({start:E,len:F.len,type:F.ltr}),E+=F.len;break;case"I":L===void 0&&(L=[]),L.push(new Gt({start:E,len:F.len,seqOffset:y})),y+=F.len;break;case"M":case"EQ":case"=":case"X":M.push(new Gt({start:E,len:F.len,seqOffset:y,gapType:A})),y+=F.len,E+=F.len;break;default:console.log("Error processing cigar element: "+F.len+F.ltr)}}return{blocks:M,insertions:L,gaps:C}}}};xc.prototype.readMetadata=function(){return cm({url:this.url,entity:"readgroupsets",entityId:this.readGroupSetIds})};function Z2(i,e){var t;if(e==="461916304629"||e==="337315832689"){for(t=1;t<23;t++)i["chr"+t]=t;i.chrX="X",i.chrY="Y",i.chrM="MT"}}var Kl=class{constructor(e,t){let n=t.genome;if(this.config=e,this.genome=n,oi(e.url)&&(this.config.indexed=!1),e.sourceType==="ga4gh")this.bamReader=new xc(e,n);else if(e.sourceType==="pysam")this.bamReader=new wm(e,n);else if(e.sourceType==="htsget")this.bamReader=new Zl(e,n);else if(e.sourceType==="shardedBam")this.bamReader=new Gl(e,n);else if(e.format==="cram")this.bamReader=new Xl(e,n,t);else{if(!this.config.indexURL&&e.indexed!==!1)if(yt(this.config.url)){let s=Ug(this.config.url,"bai");s?(console.error(`Warning: no indexURL specified for ${this.config.url}.  Guessing ${this.baiPath}`),this.config.indexURL=s):(console.error(`Warning: no indexURL specified for ${this.config.url}.`),this.config.indexed=!1)}else console.error(`Warning: no indexURL specified for ${this.config.name}.`),this.config.indexed=!1;this.config.indexed!==!1?this.bamReader=new Js(e,n):this.bamReader=new jl(e,n)}this.viewAsPairs=e.viewAsPairs,this.showSoftClips=e.showSoftClips}setViewAsPairs(e){this.viewAsPairs=e}setShowSoftClips(e){this.showSoftClips=e}async getAlignments(e,t,n){let s=this.genome,r=this.showSoftClips,a=await this.bamReader.readAlignments(e,t,n),o=a.alignments;this.viewAsPairs||(o=mm([{alignments:o}]));let l=o.length>0;if(a.packedAlignmentRows=ps(o,a.start,a.end,r),this.alignmentContainer=a,l){let c=await s.sequence.getSequence(e,a.start,a.end);if(c)return a.coverageMap.refSeq=c,a.sequence=c,a;console.error("No sequence for: "+e+":"+a.start+"-"+a.end)}return a}};function Bn(i,e,t){var n,s,r,a,o,l,c,h,d={font:"normal 10px Arial",textAlign:"right",strokeStyle:"black"};if(this.dataRange===void 0||this.dataRange.max===void 0||this.dataRange.min===void 0)return;let f=this.flipAxis===void 0?!1:this.flipAxis;he.fillRect(i,0,0,e,t,{fillStyle:"rgb(255, 255, 255)"}),c=.95*e,n=c-8,s=c,h=.01,r=a=h*t,o={x:s,y:r},he.strokeLine(i,n,r,s,a,d),he.fillText(i,u(f?this.dataRange.min:this.dataRange.max),n+4,r+12,d),r=a=(1-h)*t,l={x:s,y:r},he.strokeLine(i,n,r,s,a,d),he.fillText(i,u(f?this.dataRange.max:this.dataRange.min),n+4,r-4,d),he.strokeLine(i,o.x,o.y,l.x,l.y,d);function u(g){return g===0?"0":Math.abs(g)>=10?g.toFixed():Math.abs(g)>=1?g.toFixed(1):g.toFixed(2)}}var Jl=class i{constructor({chr:e,start:t,end:n}){this.chr=e,this.start=t,this.end=n}contains(e){return e.chr===this.chr&&e.start>=this.start&&e.end<=this.end}overlaps(e){return e.chr===this.chr&&!(e.end<this.start||e.start>this.end)}extend(e){e.chr===this.chr&&(this.start=Math.min(e.start,this.start),this.end=Math.max(e.end,this.end))}getLocusString(){if(this.chr==="all")return"all";{let e=De(Math.floor(this.start)+1),t=De(Math.round(this.end));return`${this.chr}:${e}-${t}`}}static fromLocusString(e){if(e==="all")return new i({chr:"all"});let t=e.split(":"),n=t[0],s=t[1].split("-"),r=Number.parseInt(s[0].replace(/,/g,""))-1,a=Number.parseInt(s[1].replace(/,/g,""));return new i({chr:n,start:r,end:a})}};var kc=function(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")},Sc=function(){function i(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),Yr=function(){function i(e,t){var n=[],s=!0,r=!1,a=void 0;try{for(var o=e[Symbol.iterator](),l;!(s=(l=o.next()).done)&&(n.push(l.value),!(t&&n.length===t));s=!0);}catch(c){r=!0,a=c}finally{try{!s&&o.return&&o.return()}finally{if(r)throw a}}return n}return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return i(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();String.prototype.startsWith=String.prototype.startsWith||function(i){return this.indexOf(i)===0};String.prototype.padStart=String.prototype.padStart||function(i,e){for(var t=this;t.length<i;)t=e+t;return t};var X2={cb:"0f8ff",tqw:"aebd7",q:"-ffff",qmrn:"7fffd4",zr:"0ffff",bg:"5f5dc",bsq:"e4c4",bck:"---",nch:"ebcd",b:"--ff",bvt:"8a2be2",brwn:"a52a2a",brw:"deb887",ctb:"5f9ea0",hrt:"7fff-",chcT:"d2691e",cr:"7f50",rnw:"6495ed",crns:"8dc",crms:"dc143c",cn:"-ffff",Db:"--8b",Dcn:"-8b8b",Dgnr:"b8860b",Dgr:"a9a9a9",Dgrn:"-64-",Dkhk:"bdb76b",Dmgn:"8b-8b",Dvgr:"556b2f",Drng:"8c-",Drch:"9932cc",Dr:"8b--",Dsmn:"e9967a",Dsgr:"8fbc8f",DsTb:"483d8b",DsTg:"2f4f4f",Dtrq:"-ced1",Dvt:"94-d3",ppnk:"1493",pskb:"-bfff",mgr:"696969",grb:"1e90ff",rbrc:"b22222",rwht:"af0",stg:"228b22",chs:"-ff",gnsb:"dcdcdc",st:"8f8ff",g:"d7-",gnr:"daa520",gr:"808080",grn:"-8-0",grnw:"adff2f",hnw:"0fff0",htpn:"69b4",nnr:"cd5c5c",ng:"4b-82",vr:"0",khk:"0e68c",vnr:"e6e6fa",nrb:"0f5",wngr:"7cfc-",mnch:"acd",Lb:"add8e6",Lcr:"08080",Lcn:"e0ffff",Lgnr:"afad2",Lgr:"d3d3d3",Lgrn:"90ee90",Lpnk:"b6c1",Lsmn:"a07a",Lsgr:"20b2aa",Lskb:"87cefa",LsTg:"778899",Lstb:"b0c4de",Lw:"e0",m:"-ff-",mgrn:"32cd32",nn:"af0e6",mgnt:"-ff",mrn:"8--0",mqm:"66cdaa",mmb:"--cd",mmrc:"ba55d3",mmpr:"9370db",msg:"3cb371",mmsT:"7b68ee","":"-fa9a",mtr:"48d1cc",mmvt:"c71585",mnLb:"191970",ntc:"5fffa",mstr:"e4e1",mccs:"e4b5",vjw:"dead",nv:"--80",c:"df5e6",v:"808-0",vrb:"6b8e23",rng:"a5-",rngr:"45-",rch:"da70d6",pgnr:"eee8aa",pgrn:"98fb98",ptrq:"afeeee",pvtr:"db7093",ppwh:"efd5",pchp:"dab9",pr:"cd853f",pnk:"c0cb",pm:"dda0dd",pwrb:"b0e0e6",prp:"8-080",cc:"663399",r:"--",sbr:"bc8f8f",rb:"4169e1",sbrw:"8b4513",smn:"a8072",nbr:"4a460",sgrn:"2e8b57",ssh:"5ee",snn:"a0522d",svr:"c0c0c0",skb:"87ceeb",sTb:"6a5acd",sTgr:"708090",snw:"afa",n:"-ff7f",stb:"4682b4",tn:"d2b48c",t:"-8080",thst:"d8bfd8",tmT:"6347",trqs:"40e0d0",vt:"ee82ee",whT:"5deb3",wht:"",hts:"5f5f5",w:"-",wgrn:"9acd32"};function zu(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,t=e>0?i.toFixed(e).replace(/0+$/,"").replace(/\.$/,""):i.toString();return t||"0"}var Y2=function(){function i(e,t,n,s){kc(this,i);var r=this;function a(l){if(l.startsWith("hsl")){var c=l.match(/([\-\d\.e]+)/g).map(Number),h=Yr(c,4),d=h[0],f=h[1],u=h[2],g=h[3];g===void 0&&(g=1),d/=360,f/=100,u/=100,r.hsla=[d,f,u,g]}else if(l.startsWith("rgb")){var _=l.match(/([\-\d\.e]+)/g).map(Number),b=Yr(_,4),w=b[0],p=b[1],m=b[2],v=b[3];v===void 0&&(v=1),r.rgba=[w,p,m,v]}else l.startsWith("#")?r.rgba=i.hexToRgb(l):r.rgba=i.nameToRgb(l)||i.hexToRgb(l)}if(e!==void 0)if(Array.isArray(e))this.rgba=e;else if(n===void 0){var o=e&&""+e;o&&a(o.toLowerCase())}else this.rgba=[e,t,n,s===void 0?1:s]}return Sc(i,[{key:"printRGB",value:function(t){var n=t?this.rgba:this.rgba.slice(0,3),s=n.map(function(r,a){return zu(r,a===3?3:0)});return t?"rgba("+s+")":"rgb("+s+")"}},{key:"printHSL",value:function(t){var n=[360,100,100,1],s=["","%","%",""],r=t?this.hsla:this.hsla.slice(0,3),a=r.map(function(o,l){return zu(o*n[l],l===3?3:1)+s[l]});return t?"hsla("+a+")":"hsl("+a+")"}},{key:"printHex",value:function(t){var n=this.hex;return t?n:n.substring(0,7)}},{key:"rgba",get:function(){if(this._rgba)return this._rgba;if(!this._hsla)throw new Error("No color is set");return this._rgba=i.hslToRgb(this._hsla)},set:function(t){t.length===3&&(t[3]=1),this._rgba=t,this._hsla=null}},{key:"rgbString",get:function(){return this.printRGB()}},{key:"rgbaString",get:function(){return this.printRGB(!0)}},{key:"hsla",get:function(){if(this._hsla)return this._hsla;if(!this._rgba)throw new Error("No color is set");return this._hsla=i.rgbToHsl(this._rgba)},set:function(t){t.length===3&&(t[3]=1),this._hsla=t,this._rgba=null}},{key:"hslString",get:function(){return this.printHSL()}},{key:"hslaString",get:function(){return this.printHSL(!0)}},{key:"hex",get:function(){var t=this.rgba,n=t.map(function(s,r){return r<3?s.toString(16):Math.round(s*255).toString(16)});return"#"+n.map(function(s){return s.padStart(2,"0")}).join("")},set:function(t){this.rgba=i.hexToRgb(t)}}],[{key:"hexToRgb",value:function(t){var n=(t.startsWith("#")?t.slice(1):t).replace(/^(\w{3})$/,"$1F").replace(/^(\w)(\w)(\w)(\w)$/,"$1$1$2$2$3$3$4$4").replace(/^(\w{6})$/,"$1FF");if(!n.match(/^([0-9a-fA-F]{8})$/))throw new Error("Unknown hex color; "+t);var s=n.match(/^(\w\w)(\w\w)(\w\w)(\w\w)$/).slice(1).map(function(r){return parseInt(r,16)});return s[3]=s[3]/255,s}},{key:"nameToRgb",value:function(t){var n=t.toLowerCase().replace("at","T").replace(/[aeiouyldf]/g,"").replace("ght","L").replace("rk","D").slice(-5,4),s=X2[n];return s===void 0?s:i.hexToRgb(s.replace(/\-/g,"00").padStart(6,"f"))}},{key:"rgbToHsl",value:function(t){var n=Yr(t,4),s=n[0],r=n[1],a=n[2],o=n[3];s/=255,r/=255,a/=255;var l=Math.max(s,r,a),c=Math.min(s,r,a),h=void 0,d=void 0,f=(l+c)/2;if(l===c)h=d=0;else{var u=l-c;switch(d=f>.5?u/(2-l-c):u/(l+c),l){case s:h=(r-a)/u+(r<a?6:0);break;case r:h=(a-s)/u+2;break;case a:h=(s-r)/u+4;break}h/=6}return[h,d,f,o]}},{key:"hslToRgb",value:function(t){var n=Yr(t,4),s=n[0],r=n[1],a=n[2],o=n[3],l=void 0,c=void 0,h=void 0;if(r===0)l=c=h=a;else{var d=function(b,w,p){return p<0&&(p+=1),p>1&&(p-=1),p<.16666666666666666?b+(w-b)*6*p:p<.5?w:p<.6666666666666666?b+(w-b)*(.6666666666666666-p)*6:b},f=a<.5?a*(1+r):a+r-a*r,u=2*a-f;l=d(u,f,s+1/3),c=d(u,f,s),h=d(u,f,s-1/3)}var g=[l*255,c*255,h*255].map(Math.round);return g[3]=o,g}}]),i}(),Q2=function(){function i(){kc(this,i),this._events=[]}return Sc(i,[{key:"add",value:function(t,n,s){t.addEventListener(n,s,!1),this._events.push({target:t,type:n,handler:s})}},{key:"remove",value:function(t,n,s){this._events=this._events.filter(function(r){var a=!0;return t&&t!==r.target&&(a=!1),n&&n!==r.type&&(a=!1),s&&s!==r.handler&&(a=!1),a&&i._doRemove(r.target,r.type,r.handler),!a})}},{key:"destroy",value:function(){this._events.forEach(function(t){return i._doRemove(t.target,t.type,t.handler)}),this._events=[]}}],[{key:"_doRemove",value:function(t,n,s){t.removeEventListener(n,s,!1)}}]),i}();function K2(i){var e=document.createElement("div");return e.innerHTML=i,e.firstElementChild}function oo(i,e,t){var n=!1;function s(l,c,h){return Math.max(c,Math.min(l,h))}function r(l,c,h){if(h&&(n=!0),!!n){l.preventDefault();var d=e.getBoundingClientRect(),f=d.width,u=d.height,g=c.clientX,_=c.clientY,b=s(g-d.left,0,f),w=s(_-d.top,0,u);t(b/f,w/u)}}function a(l,c){var h=l.buttons===void 0?l.which:l.buttons;h===1?r(l,l,c):n=!1}function o(l,c){l.touches.length===1?r(l,l.touches[0],c):n=!1}i.add(e,"mousedown",function(l){a(l,!0)}),i.add(e,"touchstart",function(l){o(l,!0)}),i.add(window,"mousemove",a),i.add(e,"touchmove",o),i.add(window,"mouseup",function(l){n=!1}),i.add(e,"touchend",function(l){n=!1}),i.add(e,"touchcancel",function(l){n=!1})}var J2=`linear-gradient(45deg, lightgrey 25%, transparent 25%, transparent 75%, lightgrey 75%) 0 0 / 2em 2em,
                   linear-gradient(45deg, lightgrey 25%,       white 25%,       white 75%, lightgrey 75%) 1em 1em / 2em 2em`,ex=360,vm="keydown",Qr="mousedown",lo="focusin";function Jt(i,e){return(e||document).querySelector(i)}function _m(i){i.preventDefault(),i.stopPropagation()}function ho(i,e,t,n,s){i.add(e,vm,function(r){t.indexOf(r.key)>=0&&(s&&_m(r),n(r))})}var ym=function(){function i(e){kc(this,i),this.settings={popup:"right",layout:"default",alpha:!0,editor:!0,editorFormat:"hex",cancelButton:!1,defaultColor:"#0cf"},this._events=new Q2,this.onChange=null,this.onDone=null,this.onOpen=null,this.onClose=null,this.setOptions(e)}return Sc(i,[{key:"setOptions",value:function(t){var n=this;if(!t)return;var s=this.settings;function r(c,h,d){for(var f in c)d&&d.indexOf(f)>=0||(h[f]=c[f])}if(t instanceof HTMLElement)s.parent=t;else{s.parent&&t.parent&&s.parent!==t.parent&&(this._events.remove(s.parent),this._popupInited=!1),r(t,s),t.onChange&&(this.onChange=t.onChange),t.onDone&&(this.onDone=t.onDone),t.onOpen&&(this.onOpen=t.onOpen),t.onClose&&(this.onClose=t.onClose);var a=t.color||t.colour;a&&this._setColor(a)}var o=s.parent;if(o&&s.popup&&!this._popupInited){var l=function(h){return n.openHandler(h)};this._events.add(o,"click",l),ho(this._events,o,[" ","Spacebar","Enter"],l),this._popupInited=!0}else t.parent&&!s.popup&&this.show()}},{key:"openHandler",value:function(t){if(this.show()){t&&t.preventDefault(),this.settings.parent.style.pointerEvents="none";var n=t&&t.type===vm?this._domEdit:this.domElement;setTimeout(function(){return n.focus()},100),this.onOpen&&this.onOpen(this.colour)}}},{key:"closeHandler",value:function(t){var n=t&&t.type,s=!1;if(!t)s=!0;else if(n===Qr||n===lo){var r=(this.__containedEvent||0)+100;t.timeStamp>r&&(s=!0)}else _m(t),s=!0;s&&this.hide()&&(this.settings.parent.style.pointerEvents="",n!==Qr&&this.settings.parent.focus(),this.onClose&&this.onClose(this.colour))}},{key:"movePopup",value:function(t,n){this.closeHandler(),this.setOptions(t),n&&this.openHandler()}},{key:"setColor",value:function(t,n){this._setColor(t,{silent:n})}},{key:"_setColor",value:function(t,n){if(typeof t=="string"&&(t=t.trim()),!!t){n=n||{};var s=void 0;try{s=new Y2(t)}catch(a){if(n.failSilently)return;throw a}if(!this.settings.alpha){var r=s.hsla;r[3]=1,s.hsla=r}this.colour=this.color=s,this._setHSLA(null,null,null,null,n)}}},{key:"setColour",value:function(t,n){this.setColor(t,n)}},{key:"show",value:function(){var t=this.settings.parent;if(!t)return!1;if(this.domElement){var n=this._toggleDOM(!0);return this._setPosition(),n}var s=this.settings.template||'<div class="picker_wrapper" tabindex="-1"><div class="picker_arrow"></div><div class="picker_hue picker_slider"><div class="picker_selector"></div></div><div class="picker_sl"><div class="picker_selector"></div></div><div class="picker_alpha picker_slider"><div class="picker_selector"></div></div><div class="picker_editor"><input aria-label="Type a color name or hex value"/></div><div class="picker_sample"></div><div class="picker_done"><button>Ok</button></div><div class="picker_cancel"><button>Cancel</button></div></div>',r=K2(s);return this.domElement=r,this._domH=Jt(".picker_hue",r),this._domSL=Jt(".picker_sl",r),this._domA=Jt(".picker_alpha",r),this._domEdit=Jt(".picker_editor input",r),this._domSample=Jt(".picker_sample",r),this._domOkay=Jt(".picker_done button",r),this._domCancel=Jt(".picker_cancel button",r),r.classList.add("layout_"+this.settings.layout),this.settings.alpha||r.classList.add("no_alpha"),this.settings.editor||r.classList.add("no_editor"),this.settings.cancelButton||r.classList.add("no_cancel"),this._ifPopup(function(){return r.classList.add("popup")}),this._setPosition(),this.colour?this._updateUI():this._setColor(this.settings.defaultColor),this._bindEvents(),!0}},{key:"hide",value:function(){return this._toggleDOM(!1)}},{key:"destroy",value:function(){this._events.destroy(),this.domElement&&this.settings.parent.removeChild(this.domElement)}},{key:"_bindEvents",value:function(){var t=this,n=this,s=this.domElement,r=this._events;function a(c,h,d){r.add(c,h,d)}a(s,"click",function(c){return c.preventDefault()}),oo(r,this._domH,function(c,h){return n._setHSLA(c)}),oo(r,this._domSL,function(c,h){return n._setHSLA(null,c,1-h)}),this.settings.alpha&&oo(r,this._domA,function(c,h){return n._setHSLA(null,null,null,1-h)});var o=this._domEdit;a(o,"input",function(c){n._setColor(this.value,{fromEditor:!0,failSilently:!0})}),a(o,"focus",function(c){var h=this;h.selectionStart===h.selectionEnd&&h.select()}),this._ifPopup(function(){var c=function(f){return t.closeHandler(f)};a(window,Qr,c),a(window,lo,c),ho(r,s,["Esc","Escape"],c);var h=function(f){t.__containedEvent=f.timeStamp};a(s,Qr,h),a(s,lo,h),a(t._domCancel,"click",c)});var l=function(h){t._ifPopup(function(){return t.closeHandler(h)}),t.onDone&&t.onDone(t.colour)};a(this._domOkay,"click",l),ho(r,s,["Enter"],l)}},{key:"_setPosition",value:function(){var t=this.settings.parent,n=this.domElement;t!==n.parentNode&&t.appendChild(n),this._ifPopup(function(s){getComputedStyle(t).position==="static"&&(t.style.position="relative");var r=s===!0?"popup_right":"popup_"+s;["popup_top","popup_bottom","popup_left","popup_right"].forEach(function(a){a===r?n.classList.add(a):n.classList.remove(a)}),n.classList.add(r)})}},{key:"_setHSLA",value:function(t,n,s,r,a){a=a||{};var o=this.colour,l=o.hsla;[t,n,s,r].forEach(function(c,h){(c||c===0)&&(l[h]=c)}),o.hsla=l,this._updateUI(a),this.onChange&&!a.silent&&this.onChange(o)}},{key:"_updateUI",value:function(t){if(!this.domElement)return;t=t||{};var n=this.colour,s=n.hsla,r="hsl("+s[0]*ex+", 100%, 50%)",a=n.hslString,o=n.hslaString,l=this._domH,c=this._domSL,h=this._domA,d=Jt(".picker_selector",l),f=Jt(".picker_selector",c),u=Jt(".picker_selector",h);function g(R,M,C){M.style.left=C*100+"%"}function _(R,M,C){M.style.top=C*100+"%"}g(l,d,s[0]),this._domSL.style.backgroundColor=this._domH.style.color=r,g(c,f,s[1]),_(c,f,1-s[2]),c.style.color=a,_(h,u,1-s[3]);var b=a,w=b.replace("hsl","hsla").replace(")",", 0)"),p="linear-gradient("+[b,w]+")";if(this._domA.style.background=p+", "+J2,!t.fromEditor){var m=this.settings.editorFormat,v=this.settings.alpha,x=void 0;switch(m){case"rgb":x=n.printRGB(v);break;case"hsl":x=n.printHSL(v);break;default:x=n.printHex(v)}this._domEdit.value=x}this._domSample.style.color=o}},{key:"_ifPopup",value:function(t,n){this.settings.parent&&this.settings.popup?t&&t(this.settings.popup):n&&n()}},{key:"_toggleDOM",value:function(t){var n=this.domElement;if(!n)return!1;var s=t?"":"none",r=n.style.display!==s;return r&&(n.style.display=s),r}}]),i}();Kr=document.createElement("style"),Kr.textContent='.picker_wrapper.no_alpha .picker_alpha{display:none}.picker_wrapper.no_editor .picker_editor{position:absolute;z-index:-1;opacity:0}.picker_wrapper.no_cancel .picker_cancel{display:none}.layout_default.picker_wrapper{display:flex;flex-flow:row wrap;justify-content:space-between;align-items:stretch;font-size:10px;width:25em;padding:.5em}.layout_default.picker_wrapper input,.layout_default.picker_wrapper button{font-size:1rem}.layout_default.picker_wrapper>*{margin:.5em}.layout_default.picker_wrapper::before{content:"";display:block;width:100%;height:0;order:1}.layout_default .picker_slider,.layout_default .picker_selector{padding:1em}.layout_default .picker_hue{width:100%}.layout_default .picker_sl{flex:1 1 auto}.layout_default .picker_sl::before{content:"";display:block;padding-bottom:100%}.layout_default .picker_editor{order:1;width:6.5rem}.layout_default .picker_editor input{width:100%;height:100%}.layout_default .picker_sample{order:1;flex:1 1 auto}.layout_default .picker_done,.layout_default .picker_cancel{order:1}.picker_wrapper{box-sizing:border-box;background:#f2f2f2;box-shadow:0 0 0 1px silver;cursor:default;font-family:sans-serif;color:#444;pointer-events:auto}.picker_wrapper:focus{outline:none}.picker_wrapper button,.picker_wrapper input{box-sizing:border-box;border:none;box-shadow:0 0 0 1px silver;outline:none}.picker_wrapper button:focus,.picker_wrapper button:active,.picker_wrapper input:focus,.picker_wrapper input:active{box-shadow:0 0 2px 1px #1e90ff}.picker_wrapper button{padding:.4em .6em;cursor:pointer;background-color:#f5f5f5;background-image:linear-gradient(0deg, gainsboro, transparent)}.picker_wrapper button:active{background-image:linear-gradient(0deg, transparent, gainsboro)}.picker_wrapper button:hover{background-color:#fff}.picker_selector{position:absolute;z-index:1;display:block;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);border:2px solid #fff;border-radius:100%;box-shadow:0 0 3px 1px #67b9ff;background:currentColor;cursor:pointer}.picker_slider .picker_selector{border-radius:2px}.picker_hue{position:relative;background-image:linear-gradient(90deg, red, yellow, lime, cyan, blue, magenta, red);box-shadow:0 0 0 1px silver}.picker_sl{position:relative;box-shadow:0 0 0 1px silver;background-image:linear-gradient(180deg, white, rgba(255, 255, 255, 0) 50%),linear-gradient(0deg, black, rgba(0, 0, 0, 0) 50%),linear-gradient(90deg, #808080, rgba(128, 128, 128, 0))}.picker_alpha,.picker_sample{position:relative;background:linear-gradient(45deg, lightgrey 25%, transparent 25%, transparent 75%, lightgrey 75%) 0 0/2em 2em,linear-gradient(45deg, lightgrey 25%, white 25%, white 75%, lightgrey 75%) 1em 1em/2em 2em;box-shadow:0 0 0 1px silver}.picker_alpha .picker_selector,.picker_sample .picker_selector{background:none}.picker_editor input{font-family:monospace;padding:.2em .4em}.picker_sample::before{content:"";position:absolute;display:block;width:100%;height:100%;background:currentColor}.picker_arrow{position:absolute;z-index:-1}.picker_wrapper.popup{position:absolute;z-index:2;margin:1.5em}.picker_wrapper.popup,.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{background:#f2f2f2;box-shadow:0 0 10px 1px rgba(0,0,0,.4)}.picker_wrapper.popup .picker_arrow{width:3em;height:3em;margin:0}.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{content:"";display:block;position:absolute;top:0;left:0;z-index:-99}.picker_wrapper.popup .picker_arrow::before{width:100%;height:100%;-webkit-transform:skew(45deg);transform:skew(45deg);-webkit-transform-origin:0 100%;transform-origin:0 100%}.picker_wrapper.popup .picker_arrow::after{width:150%;height:150%;box-shadow:none}.popup.popup_top{bottom:100%;left:0}.popup.popup_top .picker_arrow{bottom:0;left:0;-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}.popup.popup_bottom{top:100%;left:0}.popup.popup_bottom .picker_arrow{top:0;left:0;-webkit-transform:rotate(90deg) scale(1, -1);transform:rotate(90deg) scale(1, -1)}.popup.popup_left{top:0;right:100%}.popup.popup_left .picker_arrow{top:0;right:0;-webkit-transform:scale(-1, 1);transform:scale(-1, 1)}.popup.popup_right{top:0;left:100%}.popup.popup_right .picker_arrow{top:0;left:0}',document.documentElement.firstElementChild.appendChild(Kr),ym.StyleElement=Kr;var Kr;function tx(i){if(un[i])return un[i];if(un["chr"+i]){let e=un["chr"+i];return un[i]=e,e}else{let e=ix();return un[i]=e,e}}function ix(i,e){var t=Math.round(Math.random()*255).toString(10),n=Math.round(Math.random()*255).toString(10),s=Math.round(Math.random()*255).toString(10);return"rgb("+t+","+n+","+s+")"}var un={chrX:"rgb(204, 153, 0)",chrY:"rgb(153, 204, 0",chrUn:"rgb(50, 50, 50)",chr1:"rgb(80, 80, 255)",chrI:"rgb(139, 155, 187)",chr2:"rgb(206, 61, 50)",chrII:"rgb(206, 61, 50)",chr2a:"rgb(216, 71, 60)",chr2b:"rgb(226, 81, 70)",chr3:"rgb(116, 155, 88)",chrIII:"rgb(116, 155, 88)",chr4:"rgb(240, 230, 133)",chrIV:"rgb(240, 230, 133)",chr5:"rgb(70, 105, 131)",chr6:"rgb(186, 99, 56)",chr7:"rgb(93, 177, 221)",chr8:"rgb(128, 34, 104)",chr9:"rgb(107, 215, 107)",chr10:"rgb(213, 149, 167)",chr11:"rgb(146, 72, 34)",chr12:"rgb(131, 123, 141)",chr13:"rgb(199, 81, 39)",chr14:"rgb(213, 143, 92)",chr15:"rgb(122, 101, 165)",chr16:"rgb(228, 175, 105)",chr17:"rgb(59, 27, 83)",chr18:"rgb(205, 222, 183)",chr19:"rgb(97, 42, 121)",chr20:"rgb(174, 31, 99)",chr21:"rgb(231, 199, 111)",chr22:"rgb(90, 101, 94)",chr23:"rgb(204, 153, 0)",chr24:"rgb(153, 204, 0)",chr25:"rgb(51, 204, 0)",chr26:"rgb(0, 204, 51)",chr27:"rgb(0, 204, 153)",chr28:"rgb(0, 153, 204)",chr29:"rgb(10, 71, 255)",chr30:"rgb(71, 117, 255)",chr31:"rgb(255, 194, 10)",chr32:"rgb(255, 209, 71)",chr33:"rgb(153, 0, 51)",chr34:"rgb(153, 26, 0)",chr35:"rgb(153, 102, 0)",chr36:"rgb(128, 153, 0)",chr37:"rgb(51, 153, 0)",chr38:"rgb(0, 153, 26)",chr39:"rgb(0, 153, 102)",chr40:"rgb(0, 128, 153)",chr41:"rgb(0, 51, 153)",chr42:"rgb(26, 0, 153)",chr43:"rgb(102, 0, 153)",chr44:"rgb(153, 0, 128)",chr45:"rgb(214, 0, 71)",chr46:"rgb(255, 20, 99)",chr47:"rgb(0, 214, 143)",chr48:"rgb(20, 255, 177)"},eh=class{constructor(e){this.tracks=[],this.chordSets=[]}addChordSet(e){this.chordSets=this.chordSets.filter(n=>n.name!==e.name),this.chordSets.push(e);let t=this.tracks.find(n=>e.trackName===n.name);t&&(t.chordSets=t.chordSets.filter(n=>n.name!==e.name),t.chordSets.push(e)),t||(t=new th(e),this.tracks.push(t))}clearChords(){this.tracks=[],this.chordSets=[]}getTrack(e){return this.tracks.find(t=>e===t.name)}getChordSet(e){return this.chordSets.find(t=>e===t.name)}},th=class{constructor(e){this.name=e.trackName,this.color=e.trackColor,this.visible=!0,this.chordSets=[e],this.id=nx()}get chords(){if(this.chordSets.length===1)return this.chordSets[0].chords;let e=[];for(let t of this.chordSets)for(let n of t.chords)e.push(n);return e}};function nx(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}var Hu=Math.exp(5),ih=class i{static isInstalled(){return window.JBrowseReactCircularGenomeView!==void 0&&window.React!==void 0&&window.ReactDOM!==void 0}constructor(e,t){if(t=t||{},this.config=t,i.isInstalled()){this.parent=e,this.groupByTrack=t.groupByTrack===!0,this.chordManager=new eh(t);let n=document.createElement("div");n.className="igv-circview-container",e.appendChild(n),this.createControls(n),this.resetControlPanel();let s=document.createElement("div");s.className="igv-circview-circular-genome-view",n.appendChild(s),this.container=s,t.assembly&&this.setAssembly(t.assembly),this.width=t.width||500,this.height=t.height||500,this.setSize(this.width,this.height)}else console.error("JBrowse circular view is not installed")}createControls(e){let t=document.createElement("div");t.className="igv-circview-toolbar",e.appendChild(t),this.toolbar=t;let n=document.createElement("div");n.className="igv-circview-track-panel",e.appendChild(n),this.controlPanel=n,this.controlPanel.style.display="none";let s=document.createElement("div");s.className="igv-circview-toolbar-button-container",this.toolbar.appendChild(s),this.showControlsButton=document.createElement("div"),this.showControlsButton.className="igv-circview-button",s.appendChild(this.showControlsButton),this.showControlsButton.innerText=this.controlPanel.style.display==="none"?"Show Controls":"Hide Controls",this.showControlsButton.addEventListener("click",a=>{this.controlPanel.querySelectorAll("div").length>0&&(this.controlPanel.style.display==="none"?(this.controlPanel.style.display="flex",a.target.innerText="Hide Controls"):(this.controlPanel.style.display="none",a.target.innerText="Show Controls"))});let r=document.createElement("div");r.className="igv-circview-button",s.appendChild(r),r.innerText="Clear All",r.addEventListener("click",()=>{this.clearChords()}),this.config.showCloseButton!==!1&&(r=document.createElement("div"),r.className="igv-circview-button",s.appendChild(r),r.innerText="Close",r.addEventListener("click",()=>{this.visible=!1}))}resetControlPanel(){this.controlPanel.innerHTML="",this.controlPanel.appendChild(this.createGroupByCB());let e=this.groupByTrack?this.chordManager.tracks:this.chordManager.chordSets;for(let t of e)this.addToControlPanel(t)}createGroupByCB(){let e=document.createElement("input");e.type="checkbox",e.id="groupByCB",e.style.width="1.4em",e.style.height="1.4em",e.checked=this.groupByTrack,e.onclick=s=>{this.groupByTrack=s.target.checked,this.resetControlPanel(),this.render()};let t=document.createElement("label");t.for="groupByCB",t.innerText="Group by track",t.style.color="black",t.style.paddingLeft="10px";let n=document.createElement("div");return n.style.width="100%",n.style.paddingTop="5px",n.style.paddingBottom="5px",n.style.background="rgb(216, 230, 234)",n.appendChild(e),n.appendChild(t),n}addToControlPanel(e){let t=document.createElement("div");this.controlPanel.appendChild(t);let n=document.createElement("div");n.className="igv-circview-button",t.appendChild(n),n.innerText=e.visible===!0?"Hide":"Show",n.addEventListener("click",d=>{e.visible===!0?(this.hideChordSet(e.name),d.target.innerText="Show"):(this.showChordSet(e.name),d.target.innerText="Hide")});let s=document.createElement("input"),r=d=>Math.exp(d/200)/Hu,a=d=>200*Math.log(d*Hu),o=document.createElement("div");o.className="igv-circview-button",o.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;",t.appendChild(o),o.style.backgroundColor=co(e.color,1);let l={parent:o,popup:"right",editorFormat:"rgb",color:e.color,onChange:({rgbaString:d})=>{o.style.backgroundColor=co(d,1),this.setColor(e.name,d),s.value=a(Uu(e.color))}},c=new ym(l);s.setAttribute("title","Adjust transparency of arcs"),s.type="range",s.style.width="100px",s.style.marginRight="10px",s.setAttribute("class","range"),s.setAttribute("min","0"),s.setAttribute("max","1000"),s.value=a(Uu(e.color)),s.oninput=()=>{let d=r(s.value);this.setColor(e.name,co(e.color,d)),c.setColor(e.color)},t.appendChild(s);let h=document.createElement("div");h.style.color="black",t.appendChild(h),h.innerText=h.title=e.name}setAssembly(e){let t=this.genomeId||Vu();if(this.genomeId===t)return;this.chordManager.clearChords(),this.genomeId=t,this.chrNames=new Set(e.chromosomes.map(r=>$u(r.name)));let n=[],s=[];for(let r of e.chromosomes){let a=$u(r.name);s.push(r.color||tx(a)),n.push({refName:a,uniqueId:a,start:0,end:r.bpLength})}this.assembly={name:e.name,sequence:{trackId:t,type:"ReferenceSequenceTrack",adapter:{type:"FromConfigSequenceAdapter",features:n}},refNameColors:s},this.render()}addChords(e,t={}){let n=t.name||t.track||"*",s=n.split(" ")[0].replaceAll("%20"," "),a={name:n.replaceAll("%20"," "),trackName:s,chords:e,color:t.color||"black",trackColor:t.trackColor||t.color||"black",visible:!0,id:t.id||Vu()};this.chordManager.addChordSet(a),this.resetControlPanel(),this.render()}setSize(e,t){if(t=t||e,this.width=e,this.height=t,this.viewState){let n=this.viewState.session.view;n.setWidth(e),n.setHeight(t),n.setBpPerPx(n.minBpPerPx)}}getSize(){return Math.min(this.width,this.height)}clearChords(){this.chordManager.clearChords(),this.resetControlPanel(),this.render()}clearSelection(){this.viewState.pluginManager.rootModel.session.clearSelection()}show(){this.parent.style.display="block"}hide(){this.parent.style.display="none"}get visible(){return this.parent.style.display!=="none"}set visible(e){this.parent.style.display=e?"block":"none"}hideChordSet(e){let t=this.getChordSet(e);t?(t.visible=!1,this.render()):console.warn(`No track with name: ${name}`)}showChordSet(e){let t=this.getChordSet(e);t?(t.visible=!0,this.render()):console.warn(`No track with name: ${e}`)}deleteTrack(e){let t=this.tracks.findIndex(n=>e===n.name);t>=0&&this.tracks.splice(t,1),this.render()}getChordSet(e){return this.groupByTrack?this.chordManager.getTrack(e):this.chordManager.getChordSet(e)}setColor(e,t){let n=this.getChordSet(e);if(n){n.color=t;let s=n.id;for(let r of this.viewState.config.tracks)if(s===r.trackId){r.displays[0].renderer.strokeColor.set(t);break}}}render(){let{createViewState:e,JBrowseCircularGenomeView:t}=JBrowseReactCircularGenomeView;ReactDOM.unmountComponentAtNode(this.container);let n=(this.groupByTrack?this.chordManager.tracks:this.chordManager.chordSets).filter(o=>o.visible),s=[],r=[];for(let o of n)s.push({trackId:o.id,name:o.name,assemblyNames:["forIGV"],type:"VariantTrack",adapter:{type:"FromConfigAdapter",features:o.chords}}),r.push(o.color);this.viewState=e({assembly:this.assembly,tracks:s});for(let o=0;o<n.length;o++)this.viewState.config.tracks[o].displays[0].renderer.strokeColor.set(r[o]);this.element=React.createElement(t,{viewState:this.viewState}),this.setSize(this.width,this.height),ReactDOM.render(this.element,this.container);let a=this.config.onChordClick||rx;for(let o=0;o<n.length;o++)this.viewState.session.view.showTrack(this.viewState.config.tracks[o].trackId),a&&(this.viewState.pluginManager.jexl.addFunction("onChordClick",a),this.viewState.config.tracks[o].displays[0].onChordClick.set("jexl:onChordClick(feature, track, pluginManager)"))}};function co(i,e){let[t,n,s,r]=i.split(",");return`${t},${n},${s},${e})`}function Uu(i){return i.startsWith("rgba(")?Number(i.split(",")[3].replace(")","")):1}function $u(i){return i.startsWith("chr")?i.substring(3):i}function rx(i,e,t){console.log(i)}function Vu(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}function sx(){let i=`.igv-circview-container {
  width: fit-content;
  height: fit-content;
  box-sizing: content-box;
  color: dimgray;
  font-family: "Open Sans", sans-serif;
  font-size: 12px;
  background-color: white;
  border-color: dimgray;
  border-style: solid;
  border-width: thin;
  display: flex;
  flex-direction: column;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: flex-start;
}

.igv-circview-toolbar {
  position: relative;
  width: 100%;
  height: 32px;
  background-color: lightgrey;
  border-bottom-style: solid;
  border-bottom-color: dimgray;
  border-bottom-width: thin;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: space-between;
  align-items: center;
}

.igv-circview-toolbar-button-container {
  height: 100%;
  width: fit-content;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: center;
}
.igv-circview-toolbar-button-container > div {
  margin: 4px;
}

.igv-circview-track-panel {
  z-index: 1024;
  position: absolute;
  top: 33px;
  left: 0;
  width: 100%;
  height: fit-content;
  border-bottom-style: solid;
  border-bottom-color: dimgray;
  border-bottom-width: thin;
  background-color: white;
  display: flex;
  flex-flow: column;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: flex-start;
}
.igv-circview-track-panel > div {
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: center;
}
.igv-circview-track-panel > div > div {
  margin: 4px;
}

.igv-circview-swatch-button {
  cursor: pointer;
  padding: 5px;
  width: 8px;
  height: 8px;
  border: 1px solid #8d8b8b;
  border-radius: 16px;
}

.igv-circview-button {
  cursor: pointer;
  padding: 5px;
  color: #444;
  vertical-align: middle;
  text-align: center;
  font-family: "Open Sans", sans-serif;
  font-size: 12px;
  border: 1px solid #8d8b8b;
  border-radius: 4px;
  background: #efefef;
  box-shadow: 0 0 5px -1px rgba(0, 0, 0, 0.2);
}

.igv-circview-button:hover {
  background: #efefef;
  box-shadow: 0 0 5px -1px rgba(0, 0, 0, 0.6);
}

.igv-circview-button:active {
  color: #007bff;
  box-shadow: 0 0 5px -1px rgba(0, 0, 0, 0.6);
}

/*# sourceMappingURL=circular-view.css.map */
`,e=document.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=i,document.head.insertBefore(e,document.head.childNodes[document.head.childNodes.length-1])}typeof document<"u"&&(function(e){for(let t of document.styleSheets)if(t=t.href?t.href.replace(/^.*[\\\/]/,""):"",t===e)return!0;return!1}("circular-view.css")||sx());var ax=1e6,ni=i=>i.startsWith("chr")?i.substring(3):i,ox=i=>{let e=[];for(let t of i)if(t.paired)t.firstAlignment&&t.secondAlignment&&e.push({uniqueId:t.readName,refName:ni(t.firstAlignment.chr),start:t.firstAlignment.start,end:t.firstAlignment.end,mate:{refName:ni(t.secondAlignment.chr),start:t.secondAlignment.start,end:t.secondAlignment.end}});else{let n=t.mate;n&&n.chr&&n.position&&e.push({uniqueId:t.readName,refName:ni(t.chr),start:t.start,end:t.end,mate:{refName:ni(n.chr),start:n.position-1,end:n.position}})}return e},lx=i=>{let e=n=>{let s=n.tags().SA,r=bm(s),a=0;for(let o of r)o.start!==n.start&&t.push({uniqueId:`${n.readName}_${a++}`,refName:ni(n.chr),start:n.start,end:n.end,mate:{refName:ni(o.chr),start:o.start,end:o.start+o.lenOnRef}})},t=[];for(let n of i)n.paired?(e(n.firstAlignment),n.secondAlignment&&e(n.secondAlignment)):e(n);return t},hx=i=>i.map(e=>{let t=e._f||e;return{uniqueId:`${t.chr1}:${t.start1}-${t.end1}_${t.chr2}:${t.start2}-${t.end2}`,refName:ni(t.chr1),start:t.start1,end:t.end1,mate:{refName:ni(t.chr2),start:t.start2,end:t.end2}}}),cx=i=>i.filter(t=>{let n=t._f||t;return n.info&&n.info.CHR2&&n.info.END&&(n.info.CHR2!==n.chr||Math.abs(Number.parseInt(n.info.END)-n.pos)>ax)}).map(t=>{let n=t._f||t,s=Number.parseInt(n.info.END),r=s-100,a=s+100;return{uniqueId:`${n.chr}:${n.start}-${n.end}_${n.info.CHR2}:${n.info.END}`,refName:ni(n.chr),start:n.start,end:n.end,mate:{refName:ni(n.info.CHR2),start:r,end:a}}});function qu(i){let e=[],t=[];for(let n of i.wgChromosomeNames){let s=i.getChromosome(n);t.push(Mn(s.name)),e.push({name:s.name,bpLength:s.bpLength})}return e}function ta(i,e,t,n){let s=e.color||"rgb(0,0,255)",r=Ve.addAlpha(t.chr==="all"?s:Mn(t.chr),n),a=Ve.addAlpha(s,n),o=e.name.replaceAll(" ","%20"),l=t.chr==="all"?o:`${o}  ${t.chr}:${t.start}-${t.end}`;e.browser.circularView.addChords(i,{track:l,color:r,trackColor:a}),e.browser.circularViewVisible||(e.browser.circularViewVisible=!0)}function fx(i,e){return new ih(i,{onChordClick:(n,s,r)=>{let a=n.data,o=a.mate;l(a),l(o);function l(c){c.chr=e.genome.getChromosomeName(c.refName);let h=!1;for(let d of e.referenceFrameList){let f=Jl.fromLocusString(d.getLocusString());if(f.contains(c)){h=!0;break}else if(f.overlaps(c)){d.extend(c),h=!0;break}}if(!h){let f=(c.start+c.end)/2;e.addMultiLocusPanel(c.chr,f-2e3,f+2e3)}}}})}var nh=class{constructor(e,{minTLENPercentile:t,maxTLENPercentile:n}){this.totalCount=0,this.frCount=0,this.rfCount=0,this.ffCount=0,this.sumF=0,this.sumF2=0,this.lp=t===void 0?.1:t,this.up=n===void 0?99.5:n,this.isizes=[],this.compute(e)}compute(e){for(let r of e)if(r.isProperPair()){var t=Math.abs(r.fragmentLength);this.sumF+=t,this.sumF2+=t*t,this.isizes.push(t);var n=r.pairOrientation;if(typeof n=="string"&&n.length===4){var s=""+n.charAt(0)+n.charAt(2);switch(s){case"FF":case"RR":this.ffCount++;break;case"FR":this.frCount++;break;case"RF":this.rfCount++}}this.totalCount++}this.ffCount/this.totalCount>.9?this.orienation="ff":this.frCount/this.totalCount>.9?this.orienation="fr":this.rfCount/this.totalCount>.9&&(this.orienation="rf"),this.minTLEN=this.lp===0?0:Wu(this.isizes,this.lp),this.maxTLEN=Wu(this.isizes,this.up)}};function Wu(i,e){if(i.length!==0){var t=Math.floor(i.length*(e/100));return i.sort(function(n,s){return n-s}),i[t]}}var Cc={getTissueInfo:function(i,e){i=i||"gtex_v8",e=e||"https://gtexportal.org/rest/v1";let t=e+"/dataset/tissueInfo?datasetId="+i;return Ce.loadJson(t,{})},trackConfiguration:function(i,e){return e=e||"https://gtexportal.org/rest/v1",{type:"eqtl",sourceType:"gtex-ws",url:e+"/association/singleTissueEqtlByLocation",tissueSiteDetailId:i.tissueSiteDetailId,name:i.tissueSiteDetailId.split("_").join(" "),visibilityWindow:25e4}}};function xm(i,e,t){let n=(i.start-e)/t,s=(i.end-e)/t,r=s-n;return r<3&&(r=3,n-=1.5),{px:n,px1:s,pw:r}}function ux(i,e,t,n,s,r){try{s.save(),s.fillStyle=this.color,s.strokeStyle=this.color;let a=this.getColorForFeature(i);s.fillStyle=a,s.strokeStyle=a;let o,l;this.displayMode==="SQUISHED"&&i.row!==void 0?(o=this.featureHeight/2,l=this.margin+this.squishedRowHeight*i.row):this.displayMode==="EXPANDED"&&i.row!==void 0?(o=this.featureHeight,l=this.margin+this.expandedRowHeight*i.row):(o=this.featureHeight,l=this.margin);let c=r.pixelWidth,h=l+o/2,d=o/2,f=h-d/2,u=i.exons?i.exons.length:0,g=xm(i,e,t),_=this.arrowSpacing,b=i.strand==="+"?1:i.strand==="-"?-1:0;if(u===0){let w=Math.max(0,g.px),p=Math.min(c,g.px1),m=p-w;if(s.fillRect(w,l,m,o),b!==0){s.fillStyle="white",s.strokeStyle="white";for(let v=w+_/2;v<p;v+=_)he.strokeLine(s,v-b*2,h-2,v,h),he.strokeLine(s,v-b*2,h+2,v,h);s.fillStyle=a,s.strokeStyle=a}}else{he.strokeLine(s,g.px+1,h,g.px1-1,h);let w=Math.max(0,g.px)+_/2,p=Math.min(c,g.px1);for(let m=w;m<p;m+=_)he.strokeLine(s,m-b*2,h-2,m,h),he.strokeLine(s,m-b*2,h+2,m,h);for(let m=0;m<u;m++){let v=i.exons[m],x=Math.round((v.start-e)/t),R=Math.round((v.end-e)/t),M=Math.max(1,R-x),C;if(!(x+M<0)){if(x>c)break;if(v.utr)s.fillRect(x,f,M,d);else if(v.cdStart&&(C=Math.round((v.cdStart-e)/t),s.fillRect(x,f,C-x,d),M-=C-x,x=C),v.cdEnd&&(C=Math.round((v.cdEnd-e)/t),s.fillRect(C,f,R-C,d),M-=R-C,R=C),M=Math.max(M,1),s.fillRect(x,l,M,o),M>_+5&&b!==0){s.fillStyle="white",s.strokeStyle="white";for(let L=x+_/2;L<R;L+=_)he.strokeLine(s,L-b*2,h-2,L,h),he.strokeLine(s,L-b*2,h+2,L,h);s.fillStyle=a,s.strokeStyle=a}}}}r.drawLabel&&this.displayMode!=="SQUISHED"&&dx.call(this,s,i,g.px,g.px1,l,r.referenceFrame,r)}finally{s.restore()}}function dx(i,e,t,n,s,r,a){try{i.save();let o=e.name;if(o===void 0&&e.gene&&(o=e.gene.name),o===void 0&&(o=e.id||e.ID),!o||o===".")return;let l=(t+n)/2,c;this.displayMode==="COLLAPSED"&&this.labelDisplayMode==="SLANT"&&(c={rotate:{angle:45}});let h=px(s,c),d=this.getColorForFeature(e),f,u=!1;r.selection&&Cc.gtexLoaded&&(u=!0,f=r.selection.colorForGene(o));let g={textAlign:this.labelDisplayMode==="SLANT"?void 0:"center",fillStyle:f||d,strokeStyle:f||d},_=i.measureText(o),b=l-_.width/2,w=l+_.width/2,p=a.rowLastLabelX[e.row]||-Number.MAX_SAFE_INTEGER;(a.labelAllFeatures||b>p||u)&&(a.rowLastLabelX[e.row]=w,a.axis==="y"?(i.save(),he.labelTransformWithContext(i,l),he.fillText(i,o,l,h,g,c),i.restore()):he.fillText(i,o,l,h,g,c))}finally{i.restore()}}function px(i,e){return e?i+20:i+25}var gx=new Set(["nonsense","missense","stop-loss","frameshift","cds-indel"]),mx=new Set(["coding-synon"]),bx=new Set(["splice-3","splice-5"]),wx=new Set(["untranslated-5","untranslated-3"]);function fo(i,e,t,n,s){var r=xm(i,e,t),a=this.margin,o,l=this.snpColors.length,c;switch(o=this.displayMode==="squished"?this.squishedRowHeight:this.expandedRowHeight,this.colorBy){case"function":c=h(i.func);break;case"class":c=d(i.class)}s.fillStyle=this.snpColors[c],s.fillRect(r.px,a,r.pw,o);function h(f){var u,g=f.split(",");return u=g.map(function(_){return gx.has(_)||bx.has(_)?l-1:mx.has(_)?l-2:wx.has(_)?l-3:0}),u.reduce(function(_,b){return Math.max(_,b)})}function d(f){return f==="deletion"?l-1:f==="mnp"?l-2:f==="microsatellite"||f==="named"?l-3:0}}function vx(i,e,t,n,s){let r=this.displayMode==="EXPANDED"?this.expandedRowHeight:this.squishedRowHeight,a=this.margin;this.displayMode!=="COLLAPSED"&&i.row!==void 0&&(a+=i.row*r);let o=a+.5*r,l=o-.5*r,c=o+.5*r,h=Math.round((i.junction_left-e)/t),d=Math.round((i.junction_right-e)/t);s.beginPath(),s.moveTo(h,o),s.bezierCurveTo(h,l,d,l,d,o),s.lineWidth=1+Math.log(i.num_junction_reads)/Math.log(2),s.strokeStyle="blue",s.stroke();let f=i.spanning_frag_coords;for(let u=0;u<f.length;u++){let g=f[u],_=Math.round((g.left-e)/t),b=Math.round((g.right-e)/t);s.beginPath(),s.moveTo(_,o),s.bezierCurveTo(_,c,b,c,b,o),s.lineWidth=1,s.strokeStyle="purple",s.stroke()}}var _x="rgb(0, 0, 150)",ia=class extends kt{static defaults={type:"annotation",maxRows:1e3,displayMode:"EXPANDED",margin:10,featureHeight:14,autoHeight:!1,useScore:!1};constructor(e,t){super(e,t)}init(e){super.init(e),this.labelDisplayMode=e.labelDisplayMode,e._featureSource?(this.featureSource=e._featureSource,delete e._featureSource):this.featureSource=e.featureSource?e.featureSource:Bt(e,this.browser.genome),e.type==="FusionJuncSpan"?(this.render=e.render||vx,this.squishedRowHeight=e.squishedRowHeight||50,this.expandedRowHeight=e.expandedRowHeight||50,this.height=e.height||this.margin+2*this.expandedRowHeight):e.type==="snp"?(this.render=e.render||fo,this.snpColors=["rgb(0,0,0)","rgb(0,0,255)","rgb(0,255,0)","rgb(255,0,0)"],this.colorBy="function",this.expandedRowHeight=e.expandedRowHeight||10,this.squishedRowHeight=e.squishedRowHeight||5,this.height=e.height||30):(this.render=e.render||ux,this.arrowSpacing=30,yx(this),this.squishedRowHeight=e.squishedRowHeight||15,this.expandedRowHeight=e.expandedRowHeight||30,this.height=e.height||this.margin+2*this.expandedRowHeight,e.colorBy&&(e.colorBy.field&&(e.colorTable=e.colorBy.pallete||e.colorBy.palette,e.colorBy=e.colorBy.field),this.colorBy=e.colorBy,e.colorTable?this.colorTable=new Gi(e.colorTable):this.colorTable=new ji("Set1")))}async postInit(){if(!(typeof this.featureSource.getHeader=="function"&&(this.header=await this.featureSource.getHeader(),this.disposed)))return this.header&&this.setTrackProperties(this.header),this.visibilityWindow===void 0&&typeof this.featureSource.defaultVisibilityWindow=="function"&&(this.visibilityWindow=await this.featureSource.defaultVisibilityWindow()),this}get supportsWholeGenome(){if(this.config.supportsWholeGenome!==void 0)return this.config.supportsWholeGenome;if(this.featureSource&&typeof this.featureSource.supportsWholeGenome=="function")return this.featureSource.supportsWholeGenome();if(this.visibilityWindow===void 0&&(this.config.indexed===!1||!this.config.indexURL))return!0}async getFeatures(e,t,n,s){let r=this.visibilityWindow;return this.featureSource.getFeatures({chr:e,start:t,end:n,bpPerPixel:s,visibilityWindow:r})}computePixelHeight(e){if(this.displayMode==="COLLAPSED")return this.margin+this.expandedRowHeight;{let t=0;if(e&&typeof e.forEach=="function")for(let s of e)s.row&&s.row>t&&(t=s.row);return this.margin+(t+1)*(this.displayMode==="SQUISHED"?this.squishedRowHeight:this.expandedRowHeight)}}draw(e){let t=e.features,n=e.context,s=e.bpPerPixel,r=e.bpStart,a=e.pixelWidth,o=e.pixelHeight,l=r+a*s+1;if(this.config.isMergedTrack||he.fillRect(n,0,e.pixelTop,a,o,{fillStyle:"rgb(255, 255, 255)"}),t){let c=[];e.rowLastX=[],e.rowLastLabelX=[];for(let u of t)if(u.start>r&&u.end<l){let g=this.displayMode==="COLLAPSED"?0:u.row||0;c[g]===void 0?c[g]=1:c[g]++,e.rowLastX[g]=-Number.MAX_SAFE_INTEGER,e.rowLastLabelX[g]=-Number.MAX_SAFE_INTEGER}let h=Math.max(1,Math.max(...c)),d=a/h,f=[];for(let u of t){if(u.end<r)continue;if(u.start>l)break;let g=this.displayMode==="COLLAPSED"?0:u.row;e.drawLabel=e.labelAllFeatures||d>10;let _=Math.ceil((u.end-r)/s),b=f[g];if(!b||_>b){this.render.call(this,u,r,s,o,n,e);let w=Math.floor((u.start-r)/s);b&&w-b<=0&&(n.globalAlpha=.5,he.strokeLine(n,w,0,w,o,{strokeStyle:"rgb(255, 255, 255)"}),n.globalAlpha=1),f[g]=_}}}else console.log("No feature list")}clickedFeatures(e){let t=e.y-this.margin,n=super.clickedFeatures(e),s;switch(this.displayMode){case"SQUISHED":s=Math.floor(t/this.squishedRowHeight);break;case"EXPANDED":s=Math.floor(t/this.expandedRowHeight);break;default:s=void 0}return n.filter(function(r){return s===void 0||r.row===void 0||s===r.row})}popupData(e,t){t===void 0&&(t=this.clickedFeatures(e));let n=e.genomicLocation,s=[];for(let r of t){let a=r._f||r,o=typeof a.popupData=="function"?a.popupData(n):this.extractPopupData(a);if(o){s.length>0&&s.push("<hr/><hr/>");let l=this.infoURL||this.config.infoURL;for(let h of o)if(s.push(h),l&&h.name&&h.name.toLowerCase()==="name"&&h.value&&yt(h.value)&&!h.value.startsWith("<")){let d=l.replace("$$",r.name);h.value=`<a target=_blank href=${d}>${h.value}</a>`}let c=this.config.format==="gff"||this.config.format==="gff3"||this.config.format==="gtf";if(a.exons)for(let h=0;h<a.exons.length;h++){let d=a.exons[h];if(n>=d.start&&n<=d.end){let f=c?d.number:a.strand==="-"?a.exons.length-h:h+1;f&&(s.push("<hr/>"),s.push({name:"Exon Number",value:f}));break}}}}return s}menuItemList(){let e=[];if(this.render===fo){e.push("<hr/>");for(let t of["function","class"])e.push({object:pe(ot("Color by "+t,t===this.colorBy)),click:()=>{this.colorBy=t,this.trackView.repaintViews()}})}e.push("<hr/>");for(let t of["COLLAPSED","SQUISHED","EXPANDED"]){let n={COLLAPSED:"Collapse",SQUISHED:"Squish",EXPANDED:"Expand"};e.push({object:pe(ot(n[t],t===this.displayMode)),click:()=>{this.displayMode=t,this.config.displayMode=t,this.trackView.checkContentHeight(),this.trackView.repaintViews()}})}return e}contextMenuItemList(e){let t=this.clickedFeatures(e);if(t===void 0||t.length===0)return;t.length>1&&t.sort((s,r)=>r.end-r.start-(s.end-s.start));let n=t[0];if(n.end-n.start<=1e6){let s=[{label:"View feature sequence",click:async()=>{let r=await this.browser.genome.getSequence(n.chr,n.start,n.end);r?n.strand==="-"&&(r=Pi(r)):r="Unknown sequence",this.browser.alert.present(r)}}];return bc()&&navigator.clipboard!==void 0&&s.push({label:"Copy feature sequence",click:async()=>{let r=await this.browser.genome.getSequence(n.chr,n.start,n.end);r?n.strand==="-"&&(r=Pi(r)):r="Unknown sequence";try{await navigator.clipboard.writeText(r)}catch(a){console.error(a),this.browser.alert.present(`error copying sequence to clipboard ${a}`)}}}),s.push("<hr/>"),s}else return}description(){if(fo===this.render){let e="<html>"+this.name+"<hr/>";return e+="<em>Color By Function:</em><br>",e+='<span style="color:red">Red</span>: Coding-Non-Synonymous, Splice Site<br>',e+='<span style="color:green">Green</span>: Coding-Synonymous<br>',e+='<span style="color:blue">Blue</span>: Untranslated<br>',e+='<span style="color:black">Black</span>: Intron, Locus, Unknown<br><br>',e+="<em>Color By Class:</em><br>",e+='<span style="color:red">Red</span>: Deletion<br>',e+='<span style="color:green">Green</span>: MNP<br>',e+='<span style="color:blue">Blue</span>: Microsatellite, Named<br>',e+='<span style="color:black">Black</span>: Indel, Insertion, SNP',e+="</html>",e}else return super.description()}getColorForFeature(e){let t;if(this.altColor&&e.strand==="-")t=typeof this.altColor=="function"?this.altColor(e):this.altColor;else if(this.color)t=typeof this.color=="function"?this.color(e):this.color;else if(this.colorBy){let s=e.getAttributeValue?e.getAttributeValue(this.colorBy):e[this.colorBy];t=this.colorTable.getColor(s)}else e.color&&(t=e.color);if(t||(t=_x),e.alpha&&e.alpha!==1)t=Ve.addAlpha(t,e.alpha);else if(this.useScore&&e.score&&!Number.isNaN(e.score)){let s=this.config.min?this.config.min:this.viewLimitMin?this.viewLimitMin:0,r=this.config.max?this.config.max:this.viewLimitMax?this.viewLimitMax:1e3,a=n(s,r,e.score);e.alpha=a,t=Ve.addAlpha(t,a)}function n(s,r,a){let o=(r-s)/9,l=Math.floor((a-s)/o);return Math.min(1,.2+l*.8/9)}return t}dispose(){this.trackView=void 0}};function yx(i){i.browser.on&&(i.browser.on("trackdragend",e),i.browser.on("trackremoved",t));function e(){i.trackView&&i.displayMode!=="SQUISHED"&&i.trackView.updateViews()}function t(n){i.browser.un&&i===n&&(i.browser.un("trackdragend",e),i.browser.un("trackremoved",t))}}var na=class{constructor(e){this.config=e,this.browser=e.browser,this.columnFormat=e.columnFormat,this.tableRowSelectionList=[],this.tableDOM=de.div({class:"igv-roi-table"}),e.parent.appendChild(this.tableDOM),this.headerDOM=e,this.tableColumnTitles=this.tableDOM,this.tableRowContainer=this.tableDOM,this.footerDOM=e.gotoButtonHandler}set headerDOM({browser:e,parent:t,headerTitle:n,dismissHandler:s}){let r=de.div();this.tableDOM.appendChild(r);let a=de.div();r.appendChild(a),a.innerHTML=n;let o=de.div();r.appendChild(o),o.appendChild(Ui.createIcon("times")),this.boundDismissHandler=l.bind(this),o.addEventListener("click",this.boundDismissHandler);function l(f){f.stopPropagation(),s()}let{y:c}=e.root.getBoundingClientRect(),{y:h}=t.getBoundingClientRect(),d=-(h-c);Ki(this.tableDOM,r,{minX:0,minY:d}),this.tableDOM.style.display="none",this._headerDOM=r}set tableColumnTitles(e){let t=de.div({class:"igv-roi-table-column-titles"});e.appendChild(t);for(let{label:n,width:s}of this.columnFormat){let r=de.div();t.appendChild(r),r.style.width=s,r.innerText=n}this._tableColumnTitlesDOM=t}get tableColumnTitles(){return this._tableColumnTitlesDOM}set tableRowContainer(e){let t=de.div({class:"igv-roi-table-row-container"});e.appendChild(t),this._tableRowContainerDOM=t}get tableRowContainer(){return this._tableRowContainerDOM}set footerDOM(e){let t=de.div();this.tableDOM.appendChild(t);let n=de.div({class:"igv-roi-table-button"});t.appendChild(n),n.id="igv-roi-table-view-button",n.textContent="Go To",n.style.pointerEvents="none",this._footerDOM=t,this.gotoButton=n,this.boundGotoButtonHandler=e.bind(this),this.gotoButton.addEventListener("click",this.boundGotoButtonHandler)}tableRowDOMHelper(e){e.addEventListener("mousedown",t=>{t.stopPropagation(),e.classList.toggle("igv-roi-table-row-selected"),e.classList.contains("igv-roi-table-row-selected")?e.classList.remove("igv-roi-table-row-hover"):e.classList.add("igv-roi-table-row-hover"),this.setTableRowSelectionState(e.classList.contains("igv-roi-table-row-selected"))}),e.addEventListener("mouseover",t=>{e.classList.contains("igv-roi-table-row-selected")?e.classList.remove("igv-roi-table-row-hover"):e.classList.add("igv-roi-table-row-hover")}),e.addEventListener("mouseout",t=>{e.classList.remove("igv-roi-table-row-hover")})}clearTable(){let e=this.tableRowContainer.querySelectorAll(".igv-roi-table-row");for(let t of e)t.remove()}setTableRowSelectionState(e){e?this.tableRowSelectionList.push(1):this.tableRowSelectionList.pop(),this.gotoButton.style.pointerEvents=this.tableRowSelectionList.length>0?"auto":"none"}present(){this.tableDOM.style.left="0px";let{y:e}=this.browser.root.getBoundingClientRect(),{y:t}=this.config.parent.getBoundingClientRect();this.tableDOM.style.top=`${e-t}px`,this.tableDOM.style.display="flex"}dismiss(){this.tableDOM.style.display="none"}dispose(){this.tableDOM.innerHTML="",this.tableDOM.remove();for(let e of Object.keys(this))this[e]=void 0;document.removeEventListener("click",this.boundDismissHandler)}},or=class extends na{constructor(e){let t=Object.assign({width:"1024px"},e);super(t),this.descriptionDOM=e}set descriptionDOM(e){if(e.description){let t;t=de.div({class:"igv-roi-table-description"}),this.tableDOM.insertBefore(t,this.tableColumnTitles),t.style.height="auto",t.innerHTML="BLAT result for query sequence:",t=de.div({class:"igv-roi-table-description"}),this.tableDOM.insertBefore(t,this.tableColumnTitles),t.style.height="auto",t.style.maxHeight="128px",t.innerHTML=e.description,t=de.div({class:"igv-roi-table-goto-explainer"}),this.tableDOM.insertBefore(t,this.tableColumnTitles),t.innerHTML="Select one or more rows and click Go To to view the regions"}}tableRowDOM(e){let t=de.div({class:"igv-roi-table-row"}),n=e.map(s=>isFinite(s)?De(s):s);for(let s=0;s<n.length;s++){let r=de.div();t.appendChild(r);let a=this.columnFormat[s];r.style.width=a.width||"fit-content",r.innerText=n[s]}return this.tableRowDOMHelper(t),t}renderTable(e){if(Array.from(this.tableRowContainer.querySelectorAll(".igv-roi-table-row")).forEach(t=>t.remove()),e.length>0)for(let t of e){let n=this.tableRowDOM(t);this.tableRowContainer.appendChild(n)}}static getColumnFormatConfiguration(){return[{label:"chr",width:"7%"},{label:"start",width:"12%"},{label:"end",width:"12%"},{label:"strand",width:"5%"},{label:"score",width:"5%"},{label:"match",width:"5%"},{label:"mis-match",width:"7%"},{label:"rep. match",width:"7%"},{label:"N's",width:"3%"},{label:"Q gap count",width:"9%"},{label:"Q gap bases",width:"9%"},{label:"T gap count",width:"9%"},{label:"T gap bases",width:"9%"}]}static gotoButtonHandler(e){e.stopPropagation();let t=this.tableDOM.querySelectorAll(".igv-roi-table-row-selected"),n=[];for(let s of t){let r=[];s.querySelectorAll("div").forEach(c=>r.push(c.innerText));let[a,o,l]=r;n.push(`${a}:${o}-${l}`)}for(let s of this.tableDOM.querySelectorAll(".igv-roi-table-row"))s.classList.remove("igv-roi-table-row-selected");this.setTableRowSelectionState(!1),this.browser.search(n.join(" "))}},xx="https://igv.org/services/blatUCSC.php";async function kx({url:i,userSeq:e,db:t}){i=i||xx;let n=await Sx(i,e,t);return n.fields,n.blat.map(U_)}async function Sx(i="",e,t){let n=new URLSearchParams;return n.append("userSeq",e),n.append("db",t),(await fetch(i,{method:"post",body:n})).json()}var lr=25e3,rh=class extends ia{constructor(e,t){super(e,t),this.name||(this.name="Blat Results"),this.sequence=e.sequence,this.table=void 0}openTableView(){if(this.table===void 0){let e=this.config.features.map(n=>[n.chr,n.start+1,n.end,n.strand,n.score,n.matches,n.misMatches,n.repMatches,n.nCount,n.qNumInsert,n.qBaseInsert,n.tNumInsert,n.tBaseInsert]),t={browser:this.browser,parent:this.browser.parent,headerTitle:this.config.title,description:this.sequence,dismissHandler:()=>{this.table.dismiss(),this.table.dispose(),this.table=void 0},columnFormat:or.getColumnFormatConfiguration(),gotoButtonHandler:or.gotoButtonHandler};this.table=new or(t),this.table.renderTable(e)}this.table.present()}menuItemList(){let e=super.menuItemList();return e.push("<hr/>"),e.push({label:"Open table view",click:()=>this.openTableView()}),e}dispose(){super.dispose(),this.table&&this.table.popover.parentElement.removeChild(this.table.popover)}};async function uo({sequence:i,browser:e,name:t,title:n}){if(i.length>lr){e.alert.present(`Sequence size exceeds maximum allowed length (${i.length} > ${lr})`);return}let s=e.genome.id,r=e.config.blatServerURL;try{let a=await kx({url:r,userSeq:i,db:s}),o={type:"blat",name:t||"blat results",title:n||"blat results",sequence:i,altColor:"rgb(176, 176, 236)",color:"rgb(236, 176, 176)",features:a};(await e.loadTrack(o)).openTableView()}catch(a){e.alert.present(`Error performing blat search:  ${a}`)}}var ju=5,po=5,Gu="rgb(185, 185, 185)",Cx="rgb(150, 150, 150)",Ex="rgb(200, 200, 200)",Zu=20,sh=class extends kt{static defaults={alleleFreqThreshold:.2,visibilityWindow:3e4,showCoverage:!0,showAlignments:!0,viewAsPairs:!1,pairsSupported:!0,showSoftClips:!1,showAllBases:!1,showInsertions:!0,showMismatches:!0,height:300,coverageTrackHeight:50};constructor(e,t){super(e,t)}init(e){this.type="alignment",this.featureSource=new Kl(e,this.browser),this.coverageTrack=new ah(e,this),this.alignmentTrack=new oh(e,this),super.init(e),this.alignmentTrack.setTop(this.coverageTrack,this.showCoverage),this.showAlignments||(this._height=this.coverageTrackHeight),e.sort&&(Array.isArray(e.sort)?this.assignSort(e.sort[0]):this.assignSort(e.sort))}set height(e){this._height=e,this.showAlignments&&(this.alignmentTrack.height=this.showCoverage?e-this.coverageTrackHeight:e)}get height(){return this._height}get minTemplateLength(){let e=this.config.minTLEN!==void 0?this.config.minTLEN:this.config.minFragmentLength;return e!==void 0?e:this._pairedEndStats?this._pairedEndStats.minTLEN:0}get maxTemplateLength(){let e=this.config.maxTLEN!==void 0?this.config.maxTLEN:this.config.maxFragmentLength;return e!==void 0?e:this._pairedEndStats?this._pairedEndStats.maxTLEN:1e3}sort(e){e=this.assignSort(e);for(let t of this.trackView.viewports)if(t.containsPosition(e.chr,e.position)){let n=t.cachedFeatures;n&&(n.sortRows(e),t.repaint())}}assignSort(e){if(e.locus){let t=zb(e.locus);e.chr=t.chr,e.position=t.start}else e.position--;return e.direction=e.direction==="ASC"||e.direction===!0,e.chr=this.browser.genome.getChromosomeName(e.chr),this.sortObject=e,this.sortObject}async getFeatures(e,t,n,s,r){let a=await this.featureSource.getAlignments(e,t,n);if(a.paired&&!this._pairedEndStats&&!this.config.maxFragmentLength){let l=new nh(a.alignments,this.config);l.totalCount>99&&(this._pairedEndStats=l)}a.alignments=void 0;let o=this.sortObject;return o&&o.chr===e&&o.position>=t&&o.position<=n&&a.sortRows(o),a}computePixelHeight(e){return(this.showCoverage?this.coverageTrackHeight:0)+(this.showAlignments?this.alignmentTrack.computePixelHeight(e):0)}draw(e){he.fillRect(e.context,0,e.pixelTop,e.pixelWidth,e.pixelHeight,{fillStyle:"rgb(255, 255, 255)"}),this.showCoverage===!0&&this.coverageTrackHeight>0?(this.trackView.axisCanvas.style.display="block",this.coverageTrack.draw(e)):this.trackView.axisCanvas.style.display="none",this.showAlignments===!0&&(this.alignmentTrack.setTop(this.coverageTrack,this.showCoverage),this.alignmentTrack.draw(e))}paintAxis(e,t,n){this.coverageTrack.paintAxis(e,t,this.coverageTrackHeight)}contextMenuItemList(e){return this.alignmentTrack.contextMenuItemList(e)}popupData(e){return this.showCoverage===!0&&e.y>=this.coverageTrack.top&&e.y<this.coverageTrackHeight?this.coverageTrack.popupData(e):this.alignmentTrack.popupData(e)}clickedFeatures(e){let t;return this.showCoverage===!0&&e.y>=this.coverageTrack.top&&e.y<this.coverageTrackHeight?t=this.coverageTrack.getClickedObject(e):t=this.alignmentTrack.getClickedObject(e),t?[t]:void 0}hoverText(e){if(this.showCoverage===!0&&e.y>=this.coverageTrack.top&&e.y<this.coverageTrackHeight){let t=this.coverageTrack.getClickedObject(e);if(t)return t.hoverText()}}menuItemList(){let e=[];e=e.concat(Xt.numericDataMenuItems(this.trackView)),e.push("<hr/>");let t=pe('<div class="igv-track-menu-category">');t.text("Color by:"),e.push({name:void 0,object:t,click:void 0,init:void 0});let n=[{key:"strand",label:"read strand"}];this.alignmentTrack.hasPairs&&(n.push({key:"firstOfPairStrand",label:"first-of-pair strand"}),n.push({key:"pairOrientation",label:"pair orientation"}),n.push({key:"tlen",label:"insert size (TLEN)"}),n.push({key:"unexpectedPair",label:"pair orientation & insert size (TLEN)"}));let s="tag"+(this.alignmentTrack.colorByTag?" ("+this.alignmentTrack.colorByTag+")":"");n.push({key:"tag",label:s});for(let o of n){let l=this.alignmentTrack.colorBy===o.key;e.push(this.colorByCB(o,l))}let r=()=>{if(!this.autoHeight){let o=(this.showCoverage?this.coverageTrackHeight:0)+(this.showAlignments?this.alignmentTrack.height:0);this.trackView.setTrackHeight(o)}};e.push("<hr/>"),e.push({object:pe(ot("Show Coverage",this.showCoverage)),click:()=>{this.showCoverage=!this.showCoverage,r(),this.trackView.checkContentHeight(),this.trackView.repaintViews()}}),e.push({object:pe(ot("Show Alignments",this.showAlignments)),click:()=>{this.showAlignments=!this.showAlignments,r(),this.trackView.checkContentHeight(),this.trackView.repaintViews()}}),e.push("<hr/>"),e.push({object:pe(ot("Show all bases",this.showAllBases)),click:()=>{this.showAllBases=!this.showAllBases,this.config.showAllBases=this.showAllBases,this.trackView.repaintViews()}}),e.push("<hr/>"),e.push({object:pe(ot("Show mismatches",this.showMismatches)),click:()=>{this.showMismatches=!this.showMismatches,this.config.showMismatches=this.showMismatches,this.trackView.repaintViews()}}),e.push({object:pe(ot("Show insertions",this.showInsertions)),click:()=>{this.showInsertions=!this.showInsertions,this.config.showInsertions=this.showInsertions,this.getCachedAlignmentContainers(),this.trackView.repaintViews()}}),e.push({object:pe(ot("Show soft clips",this.showSoftClips)),click:()=>{this.showSoftClips=!this.showSoftClips,this.config.showSoftClips=this.showSoftClips,this.featureSource.setShowSoftClips(this.showSoftClips);let o=this.getCachedAlignmentContainers();for(let l of o)l.setShowSoftClips(this.showSoftClips);this.trackView.repaintViews()}}),this.pairsSupported&&this.alignmentTrack.hasPairs&&(e.push("<hr/>"),e.push({object:pe(ot("View as pairs",this.viewAsPairs)),click:()=>{this.viewAsPairs=!this.viewAsPairs,this.config.viewAsPairs=this.viewAsPairs,this.featureSource.setViewAsPairs(this.viewAsPairs);let o=this.getCachedAlignmentContainers();for(let l of o)l.setViewAsPairs(this.viewAsPairs);this.trackView.repaintViews()}})),this.browser.circularView&&(this.alignmentTrack.hasPairs||this.alignmentTrack.hasSupplemental)&&(e.push("<hr/>"),this.alignmentTrack.hasPairs&&e.push({label:"Add discordant pairs to circular view",click:()=>{for(let o of this.trackView.viewports)this.addPairedChordsForViewport(o)}}),this.alignmentTrack.hasSupplemental&&e.push({label:"Add split reads to circular view",click:()=>{for(let o of this.trackView.viewports)this.addSplitChordsForViewport(o)}})),e.push("<hr/>");let a=pe('<div class="igv-track-menu-category">');return a.text("Display mode:"),e.push({name:void 0,object:a,click:void 0,init:void 0}),e.push({object:pe(ot("expand",this.alignmentTrack.displayMode==="EXPANDED")),click:()=>{this.alignmentTrack.displayMode="EXPANDED",this.config.displayMode="EXPANDED",this.trackView.checkContentHeight(),this.trackView.repaintViews()}}),e.push({object:pe(ot("squish",this.alignmentTrack.displayMode==="SQUISHED")),click:()=>{this.alignmentTrack.displayMode="SQUISHED",this.config.displayMode="SQUISHED",this.trackView.checkContentHeight(),this.trackView.repaintViews()}}),e}colorByCB(e,t){return{name:void 0,object:pe(ot(e.label,t)),click:r=>{e.key!=="tag"?e.key===this.alignmentTrack.colorBy?(this.alignmentTrack.colorBy="none",this.config.colorBy="none",this.trackView.repaintViews()):(this.alignmentTrack.colorBy=e.key,this.config.colorBy=e.key,this.trackView.repaintViews()):this.browser.inputDialog.present({label:"Tag Name",value:this.alignmentTrack.colorByTag?this.alignmentTrack.colorByTag:"",callback:a=>{a?(this.alignmentTrack.colorBy="tag",this.alignmentTrack.colorByTag=a,this.alignmentTrack.tagColors||(this.alignmentTrack.tagColors=new ji("Set1"))):(this.alignmentTrack.colorBy="none",this.alignmentTrack.colorByTag=""),this.trackView.repaintViews()}},r)},init:void 0}}getState(){let e=super.getState();return this.sortObject&&(e.sort={chr:this.sortObject.chr,position:this.sortObject.position+1,option:this.sortObject.option,direction:this.sortObject.direction?"ASC":"DESC"}),e}getCachedAlignmentContainers(){return this.trackView.viewports.map(e=>e.cachedFeatures)}get dataRange(){return this.coverageTrack.dataRange}set dataRange(e){this.coverageTrack.dataRange=e}get logScale(){return this.coverageTrack.logScale}set logScale(e){this.coverageTrack.logScale=e}get autoscale(){return this.coverageTrack.autoscale}set autoscale(e){this.coverageTrack.autoscale=e}addPairedChordsForViewport(e){let t=this.maxTemplateLength,n=[],s=e.referenceFrame;for(let a of e.cachedFeatures.allAlignments())a.end>=s.start&&a.start<=s.end&&(a.paired?a.end-a.start>t&&n.push(a):a.mate&&a.mate.chr&&(a.mate.chr!==a.chr||Math.max(a.fragmentLength)>t)&&n.push(a));let r=ox(n);ta(r,this,s,.02)}addSplitChordsForViewport(e){let t=[],n=e.referenceFrame;for(let r of e.cachedFeatures.allAlignments()){let a=r.hasTag("SA");r.end>=n.start&&r.start<=n.end&&a&&t.push(r)}let s=lx(t);ta(s,this,n,.02)}},ah=class{constructor(e,t){this.parent=t,this.featureSource=t.featureSource,this.paintAxis=Bn,this.top=0,this.autoscale=e.autoscale||e.max===void 0,this.autoscale||(this.dataRange={min:e.min||0,max:e.max})}get height(){return this.parent.coverageTrackHeight}draw(e){let t=e.pixelTop;t+e.pixelHeight;let n=this.parent.browser.nucleotideColors;if(t>this.height)return;let s=e.context,a=e.features.coverageMap,o;a.refSeq&&(o=a.refSeq.toUpperCase());let l=e.bpPerPixel,c=e.bpStart,h=e.pixelWidth,d=c+h*l+1,f;this.parent.coverageColor?f=this.parent.coverageColor:this.parent.color&&typeof this.parent.color!="function"?f=Ve.darkenLighten(this.parent.color,-35):f=Cx,he.setProperties(s,{fillStyle:f,strokeStyle:f});let u=Math.max(1,Math.ceil(1/l));for(let g=0,_=a.coverage.length;g<_;g++){let b=a.bpStart+g;if(b<c)continue;if(b>d)break;let w=a.coverage[g];if(!w)continue;let p=Math.round(w.total/this.dataRange.max*this.height),m=this.height-p,v=Math.floor((b-c)/l);he.fillRect(s,v,m,u,p)}if(o)for(let g=0,_=a.coverage.length;g<_;g++){let b=a.bpStart+g;if(b<c)continue;if(b>d)break;let w=a.coverage[g];if(!w)continue;let p=w.total/this.dataRange.max*this.height,m=this.height-p,v=Math.floor((b-c)/l),x=o[g];if(w.isMismatch(x)){he.setProperties(s,{fillStyle:n[x]}),he.fillRect(s,v,m,u,p);let R=0;for(let M of["A","C","T","G"]){let L=(w["pos"+M]+w["neg"+M])/this.dataRange.max*this.height;m=this.height-L-R,R+=L,he.setProperties(s,{fillStyle:n[M]}),he.fillRect(s,v,m,u,L)}}}}getClickedObject(e){let t=e.viewport.cachedFeatures;if(!t||t.length===0)return;let n=Math.floor(e.genomicLocation),s=t.coverageMap,r=Math.floor(n-s.bpStart);return s.coverage[r]}popupData(e){let t=[],n=this.getClickedObject(e);if(n){let s=Math.floor(e.genomicLocation),r=e.viewport.referenceFrame;t.push(r.chr+":"+De(1+s)),t.push({name:"Total Count",value:n.total});let a=n.posA+n.negA;a>0&&(a=a.toString()+" ("+Math.round(a/n.total*100)+"%, "+n.posA+"+, "+n.negA+"- )"),t.push({name:"A",value:a}),a=n.posC+n.negC,a>0&&(a=a.toString()+" ("+Math.round(a/n.total*100)+"%, "+n.posC+"+, "+n.negC+"- )"),t.push({name:"C",value:a}),a=n.posG+n.negG,a>0&&(a=a.toString()+" ("+Math.round(a/n.total*100)+"%, "+n.posG+"+, "+n.negG+"- )"),t.push({name:"G",value:a}),a=n.posT+n.negT,a>0&&(a=a.toString()+" ("+Math.round(a/n.total*100)+"%, "+n.posT+"+, "+n.negT+"- )"),t.push({name:"T",value:a}),a=n.posN+n.negN,a>0&&(a=a.toString()+" ("+Math.round(a/n.total*100)+"%, "+n.posN+"+, "+n.negN+"- )"),t.push({name:"N",value:a}),t.push("<HR/>"),t.push({name:"DEL",value:n.del.toString()}),t.push({name:"INS",value:n.ins.toString()})}return t}},oh=class{constructor(e,t){this.parent=t,this.browser=t.browser,this.featureSource=t.featureSource,this.top=e.coverageTrackHeight===0?0:e.coverageTrackHeight+5,this.displayMode=e.displayMode||"EXPANDED",this.alignmentRowHeight=e.alignmentRowHeight||14,this.squishedRowHeight=e.squishedRowHeight||3,this.negStrandColor=e.negStrandColor||"rgba(150, 150, 230, 0.75)",this.posStrandColor=e.posStrandColor||"rgba(230, 150, 150, 0.75)",this.insertionColor=e.insertionColor||"rgb(138, 94, 161)",this.insertionTextColor=e.insertionTextColor||"white",this.showInsertionText=e.showInsertionText===void 0?!1:!!e.showInsertionText,this.deletionColor=e.deletionColor||"black",this.deletionTextColor=e.deletionTextColor||"black",this.showDeletionText=e.showDeletionText===void 0?!1:!!e.showDeletionText,this.skippedColor=e.skippedColor||"rgb(150, 170, 170)",this.pairConnectorColor=e.pairConnectorColor,this.smallTLENColor=e.smallTLENColor||e.smallFragmentLengthColor||"rgb(0, 0, 150)",this.largeTLENColor=e.largeTLENColor||e.largeFragmentLengthColor||"rgb(200, 0, 0)",this.pairOrientation=e.pairOrienation||"fr",this.pairColors={},this.pairColors.RL=e.rlColor||"rgb(0, 150, 0)",this.pairColors.RR=e.rrColor||"rgb(20, 50, 200)",this.pairColors.LL=e.llColor||"rgb(0, 150, 150)",this.colorBy=e.colorBy||"unexpectedPair",this.colorByTag=e.colorByTag?e.colorByTag.toUpperCase():void 0,this.bamColorTag=e.bamColorTag===void 0?"YC":e.bamColorTag,this.hideSmallIndels=e.hideSmallIndels,this.indelSizeThreshold=e.indelSizeThreshold||1,this.hasPairs=!1,this.hasSupplemental=!1}setTop(e,t){this.top=e.height===0||t===!1?0:5+e.height}computePixelHeight(e){if(e.packedAlignmentRows){let t=e.hasDownsampledIntervals()?po+ju:0,n=this.displayMode==="SQUISHED"?this.squishedRowHeight:this.alignmentRowHeight;return t+n*e.packedAlignmentRows.length+5}else return 0}draw(e){let t=e.features,n=e.context,s=e.bpPerPixel,r=e.bpStart,a=e.pixelWidth,o=r+a*s+1,l=this.parent.showSoftClips,c=this.parent.showAllBases,h=this.browser.nucleotideColors,d=t.packedAlignmentRows;n.save();let f=t.sequence;f&&(f=f.toUpperCase());let u=0,g=e.pixelTop;this.top&&n.translate(0,this.top);let _=g+e.pixelHeight;t.hasDownsampledIntervals()?(u=po+ju,t.downsampledIntervals.forEach(function(m){var v=(m.start-r)/s,x=(m.end-r)/s;x-v>5&&(v+=1,x-=1),he.fillRect(n,v,2,x-v,po-2,{fillStyle:"black"})})):u=0,this.alignmentsYOffset=u;let b=this.displayMode==="SQUISHED"?this.squishedRowHeight:this.alignmentRowHeight;if(d){let m=d.length;for(let v=0;v<m;v++){let x=d[v],R=u+b*v,M=b<=4?b:b-2;if(R>_)break;if(R+M<g)continue;for(let C of x.alignments)if(this.hasPairs=this.hasPairs||C.isPaired(),this.browser.circularView&&(this.hasSupplemental=this.hasSupplemental||C.hasTag("SA")),!(C.start+C.lengthOnRef<r)){if(C.start>o)break;C.hidden!==!0&&(C instanceof Ai?(w.call(this,C,R,M),p.call(this,C.firstAlignment,R,M),C.secondAlignment&&p.call(this,C.secondAlignment,R,M)):p.call(this,C,R,M))}}}n.restore();function w(m,v,x){var R=this.getConnectorColor(m.firstAlignment),M=(m.connectingStart-r)/s,C=(m.connectingEnd-r)/s,L=v+x/2;m.connectingEnd<r||m.connectingStart>o||(m.mq<=0&&(R=Ve.addAlpha(R,.15)),he.setProperties(n,{fillStyle:R,strokeStyle:R}),he.strokeLine(n,M,L,C,L))}function p(m,v,x){if(m.start+m.lengthOnRef<r||m.start>o)return;let R=l?m.blocks:m.blocks.filter(k=>k.type!=="S"),M=this.getAlignmentColor(m),C=M;m.mq<=0&&(M=Ve.addAlpha(M,.15)),he.setProperties(n,{fillStyle:M,strokeStyle:C});let L=[];for(let k=0;k<R.length;k++){let A=R[k];if(!(k!==R.length-1&&R[k+1].start<r)&&(L.push(...y.call(this,A,k)),A.start+A.len>o))break}if(m.gaps){let k=v+x/2;for(let A of m.gaps){let I=(A.start-r)/s,F=(A.start+A.len-r)/s,X=F-I,U=A.len.toString(),V=U.length*6,q=I+X/2,S=A.type==="D"?this.deletionColor:this.skippedColor;if(he.strokeLine(n,I,k,F,k,{strokeStyle:S,lineWidth:2}),this.showDeletionText&&A.len>1&&X>=V+8){let P=q-V/2;he.fillRect(n,P-1,v-1,V+2,12,{fillStyle:"white"}),he.fillText(n,U,P,v+10,{font:"normal 10px monospace",fillStyle:this.deletionTextColor})}}}if(m.insertions&&this.parent.showInsertions){let k=-1;for(let A of m.insertions){if(this.hideSmallIndels&&A.len<=this.indelSizeThreshold||A.start<r)continue;if(A.start>o)break;let I=A.start-r,F=A.len.toString(),X=2+F.length*6,U=!this.showInsertionText||A.len===1?2:Math.round(A.len/s),V=Math.max(Math.min(X,U),2),q=I/s-V/2;if(q-k>2){let S={fillStyle:this.insertionColor};he.fillRect(n,q-2,v,V+4,2,S),he.fillRect(n,q,v+2,V,x-4,S),he.fillRect(n,q-2,v+x-2,V+4,2,S),this.showInsertionText&&A.len>1&&U>X&&he.fillText(n,F,q+1,v+10,{font:"normal 10px monospace",fillStyle:this.insertionTextColor}),k=q}}}L.forEach(({bbox:k,baseColor:A,readChar:I})=>{E(n,s,k,A,I)});function y(k,A){let I=[],F=k.start-t.start,X=(k.start-r)/s,U=(k.start+k.len-r)/s,V=Math.max(1,U-X),q=100/s,S=Math.min(b/2,q/6),P=k.type==="S",H=m.mq<=0||this.highlightedAlignmentReadNamed===m.readName||P,D=C;this.highlightedAlignmentReadNamed===m.readName?D="red":P&&(D="rgb(50,50,50)");let O=m.strand===!0&&A===R.length-1,W=m.strand===!1&&A===0;if(O|W){let G,Z;O?(G=[X,U,U+S,U,X,X],Z=[v,v,v+x/2,v+x,v+x,v]):W&&(G=[U,X,X-S,X,U,U],Z=[v,v,v+x/2,v+x,v+x,v]),he.fillPolygon(n,G,Z,{fillStyle:M}),H&&he.strokePolygon(n,G,Z,{strokeStyle:D})}else he.fillRect(n,X,v,V,x,{fillStyle:M}),H&&(n.save(),n.strokeStyle=D,n.strokeRect(X,v,V,x),n.restore());if(P||c||this.parent.showMismatches&&f&&m.seq&&m.seq!=="*"){let G=m.seq?m.seq.toUpperCase():void 0,Z=m.qual,te=k.seqOffset,se=Math.max(1,1/s);for(let re=0,ae=k.len;re<ae;re++){let me=(k.start+re-r)/s;if(me+se<0)continue;if(me>a)break;let ue=G?G.charAt(te+re):"",Se=F+re>=0?f.charAt(F+re):"";if(ue==="="&&(ue=Se),ue==="X"||Se!==ue||P||c){let _e;if(!P&&Z!==void 0&&Z.length>te+re){let ge=Z[te+re];_e=Ax(ge,h[ue])}else _e=h[ue];_e&&I.push({bbox:{x:me,y:v,width:se,height:x},baseColor:_e,readChar:ue})}}}return I}function E(k,A,I,F,X){var U,V;if(U=1/10,A<=U&&I.height>=8){let q=Math.min(10,I.height);k.font=""+q+"px sans-serif",V=I.x+I.width/2,he.strokeText(k,X,V-k.measureText(X).width/2,q-1+I.y,{strokeStyle:F})}else he.fillRect(k,I.x,I.y,I.width,I.height,{fillStyle:F})}}}popupData(e){let t=this.getClickedObject(e);return t?t.popupData(e.genomicLocation):void 0}contextMenuItemList(e){let t=e.viewport,n=[],s=a=>{let o=this.parent.sortObject,l=o&&o.position===Math.floor(e.genomicLocation)?!o.direction:!0,c={chr:t.referenceFrame.chr,position:Math.floor(e.genomicLocation),option:a,direction:l};this.parent.sortObject=c,t.cachedFeatures.sortRows(c),t.repaint()};n.push("<b>Sort by...</b>"),n.push({label:"&nbsp; base",click:()=>s("BASE")}),n.push({label:"&nbsp; read strand",click:()=>s("STRAND")}),n.push({label:"&nbsp; insert size",click:()=>s("INSERT_SIZE")}),n.push({label:"&nbsp; gap size",click:()=>s("GAP_SIZE")}),n.push({label:"&nbsp; chromosome of mate",click:()=>s("MATE_CHR")}),n.push({label:"&nbsp; mapping quality",click:()=>s("MQ")}),n.push({label:"&nbsp; read name",click:()=>s("READ_NAME")}),n.push({label:"&nbsp; aligned read length",click:()=>s("ALIGNED_READ_LENGTH")}),n.push({label:"&nbsp; tag",click:()=>{let a=this.parent.sortObject,o=a&&a.position===Math.floor(e.genomicLocation)?!a.direction:!0,l={label:"Tag Name",value:this.sortByTag?this.sortByTag:"",callback:c=>{if(c){let h={chr:t.referenceFrame.chr,position:Math.floor(e.genomicLocation),option:"TAG",tag:c,direction:o};this.sortByTag=c,this.parent.sortObject=h,t.cachedFeatures.sortRows(h),t.repaint()}}};this.browser.inputDialog.present(l,e.event)}}),n.push("<hr/>");let r=this.getClickedObject(e);if(r){let a=this.parent.showSoftClips,o=typeof r.alignmentContaining=="function"?r.alignmentContaining(e.genomicLocation,a):r;if(o){o.isPaired()&&o.isMateMapped()&&n.push({label:"View mate in split screen",click:()=>{if(o.mate){let c=e.viewport.referenceFrame;if(this.browser.genome.getChromosome(o.mate.chr)){this.highlightedAlignmentReadNamed=o.readName;let h=c.end-c.start,d=o.mate.position-h/2,f=o.mate.position+h/2;this.browser.addMultiLocusPanel(o.mate.chr,d,f,c)}else this.browser.alert.present(`Reference does not contain chromosome: ${o.mate.chr}`)}},init:void 0}),n.push({label:"View read sequence",click:()=>{let c=o.seq;!c||c==="*"?this.browser.alert.present("Read sequence: *"):this.browser.alert.present(c)}}),bc()&&n.push({label:"Copy read sequence",click:async()=>{let c=o.seq;try{await navigator.clipboard.writeText(c)}catch(h){console.error(h),this.browser.alert.present(`error copying sequence to clipboard ${h}`)}}});let l=o.seq;if(l&&l!="*"){l.length<lr&&n.push({label:"BLAT read sequence",click:()=>{let h=o.isNegativeStrand()?Pi(l):l,d=`${o.readName} - blat`,f=`${this.parent.name} - ${d}`;uo({sequence:h,browser:this.browser,name:d,title:f})}});let c=o.softClippedBlocks();c.left&&c.left.len>Zu&&c.left.len<lr&&n.push({label:"BLAT left soft-clipped sequence",click:()=>{let h=l.substr(c.left.seqOffset,c.left.len),d=o.isNegativeStrand()?Pi(h):h,f=`${o.readName} - blat left clip`,u=`${this.parent.name} - ${f}`;uo({sequence:d,browser:this.browser,name:f,title:u})}}),c.right&&c.right.len>Zu&&c.right.len<lr&&n.push({label:"BLAT right soft-clipped sequence",click:()=>{let h=l.substr(c.right.seqOffset,c.right.len),d=o.isNegativeStrand()?Pi(h):h,f=`${o.readName} - blat right clip`,u=`${this.parent.name} - ${f}`;uo({sequence:d,browser:this.browser,name:f,title:u})}})}n.push("<hr/>")}}return this.browser.circularView&&(this.hasPairs||this.hasSupplemental)&&(this.hasPairs&&n.push({label:"Add discordant pairs to circular view",click:()=>{this.parent.addPairedChordsForViewport(t)}}),this.hasSupplemental&&n.push({label:"Add split reads to circular view",click:()=>{this.parent.addSplitChordsForViewport(t)}}),n.push("<hr/>")),n}getClickedObject(e){let t=e.viewport,n=e.y,s=e.genomicLocation,r=this.parent.showSoftClips,a=t.cachedFeatures;if(!a||a.length===0)return;let o=a.packedAlignmentRows,l=a.downsampledIntervals,c=this.displayMode==="SQUISHED"?this.squishedRowHeight:this.alignmentRowHeight,h=Math.floor((n-this.top-this.alignmentsYOffset)/c);if(h<0){for(let d=0;d<l.length;d++)if(l[d].start<=s&&l[d].end>=s)return l[d]}else if(h<o.length){let f=o[h].alignments.filter(u=>u.containsLocation(s,r));if(f.length>0)return f[0]}}getConnectorColor(e){if(this.pairConnectorColor)return this.pairConnectorColor;switch(this.colorBy){case"strand":case"firstOfPairStrand":case"pairOrientation":case"tag":return this.parent.color?typeof this.parent.color=="function"?this.parent.color(e):this.parent.color:Ex;default:return this.getAlignmentColor(e)}}getAlignmentColor(e){let t=Gu;this.parent.color?t=typeof this.parent.color=="function"?this.parent.color(e):this.parent.color:t=Gu;let n=this.colorBy;switch(n){case"strand":t=e.strand?this.posStrandColor:this.negStrandColor;break;case"firstOfPairStrand":e instanceof Ai?t=e.firstOfPairStrand()?this.posStrandColor:this.negStrandColor:e.isPaired()&&(e.isFirstOfPair()?t=e.strand?this.posStrandColor:this.negStrandColor:e.isSecondOfPair()?t=e.strand?this.negStrandColor:this.posStrandColor:console.error("ERROR. Paired alignments are either first or second."));break;case"unexpectedPair":case"pairOrientation":if(this.pairOrientation&&e.pairOrientation){let r=Tx[this.pairOrientation];if(r){let a=this.pairColors[r[e.pairOrientation]];if(a){t=a;break}}}if(n==="pairOrientation")break;case"tlen":case"fragmentLength":e.mate&&e.isMateMapped()&&(e.mate.chr!==e.chr?t=Mn(e.mate.chr):this.parent.minTemplateLength&&Math.abs(e.fragmentLength)<this.parent.minTemplateLength?t=this.smallTLENColor:this.parent.maxTemplateLength&&Math.abs(e.fragmentLength)>this.parent.maxTemplateLength&&(t=this.largeTLENColor));break;case"tag":let s=e.tags()[this.colorByTag];s!==void 0&&(this.bamColorTag===this.colorByTag?t="rgb("+s+")":(this.tagColors||(this.tagColors=new ji("Set1")),t=this.tagColors.getColor(s)));break}return t}};function Ax(i,e){let s;return i<5?s=.1:s=Math.max(.1,Math.min(1,.1+.9*(i-5)/15)),s=Math.round(s*10)/10,s<1&&(e=Ve.addAlpha(e,s)),e}var Tx={fr:{F1R2:"LR",F2R1:"LR",F1F2:"LL",F2F1:"LL",R1R2:"RR",R2R1:"RR",R1F2:"RL",R2F1:"RL"},rf:{R1F2:"LR",R2F1:"LR",R1R2:"LL",R2R1:"LL",F1F2:"RR",F2F1:"RR",F1R2:"RL",F2R1:"RL"},ff:{F2F1:"LR",R1R2:"LR",F2R1:"LL",R1F2:"LL",R2F1:"RR",F1R2:"RR",R2R1:"RL",F1F2:"RL"}};function Mn(i){if(dn[i])return dn[i];if(dn["chr"+i]){let e=dn["chr"+i];return dn[i]=e,e}else{let e=Ve.randomRGB(0,255);return dn[i]=e,e}}var dn={chrX:"rgb(204, 153, 0)",chrY:"rgb(153, 204, 0)",chrUn:"rgb(50, 50, 50)",chr1:"rgb(80, 80, 255)",chrI:"rgb(139, 155, 187)",chr2:"rgb(206, 61, 50)",chrII:"rgb(206, 61, 50)",chr2a:"rgb(216, 71, 60)",chr2b:"rgb(226, 81, 70)",chr3:"rgb(116, 155, 88)",chrIII:"rgb(116, 155, 88)",chr4:"rgb(240, 230, 133)",chrIV:"rgb(240, 230, 133)",chr5:"rgb(70, 105, 131)",chr6:"rgb(186, 99, 56)",chr7:"rgb(93, 177, 221)",chr8:"rgb(128, 34, 104)",chr9:"rgb(107, 215, 107)",chr10:"rgb(213, 149, 167)",chr11:"rgb(146, 72, 34)",chr12:"rgb(131, 123, 141)",chr13:"rgb(199, 81, 39)",chr14:"rgb(213, 143, 92)",chr15:"rgb(122, 101, 165)",chr16:"rgb(228, 175, 105)",chr17:"rgb(59, 27, 83)",chr18:"rgb(205, 222, 183)",chr19:"rgb(97, 42, 121)",chr20:"rgb(174, 31, 99)",chr21:"rgb(231, 199, 111)",chr22:"rgb(90, 101, 94)",chr23:"rgb(204, 153, 0)",chr24:"rgb(153, 204, 0)",chr25:"rgb(51, 204, 0)",chr26:"rgb(0, 204, 51)",chr27:"rgb(0, 204, 153)",chr28:"rgb(0, 153, 204)",chr29:"rgb(10, 71, 255)",chr30:"rgb(71, 117, 255)",chr31:"rgb(255, 194, 10)",chr32:"rgb(255, 209, 71)",chr33:"rgb(153, 0, 51)",chr34:"rgb(153, 26, 0)",chr35:"rgb(153, 102, 0)",chr36:"rgb(128, 153, 0)",chr37:"rgb(51, 153, 0)",chr38:"rgb(0, 153, 26)",chr39:"rgb(0, 153, 102)",chr40:"rgb(0, 128, 153)",chr41:"rgb(0, 51, 153)",chr42:"rgb(26, 0, 153)",chr43:"rgb(102, 0, 153)",chr44:"rgb(153, 0, 128)",chr45:"rgb(214, 0, 71)",chr46:"rgb(255, 20, 99)",chr47:"rgb(0, 214, 143)",chr48:"rgb(20, 255, 177)"},Xu,pn,Mx=1e4,lh=class extends kr{constructor(e,t,n,s){super(e,t,n,s)}get contentDiv(){return this.$viewport.get(0)}initializationHelper(){this.$multiLocusCloseButton=pe("<div>",{class:"igv-multi-locus-close-button"}),this.$viewport.append(this.$multiLocusCloseButton),this.$multiLocusCloseButton.get(0).appendChild(Ui.createIcon("times-circle")),this.$multiLocusCloseButton.click(()=>{this.browser.removeMultiLocusPanel(this.referenceFrame)}),this.$rulerLabel=pe("<div>",{class:"igv-multi-locus-ruler-label"}),this.$viewport.append(this.$rulerLabel);let e;e=document.createElement("div"),this.$rulerLabel.append(pe(e)),this.$rulerLabel.get(0).addEventListener("click",async t=>{t.stopPropagation(),await this.browser.gotoMultilocusPanel(this.referenceFrame)}),this.$tooltip=pe("<div>",{class:"igv-ruler-tooltip"}),this.$tooltip.height(this.$viewport.height()),this.$viewport.append(this.$tooltip),this.$tooltipContent=pe("<div>"),this.$tooltip.append(this.$tooltipContent),this.rulerSweeper=new Ul(this,this.$viewport.get(0).parentElement,this.browser,this.referenceFrame),this.attachMouseHandlers(mt.isWholeGenomeView(this.referenceFrame.chr)),this.$tooltip.hide(),this.dismissLocusLabel()}presentLocusLabel(e){this.$multiLocusCloseButton.show(),this.$rulerLabel.show(),this.$rulerLabel.get(0).style.backgroundColor=Mn(this.referenceFrame.chr);let t=this.$rulerLabel.get(0).querySelector("div"),{width:n}=this.$rulerLabel.get(0).getBoundingClientRect();t.innerHTML=`${this.referenceFrame.getMultiLocusLabel(e)}`;let{width:s}=t.getBoundingClientRect();s/n>.5&&(t.innerHTML=`${this.referenceFrame.getMultiLocusLabelBPLengthOnly(e)}`)}dismissLocusLabel(){this.$rulerLabel.hide(),this.$multiLocusCloseButton.hide()}attachMouseHandlers(e){if(this.namespace=`.ruler_track_viewport_${this.browser.referenceFrameList.indexOf(this.referenceFrame)}`,this.$viewport.off(this.namespace),e===!0){let t=this.browser.referenceFrameList.indexOf(this.referenceFrame),n=`click${this.namespace}`;this.$viewport.on(n,s=>{let{x:r}=de.translateMouseCoordinates(s,this.$viewport.get(0)),a=Math.round(this.referenceFrame.start+this.referenceFrame.toBP(r)),o,{chr:l}=this.browser.genome.getChromosomeCoordinate(a);if(this.browser.referenceFrameList.length===1)o=l;else{let c=this.browser.referenceFrameList.map(({locusSearchString:h})=>h);c[t]=l,o=c.join(" ")}this.browser.search(o)}),this.$viewport.get(0).style.cursor="pointer"}else this.$viewport.get(0).style.cursor="default"}mouseMove(e){if(this.browser.cursorGuideVisible===!0){if(pn===void 0?(pn=this,this.$tooltip.show()):pn.guid!==this.guid?(pn.$tooltip&&pn.$tooltip.hide(),this.$tooltip.show(),pn=this):this.$tooltip.show(),this.browser.isMultiLocusWholeGenomeView()||mt.isWholeGenomeView(this.referenceFrame.chr)){this.$tooltip.hide();return}let{x:n}=de.translateMouseCoordinates(e,this.$viewport.get(0)),{start:s,bpPerPixel:r}=this.referenceFrame,a=Math.round(.5+s+Math.max(0,n)*r);this.$tooltipContent.text(De(a));let{width:o}=this.$tooltipContent.get(0).getBoundingClientRect(),{width:l}=this.$viewport.get(0).getBoundingClientRect();this.$tooltip.css({left:`${gt.clamp(n,0,l-o)}px`}),clearTimeout(Xu),Xu=setTimeout(()=>{this.$tooltip&&this.$tooltip.hide()},Mx)}}startSpinner(){}stopSpinner(){}dispose(){this.rulerSweeper.dispose(),super.dispose()}},hh=class extends kr{constructor(e,t,n,s){super(e,t,n,s)}initializationHelper(){this.canvas=document.createElement("canvas"),this.canvas.className="igv-ideogram-canvas",this.$viewport.append(pe(this.canvas)),this.ideogram_ctx=this.canvas.getContext("2d"),this.addMouseHandlers()}addMouseHandlers(){this.addViewportClickHandler(this.$viewport.get(0))}addViewportClickHandler(e){this.boundClickHandler=t.bind(this),e.addEventListener("click",this.boundClickHandler);function t(n){let{xNormalized:s,width:r}=de.translateMouseCoordinates(n,this.ideogram_ctx.canvas),{bpLength:a}=this.browser.genome.getChromosome(this.referenceFrame.chr),l=this.referenceFrame.bpPerPixel*r/a,c=s;c-l/2<0&&(c=l/2),c+l/2>1&&(c=1-l/2);let h=Math.round((c-l/2)*a),d=Math.round((c+l/2)*a);this.referenceFrame.start=h,this.referenceFrame.end=d,this.referenceFrame.bpPerPixel=(d-h)/r,this.browser.updateViews(this.referenceFrame,this.browser.trackViews,!0)}}setWidth(e){this.$viewport.width(e)}drawSVGWithContext(e,t,n,s,r,a,o){e.saveWithTranslationAndClipRect(s,r,a,t,n,o),this.trackView.track.draw({context:e,referenceFrame:this.referenceFrame,pixelWidth:t,pixelHeight:n}),e.restore()}repaint(){this.draw({referenceFrame:this.referenceFrame})}draw({referenceFrame:e}){he.configureHighDPICanvas(this.ideogram_ctx,this.$viewport.width(),this.$viewport.height()),this.trackView.track.draw({context:this.ideogram_ctx,referenceFrame:e,pixelWidth:this.$viewport.width(),pixelHeight:this.$viewport.height()})}startSpinner(){}stopSpinner(){}};function ch(i,e,t,n){return i.track.type==="ruler"?new lh(i,e,t,n):i.track.id==="ideogram"?new hh(i,e,t,n):new kr(i,e,t,n)}var Rx=10,Ix={textAlign:"start",textBaseline:"bottom",strokeStyle:"black",fillStyle:"black"},fh=class{constructor(e,t,n,s){this.guid=de.guid(),this.trackView=e,this.browser=e.browser,this.viewport=de.div({class:"igv-viewport"}),t.appendChild(this.viewport),e.track.height&&(this.viewport.style.height=`${e.track.height}px`),this.canvas=document.createElement("canvas"),this.viewport.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),this.trackScrollDelta=0,this.contentTop=0,this.setWidth(s),this.browser.showSampleNames===!1&&this.hide(),this.addMouseHandlers()}checkCanvas(){let e=window.devicePixelRatio,t=this.viewport.clientHeight,n=this.browser.sampleNameViewportWidth;if(this.canvas.width!==n*e||this.canvas.height!==t*e){let s=this.canvas;s.width=n*e,s.height=t*e,s.style.width=`${n}px`,s.style.height=`${t}px`,this.ctx=this.canvas.getContext("2d"),this.ctx.scale(e,e)}}setTop(e){if(typeof this.trackView.track.getSamples=="function"){this.contentTop=e;let t=this.trackView.track.getSamples();this.repaint(t)}}setWidth(e){this.viewport.innerWidth=e,this.checkCanvas()}show(){this.viewport.style.display="block"}hide(){this.viewport.style.display="none"}async repaint(e){this.checkCanvas(),this.draw({context:this.ctx,samples:e})}draw({context:e,samples:t}){if(!t||t.names.length===0)return;Fx(e,Ix,t.height);let n=4;e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle=Jv("lead");let s=this.viewport.getBoundingClientRect().height,r=(t.yOffset||0)+this.contentTop;for(let a of t.names){if(r>s)break;if(r+t.height>0){let o=a,l=Lx(e,o,r,t.height);e.fillText(o,n,l)}r+=t.height}}renderSVGContext(e,{deltaX:t,deltaY:n}){if(typeof this.trackView.track.getSamples=="function"){let s=this.trackView.track.getSamples(),r=0,{width:a,height:o}=this.viewport.getBoundingClientRect(),c=`${(this.trackView.track.name||this.trackView.track.id).replace(/\W/g,"")}_sample_names_guid_${de.guid()}`;e.saveWithTranslationAndClipRect(c,t,n+r,a,o,-r),this.draw({context:e,samples:s}),e.restore()}}addMouseHandlers(){this.addViewportContextMenuHandler(this.viewport)}removeMouseHandlers(){this.removeViewportContextMenuHandler(this.viewport)}addViewportContextMenuHandler(e){this.boundContextMenuHandler=t.bind(this),e.addEventListener("contextmenu",this.boundContextMenuHandler);function t(n){n.preventDefault(),n.stopPropagation();let s={label:"Name Panel Width",value:this.browser.sampleNameViewportWidth,callback:r=>{this.browser.sampleNameViewportWidth=parseInt(r);for(let{sampleNameViewport:a}of this.browser.trackViews)a.setWidth(this.browser.sampleNameViewportWidth);this.browser.layoutChange()}};this.browser.inputDialog.present(s,n)}}removeViewportContextMenuHandler(e){e.removeEventListener("contextmenu",this.boundContextMenuHandler)}dispose(){this.removeMouseHandlers(),this.viewport.remove()}};function Lx(i,e,t,n){return t+n-Nx(i,e,n)}function Nx(i,e,t){let{actualBoundingBoxAscent:n,actualBoundingBoxDescent:s}=i.measureText(e);return(t-(n+s))/2}function Fx(i,{textAlign:e,textBaseline:t,strokeStyle:n,fillStyle:s},r){let a=Math.min(r,Rx);i.font=`${a}px sans-serif`,i.textAlign=e,i.textBaseline=t,i.fillStyle=s}var Pn=function(i){this.popover=de.div({class:"igv-menu-popup"}),i.appendChild(this.popover);let e=de.div({class:"igv-menu-popup-header"});this.popover.appendChild(e),sc.attachDialogCloseHandlerWithParent(e,()=>this.hide()),this.popoverContent=de.div(),this.popover.appendChild(this.popoverContent),Ki(this.popover,e),e.addEventListener("click",t=>{t.stopPropagation(),t.preventDefault()}),this.hide()};Pn.prototype.hide=function(){this.popover.style.display="none"};Pn.prototype.presentMenuList=function(i){if(Bx(),i.length>0){this.popoverContent.innerHTML="",i=Xt.trackMenuItemListHelper(i,this);for(let t of i){t.init&&t.init();let n=t.object;i.indexOf(t)===0&&n.removeClass("igv-track-menu-border-top"),n.hasClass("igv-track-menu-border-top")||n.hasClass("igv-menu-popup-check-container")||n.is("div")&&n.addClass("igv-menu-popup-shim"),this.popoverContent.appendChild(n.get(0))}this.popover.style.display="flex";let{width:e}=this.popover.getBoundingClientRect();this.popover.style.left=`${-e}px`,this.popover.style.top="0px"}};Pn.prototype.presentTrackContextMenu=function(i,e){this.popoverContent.innerHTML="";let t=Dx(e,this.popover);for(let{el:n}of t)this.popoverContent.appendChild(n);Ox(i,this.popover)};Pn.prototype.dispose=function(){this.popoverContent.innerHTML="",this.popover.innerHTML="",Object.keys(this).forEach(function(i){this[i]=void 0})};function Dx(i,e){return i.map(t=>{let n;if(typeof t=="string"&&t==="<hr/>")n=document.createElement("hr");else if(typeof t=="string")n=de.div({class:"context-menu"}),n.innerHTML=t;else if(typeof t=="Node")n=t;else{if(typeof t.init=="function"&&t.init(),t.type==="checkbox")n=ot("Show all bases",t.value);else if(t.type==="color"){let s=new ks({parent:e.parentElement,width:364});s.configure(void 0,{color:a=>t.click(a)}),n=de.div({class:"context-menu"}),typeof t.label=="string"&&(n.innerHTML=t.label);let r=a=>{s.show(),de.hide(e),a.preventDefault(),a.stopPropagation()};n.addEventListener("click",r),n.addEventListener("touchend",r),n.addEventListener("mouseup",function(a){a.preventDefault(),a.stopPropagation()})}else n=de.div({class:"context-menu"}),typeof t.label=="string"&&(n.innerHTML=t.label);if(t.click&&t.type!=="color"){let s=function(r){t.click(),de.hide(e),r.preventDefault(),r.stopPropagation()};n.addEventListener("click",s),n.addEventListener("touchend",s),n.addEventListener("mouseup",function(r){r.preventDefault(),r.stopPropagation()})}}return{el:n,init:t.init}})}function Ox(i,e){e.style.display="flex";let{x:t,y:n}=de.translateMouseCoordinates(i,e.parentNode),{width:s}=e.getBoundingClientRect(),r=t+s,{width:a}=e.parentNode.getBoundingClientRect();e.style.left=`${r>a?t-(r-a):t}px`,e.style.top=`${n}px`}var Bx=()=>{let i=document.querySelectorAll(".igv-menu-popup");for(let e=0;e<i.length;e++)i[e].style.display="none"},go=50,Jr=new Set(["ruler","ideogram"]),Px=new Set(["ruler","sequence","ideogram"]),hr=class{constructor(e,t,n){this.browser=e,this.track=n,n.trackView=this,this.addDOMToColumnContainer(e,t,e.referenceFrameList)}startSpinner(){this.viewports&&this.viewports.length>0&&this.viewports[0].startSpinner()}stopSpinner(){this.viewports&&this.viewports.length>0&&this.viewports[0].stopSpinner()}addDOMToColumnContainer(e,t,n){this.axis=this.createAxis(e,this.track),this.viewports=[];let s=e.calculateViewportWidth(n.length),r=t.querySelectorAll(".igv-column");for(let a=0;a<r.length;a++){let o=ch(this,r[a],n[a],s);this.viewports.push(o)}this.sampleNameViewport=new fh(this,e.columnContainer.querySelector(".igv-sample-name-column"),void 0,e.sampleNameViewportWidth),this.createTrackScrollbar(e),this.createTrackDragHandle(e),this.createTrackGearPopup(e)}createAxis(e,t){let n=de.div();if(e.columnContainer.querySelector(".igv-axis-column").appendChild(n),n.style.height=`${t.height}px`,typeof t.paintAxis=="function"){t.dataRange&&n.addEventListener("click",()=>{e.dataRangeDialog.configure(this),e.dataRangeDialog.present(pe(e.columnContainer))});let{width:s,height:r}=n.getBoundingClientRect();this.axisCanvas=document.createElement("canvas"),this.axisCanvas.style.width=`${s}px`,this.axisCanvas.style.height=`${r}px`,n.appendChild(this.axisCanvas)}return n}resizeAxisCanvas(e,t){this.axis.style.width=`${e}px`,this.axis.style.height=`${t}px`,typeof this.track.paintAxis=="function"&&(this.axisCanvas.style.width=`${e}px`,this.axisCanvas.style.height=`${t}px`)}removeDOMFromColumnContainer(){this.boundAxisClickHander&&this.removeAxisEventListener(this.axis),this.axis.remove();for(let e of this.viewports)e.$viewport.remove();this.sampleNameViewport.dispose(),this.removeTrackScrollMouseHandlers(),this.outerScroll.remove(),this.removeTrackDragMouseHandlers(),this.dragHandle.remove(),this.removeTrackGearMouseHandlers(),this.gearContainer.remove()}renderSVGContext(e,{deltaX:t,deltaY:n}){zx(e,this.track,this.axisCanvas,t,n);let{width:s}=this.axis.getBoundingClientRect(),{y:r}=this.viewports[0].$viewport.get(0).getBoundingClientRect(),a={deltaX:s+t,deltaY:r+n};for(let o of this.viewports){o.renderSVGContext(e,a);let{width:l}=o.$viewport.get(0).getBoundingClientRect();a.deltaX+=l}this.browser.showSampleNames===!0&&this.sampleNameViewport.renderSVGContext(e,a)}dataRange(){return this.track.dataRange?this.track.dataRange:void 0}setDataRange(e,t){e!==void 0&&(this.track.dataRange.min=e),t!==void 0&&(this.track.dataRange.max=t),this.track.autoscale=!1,this.repaintViews()}presentColorPicker(e){if(Px.has(this.track.type)===!1){let t=[],n=this.track.color||this.track.defaultColor;yt(n)&&t.push(n),this.track.altColor&&yt(this.track.altColor)&&t.push(this.track.altColor);let s=t.map(a=>a.startsWith("#")?a:a.startsWith("rgb(")?Ve.rgbToHex(a):Ve.colorNameToHex(a)),r={color:a=>{this.track.color=a,this.repaintViews()},altColor:a=>{this.track.altColor=a,this.repaintViews()}};this.browser.genericColorPicker.configure(s,r),this.browser.genericColorPicker.setActiveColorHandler(e),this.browser.genericColorPicker.show()}}setTrackHeight(e,t){t||(this.track.minHeight&&(e=Math.max(this.track.minHeight,e)),this.track.maxHeight&&(e=Math.min(this.track.maxHeight,e))),this.track.height=e,this.resizeAxisCanvas(this.axis.clientWidth,this.track.height),typeof this.track.paintAxis=="function"&&this.paintAxis();for(let{$viewport:n}of this.viewports)n.height(e);if(this.sampleNameViewport.viewport.style.height=`${e}px`,typeof this.track.computePixelHeight!="function")for(let n of this.viewports)n.setContentHeight(e);this.repaintViews(),Jr.has(this.track.type)===!1&&this.updateScrollbar(),this.dragHandle.style.height=`${e}px`,this.gearContainer.style.height=`${e}px`}updateScrollbar(){let e=this.viewports[0].$viewport.height();this.outerScroll.style.height=`${e}px`;let t=this.maxViewportContentHeight(),n=Math.round(e/t*e);t>e?(this.innerScroll.style.display="block",this.innerScroll.style.height=`${n}px`):this.innerScroll.style.display="none"}moveScroller(e){let t=pe(this.innerScroll).position().top+e,n=Math.min(Math.max(0,t),this.outerScroll.clientHeight-this.innerScroll.clientHeight);pe(this.innerScroll).css("top",`${n}px`);let s=this.maxViewportContentHeight(),r=-Math.round(n*(s/this.viewports[0].$viewport.height()));for(let a of this.viewports)a.setTop(r);this.sampleNameViewport.trackScrollDelta=e,this.sampleNameViewport.setTop(r)}isLoading(){for(let e of this.viewports)if(e.isLoading())return!0}repaintViews(){for(let e of this.viewports)e.isVisible()&&e.repaint();typeof this.track.paintAxis=="function"&&this.paintAxis(),this.repaintSamples()}repaintSamples(){if(typeof this.track.getSamples=="function"){let e=this.track.getSamples();this.sampleNameViewport.repaint(e)}}setTrackLabelName(e){this.viewports.forEach(t=>t.setTrackLabel(e))}resize(e){for(let t of this.viewports)t.setWidth(e)}async updateViews(){if(!(this.browser&&this.browser.referenceFrameList))return;let e=this.viewports.filter(r=>r.isVisible());if(e.forEach(r=>r.shift()),this.browser.dragObject)return;let t=e.filter(r=>r.needsRepaint()).filter(r=>r.checkZoomIn()),n=t.filter(r=>r.needsReload());for(let r of n)await r.loadFeatures();if(this.disposed)return;if(this.track&&typeof this.track.variantRowCount=="function"&&n.length>0){let r=0;for(let o of this.viewports)o.featureCache&&o.featureCache.features&&(r=Math.max(r,o.featureCache.features.reduce((l,c)=>Math.max(l,c.row||0),0)));if(this.track.nVariantRows!==r+1){this.track.variantRowCount(r+1);for(let o of this.viewports)o.checkContentHeight()}}if(this.track.autoscale){let r=[];for(let a of e){let o=a.referenceFrame,l=o.start,c=l+o.toBP(a.getWidth());if(a.featureCache&&a.featureCache.features)if(typeof a.featureCache.features.getMax=="function"){let h=a.featureCache.features.getMax(l,c);r.push({value:h})}else{let h=Ls.findOverlapping(a.featureCache.features,l,c);for(let d of h)r.push(d)}}typeof this.track.doAutoscale=="function"?this.track.dataRange=this.track.doAutoscale(r):this.track.dataRange=mc(r)}let s=this.track.autoscale||this.track.autoscaleGroup||this.track.type==="ruler";for(let r of e)t.includes(r)?r.repaint():s&&r.refresh();this.adjustTrackHeight(),this.repaintSamples(),this.updateRulerViewportLabels()}clearCachedFeatures(){for(let e of this.viewports)e.clearCache()}updateRulerViewportLabels(){let e=this.browser.calculateViewportWidth(this.viewports.length);for(let t of this.viewports)this.track.type==="ruler"&&(this.viewports.length>1?t.presentLocusLabel(e):t.dismissLocusLabel())}async getInViewFeatures(){if(!(this.browser&&this.browser.referenceFrameList))return[];let e=[],t=this.viewports.filter(n=>n.isVisible());for(let n of t){let s=n.referenceFrame,{chr:r,start:a,bpPerPixel:o}=n.referenceFrame,l=a+s.toBP(n.getWidth());if((!n.featureCache||!n.featureCache.containsRange(r,a,l,o))&&await n.loadFeatures(),n.featureCache&&n.featureCache.features)if(typeof n.featureCache.features.getMax=="function"){let h=n.featureCache.features.getMax(a,l);e.push({value:h})}else{let h=typeof n.featureCache.queryFeatures=="function"?n.featureCache.queryFeatures(r,a,l):Ls.findOverlapping(n.featureCache.features,a,l);e=e.concat(h)}}return e}checkContentHeight(){for(let e of this.viewports)e.checkContentHeight();this.adjustTrackHeight()}adjustTrackHeight(){var e=this.maxViewportContentHeight();if(this.track.autoHeight?this.setTrackHeight(e,!1):this.track.paintAxis&&this.paintAxis(),Jr.has(this.track.type)===!1){let t=this.viewports[0].getContentTop(),n=this.viewports[0].$viewport.height(),s=Math.min(0,n-e);if(t<s)for(let r of this.viewports)r.setTop(s);this.updateScrollbar()}}createTrackScrollbar(e){let t=de.div();if(e.columnContainer.querySelector(".igv-scrollbar-column").appendChild(t),t.style.height=`${this.track.height}px`,this.outerScroll=t,Jr.has(this.track.type)===!1){let n=de.div();t.appendChild(n),this.innerScroll=n,this.addTrackScrollMouseHandlers(e)}}createTrackDragHandle(e){let t=this.track.type==="ideogram"||this.track.type==="ruler"?"igv-track-drag-shim":"igv-track-drag-handle";this.dragHandle=de.div({class:t}),e.columnContainer.querySelector(".igv-track-drag-column").appendChild(this.dragHandle),this.dragHandle.style.height=`${this.track.height}px`,this.addTrackDragMouseHandlers(e)}createTrackGearPopup(e){this.gearContainer=de.div(),e.columnContainer.querySelector(".igv-gear-menu-column").appendChild(this.gearContainer),this.gearContainer.style.height=`${this.track.height}px`,this.track.ignoreTrackMenu===!0||(this.gear=de.div(),this.gearContainer.appendChild(this.gear),this.gear.appendChild(Ui.createIcon("cog")),this.trackGearPopup=new Pn(this.gear),this.addTrackGearMouseHandlers())}addAxisEventListener(e){this.boundAxisClickHander=t.bind(this),e.addEventListener("click",this.boundAxisClickHander);function t(n){this.browser.dataRangeDialog.configure(this),this.browser.dataRangeDialog.present(pe(this.browser.columnContainer))}}removeAxisEventListener(e){e.removeEventListener("click",this.boundAxisClickHander)}addTrackScrollMouseHandlers(e){this.boundTrackScrollMouseDownHandler=t.bind(this),this.innerScroll.addEventListener("mousedown",this.boundTrackScrollMouseDownHandler);function t(s){s.stopPropagation();let{y:r}=de.pageCoordinates(s);pe(this.innerScroll).data("yDown",r.toString()),this.boundColumnContainerMouseMoveHandler=a.bind(this),e.columnContainer.addEventListener("mousemove",this.boundColumnContainerMouseMoveHandler);function a(o){o.stopPropagation();let{y:l}=de.pageCoordinates(o);this.moveScroller(l-parseInt(pe(this.innerScroll).data("yDown"))),pe(this.innerScroll).data("yDown",l.toString())}}this.boundColumnContainerMouseUpHandler=n.bind(this),e.columnContainer.addEventListener("mouseup",this.boundColumnContainerMouseUpHandler);function n(s){e.columnContainer.removeEventListener("mousemove",this.boundColumnContainerMouseMoveHandler)}}removeTrackScrollMouseHandlers(){Jr.has(this.track.type)===!1&&(this.innerScroll.removeEventListener("mousedown",this.boundTrackScrollMouseDownHandler),this.browser.columnContainer.removeEventListener("mouseup",this.boundColumnContainerMouseUpHandler),this.browser.columnContainer.removeEventListener("mousemove",this.boundColumnContainerMouseMoveHandler))}addTrackDragMouseHandlers(e){if(!(this.track.id==="ideogram"||this.track.id==="ruler")){let n=function(o){o.preventDefault(),t=o.target,t.classList.add("igv-track-drag-handle-hover"),e.startTrackDrag(this)},s=function(o){e.endTrackDrag(),t&&o.target!==t&&t.classList.remove("igv-track-drag-handle-hover"),t=void 0},r=function(o){o.preventDefault(),t===void 0&&o.target.classList.add("igv-track-drag-handle-hover"),e.updateTrackDrag(this)},a=function(o){o.preventDefault(),t===void 0&&o.target.classList.remove("igv-track-drag-handle-hover")},t;this.boundTrackDragMouseDownHandler=n.bind(this),this.dragHandle.addEventListener("mousedown",this.boundTrackDragMouseDownHandler),this.boundDocumentTrackDragMouseUpHandler=s.bind(this),document.addEventListener("mouseup",this.boundDocumentTrackDragMouseUpHandler),this.boundTrackDragMouseEnterHandler=r.bind(this),this.dragHandle.addEventListener("mouseenter",this.boundTrackDragMouseEnterHandler),this.dragHandle.addEventListener("mouseout",o=>{o.preventDefault(),t===void 0&&o.target.classList.remove("igv-track-drag-handle-hover")}),this.boundTrackDragMouseOutHandler=a.bind(this),this.dragHandle.addEventListener("mouseout",this.boundTrackDragMouseOutHandler)}}removeTrackDragMouseHandlers(){this.track.id==="ideogram"||this.track.id==="ruler"||(this.dragHandle.removeEventListener("mousedown",this.boundTrackDragMouseDownHandler),document.removeEventListener("mouseup",this.boundDocumentTrackDragMouseUpHandler),this.dragHandle.removeEventListener("mouseup",this.boundTrackDragMouseEnterHandler),this.dragHandle.removeEventListener("mouseout",this.boundTrackDragMouseOutHandler))}addTrackGearMouseHandlers(){if(this.track.ignoreTrackMenu!==!0){let e=function(t){t.preventDefault(),t.stopPropagation(),this.trackGearPopup.presentMenuList(Xt.trackMenuItemList(this))};this.boundTrackGearClickHandler=e.bind(this),this.gear.addEventListener("click",this.boundTrackGearClickHandler)}}removeTrackGearMouseHandlers(){this.track.ignoreTrackMenu===!0||this.gear.removeEventListener("click",this.boundTrackGearClickHandler)}dispose(){this.removeAxisEventListener(this.axis),this.axis.remove();for(let e of this.viewports)e.dispose();this.sampleNameViewport.dispose(),this.removeTrackScrollMouseHandlers(),this.outerScroll.remove(),this.removeTrackDragMouseHandlers(),this.dragHandle.remove(),this.removeTrackGearMouseHandlers(),this.gearContainer.remove(),typeof this.track.dispose=="function"&&this.track.dispose();for(let e of Object.keys(this))this[e]=void 0;this.alert&&this.alert.container.remove(),this.disposed=!0}paintAxis(){if(typeof this.track.paintAxis=="function"){let{width:e,height:t}=this.axisCanvas.getBoundingClientRect(),n=window.devicePixelRatio||1;this.axisCanvas.height=n*t,this.axisCanvas.width=n*e;let s=this.axisCanvas.getContext("2d");s.scale(n,n),this.track.paintAxis(s,e,t)}}maxViewportContentHeight(){return Math.max(this.viewports.map(e=>e.getContentHeight()))}};function zx(i,e,t,n,s){if(typeof e.paintAxis=="function"){let{y:r,width:a,height:o}=t.getBoundingClientRect(),c=`${(e.name||e.id).replace(/\W/g,"")}_axis_guid_${de.guid()}`;i.saveWithTranslationAndClipRect(c,n,r+s,a,o,0),e.paintAxis(i,a,o),i.restore()}}var Yu="rgb(150, 150, 150)",uh=class extends kt{static defaults={height:50,flipAxis:!1,logScale:!1,windowFunction:"mean",graphType:"bar",autoscale:!0,normalize:void 0,scaleFactor:void 0};constructor(e,t){super(e,t)}init(e){super.init(e),this.type="wig",this.featureType="numeric",this.paintAxis=Bn;let t=e.format?e.format.toLowerCase():e.format;e.featureSource?(this.featureSource=e.featureSource,delete e.featureSource):t==="bigwig"?this.featureSource=new Xs(e,this.browser.genome):t==="tdf"?this.featureSource=new Ys(e,this.browser.genome):this.featureSource=Bt(e,this.browser.genome),e.max===void 0||e.autoscale===!0?this.autoscale=!0:this.dataRange={min:e.min||0,max:e.max}}async postInit(){let e=await this.getHeader();this.disposed||e&&this.setTrackProperties(e)}async getFeatures(e,t,n,s){let r=await this.featureSource.getFeatures({chr:e,start:t,end:n,bpPerPixel:s,visibilityWindow:this.visibilityWindow,windowFunction:this.windowFunction});if(this.normalize&&this.featureSource.normalizationFactor){let a=this.featureSource.normalizationFactor;for(let o of r)o.value*=a}if(this.scaleFactor){let a=this.scaleFactor;for(let o of r)o.value*=a}return r}menuItemList(){let e=[];return this.flipAxis!==void 0&&(e.push("<hr>"),e.push({label:"Flip y-axis",click:()=>{this.flipAxis=!this.flipAxis,this.trackView.repaintViews()}})),e=e.concat(Xt.numericDataMenuItems(this.trackView)),e}async getHeader(){return typeof this.featureSource.getHeader=="function"&&(this.header=await this.featureSource.getHeader()),this.header}getScaleFactor(e,t,n,s){return s?n/(Math.log10(t+1)-(e<=0?0:Math.log10(e+1))):n/(t-e)}computeYPixelValue(e,t){return(this.flipAxis?e-this.dataRange.min:this.dataRange.max-e)*t}computeYPixelValueInLogScale(e,t){let n=this.dataRange.max,s=this.dataRange.min;return n<=0?0:(s<=-1&&(s=0),s=s<=0?0:Math.log10(s+1),n=Math.log10(n+1),e=Math.log10(e+1),(this.flipAxis?e-s:n-e)*t)}draw(e){let t=e.features,n=e.context,s=e.bpPerPixel,r=e.bpStart,a=e.pixelWidth;e.pixelHeight;let o=r+a*s+1,l=this.color||Yu,c;typeof l=="string"&&l.startsWith("rgb(")&&(c=Ve.addAlpha(l,.1));let h=this.getScaleFactor(this.dataRange.min,this.dataRange.max,e.pixelHeight,this.logScale),d=f=>this.logScale?this.computeYPixelValueInLogScale(f,h):this.computeYPixelValue(f,h);if(t&&t.length>0&&(this.dataRange.min===void 0&&(this.dataRange.min=0),this.dataRange.max>this.dataRange.min)){let f=-1,u,g=d(0);for(let _ of t){if(_.end<r)continue;if(_.start>o)break;let b=Math.floor((_.start-r)/s);if(isNaN(b))continue;let w=d(_.value),p=Math.ceil((_.end-r)/s),m=Math.max(1,p-b),v=this.getColorForFeature(_);if(this.graphType==="points"){let x=this.config.pointSize||3,R=b+m/2;he.fillCircle(n,R,w,x/2,{fillStyle:v,strokeStyle:v})}else if(this.graphType==="line")u!=null&&he.strokeLine(n,f,u,b,w,{fillStyle:v,strokeStyle:v}),he.strokeLine(n,b,w,b+m,w,{fillStyle:v,strokeStyle:v});else{let x=w-g;he.fillRect(n,b,g,m,x,{fillStyle:v})}f=b+m,u=w}if(this.dataRange.min<0){let _=this.dataRange.max/(this.dataRange.max-this.dataRange.min)*e.pixelHeight;he.strokeLine(n,0,_,e.pixelWidth,_,{strokeStyle:c})}}if(this.config.hasOwnProperty("guideLines")){for(let f of this.config.guideLines)if(f.hasOwnProperty("color")&&f.hasOwnProperty("y")&&f.hasOwnProperty("dotted")){let u=d(f.y),g={strokeStyle:f.color,strokeWidth:2};f.dotted?he.dashedLine(e.context,0,u,e.pixelWidth,u,5,g):he.strokeLine(e.context,0,u,e.pixelWidth,u,g)}}}popupData(e,t){if(t===void 0&&(t=this.clickedFeatures(e)),t&&t.length>0){let n=e.genomicLocation,s=[];t.sort(function(a,o){let l=Math.abs((a.start+a.end)/2-n),c=Math.abs((o.start+o.end)/2-n);return l-c});let r=t.length>10?t.slice(0,10):t;r.sort(function(a,o){return a.start-o.start});for(let a of r)if(a){s.length>0&&s.push("<hr/>");let o=a.end-a.start===1?De(a.start+1):De(a.start+1)+"-"+De(a.end);s.push({name:"Position:",value:o}),s.push({name:"Value:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",value:De(a.value)})}return r.length<t.length&&s.push("<hr/>..."),s}else return[]}get supportsWholeGenome(){return!this.config.indexURL&&this.config.supportsWholeGenome!==!1}getColorForFeature(e){let t=e.value<0&&this.altColor?this.altColor:this.color||Yu;return typeof t=="function"?t(e.value):t}dispose(){this.trackView=void 0}};function km(i){this.thresholds=i.thresholds,this.colors=i.colors}km.prototype.getColor=function(i){for(let e of this.thresholds)if(i<e)return this.colors[this.thresholds.indexOf(e)];return this.colors[this.colors.length-1]};function dh(i){this.scale=i,this.lowColor="rgb("+i.lowR+","+i.lowG+","+i.lowB+")",this.highColor="rgb("+i.highR+","+i.highG+","+i.highB+")",this.diff=i.high-i.low}dh.prototype.getColor=function(i){var e=this.scale,t,n,s,r;return i<=e.low?this.lowColor:i>=e.high?this.highColor:(r=(i-e.low)/this.diff,t=Math.floor(e.lowR+r*(e.highR-e.lowR)),n=Math.floor(e.lowG+r*(e.highG-e.lowG)),s=Math.floor(e.lowB+r*(e.highB-e.lowB)),"rgb("+t+","+n+","+s+")")};var ph=class{constructor(e){this.color=e}getColor(){return this.color}},cr=class extends kt{constructor(e,t){super(e,t)}init(e){if(super.init(e),this.type=e.type||"seg",this.type==="maf"&&(this.type="mut"),this.isLog=e.isLog,this.displayMode=e.displayMode||"EXPANDED",this.height=e.height||300,this.maxHeight=e.maxHeight||500,this.squishedRowHeight=e.sampleSquishHeight||e.squishedRowHeight||2,this.expandedRowHeight=e.sampleExpandHeight||e.expandedRowHeight||13,this.sampleHeight=this.squishedRowHeight,e.color?this.color=e.color:(this.posColorScale=e.posColorScale||new dh({low:.1,lowR:255,lowG:255,lowB:255,high:1.5,highR:255,highG:0,highB:0}),this.negColorScale=e.negColorScale||new dh({low:-1.5,lowR:0,lowG:0,lowB:255,high:-.1,highR:255,highG:255,highB:255}),this.type==="mut"&&(this.colorTable=new Gi(e.colorTable||Hx))),this.sampleKeys=[],this.sampleNames=new Map,e.samples){for(let n of e.samples)this.sampleKeys.push(n),this.sampleNames.set(n,n);this.explicitSamples=!0}let t=Object.assign({},this.config);t.maxWGCount=t.maxWGCount||Number.MAX_SAFE_INTEGER,this.featureSource=Bt(t,this.browser.genome),this.initialSort=e.sort}async postInit(){typeof this.featureSource.getHeader=="function"&&(this.header=await this.featureSource.getHeader(),this.disposed)||this.header&&this.setTrackProperties(this.header)}menuItemList(){let e=[],t={SQUISHED:"Squish",EXPANDED:"Expand",FILL:"Fill"};e.push("<hr/>"),e.push("DisplayMode:");let n=this.type==="seg"?["SQUISHED","EXPANDED","FILL"]:["SQUISHED","EXPANDED"];for(let s of n){let r=ot(t[s],s===this.displayMode);e.push({object:pe(r),click:()=>{this.displayMode=s,this.config.displayMode=s,this.trackView.checkContentHeight(),this.trackView.repaintViews(),this.trackView.moveScroller(this.trackView.sampleNameViewport.trackScrollDelta)}})}return e}hasSamples(){return!0}getSamples(){return{names:this.sampleKeys.map(e=>this.sampleNames.get(e)),height:this.sampleHeight,yOffset:0}}async getFeatures(e,t,n){let s=await this.featureSource.getFeatures({chr:e,start:t,end:n});if(this.initialSort){let r=this.initialSort;this.sortSamples(r.chr,r.start,r.end,r.direction,s),this.initialSort=void 0}return s}draw({context:e,renderSVG:t,pixelTop:n,pixelWidth:s,pixelHeight:r,features:a,bpPerPixel:o,bpStart:l}){if(he.fillRect(e,0,n,s,r,{fillStyle:"rgb(255, 255, 255)"}),a&&a.length>0){this.checkForLog(a),this.updateSampleKeys(a);let c={};this.sampleKeys.forEach(function(_,b){c[_]=b});let h;switch(this.displayMode){case"FILL":this.sampleHeight=r/this.sampleKeys.length,h=0;break;case"SQUISHED":this.sampleHeight=this.squishedRowHeight,h=0;break;default:this.sampleHeight=this.expandedRowHeight,h=1}let d=this.sampleHeight;for(let _ of a)_.pixelRect=void 0;let f=n+r,u=l+s*o+1,g=o;this.sampleYStart=void 0;for(let _ of a){if(_.end<l)continue;if(_.start>u)break;let b=_.sampleKey||_.sample;_.row=c[b];let w=_.row*d+h;if(this.sampleYStart===void 0&&(this.sampleYStart=w),w+d<n||w>f)continue;let m=Math.max(_.start,l),v=Math.round((m-l)/g),x=Math.min(_.end,u),R=Math.round((x-l)/g),M=Math.max(1,R-v),C;this.color?typeof this.color=="function"?C=this.color(_):C=this.color:this.colorTable&&(C=this.colorTable.getColor(_.value.toLowerCase()));let L;if(this.type==="mut")L=d-2*h,M<3&&(M=3,v-=1);else{let y=_.value;this.isLog||(y=gt.log2(y/2)),y<-.1?C=this.negColorScale.getColor(y):y>.1?C=this.posColorScale.getColor(y):C="white";let E=d;if(d<.25){let k=.1+2*Math.abs(y);E=Math.min(1,k*d)}L=E-2*h}_.pixelRect={x:v,y:w,w:M,h:L},e.fillStyle=C,e.fillRect(v,w,M,L)}}}checkForLog(e){if(this.isLog===void 0){this.isLog=!1;for(let t of e)if(t.value<0){this.isLog=!0;return}}}computePixelHeight(e){if(!e)return 0;let t=this.displayMode==="SQUISHED"?this.squishedRowHeight:this.expandedRowHeight;return this.updateSampleKeys(e),this.sampleKeys.length*t}async sortSamples(e,t,n,s,r){if(r||(r=await this.featureSource.getFeatures({chr:e,start:t,end:n})),!r)return;this.updateSampleKeys(r);let a={},o=s==="ASC"?1:-1,l=()=>{let h=n-t+1;for(let d of r){if(d.end<t)continue;if(d.start>n)break;let f=Math.max(t,d.start),g=(Math.min(n,d.end)-f)/h,_=d.sampleKey||d.sample,b=a[_]||0;a[_]=b+g*d.value}this.sampleKeys.sort(function(d,f){let u=a[d],g=a[f];return u||(u=o*Number.MAX_VALUE),g||(g=o*Number.MAX_VALUE),u===g?0:u>g?o:o*-1})},c=()=>{for(let h of r){if(h.end<t)continue;if(h.start>n)break;let d=h.sampleKey||h.sample;(!a.hasOwnProperty(d)||h.value.localeCompare(a[d])>0)&&(a[d]=h.value)}this.sampleKeys.sort(function(h,d){let f=a[h]||"",u=a[d]||"";return o*f.localeCompare(u)})};this.type==="mut"?c():l(),this.trackView.repaintViews()}clickedFeatures(e){let t=super.clickedFeatures(e),n=e.y;return t.filter(function(s){let r=s.pixelRect;return r&&n>=r.y&&n<=r.y+r.h})}hoverText(e){let t=this.clickedFeatures(e);if(t&&t.length>0)return`${t[0].sample}: ${t[0].value}`}popupData(e,t){t===void 0&&(t=this.clickedFeatures(e));let n=[];for(let s of t){n.length>0&&(n.push("<hr/>"),n.push("<hr/>"));let r=s._f||s,a=typeof r.popupData=="function"?r.popupData(this.type,this.browser.genome.id):this.extractPopupData(r);Array.prototype.push.apply(n,a)}return n}contextMenuItemList(e){let t=e.viewport.referenceFrame,n=e.genomicLocation,s=this.config.sort?this.config.sort.direction==="ASC"?"DESC":"ASC":"DESC",r=t.toBP(2.5),a=l=>{let h=e.viewport.cachedFeatures;this.sortSamples(l.chr,l.start,l.end,l.direction,h)};return[{label:this.type==="seg"?"Sort by value":"Sort by type",click:l=>{let c={direction:s,chr:e.viewport.referenceFrame.chr,start:n-r,end:n+r};a(c),this.config.sort=c}}]}get supportsWholeGenome(){return(this.config.indexed===!1||!this.config.indexURL)&&this.config.supportsWholeGenome!==!1}updateSampleKeys(e){if(!this.explicitSamples)for(let t of e){let n=t.sampleKey||t.sample;this.sampleNames.has(n)||(this.sampleNames.set(n,t.sample),this.sampleKeys.push(n))}}},Hx={indel:"rgb(0,200,0)","targeted region":"rgb(236,155,43)",truncating:"rgb(	150,0,0)","non-coding transcript":"rgb(0,0,150)",synonymous:"rgb(109,165,95)",silent:"rgb(109,135,80)",missense_mutation:"rgb(72,130,187)",missense:"rgb(72,130,187)","splice site":"rgb(143,83,155)",splice_region:"rgb(143,83,155)",nonsense:"rgb(216, 57,81)",nonsense_mutation:"rgb(216, 57,81)",frame_shift_del:"rgb(226,135,65)",frame_shift_ins:"rgb(226,135,65)",in_frame_del:"rgb(247,235,94)",in_frame_ins:"rgb(247,235,94)","*other*":"rgb(159,91,50)"},gh=class extends kt{constructor(e,t){super(e,t),this.type="merged",this.featureType="numeric",this.paintAxis=Bn,this.graphType=e.graphType}init(e){if(!e.tracks)throw Error("Error: no tracks defined for merged track"+e);super.init(e)}async postInit(){this.tracks=[];let e=[];for(let t of this.config.tracks){t.isMergedTrack=!0;let n=await this.browser.createTrack(t);n?(n.autoscale=!1,this.tracks.push(n)):console.warn("Could not create track "+t),typeof n.postInit=="function"&&e.push(n.postInit())}this.flipAxis=this.config.flipAxis?this.config.flipAxis:!1,this.logScale=this.config.logScale?this.config.logScale:!1,this.autoscale=this.config.autoscale||this.config.max===void 0,this.autoscale||(this.dataRange={min:this.config.min||0,max:this.config.max});for(let t of this.tracks)t.autoscale=!1,t.dataRange=this.dataRange;return this.height=this.config.height||50,Promise.all(e)}get height(){return this._height}set height(e){if(this._height=e,this.tracks)for(let t of this.tracks)t.height=e,t.config.height=e}menuItemList(){let e=[];return this.flipAxis!==void 0&&e.push({label:"Flip y-axis",click:()=>{this.flipAxis=!this.flipAxis,this.trackView.repaintViews()}}),e=e.concat(Xt.numericDataMenuItems(this.trackView)),e}async getFeatures(e,t,n,s){let r=this.tracks.map(o=>o.getFeatures(e,t,n,s)),a=await Promise.all(r);return new mh(a)}draw(e){let t=e.features;for(let n=0,s=this.tracks.length;n<s;n++){let r=Object.assign({},e);r.features=t.featureArrays[n],this.tracks[n].dataRange=this.dataRange,this.tracks[n].flipAxis=this.flipAxis,this.tracks[n].logScale=this.logScale,this.graphType&&(this.tracks[n].graphType=this.graphType),this.tracks[n].draw(r)}}popupData(e){if(e.viewport&&e.viewport.cachedFeatures){let t=e.viewport.cachedFeatures.featureArrays;if(t&&t.length===this.tracks.length){let n=[];for(let s=0;s<this.tracks.length;s++){s>0&&n.push("<hr/>"),n.push(`<div style=background-color:rgb(245,245,245);border-bottom-style:dashed;border-bottom-width:1px;padding-bottom:5px;padding-top:10px;font-weight:bold;font-size:larger >${this.tracks[s].name}</div>`);let r=this.tracks[s].popupData(e,t[s]);n.push(...r)}return n}}}clickedFeatures(e){let t=e.viewport.cachedFeatures;if(!t)return[];let n=e.genomicLocation,s=[];for(let r of t.featureArrays){let a=e.referenceFrame.bpPerPixel>.2?3*e.referenceFrame.bpPerPixel:.2,o=n-a,l=n+a,c=Ls.findOverlapping(r,o,l);for(let h of c)s.push(h)}return s}get supportsWholeGenome(){return this.tracks.every(e=>e.supportsWholeGenome)}},mh=class{constructor(e){this.featureArrays=e}getMax(e,t){let n=-Number.MAX_VALUE;for(let s of this.featureArrays)for(let r of s)if(typeof r.value<"u"&&!Number.isNaN(r.value)){if(r.end<e)continue;if(r.start>t)break;n=Math.max(n,r.value)}return n}};function Ux(i){if(!i.arcType)return"nested";switch(i.arcType){case"chiapet":return"inView";case"chiapetoutbound":return"partialInView";default:return i.arcType}}var $x="rgb(180,25,137)",ra=class extends kt{static defaults={height:250,theta:Math.PI/4,arcOrientation:!0,showBlocks:!0,blockHeight:3,thickness:1,alpha:.02,logScale:!0};constructor(e,t){super(e,t)}init(e){super.init(e),this.sinTheta=Math.sin(this.theta),this.cosTheta=Math.cos(this.theta),this.arcType=Ux(e),this.alpha=e.alpha||.02,this.painter={flipAxis:!this.arcOrientation,dataRange:this.dataRange,paintAxis:Bn},e.valueColumn?(this.valueColumn=e.valueColumn,this.hasValue=!0):e.useScore&&(this.hasValue=!0,this.valueColumn="score"),e.max?(this.dataRange={min:e.min||0,max:e.max},this.autoscale=!1):this.autoscale=!0,e.featureSource?(this.featureSource=e.featureSource,delete e._featureSource):(this.featureSource=Bt(e,this.browser.genome),this.featureSource.getWGFeatures=qx)}async postInit(){if(!(typeof this.featureSource.getHeader=="function"&&(this.header=await this.featureSource.getHeader(),this.disposed)))return this.header&&this.setTrackProperties(this.header),this.visibilityWindow===void 0&&typeof this.featureSource.defaultVisibilityWindow=="function"&&(this.visibilityWindow=await this.featureSource.defaultVisibilityWindow(),this.featureSource.visibilityWindow=this.visibilityWindow),this}get supportsWholeGenome(){return!0}async getFeatures(e,t,n){let s=this.visibilityWindow,r=await this.featureSource.getFeatures({chr:e,start:t,end:n,visibilityWindow:s});return this.hasValue===void 0&&r&&r.length>0&&(this.hasValue=r[0].score!==void 0),r}draw(e){this.arcType==="proportional"?this.drawProportional(e):this.arcType==="inView"||this.arcType==="partialInView"?this.drawProportional(e):this.drawNested(e)}drawNested(e){let t=e.context,n=e.pixelWidth,s=e.pixelHeight,r=e.viewportWidth,a=e.bpPerPixel,o=e.bpStart,l=a;he.fillRect(t,0,e.pixelTop,n,s,{fillStyle:"rgb(255, 255, 255)"});let c=e.features;if(c){h.call(this);let d=this.arcOrientation?e.pixelHeight:0,f=this.arcOrientation;t.font="8px sans-serif",t.textAlign="center";for(let u of c){u.drawState=void 0;let g;if(typeof this.color=="function"?g=this.color(u):(g=this.color||u.color||$x,g&&this.config.useScore&&(g=jn(g,zy(u.score)))),t.lineWidth=u.thickness||this.thickness||1,u.chr1===u.chr2||u.chr==="all"){let{m1:_,m2:b}=Qu(u,this.browser.genome),w=Math.round((_-o)/l),p=Math.round((b-o)/l);if(p<0||w>n)continue;let m=p-w;m<3&&(m=3,w--);let v=m/2,x=v/this.sinTheta,R=this.cosTheta*x,M=w+v,C,L,y;if(f?(C=this.height+R,L=Math.PI+Math.PI/2-this.theta,y=Math.PI+Math.PI/2+this.theta):(C=-R,L=Math.PI/2-this.theta,y=Math.PI/2+this.theta),this.showBlocks&&u.chr!=="all"){let E=(u.start1-o)/l,k=(u.end1-o)/l,A=(u.start2-o)/l,I=(u.end2-o)/l,F=this.arcOrientation?-this.blockHeight:this.blockHeight;t.fillRect(E,d,k-E,F),t.fillRect(A,d,I-A,F)}g&&!this.config.useScore&&m>r&&(g=jn(g,this.alpha)),t.strokeStyle=g,t.fillStyle=g,t.beginPath(),t.arc(M,C,x,L,y,!1),t.stroke(),u.drawState={xc:M,yc:C,r:x}}else{let _=Math.round((u.start-o)/l),b=Math.round((u.end-o)/l);if(b<0||_>n)continue;let w=b-_;w<3&&(w=3,_--);let p=u.chr===u.chr1?u.chr2:u.chr1;t.strokeStyle=g,t.fillStyle=jn(Mn(p),.5),f?(t.fillRect(_,this.height/2,w,this.height/2),t.fillText(p,_+w/2,this.height/2-5),u.drawState={x:_,y:this.height/2,w,h:this.height/2}):(t.fillRect(_,0,w,this.height/2),t.fillText(p,_+w/2,this.height/2+13),u.drawState={x:_,y:0,w,h:this.height/2})}}}function h(){let d=0;for(let u of c){let g=(u.start-o)/l,_=(u.end-o)/l;g>=0&&_<=n&&(d=Math.max(d,_-g))}let f=Math.min(r,d)/2;if(d>0){let u=(s-10)/f;this.theta=Vx(u),this.sinTheta=Math.sin(this.theta),this.cosTheta=Math.cos(this.theta)}}}getScaleFactor(e,t,n,s){return s?n/(Math.log10(t+1)-(e<=0?0:Math.log10(e+1))):n/(t-e)}drawProportional(e){let t=e.context,n=e.pixelWidth,s=e.pixelHeight,r=e.bpPerPixel,a=e.bpStart,o=r,l=e.referenceFrame.start,c=e.referenceFrame.end;he.fillRect(t,0,e.pixelTop,n,s,{fillStyle:"rgb(255, 255, 255)"});let h=e.features;if(h&&h.length>0){let f=this.getScaleFactor(0,this.dataRange.max,e.pixelHeight-1,this.logScale),u=this.arcOrientation?e.pixelHeight:0;for(let g of h){g.drawState=void 0;let _=this.valueColumn?g[this.valueColumn]:g.score;if(_===void 0||Number.isNaN(_))continue;let b=Math.round((this.logScale?Math.log10(_+1):_)*f);if(g.chr1===g.chr2||g.chr==="all"){let{m1:w,m2:p}=Qu(g,this.browser.genome),m=Math.round((w-a)/o),x=Math.round((p-a)/o)-m;if(x<3&&(x=3,m--),_<this.dataRange.min||_>this.dataRange.max)continue;if(this.arcType!=="proportional"){let y=this.arcType==="partialInView",E=w>=l&&p<=c,k=!1,A=!1;if(!E&&y&&(k=l<=w&&w<=c,k||(A=l<=p&&p<=c)),!(E||k||A))continue}let R=x/2,M=m+x/2;g.drawState={xc:M,yc:u,radiusX:R,radiusY:b};let C=!!this.arcOrientation,L=g.color||this.color;if(t.strokeStyle=L,t.lineWidth=g.thickness||this.thickness||1,t.isSVG===!0?t.strokeEllipse(M,u,R,b,0,0,Math.PI,C):(t.beginPath(),t.ellipse(M,u,R,b,0,0,Math.PI,C),t.stroke()),this.alpha&&(t.fillStyle=jn(L,this.alpha),t.isSVG===!0?t.fillEllipse(M,u,R,b,0,0,Math.PI,C):t.fill()),this.showBlocks&&g.chr!=="all"){t.fillStyle=L;let y=(g.start1-a)/o,E=(g.end1-a)/o,k=(g.start2-a)/o,A=(g.end2-a)/o,I=this.arcOrientation?-this.blockHeight:this.blockHeight;t.fillRect(y,u,E-y,I),t.fillRect(k,u,A-k,I)}}else{let w=Math.round((g.start-a)/o),p=Math.round((g.end-a)/o);if(p<0||w>n||_<this.dataRange.min||_>this.dataRange.max)continue;let m=Math.min(b,this.height-13),v=p-w;v<3&&(v=3,w--);let x=g.chr===g.chr1?g.chr2:g.chr1;if(t.font="8px sans-serif",t.textAlign="center",t.fillStyle=jn(Mn(x),.5),this.arcOrientation){let R=this.height-m;t.fillRect(w,R,v,m),t.fillText(x,w+v/2,R-5),g.drawState={x:w,y:R,w:v,h:m}}else t.fillRect(w,0,v,m),t.fillText(x,w+v/2,m+13),g.drawState={x:w,y:0,w:v,h:m}}}}}clearAxis(e,t,n){he.fillRect(e,0,0,t,n,{fillStyle:"rgb(255, 255, 255)"})}paintAxis(e,t,n){let s={min:0,max:this.dataRange.max};this.arcType==="proportional"?(this.painter.flipAxis=!this.arcOrientation,this.painter.dataRange=s,this.painter.paintAxis(e,t,n)):this.arcType==="inView"||this.arcType==="partialInView"?(this.painter.flipAxis=!this.arcOrientation,this.painter.dataRange=s,this.painter.paintAxis(e,t,n)):this.clearAxis(e,t,n)}menuItemList(){let e=[];if(this.hasValue){e.push("<hr/>");let t={nested:"Nested",proportional:"Proportional - All",inView:"Proportional - Both Ends in View",partialInView:"Proportional - One End in View"};e.push("<b>Arc Type</b>");for(let n of["nested","proportional","inView","partialInView"])e.push({object:pe(ot(t[n],n===this.arcType)),click:()=>{this.arcType=n,this.trackView.repaintViews()}})}return e.push("<hr/>"),e.push({name:"Toggle arc direction",click:()=>{this.arcOrientation=!this.arcOrientation,this.trackView.repaintViews()}}),e.push({name:this.showBlocks?"Hide Blocks":"Show Blocks",click:()=>{this.showBlocks=!this.showBlocks,this.trackView.repaintViews()}}),(this.arcType==="proportional"||this.arcType==="inView"||this.arcType==="partialInView")&&(e=e.concat(Xt.numericDataMenuItems(this.trackView))),this.browser.circularView&&(e.push("<hr/>"),e.push({label:"Add interactions to circular view",click:()=>{for(let t of this.trackView.viewports)this.addChordsForViewport(t.referenceFrame)}})),e}contextMenuItemList(e){if(this.browser.circularView){let t=e.viewport,n=[];return n.push({label:"Add interactions to circular view",click:()=>{let s=t.referenceFrame;this.addChordsForViewport(s)}}),n.push("<hr/>"),n}}addChordsForViewport(e){let n=(e.chr==="all"?this.featureSource.getAllFeatures():this.featureSource.featureCache.queryFeatures(e.chr,e.start,e.end)).filter(r=>r.drawState);if(n.length===0)return;let s=hx(n);ta(s,this,e,.5)}doAutoscale(e){let t=0;if(e)for(let n of e){let s=this.valueColumn?n[this.valueColumn]:n.score;Number.isNaN(s)||(t=Math.max(t,s))}return{min:0,max:t}}popupData(e,t){t===void 0&&(t=this.clickedFeatures(e));let n=[];for(let s of t){let r=s._||s;if(n.push({name:"Region 1",value:Ku(r.chr1,r.start1,r.end1,r.strand1)}),n.push({name:"Region 2",value:Ku(r.chr2,r.start2,r.end2,r.strand2)}),r.name&&n.push({name:"Name",value:r.name}),r.value!==void 0&&n.push({name:"Value",value:r.value}),r.score!==void 0&&n.push({name:"Score",value:r.score}),r.extras&&this.header&&this.header.columnNames){let a=this.header.columnNames,o=this.header.hiccups?6:10;for(let l=o;l<a.length;l++)this.header.colorColumn!==l&&(a[l]==="info"?Wx(n,r.extras[l-o]):n.push({name:a[l],value:r.extras[l-o]}))}break}return n}clickedFeatures(e){let t=e.viewport.cachedFeatures,n=[];if(t){let s=this.arcType==="proportional"||this.arcType==="inView"||this.arcType==="partialInView";for(let r of t)if(r.drawState)if(r.chr1===r.chr2||r.chr==="all")if(s){let{xc:a,yc:o,radiusX:l,radiusY:c}=r.drawState,h=e.canvasX-a,d=e.canvasY-o,f=h/l*(h/l)+d/c*(d/c);f<=1&&n.push({score:1/f,feature:r})}else{let{xc:a,yc:o,r:l}=r.drawState,c=e.canvasX-a,h=e.canvasY-o,d=Math.abs(Math.sqrt(c*c+h*h)-l);d<5&&n.push({score:d,feature:r})}else{let{x:a,y:o,w:l,h:c}=r.drawState,h=5;if(e.canvasX>=a-h&&e.canvasX<=a+l+h&&e.canvasY>=o&&e.canvasY<=o+c){let d=-Math.abs(e.canvasX-(a+l/2));n.push({score:d,feature:r});break}}}return n.length>1&&n.sort((s,r)=>s.score-r.score),n.map(s=>s.feature)}};function Qu(i,e){let t=(i.start1+i.end1)/2,n=(i.start2+i.end2)/2;if(i.chr==="all"&&(t=e.getGenomeCoordinate(i.chr1,t),n=e.getGenomeCoordinate(i.chr2,n)),t>n){let s=t;t=n,n=s}return{m1:t,m2:n}}function Ku(i,e,t,n){return n&&n!=="."?`${i}:${De(e+1)}-${De(t)} (${n})`:`${i}:${De(e+1)}-${De(t)}`}function Vx(i){let e=[.01570925532366355,.15838444032453644,.3249196962329063,.5095254494944288,.7265425280053609,.9999999999999999],t=[.031415926535897934,.3141592653589793,.6283185307179586,.9424777960769379,1.2566370614359172,1.5707963267948966],n;for(n=0;n<e.length&&!(e[n]>i);n++);let s=n===0?0:e[n-1],r=n<e.length?e[n]:1,a=(i-s)/(r-s),o=n===0?0:t[n-1],l=n<t.length?t[n]:Math.PI/2;return Math.min(Math.PI/2,o+a*(l-o))}var Ju=new Map;function jn(i,e){let t=`${i}_${e}`,n=Ju.get(t);return n||(n=Ve.addAlpha(i,e),Ju.set(t,n)),n}function qx(i){let e=f=>{let u=Object.assign({},f);return u.chr="all",u.start=t.getGenomeCoordinate(f.chr1,f.start1),u.end=t.getGenomeCoordinate(f.chr2,f.end2),u},t=this.genome,n,s=0;for(let f of t.wgChromosomeNames){let u=i[f];if(u)for(let g of u)g.dup||(s++,g.score&&(!n||g.score>n.score)&&(n=g))}let r=this.maxWGCount,a=n&&n.score>0&&s>r?5:1,o=Math.floor(r/a),l=n&&n.score>0?Math.log(n.score)/a:Number.MAX_SAFE_INTEGER,c=[],h=[];for(let f=0;f<a;f++)h.push([0]),c.push([]);for(let f of t.wgChromosomeNames){let u=i[f];if(u){for(let g of u)if(!g.dup){let _=g.score?Math.max(0,Math.min(a-1,Math.floor(Math.log(g.score)/l))):0;if(c[_].length<o)c[_].push(e(g));else{let b=o/(h[_]+1);if(Math.random()<b){let w=Math.floor(Math.random()*(o-1));c[_][w]=e(g)}}h[_]++}}}let d;if(a===1)d=c[0];else{d=[];for(let f of c)for(let u of f)d.push(u);n&&d.push(e(n)),d.sort(function(f,u){return f.start-u.start}),console.log(d.length)}return d}function Wx(i,e){let t=e.split(";");for(let n of t){let s=n.split("=");s.length===2&&i.push({name:s[0],value:s[1]})}}var jx=yt,Gx="rgb(0,0,150)",Zx=1e6,Gn=10,ed=new Map([["REF","referenceBases"],["ALT","alternateBases"],["QUAL","quality"],["FILTER","filter"]]),bh=class extends kt{static defaults={displayMode:"EXPANDED",sortDirection:"ASC",showGenotypes:!0,squishedVariantHeight:2,squishedCallHeight:1,expandedCallHeight:10,expandedVGap:2,squishedVGap:1,expandedGroupGap:10,squishedGroupGap:5,featureHeight:14,noGenotypeColor:"rgb(200,180,180)",noCallColor:"rgb(225, 225, 225)",nonRefColor:"rgb(200, 200, 215)",mixedColor:"rgb(200, 220, 200)",homrefColor:"rgb(200, 200, 200)",homvarColor:"rgb(17,248,254)",hetvarColor:"rgb(34,12,253)",colorBy:void 0,visibilityWindow:void 0,labelDisplayMode:void 0,type:"variant"};constructor(e,t){super(e,t)}init(e){super.init(e),this.expandedVariantHeight=e.expandedVariantHeight||e.variantHeight||10,this.featureSource=Bt(e,this.browser.genome),this._initColorBy=e.colorBy,e.colorTable&&(this.colorTables=new Map,this.colorTables.set(e.colorBy,new Gi(e.colorTable))),this._color=e.color,this._strokecolor=e.strokecolor,this._context_hook=e.context_hook,this.variantRowCount(1)}async postInit(){if(this.header=await this.getHeader(),!this.disposed){if(this.visibilityWindow===void 0&&this.config.indexed!==!1){let e=Ei(this.config.url)?this.config.url.name:this.config.url;jx(e)&&e.toLowerCase().includes("gnomad")?this.visibilityWindow=1e3:typeof this.featureSource.defaultVisibilityWindow=="function"?this.visibilityWindow=await this.featureSource.defaultVisibilityWindow():this.visibilityWindow=Zx}return this}}get supportsWholeGenome(){return this.config.indexed===!1||this.config.supportsWholeGenome===!0}get color(){return this._color||Gx}set color(e){this._color=e,this.colorBy=void 0}async getHeader(){if(!this.header){if(typeof this.featureSource.getHeader=="function"){let e=await this.featureSource.getHeader();e&&(this.callSets=e.callSets||[]),this.header=e}this.sampleNames=this.callSets?this.callSets.map(e=>e.name):[]}return this.header}getCallsetsLength(){return this.callSets?this.callSets.length:0}async getFeatures(e,t,n,s){return this.header===void 0&&(this.header=await this.getHeader()),this.featureSource.getFeatures({chr:e,start:t,end:n,bpPerPixel:s,visibilityWindow:this.visibilityWindow})}hasSamples(){return this.getCallsetsLength()>0}getSamples(){return{yOffset:this.sampleYOffset,names:this.sampleNames,height:this.sampleHeight}}computePixelHeight(e){if(!e||e.length==0)return Gn;let t=this.displayMode==="COLLAPSED"?1:this.nVariantRows,n=this.displayMode==="SQUISHED"?this.squishedVGap:this.expandedVGap,s=this.displayMode==="SQUISHED"?this.squishedVariantHeight:this.expandedVariantHeight,r=this.displayMode==="SQUISHED"?this.squishedCallHeight:this.expandedCallHeight,a=this.showGenotypes===!1?0:this.getCallsetsLength()*t;return Gn+t*(s+n)+n+(a+1)*(r+n)}variantRowCount(e){this.nVariantRows=e}draw({context:e,pixelWidth:t,pixelHeight:n,bpPerPixel:s,bpStart:r,pixelTop:a,features:o}){he.fillRect(e,0,a,t,n,{fillStyle:"rgb(255, 255, 255)"});let l=this.displayMode==="SQUISHED"?this.squishedVGap:this.expandedVGap,c=this.displayMode==="COLLAPSED"?1:this.nVariantRows,h=this.displayMode==="SQUISHED"?this.squishedVariantHeight:this.expandedVariantHeight;this.variantBandHeight=Gn+c*(h+l);let d=this.callSets;!d&&this._f&&(d=this._f.callSets);let f=this.getCallsetsLength();if(d&&f>0&&this.showGenotypes!==!1&&he.strokeLine(e,0,this.variantBandHeight,t,this.variantBandHeight,{strokeStyle:"rgb(224,224,224) "}),o){let u=this.displayMode==="SQUISHED"?this.squishedCallHeight:this.expandedCallHeight,g=this.displayMode==="SQUISHED"?this.squishedVGap:this.expandedVGap,_=r+t*s+1;for(let b of o){if(b.end<r)continue;if(b.start>_)break;let w=this.displayMode==="SQUISHED"?this.squishedVariantHeight:this.expandedVariantHeight,p=Gn+(this.displayMode==="COLLAPSED"?0:b.row*(w+g)),m=w,v=Math.round((b.start-r)/s),x=Math.round((b.end-r)/s),R=Math.max(1,x-v);R<3?(R=3,v-=1):R>5&&(v+=1,R-=2),e.fillStyle=this.getColorForFeature(b),e.fillRect(v,p,R,m);let M=this.getVariantStrokecolor(b);if(M&&(e.strokeStyle=M,e.strokeRect(v,p,R,m)),this.callContextHook(b,e,v,p,R,m),b.pixelRect={x:v,y:p,w:R,h:m},f>0&&this.showGenotypes!==!1){let C=this.displayMode==="COLLAPSED"?1:this.nVariantRows;this.sampleYOffset=this.variantBandHeight+g,this.sampleHeight=C*(u+g);let L=0;if(d&&b.calls)for(let y of d){let E=b.calls[y.id];if(E){let k=this.displayMode==="COLLAPSED"?0:b.row,A=this.sampleYOffset+L*this.sampleHeight+k*(u+g),I=!0,F=!0,X=!1;if(E.genotype)for(let U of E.genotype)if(U==="."){X=!0;break}else U!==0&&(F=!1),U===0&&(I=!1);E.genotype?X?e.fillStyle=this.noCallColor:F?e.fillStyle=this.homrefColor:I?e.fillStyle=this.homvarColor:e.fillStyle=this.hetvarColor:e.fillStyle=this.noGenotypeColor,e.fillRect(v,A,R,u),y.pixelRect={x:v,y:A,w:R,h:u}}L++}}}}else console.log("No feature list")}getColorForFeature(e){let t=e._f||e,n;if(this.colorBy){let s=this.colorBy,r;if(t.info.hasOwnProperty(s))r=t.info[s];else if(ed.has(s)){let a=ed.get(s);r=t[a]}n=this.getVariantColorTable(s).getColor(r),n||(n="gray")}else this._color?n=typeof this._color=="function"?this._color(e):this._color:t.type==="NONVARIANT"?n=this.nonRefColor:t.type==="MIXED"?n=this.mixedColor:n=this.color;return n}getVariantStrokecolor(e){let t=e._f||e,n;return this._strokecolor?n=typeof this._strokecolor=="function"?this._strokecolor(t):this._strokecolor:n=void 0,n}callContextHook(e,t,n,s,r,a){if(this._context_hook&&typeof this._context_hook=="function"){let o=e._f||e;t.save(),this._context_hook(o,t,n,s,r,a),t.restore()}}clickedFeatures(e){let t=super.clickedFeatures(e),n=this.displayMode==="EXPANDED"?this.expandedVGap:this.squishedVGap,s=n+(this.displayMode==="SQUISHED"?this.squishedCallHeight:this.expandedCallHeight),r=e.y;if(r<=this.variantBandHeight){let a=this.displayMode==="SQUISHED"?this.squishedVariantHeight:this.expandedVariantHeight,o=Math.floor((r-Gn)/(a+n));this.displayMode!=="COLLAPSED"&&(t=t.filter(l=>l.row===o))}else if(this.callSets){let a=this.callSets,o=r-this.variantBandHeight,l=Math.floor(o/this.sampleHeight);if(l>=0&&l<a.length){let c=Math.floor((o-l*this.sampleHeight)/s),h=this.displayMode==="COLLAPSED"?t:t.filter(f=>f.row===c),d=a[l];t=h.map(f=>{let u=f.calls[d.id];return Xx(u,f),u})}}return t}popupData(e,t){t===void 0&&(t=this.clickedFeatures(e));let n=e.genomicLocation,s=this.browser.genome.id,r=this.browser.sampleInformation,a=[];for(let c of t){let h=c._f||c;if(a.length>0&&a.push({html:'<hr style="border-top-width:2px ;border-color: #c9c3ba" />'}),typeof h.popupData=="function"){let d=h.popupData(n,s);Array.prototype.push.apply(a,d)}else{let d=h;if(d.callSetName!==void 0&&a.push({name:"Name",value:d.callSetName}),d.genotypeName&&a.push({name:"Genotype",value:d.genotypeName}),d.phaseset!==void 0&&a.push({name:"Phase set",value:d.phaseset}),d.genotypeLikelihood!==void 0&&a.push({name:"genotypeLikelihood",value:d.genotypeLikelihood.toString()}),r){var o=r.getAttributes(d.callSetName);o&&Object.keys(o).forEach(function(f){var u=f.replace(/([A-Z])/g," $1");u=u.charAt(0).toUpperCase()+u.slice(1),a.push({name:u,value:o[f]})})}var l=Object.keys(d.info);l.length&&a.push("<hr/>"),l.forEach(function(f){a.push({name:f,value:decodeURIComponent(d.info[f])})})}}return a}menuItemList(){let e=[];if(this.header.INFO&&this.header.INFO){let n=this.header.INFO.SVTYPE?["SVTYPE"]:[];if(this._initColorBy&&this._initColorBy!=="SVTYPE"&&n.push(this._initColorBy),n.length>0){e.push("<hr/>");let s=pe('<div class="igv-track-menu-category igv-track-menu-border-top">');s.text("Color by:"),e.push({name:void 0,object:s,click:void 0,init:void 0}),n.sort();for(let r of n){let a=this.colorBy===r,o=r||"None";e.push(this.colorByCB({key:r,label:o},a))}e.push(this.colorByCB({key:void 0,label:"None"},this.colorBy===void 0)),e.push("<hr/>")}}this.getCallsetsLength()>0&&(e.push({object:pe('<div class="igv-track-menu-border-top">')}),e.push({object:pe(ot("Show Genotypes",this.showGenotypes)),click:()=>{this.showGenotypes=!this.showGenotypes,this.trackView.checkContentHeight(),this.trackView.repaintViews()}})),e.push({object:pe('<div class="igv-track-menu-border-top">')});for(let n of["COLLAPSED","SQUISHED","EXPANDED"]){var t={COLLAPSED:"Collapse",SQUISHED:"Squish",EXPANDED:"Expand"};e.push({object:pe(ot(t[n],n===this.displayMode)),click:()=>{this.displayMode=n,this.trackView.checkContentHeight(),this.trackView.repaintViews()}})}return this.browser.circularView&&(e.push("<hr>"),e.push({label:"Add SVs to circular view",click:()=>{for(let n of this.trackView.viewports)this.sendChordsForViewport(n)}})),e}contextMenuItemList(e){if(this.browser.circularView){let t=e.viewport,n=[];return n.push({label:"Add SVs to Circular View",click:()=>{this.sendChordsForViewport(t)}}),n.push("<hr/>"),n}}sendChordsForViewport(e){let t=e.referenceFrame,n;if(t.chr==="all"){let r=this.featureSource.getAllFeatures(),a=Object.keys(r).map(o=>r[o]);n=[].concat(...a)}else n=this.featureSource.featureCache.queryFeatures(t.chr,t.start,t.end);let s=cx(n);ta(s,this,t,.5)}colorByCB(e,t){return{name:void 0,object:pe(ot(e.label,t)),click:()=>{e.key===this.colorBy?(this.colorBy=void 0,delete this.config.colorBy,this.trackView.repaintViews()):(this.colorBy=e.key,this.config.colorBy=e.key,this.trackView.repaintViews())},init:void 0}}getState(){let e=super.getState();return this._color&&typeof this._color!="function"&&(e.color=this._color),e}getVariantColorTable(e){if(this.colorTables||(this.colorTables=new Map),!this.colorTables.has(e)){let t;switch(e){case"SVTYPE":t=Yx;break;default:t=new ji("Set1")}this.colorTables.set(e,t)}return this.colorTables.get(e)}};function Xx(i,e){if(i.genotype){let t="";if(e.alternateBases===".")t="No Call";else{let n=e.alternateBases.split(",");for(let s of i.genotype)if(t.length>0&&(t+="|"),s===".")t+=".";else if(s===0)t+=e.referenceBases;else{let r=n[s-1].replace("<","&lt;");t+=r}}i.genotypeName=t}}var Yx=new Gi({DEL:"#ff2101",INS:"#001888",DUP:"#028401",INV:"#008688",CNV:"#8931ff",BND:"#891100","*":"#002eff"}),wh=class extends kt{constructor(e,t){super(e,t)}init(e){super.init(e),this.name=e.name,this.pValueField=e.pValueField||"pValue",this.geneField=e.geneField||"geneSymbol",this.snpField=e.snpField||"snp";let t=e.minLogP||e.min,n=e.maxLogP||e.max;this.dataRange={min:t||3.5,max:n||25},n?this.autoscale=e.autoscale:this.autoscale=!0,this.autoscalePercentile=e.autoscalePercentile===void 0?98:e.autoscalePercentile,this.background=e.background,this.divider=e.divider||"rgb(225,225,225)",this.dotSize=e.dotSize||2,this.height=e.height||100,this.autoHeight=!1,this.disableButtons=e.disableButtons,this.visibilityWindow=e.visibilityWindow===void 0?2e6:e.visibilityWindow>=0?Math.min(2e6,e.visibilityWindow):2e6,this.featureSource=Bt(e,this.browser.genome),Cc.gtexLoaded=!0}paintAxis(e,t,n){let s=(this.dataRange.max-this.dataRange.min)/n,r={font:"normal 10px Arial",textAlign:"right",strokeStyle:"black"};he.fillRect(e,0,0,t,n,{fillStyle:"rgb(255, 255, 255)"});let a=Math.ceil((this.dataRange.max-this.dataRange.min)*10/n);for(let o=4;o<=this.dataRange.max;o+=a){let l=.85*t,c=l-5,h=l,d=n-(o-this.dataRange.min)/s;he.strokeLine(e,c,d,h,d,r),d>8&&he.fillText(e,o,c-1,d+2,r)}r.textAlign="center",he.fillText(e,"-log10(pvalue)",t/4,n/2,r,{rotate:{angle:-90}})}async getFeatures(e,t,n){let s=this.pValueField,r=this.visibilityWindow,a=await this.featureSource.getFeatures({chr:e,start:t,end:n,visibilityWindow:r});return a.forEach(function(o){o.value=o[s]}),a}draw(e){let t=e.context,n=e.pixelWidth,s=e.pixelHeight;this.background&&he.fillRect(t,0,0,n,s,{fillStyle:this.background}),he.strokeLine(t,0,s-1,n,s-1,{strokeStyle:this.divider});let r=a=>{let o=a?2*this.dotSize:this.dotSize,l=e.bpStart,c=(this.dataRange.max-this.dataRange.min)/s,h=e.referenceFrame.selection;for(let f of e.features){let u=(f.start-l+.5)/e.bpPerPixel;if(u<0)continue;if(u>n)break;let g=f.snp.toUpperCase(),_=f[this.geneField].toUpperCase(),b=h&&(h.snp===g||h.gene===_);if(!a||b){h&&h.snp===g&&h.addGene(_);var d=-Math.log(f[this.pValueField])/Math.LN10;if(d>=this.dataRange.min){let w;d>this.dataRange.max?(d=this.dataRange.max,w=!0):w=!1;let p=Math.max(0+o,s-Math.round((d-this.dataRange.min)/c));f.px=u,f.py=p,f.radius=o;let m;a&&h?(m=h.colorForGene(_),he.setProperties(t,{fillStyle:m,strokeStyle:"black"})):(m=w?"rgb(150, 150, 150)":"rgb(180, 180, 180)",he.setProperties(t,{fillStyle:m,strokeStyle:m})),he.fillCircle(t,u,p,o),he.strokeCircle(t,u,p,o)}}}};r(!1),r(!0)}popupData(e,t){if(t===void 0&&(t=e.viewport.cachedFeatures),!t||t.length===0)return[];let n=3,s=this.name,r=[];for(let a of t)Math.abs(a.px-e.canvasX)<a.radius+n&&Math.abs(a.py-e.canvasY)<a.radius+n&&(r.length>0&&r.push("<hr/>"),r.push({name:"snp id",value:a.snp},{name:"gene id",value:a.geneId},{name:"gene name",value:a.geneName},{name:"p value",value:a.pValue},{name:"tissue",value:s}));return r}menuItemList(){return Xt.numericDataMenuItems(this.trackView)}doAutoscale(e){if(e.length>0){var t=e.map(function(n){return-Math.log(n.value)/Math.LN10});this.dataRange.max=gt.percentile(t,this.autoscalePercentile)}else{let n=this.config.maxLogP||this.config.max;this.dataRange.max=n||25}return this.dataRange}},xn={X:"rgb(204, 153, 0)",Y:"rgb(153, 204, 0)",Un:"darkGray)",1:"rgb(80, 80, 255)",2:"rgb(206, 61, 50)","2a":"rgb(210, 65, 55)","2b":"rgb(215, 70, 60)",3:"rgb(116, 155, 88)",4:"rgb(240, 230, 133)",5:"rgb(70, 105, 131)",6:"rgb(186, 99, 56)",7:"rgb(93, 177, 221)",8:"rgb(128, 34, 104)",9:"rgb(107, 215, 107)",10:"rgb(213, 149, 167)",11:"rgb(146, 72, 34)",12:"rgb(131, 123, 141)",13:"rgb(199, 81, 39)",14:"rgb(213, 143, 92)",15:"rgb(122, 101, 165)",16:"rgb(228, 175, 105)",17:"rgb(59, 27, 83)",18:"rgb(205, 222, 183)",19:"rgb(97, 42, 121)",20:"rgb(174, 31, 99)",21:"rgb(231, 199, 111)",22:"rgb(90, 101, 94)",23:"rgb(204, 153, 0)",24:"rgb(153, 204, 0)",25:"rgb(51, 204, 0)",26:"rgb(0, 204, 51)",27:"rgb(0, 204, 153)",28:"rgb(0, 153, 204)",29:"rgb(10, 71, 255)",30:"rgb(71, 117, 255)",31:"rgb(255, 194, 10)",32:"rgb(255, 209, 71)",33:"rgb(153, 0, 51)",34:"rgb(153, 26, 0)",35:"rgb(153, 102, 0)",36:"rgb(128, 153, 0)",37:"rgb(51, 153, 0)",38:"rgb(0, 153, 26)",39:"rgb(0, 153, 102)",40:"rgb(0, 128, 153)",41:"rgb(0, 51, 153)",42:"rgb(26, 0, 153)",43:"rgb(102, 0, 153)",44:"rgb(153, 0, 128)",45:"rgb(214, 0, 71)",46:"rgb(255, 20, 99)",47:"rgb(0, 214, 143)",48:"rgb(20, 255, 177)"};for(let i of Object.keys(xn)){let e="chr"+i;xn[e]=xn[i]}for(let i=1;i<=48;i++){if(i===10)continue;let e=Qx(i);xn[e]=xn[i.toString()]}function Qx(i){if(!+i)return!1;for(var e=String(+i).split(""),t=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],n="",s=3;s--;)n=(t[+e.pop()+s*10]||"")+n;return Array(+e.join("")+1).join("M")+n}var Kx=1e8,vh=class extends kt{constructor(e,t){super(e,t)}init(e){super.init(e),this.useChrColors=e.useChrColors===void 0?!0:e.useChrColors,this.trait=e.trait,this.posteriorProbability=e.posteriorProbability,this.valueProperty=e.format==="bed"?"score":"value",this.height=e.height||100,this.autoscale=e.autoscale,this.autoscalePercentile=e.autoscalePercentile===void 0?98:e.autoscalePercentile,this.background=e.background,this.divider=e.divider||"rgb(225,225,225)",this.dotSize=e.dotSize||3,this.popoverWindow=e.popoverWindow===void 0?Kx:e.popoverWindow,this.useChrColors?this.colorScale=new Gi(e.colorTable||xn):e.color?this.colorScale=new ph(e.color):this.colorScale=new km(e.colorScale||{thresholds:[5e-8,5e-4,.5],colors:["rgb(255,50,50)","rgb(251,100,100)","rgb(251,170,170)","rgb(227,238,249)"]}),this.featureSource=Bt(e,this.browser.genome)}async postInit(){if(!(typeof this.featureSource.getHeader=="function"&&(this.header=await this.featureSource.getHeader(),this.disposed)))return this.header&&this.setTrackProperties(this.header),this.autoscale||(this.posteriorProbability?this.dataRange={min:this.config.min===void 0?0:this.config.min,max:this.config.max===void 0?1:this.config.max}:this.dataRange={min:this.config.min===void 0?0:this.config.min,max:this.config.max===void 0?25:this.config.max}),this}get supportsWholeGenome(){return!0}async getFeatures(e,t,n){let s=this.visibilityWindow;return this.featureSource.getFeatures({chr:e,start:t,end:n,visibilityWindow:s})}draw(e){let t=e.features,n=e.context,s=e.pixelWidth,r=e.pixelHeight;if(this.background&&he.fillRect(n,0,0,s,r,{fillStyle:this.background}),he.strokeLine(n,0,r-1,s,r-1,{strokeStyle:this.divider}),t){let a=e.bpPerPixel,o=e.bpStart,l=o+s*a+1;for(let c of t){let h=c.start;if(h<o)continue;if(h>l)break;let d;if(this.posteriorProbability)d=c[this.valueProperty];else{let w=c[this.valueProperty];if(!w)continue;d=-Math.log10(w)}let f=this.useChrColors?c._f?c._f.chr:c.chr:d,u=this.colorScale.getColor(f),g=(this.dataRange.max-this.dataRange.min)/r,_=Math.round((h-o)/a),b=Math.max(this.dotSize,r-Math.round((d-this.dataRange.min)/g));u&&he.setProperties(n,{fillStyle:u,strokeStyle:"black"}),he.fillCircle(n,_,b,this.dotSize),c.px=_,c.py=b}}}paintAxis(e,t,n){he.fillRect(e,0,0,t,n,{fillStyle:"rgb(255, 255, 255)"});var s={font:"normal 10px Arial",textAlign:"right",strokeStyle:"black"};let r=(this.dataRange.max-this.dataRange.min)/n;if(this.posteriorProbability)for(let o=this.dataRange.min;o<this.dataRange.max;o+=.1){let l=n-Math.round((o-this.dataRange.min)/r);he.strokeLine(e,45,l-2,50,l-2,s),he.fillText(e,o.toFixed(1),44,l+2,s)}else{let a=Math.ceil((this.dataRange.max-this.dataRange.min)*10/n);for(let o=this.dataRange.min;o<this.dataRange.max;o+=a){let l=n-Math.round((o-this.dataRange.min)/r);he.strokeLine(e,45,l,50,l,s),he.fillText(e,Math.floor(o),44,l+4,s)}}s.textAlign="center",this.posteriorProbability?he.fillText(e,"PPA",t/2,n/2,s,{rotate:{angle:-90}}):he.fillText(e,"-log10(pvalue)",t/2,n/2,s,{rotate:{angle:-90}})}popupData(e,t){t===void 0&&(t=e.viewport.cachedFeatures);let n=[],s=e.viewport.trackView.track;if(t){let r=0;for(let a of t){let o=Math.abs(e.canvasX-a.px),l=Math.abs(e.canvasY-a.py),c=a[this.valueProperty];if(o<this.dotSize&&l<this.dotSize){if(r>0&&n.push("<HR/>"),r==5){n.push("...");break}if(typeof a.popupData=="function")n=n.concat(a.popupData());else{let h=a.realChr||a.chr,d=(a.realStart||a.start)+1;n.push({name:"chromosome",value:h}),n.push({name:"position",value:d}),n.push({name:"name",value:a.name}),s.posteriorProbability?n.push({name:"posterior probability",value:c}):n.push({name:"pValue",value:c})}r++}}}return n}menuItemList(){return Xt.numericDataMenuItems(this.trackView)}doAutoscale(e){if(e.length>0){let t=this.valueProperty,n=this.posteriorProbability,s=e.map(function(r){let a=r[t];return{value:n?a:-Math.log(a)/Math.LN10}});this.dataRange=mc(s)}else this.posteriorProbability?this.dataRange={min:this.config.min||0,max:this.config.max||1}:this.dataRange={min:this.config.max||25,max:this.config.min||0};return this.dataRange}},td=1,_h=class extends kt{constructor(e,t){super(e,t)}init(e){super.init(e),this.autoscale=e.autoscale||e.max===void 0,this.dataRange={min:e.min||0,max:e.max},this.windowFunction=e.windowFunction||"mean",this.paintAxis=Bn,this.graphType=e.graphType||"bar",e._featureSource?(this.featureSource=e._featureSource,delete e._featureSource):this.featureSource=Bt(this.config,this.browser.genome),this.visibilityWindow=-1,this.featureSource.visibilityWindow=this.visibilityWindow}async postInit(){if(typeof this.featureSource.getHeader=="function"){if(this.header=await this.featureSource.getHeader(),this.disposed)return;if(this.sampleNames=this.header.columnNames.slice(3),this.setTrackProperties(this.header),this.header.hasOwnProperty("clickToHighlight")){let e=this.header.clickToHighlight;this.config.clickToHighlight=e,this.config.samplesClickedToHighlight={}}if(this.header.hasOwnProperty("highlight")){this.config.highlightSamples={};let e=this.header.highlight;Array.isArray(e)||(e=[e]);for(let t of e){let n=t.split(";");n.length===2&&(this.config.highlightSamples[n[0]]=n[1])}}}}menuItemList(){return Xt.numericDataMenuItems(this.trackView)}async getFeatures(e,t,n){let s=await this.featureSource.getFeatures({chr:e,start:0,end:Number.MAX_SAFE_INTEGER,visibilityWindow:this.visibilityWindow}),r,a;for(let o=1;o<s.length-1;o++)if(r===void 0&&s[o].end>t&&(r=o-1),a===void 0&&s[o].start>n){a=o+1;break}return r===void 0&&(r=0),a===void 0&&(a=s.length),s.slice(r,a)}draw(e){let{features:t,context:n,bpPerPixel:s,bpStart:r,pixelWidth:a,pixelHeight:o}=e,l=d=>(this.dataRange.max-d)/(this.dataRange.max-this.dataRange.min)*o,c=function(d){let f=Math.floor((d-r)/s);return isNaN(f)&&console.warn("isNaN(x). feature start "+De(d)+" bp start "+De(r)),f},h=d=>{if(this.config.hasOwnProperty("guideLines")){for(let f of this.config.guideLines)if(f.hasOwnProperty("color")&&f.hasOwnProperty("y")&&f.hasOwnProperty("dotted")){let u=l(f.y),g={strokeStyle:f.color,strokeWidth:2};f.dotted?he.dashedLine(d.context,0,u,d.pixelWidth,u,5,g):he.strokeLine(d.context,0,u,d.pixelWidth,u,g)}}};if(t&&t.length>0&&(this.dataRange.min===void 0&&(this.dataRange.min=0),this.dataRange.max>this.dataRange.min)){let d=this.config.highlightSamples,f=this.config.onlyHandleClicksForHighlightedSamples,u=this.config.clickToHighlight,g=-1,_={},b=[],w=[];this.clickDetectorCache={};for(let p of t){let m=c(p.start),v=c(p.end),x=g>=0?c(g):m;if(!(isNaN(m)||isNaN(v))){this.clickDetectorCache[m]=[],this.clickDetectorCache[v]=[];for(let R=0;R<p.values.length;R++){let M=this.sampleNames[R],C=p.values[R],L=l(C);if(m-x>=td){let y=_[M],E=l(y),k=d&&d[M];k?b.push([x,E,m,L,k]):u&&M in this.config.samplesClickedToHighlight?b.push([x,E,m,L,this.config.samplesClickedToHighlight[M]]):he.strokeLine(n,x,E,m,L,{strokeStyle:"#D9D9D9"}),(!f||M in d)&&this.clickDetectorCache[m].push([x,E,m,L,M,k||"gray"])}if(v-m>=td){let y=d&&d[M];y?w.push([m,L,v,L,y]):u&&M in this.config.samplesClickedToHighlight?w.push([m,L,v,L,this.config.samplesClickedToHighlight[M]]):he.strokeLine(n,m,L,v,L,{strokeStyle:"gray"}),(!f||M in d)&&this.clickDetectorCache[v].push([m,L,v,L,M,y||"gray"])}_[M]=C}g=p.end}}for(let p of b)he.strokeLine(n,p[0],p[1],p[2],p[3],{strokeStyle:p[4],lineWidth:1.3});for(let p of w)he.strokeLine(n,p[0],p[1],p[2],p[3],{strokeStyle:p[4],lineWidth:2})}h(e)}doAutoscale(e){let t,n;return e.length>0?(t=Number.MAX_VALUE,n=-Number.MAX_VALUE,e.forEach(function(s){t=Math.min(t,...s.values),n=Math.max(n,...s.values)}),t-=.01,n+=.01):(t=0,n=100),{min:t,max:n}}clickedFeatures(e){let s=e.canvasX,r=e.canvasY,a=null;for(a of Object.keys(this.clickDetectorCache))if(a=parseInt(a),a>=s)break;if(a){let c=Number.MAX_VALUE,h=[],d=this.clickDetectorCache[a];for(let f of d){let u=f[0],g=f[2];if(s<u||s>g)return[];let _=f[1],b=f[3];if(r<Math.min(_,b)-10||r>Math.max(_,b)+10)continue;let w=Jx(s,r,u,_,g,b);w<c&&(h=[{name:f[4],color:f[5]}],c=w)}if(c<5){if(this.config.clickToHighlight){if(h[0].name in this.config.samplesClickedToHighlight)delete this.config.samplesClickedToHighlight[h[0].name];else if(this.config.clickToHighlight==="any"){var o=["red","darkblue","green","teal","olivedrab","orange","maroon","purple","blue","gold"],l=o[Math.floor(Math.random()*(o.length+1))];this.config.samplesClickedToHighlight[h[0].name]=l}else this.config.samplesClickedToHighlight[h[0].name]=this.config.clickToHighlight;this.trackView.repaintViews()}return h}}return[]}popupData(e,t){t===void 0&&(t=this.clickedFeatures(e));let n=[];return t.forEach(function(s){for(let r of Object.keys(s))fs(s[r])&&n.push({name:r,value:s[r]})}),n}get supportsWholeGenome(){return!1}};function Jx(i,e,t,n,s,r){let a=s-t,o=r-n,l=Math.abs(a*(n-e)-(t-i)*o),c=Math.sqrt(a*a+o*o);return c>0?l/c:0}var yh=class extends kt{constructor(e,t){super(e,t),e.height||(this.height=300),this.arcOrientation=!1,this.theta=Math.PI/2,e.format==="bp"?this.featureSource=new xh(e,t.genome):this.featureSource=new js(e,t.genome)}async getFeatures(e,t,n){let s=this.visibilityWindow;return this.featureSource.getFeatures({chr:e,start:t,end:n,visibilityWindow:s})}draw(e){let t=e.context,n=Math.PI/2,s=e.pixelWidth,r=e.pixelHeight;e.viewportWidth;let a=e.bpPerPixel,o=e.bpStart,l=a,c=this.arcOrientation;he.fillRect(t,0,e.pixelTop,s,r,{fillStyle:"rgb(255, 255, 255)"});let h=e.features;if(h){id(h,1);for(let d of h)if(d.startLeft){let f=Math.round((d.startLeft-o)/l),u=Math.round((d.startRight-o)/l),g=Math.round((d.endLeft-o)/l),_=Math.round((d.endRight-o)/l);t.fillStyle=d.color,t.strokeStyle=d.color,t.beginPath();let b=(f+_)/2,w=(_-f)/2,p=this.height,m=Math.PI+(Math.PI/2-n),v=2*Math.PI-(Math.PI/2-n);c?(p=0,t.arc(b,p,w,v,m),t.lineTo(_,p)):(t.arc(b,p,w,m,v),t.lineTo(g,p));let x=(u+g)/2,R=(g-u)/2,M=p;c?(t.arc(x,M,R,m,v,!0),t.lineTo(g,M)):(t.arc(x,M,R,v,m,!0),t.lineTo(f,M)),t.stroke(),t.fill(),d.drawState={x1:b,y1:p,r1:w,x2:x,y2:M,r2:R,sa:m,ea:v}}else{let f=Math.round((d.start-o)/l),u=Math.round((d.end-o)/l);t.strokeStyle=d.color,t.beginPath();let g=(f+u)/2,_=(u-f)/2,b=this.height,w=Math.PI+(Math.PI/2-n),p=2*Math.PI-(Math.PI/2-n);c?(b=0,t.arc(g,b,_,p,w)):t.arc(g,b,_,w,p),t.stroke(),d.drawState={x1:g,y1:b,r1:_,sa:w,ea:p}}}}clickedFeatures(e){let t=super.clickedFeatures(e),n=[];id(t,-1);for(let s of t){let r=s.drawState,a=e.canvasX-r.x1,o=e.canvasY-r.y1,l=Math.sqrt(a*a+o*o),c=r.r1+3,h,d;if(r.x2===void 0)h=l,d=r.r1-3;else{let f=e.canvasX-r.x2,u=e.canvasY-r.y2;h=Math.sqrt(f*f+u*u),d=r.r2-3}if(l<c&&h>d){n.push(s);break}}return n}popupData(e,t){if(t===void 0&&(t=this.clickedFeatures(e)),t&&t.length>0)return this.extractPopupData(t[0],this.getGenomeId())}menuItemList(){var e=this;return[{name:"Toggle arc direction",click:function(){e.arcOrientation=!e.arcOrientation,e.trackView.repaintViews()}}]}};function id(i,e){i.sort(function(t,n){let s=t.score===void 0?-Number.MAX_VALUE:t.score,r=n.score===void 0?-Number.MAX_VALUE:n.score;return(e===void 0?1:e)*(s-r)})}var xh=class{constructor(e,t){this.config=e,this.genome=t}async getFeatures({chr:e,start:t,end:n,bpPerPixel:s,visibilityWindow:r}){let a=this.genome;if(this.featureCache)return this.featureCache.queryFeatures(e,t,n);{let l=Oe(this.config),c=await Ce.loadString(this.config.url,l);return this.featureCache=new Wi(o(c),a),this.featureCache.queryFeatures(e,t,n)}function o(l){if(!l)return null;let c=jt(l),h=!0,d,f=[],u=[],g=[];for(;(d=c.nextLine())!==void 0;){let b=d.split("	");if(h&&d.startsWith("color:")){let w="rgb("+b[1]+","+b[2]+","+b[3]+")";f.push(w),b.length>4&&u.push(b[4])}else{h=!1;let w=b[0],p=Number.parseInt(b[1])-1,m=Number.parseInt(b[2])-1,v=Number.parseInt(b[3]),x=Number.parseInt(b[4]);var _=Number.parseInt(b[5]);let R=f[_],M;p<=x?M={chr:w,startLeft:Math.min(p,m),startRight:Math.max(p,m),endLeft:Math.min(v,x),endRight:Math.max(v,x),color:R,score:_}:M={chr:w,startLeft:Math.min(v,x),startRight:Math.max(v,x),endLeft:Math.min(p,m),endRight:Math.max(p,m),color:R,score:_},M.start=M.startLeft,M.end=M.endRight,u.length>_&&(M.description=u[_]),g.push(M)}}return g}}},sa=class{constructor(e){this.browser=e,this.type="ideogram",this.height=16,this.order=Number.MIN_SAFE_INTEGER,this.disableButtons=!0,this.ignoreTrackMenu=!0}async getFeatures(e,t,n){return[]}computePixelHeight(e){return this.height}draw({context:e,referenceFrame:t,pixelWidth:n,pixelHeight:s}){let r=t.chr,a=t.genome.getChromosome(r);if(a===void 0||n<=0||s<=0||r.toLowerCase()==="all")return;let o=[];e5({ctx:e,chr:r,referenceFrame:t,genome:t.genome,width:n,height:s,stainColors:o});let l=Math.round(t.bpPerPixel*n),c=t.start,h=a.bpLength,d=t.genome.getCytobands(r);if(d&&d.length>0&&d[d.length-1].end&&(h=Math.max(h,d[d.length-1].end),a.bpLength=h),l<h){let f=l/h,u=c/h,g=Math.floor(u*n),_=Math.floor(f*n);g=Math.max(0,g),g=Math.min(n-_,g),e.save(),e.strokeStyle="red",e.lineWidth=_<2?1:2;let b=g+e.lineWidth/2;_=_<2?1:_-e.lineWidth;let w=e.lineWidth/2,p=s-e.lineWidth;e.strokeRect(b,w,_,p),e.restore()}}dispose(){this.trackView=void 0}};function e5({ctx:i,chr:e,referenceFrame:t,genome:n,width:s,height:r,stainColors:a}){if(n===void 0)return;he.fillRect(i,0,0,s,r,{fillStyle:Ve.greyScale(255)});let h=n.getCytobands(e);if(h){let d=0+r/2,f=[],u=[];if(h.length===0)return;let g=h[h.length-1].end,_=s/g;i.beginPath(),he.roundRect(i,.5,.5+0,s-2*.5,r-2*.5,(r-2*.5)/2,0,1),i.clip();for(let b=0;b<h.length;b++){let w=h[b],p=_*w.start,m=_*w.end;w.type==="c"?(w.name.charAt(0)==="p"?(f[0]=p,u[0]=r+0,f[1]=p,u[1]=0,f[2]=m,u[2]=d):(f[0]=m,u[0]=r+0,f[1]=m,u[1]=0,f[2]=p,u[2]=d),i.fillStyle="rgb(150, 0, 0)",i.strokeStyle="rgb(150, 0, 0)",he.polygon(i,f,u,1,0)):(i.fillStyle=t5(a,w),he.fillRect(i,p,1,m-p,r-2*1))}}i.strokeStyle=Ve.greyScale(41),he.roundRect(i,.5,.5+0,s-2*.5,r-2*.5,(r-2*.5)/2,0,1)}function t5(i,e){if(e.type==="c")return"rgb(150, 10, 10)";var t=e.stain,n=230;e.type==="p"&&(n=Math.floor(230-t/100*230));var s=i[n];return s||(s="rgb("+n+","+n+","+n+")",i[n]=s),s}var Sm=new ji("Dark2"),i5=["GT/AG","CT/AC","GC/AG","CT/GC","AT/AC","GT/AT","non-canonical"];i5.forEach(i=>{Sm.getColor(i)});var Ct={},kh=class extends kt{constructor(e,t){super(e,t)}init(e){super.init(e),this.type=e.type||"junctions",e._featureSource?(this.featureSource=e._featureSource,delete e._featureSource):this.featureSource=e.featureSource?e.featureSource:Bt(e,this.browser.genome),this.margin=e.margin===void 0?10:e.margin,this.height||(this.height=100),e.colorByNumReadsThreshold===void 0&&(e.colorByNumReadsThreshold=5)}async postInit(){if(!(typeof this.featureSource.getHeader=="function"&&(this.header=await this.featureSource.getHeader(),this.disposed)))return this.header&&this.setTrackProperties(this.header),this.visibilityWindow===void 0&&typeof this.featureSource.defaultVisibilityWindow=="function"&&(this.visibilityWindow=await this.featureSource.defaultVisibilityWindow()),this}get supportsWholeGenome(){return!1}async getFeatures(e,t,n,s){let r=this.visibilityWindow;return this.featureSource.getFeatures({chr:e,start:t,end:n,bpPerPixel:s,visibilityWindow:r})}computePixelHeight(e){return this.height}draw(e){let t=e.features,n=e.context,s=e.bpPerPixel,r=e.bpStart,a=e.pixelWidth,o=e.pixelHeight,l=r+a*s+1;if(this.config.isMergedTrack||he.fillRect(n,0,e.pixelTop,a,o,{fillStyle:"rgb(255, 255, 255)"}),t){Ct.referenceFrame=e.viewport.referenceFrame,Ct.referenceFrameStart=Ct.referenceFrame.start,Ct.referenceFrameEnd=Ct.referenceFrameStart+Ct.referenceFrame.toBP(e.viewport.getWidth()),Ct.featureZoomOutTracker={};for(let c of t)if(!(c.end<r)){if(c.start>l)break;this.renderJunction(c,r,s,o,n)}}else console.log("No feature list")}renderJunction(e,t,n,s,r){e.isVisible=!1;let a=Math.round((e.start-t)/n),o=Math.round((e.end-t)/n),l=(a+o)/2;if(o-a<=3){if(l in Ct.featureZoomOutTracker)return;Ct.featureZoomOutTracker[l]=!0}if(this.config.hideAnnotatedJunctions&&e.attributes.annotated_junction==="true"||this.config.hideUnannotatedJunctions&&e.attributes.annotated_junction==="false"||this.config.hideMotifs&&this.config.hideMotifs.includes(e.attributes.motif)||this.config.hideStrand===e.strand)return;if(this.config.minJunctionEndsVisible){let y=0;if(e.start>=Ct.referenceFrameStart&&e.start<=Ct.referenceFrameEnd&&(y+=1),e.end>=Ct.referenceFrameStart&&e.end<=Ct.referenceFrameEnd&&(y+=1),y<this.config.minJunctionEndsVisible)return}let c,h,d;if(e.attributes.uniquely_mapped&&(c=parseInt(e.attributes.uniquely_mapped),c<this.config.minUniquelyMappedReads||(h=parseInt(e.attributes.multi_mapped),d=c+h,d<this.config.minTotalReads)||d>0&&h/d>this.config.maxFractionMultiMappedReads||e.attributes.maximum_spliced_alignment_overhang&&parseInt(e.attributes.maximum_spliced_alignment_overhang)<this.config.minSplicedAlignmentOverhang))return;let f;if(e.attributes.num_samples_with_this_junction&&(f=parseInt(e.attributes.num_samples_with_this_junction),this.config.minSamplesWithThisJunction&&f<this.config.minSamplesWithThisJunction||this.config.maxSamplesWithThisJunction&&f>this.config.maxSamplesWithThisJunction||e.attributes.num_samples_total&&(e.attributes.percent_samples_with_this_junction=100*f/Number(e.attributes.num_samples_total),this.config.minPercentSamplesWithThisJunction&&(e.attributes.percent_samples_with_this_junction<this.config.minPercentSamplesWithThisJunction||e.attributes.percent_samples_with_this_junction>this.config.maxPercentSamplesWithThisJunction))))return;let u=this.margin,g=this.height,_=u+.5*g,b=u,p=u+g-10,m=(a+l)/2,v=(l+o)/2,x=1;e.attributes.line_width?x=Number(e.attributes.line_width):(this.config.thicknessBasedOn===void 0||this.config.thicknessBasedOn==="numUniqueReads"?x=c:this.config.thicknessBasedOn==="numReads"?x=d:this.config.thicknessBasedOn==="numSamplesWithThisJunction"&&f!==void 0&&(x=f),x=1+Math.log(x+1)/Math.log(12));let R;this.config.bounceHeightBasedOn===void 0||this.config.bounceHeightBasedOn==="random"?R=(e.start+e.end)%7:this.config.bounceHeightBasedOn==="distance"?R=6*(e.end-e.start)/(Ct.referenceFrameEnd-Ct.referenceFrameStart):this.config.bounceHeightBasedOn==="thickness"&&(R=2*x),b+=g*Math.max(7-R,0)/10;let M;e.attributes.color?M=e.attributes.color:this.config.colorBy===void 0||this.config.colorBy==="numUniqueReads"?M=c>this.config.colorByNumReadsThreshold?"blue":"#AAAAAA":this.config.colorBy==="numReads"?M=d>this.config.colorByNumReadsThreshold?"blue":"#AAAAAA":this.config.colorBy==="isAnnotatedJunction"?M=e.attributes.annotated_junction==="true"?"#b0b0ec":"orange":this.config.colorBy==="strand"?M=e.strand==="+"?"#b0b0ec":"#ecb0b0":this.config.colorBy==="motif"?M=Sm.getColor(e.attributes.motif):M="#AAAAAA";let C="";e.attributes.label?C=e.attributes.label.replace(/_/g," "):this.config.labelWith===void 0||this.config.labelWith==="uniqueReadCount"?C=c:this.config.labelWith==="totalReadCount"?C=d:this.config.labelWith==="numSamplesWithThisJunction"?f!==void 0&&(C=f):this.config.labelWith==="percentSamplesWithThisJunction"?e.attributes.percent_samples_with_this_junction!==void 0&&(C=e.attributes.percent_samples_with_this_junction.toFixed(0)+"%"):this.config.labelWith==="motif"&&e.attributes.motif!==void 0&&(C+=e.attributes.motif),this.config.labelWithInParen==="uniqueReadCount"?C+=" ("+c+")":this.config.labelWithInParen==="totalReadCount"?C+=" ("+d+")":this.config.labelWithInParen==="multiMappedReadCount"?h>0&&(C+=" (+"+h+")"):this.config.labelWithInParen==="numSamplesWithThisJunction"?f!==void 0&&(C+=" ("+f+")"):this.config.labelWithInParen==="percentSamplesWithThisJunction"?e.attributes.percent_samples_with_this_junction!==void 0&&(C+=" ("+e.attributes.percent_samples_with_this_junction.toFixed(0)+"%)"):this.config.labelWithInParen==="motif"&&e.attributes.motif!==void 0&&(C+=` ${e.attributes.motif}`),e.isVisible=!0,r.beginPath(),r.moveTo(a,p),r.bezierCurveTo(m,b,v,b,o,p),r.lineWidth=x,r.strokeStyle=M,r.stroke();let L=(y,E,k,A)=>{y.beginPath(),y.moveTo(E,k),y.lineTo(E-A/2,k-A),y.lineTo(E+A/2,k-A),y.lineTo(E,k),y.closePath(),y.fill()};if(e.attributes.left_shape||e.attributes.right_shape){r.fillStyle=M;let y=r.lineWidth>2?10:7;e.attributes.left_shape&&L(r,a,p,y),e.attributes.right_shape&&L(r,o,p,y)}r.fillText(C,l-r.measureText(C).width/2,(7*b+_)/8)}clickedFeatures(e){return super.clickedFeatures(e).filter(function(n){return n.isVisible&&n.attributes})}popupData(e,t){t===void 0&&(t=this.clickedFeatures(e));let n=e.genomicLocation,s=[];for(let r of t){let a=typeof r.popupData=="function"?r.popupData(n):this.extractPopupData(r._f||r,this.getGenomeId());a&&(s.length>0&&s.push("<hr/><hr/>"),Array.prototype.push.apply(s,a))}return s}dispose(){this.trackView=void 0}},aa=class{constructor(e){this.config=e,this.url=n5(e.path||e.url)}async read(e,t){let n=this.config.headers||{};if(e!==void 0&&t){let l="bytes="+e+"-"+(e+t-1);n.Range=l}let s=this.url.slice();if(this.config.oauthToken){let l=o(this.config.oauthToken);n.Authorization=`Bearer ${l}`}this.config.apiKey&&(s=r5(s,"key",this.config.apiKey));let r=await fetch(s,{method:"GET",headers:n,redirect:"follow",mode:"cors"}),a=r.status;if(a>=400){let l=Error(r.statusText);throw l.code=a,l}else return r.arrayBuffer();async function o(l){return typeof l=="function"?await Promise.resolve(l()):l}}};function n5(i){return i.includes("//www.dropbox.com")?i.replace("//www.dropbox.com","//dl.dropboxusercontent.com"):i.startsWith("ftp://ftp.ncbi.nlm.nih.gov")?i.replace("ftp://","https://"):i}function r5(i,e,t){let n=i.includes("?")?"&":"?";return i+n+e+"="+t}var Sh=class{constructor(e){this.file=e.file,this.fetchSize=e.fetchSize||16e3,this.maxSize=e.maxSize||1e6,this.buffers=[]}async read(e,t){let n=this.buffers.filter(s=>s.overlaps(e,e+t));for(let s of n)if(s.contains(e,e+t))return s.slice(e,e+t);if(n.length===0){let s=Math.max(t,this.fetchSize);this.buffers.sort((c,h)=>c.start-h.start);let r=a5(this.buffers,c=>c.start>e,0);r<this.buffers.length&&(s=Math.min(s,this.buffers[r].start-e));let a=e,o=await this.file.read(a,s),l=new vn(a,o);return this.addBuffer(l),l.slice(e,e+t)}else{n.sort((d,f)=>d.start-f.start);let s=[],r=e;for(let d of n){if(r<d.start){let f=r,u=d.start-r,g=await this.file.read(f,u),_=new vn(f,g);s.push(_)}s.push(d),r=d.end}let a=e+t;if(a>r){let d=r,f=a-d,u=await this.file.read(d,f),g=new vn(d,u);s.push(g)}let o=s[0].start,l=s5(s.map(d=>d.buffer)),c=new vn(o,l),h=new Set(n);return this.buffers=this.buffers.filter(d=>!h.has(d)),this.addBuffer(c),c.slice(e,e+t)}}addBuffer(e){let t=this.buffers.reduce((n,s)=>n+s.size,0)+e.size;if(t>this.maxSize){let n=t-this.maxSize;this.buffers.sort((a,o)=>a.creationTime-o.creationTime);let s=0,r;for(r=0;r<this.buffers.length&&(s+=this.buffers[r].size,!(s>n));r++);this.buffers=r<this.buffers.length-1?this.buffers.slice(r):[]}e.size<=this.maxSize&&this.buffers.push(e)}},vn=class{constructor(e,t){this.creationTime=Date.now(),this.start=e,this.buffer=t}slice(e,t){if(e<this.start||t-e>this.buffer.byteLength)throw Error("buffer bounds error");return this.buffer.slice(e-this.start,t-this.start)}get end(){return this.start+this.buffer.byteLength}get size(){return this.buffer.byteLength}contains(e,t){return e>=this.start&&t<=this.end}overlaps(e,t){return e>this.start&&e<this.end||t>this.start&&t<this.end}toString(){return`Buffer ${this.creationTime}   ${this.start} - ${this.end}`}};function s5(i){let e=i.reduce((s,r)=>s+r.byteLength,0),t=new Uint8Array(e),n=0;for(let s of i)t.set(new Uint8Array(s),n),n+=s.byteLength;return t.buffer}function a5(i,e,t){let n=t-1,s=i.length;for(;1+n<s;){let r=n+(s-n>>1);e(i[r])?s=r:n=r}return s}var oa=class{constructor(e){this.file=e}async read(e,t){return t===0?new ArrayBuffer:(e!=null&&t?this.file.slice(e,e+t):this.file).arrayBuffer()}},o5=Object.defineProperty,l5=(i,e,t)=>e in i?o5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Xi=(i,e,t)=>(l5(i,typeof e!="symbol"?e+"":e,t),t);async function Je(i,e,t=0){var n=new Map;for(let[s,r]of i.entries()){let a=await ye.unpack_from_async("<"+r,e,t);t+=ye.calcsize(r),a.length==1&&(a=a[0]),n.set(s,a)}return n}function Cm(i,e,t=0){var n=new Map;for(let[s,r]of i.entries()){let a=ye.unpack_from("<"+r,e,t);t+=ye.calcsize(r),a.length==1&&(a=a[0]),n.set(s,a)}return n}function Ke(i){i||i()}function nt(i){var e="<"+Array.from(i.values()).join("");return ye.calcsize(e)}function er(i,e=8){return Math.ceil(i/e)*e}var h5={u:"Uint",i:"Int",f:"Float"};function gs(i){var e=ye._is_big_endian(i),t,n;if(/S/.test(i))t="getString",n=((i.match(/S(\d*)/)||[])[1]||1)|0;else{let[s,r,a]=i.match(/[<>=!@]?(i|u|f)(\d*)/);n=parseInt(a||4,10);let o=n*8;t="get"+h5[r]+o.toFixed()}return[t,e,n]}var c5=class{constructor(){this.big_endian=f5(),this.getters={s:"getUint8",b:"getInt8",B:"getUint8",h:"getInt16",H:"getUint16",i:"getInt32",I:"getUint32",l:"getInt32",L:"getUint32",q:"getInt64",Q:"getUint64",f:"getFloat32",d:"getFloat64"},this.byte_lengths={s:1,b:1,B:1,h:2,H:2,i:4,I:4,l:4,L:4,q:8,Q:8,f:4,d:8};let i=Object.keys(this.byte_lengths).join("");this.fmt_size_regex="(\\d*)(["+i+"])"}calcsize(i){for(var e=0,t,n=new RegExp(this.fmt_size_regex,"g");(t=n.exec(i))!==null;){let s=parseInt(t[1]||1,10),r=t[2],a=this.byte_lengths[r];e+=s*a}return e}_is_big_endian(i){var e;return/^</.test(i)?e=!1:/^(!|>)/.test(i)?e=!0:e=this.big_endian,e}async unpack_from_async(i,e,t){t=Number.parseInt(t||0);let n=this.calcsize(i),s=await e.slice(t,t+n),r=0;for(var a=new kn(s),o=[],l=this._is_big_endian(i),c,h=new RegExp(this.fmt_size_regex,"g");(c=h.exec(i))!==null;){let f=parseInt(c[1]||1,10),u=c[2],g=this.getters[u],_=this.byte_lengths[u];if(u=="s")o.push(new TextDecoder().decode(s.slice(r,r+f))),r+=f;else for(var d=0;d<f;d++)o.push(a[g](r,!l)),r+=_}return o}unpack_from(i,e,t){t=Number.parseInt(t||0);let n=this.calcsize(i),s=e.slice(t,t+n),r=0;for(var a=new kn(s),o=[],l=this._is_big_endian(i),c,h=new RegExp(this.fmt_size_regex,"g");(c=h.exec(i))!==null;){let f=parseInt(c[1]||1,10),u=c[2],g=this.getters[u],_=this.byte_lengths[u];if(u=="s")o.push(new TextDecoder().decode(s.slice(r,r+f))),r+=f;else for(var d=0;d<f;d++)o.push(a[g](r,!l)),r+=_}return o}},ye=new c5;function f5(){let i=new Uint8Array(4),e=new Uint32Array(i.buffer);return!((e[0]=1)&i[0])}var kn=class extends DataView{getUint64(i,e){let t=BigInt(this.getUint32(i,e)),n=BigInt(this.getUint32(i+4,e)),s=e?t+(n<<32n):(t<<32n)+n;return Number.parseInt(s)}getInt64(i,e){var t,n;e?(t=this.getUint32(i,!0),n=this.getInt32(i+4,!0)):(n=this.getInt32(i,!1),t=this.getUint32(i+4,!1));let s=BigInt(t)+(BigInt(n)<<32n);return Number.parseInt(s)}getString(i,e,t){let n=this.buffer.slice(i,i+t);return new TextDecoder().decode(n)}getVLENStruct(i,e,t){let n=this.getUint32(i,e),s=this.getUint64(i+4,e),r=this.getUint32(i+12,e);return[n,s,r]}};function Em(i){return i.toString(2).length}function nd(i,e,t=0,n=!0){let s=e.slice(t,t+i),r=new Uint8Array(s);return n||r.reverse(),r.reduce((o,l,c)=>o+(l<<c*8),0)}var rd=class{constructor(i,e){this.buf=i,this.offset=e,this.dtype=this.determine_dtype()}async determine_dtype(){let i=await Je(Am,this.buf,this.offset);this.offset+=u5;let e=i.get("class_and_version")&15;if(e==p5)return this._determine_dtype_fixed_point(i);if(e==g5)return this._determine_dtype_floating_point(i);if(e==m5)throw"Time datatype class not supported.";if(e==b5)return this._determine_dtype_string(i);if(e==w5)throw"Bitfield datatype class not supported.";if(e==sd)return{datatype_class:sd,size:i.get("size")};if(e==v5)return this._determine_dtype_compound(i);if(e==_5)return["REFERENCE",i.get("size")];if(e==y5)return this.determine_dtype();if(e==k5)throw"Array datatype class not supported.";if(e==x5){let t=this._determine_dtype_vlen(i);return t[0]=="VLEN_SEQUENCE"&&(t=["VLEN_SEQUENCE",this.determine_dtype()]),t}else throw"Invalid datatype class "+e}_determine_dtype_fixed_point(i){let e=i.get("size");if(![1,2,4,8].includes(e))throw"Unsupported datatype size";let t=i.get("class_bit_field_0")&8;var n;t>0?n="i":n="u";let s=i.get("class_bit_field_0")&1;var r;return s==0?r="<":r=">",this.offset+=4,r+n+e.toFixed()}_determine_dtype_floating_point(i){let e=i.get("size");if(![1,2,4,8].includes(e))throw"Unsupported datatype size";let t="f",n=i.get("class_bit_field_0")&1;var s;return n==0?s="<":s=">",this.offset+=12,s+t+e.toFixed()}_determine_dtype_string(i){return"S"+i.get("size").toFixed()}_determine_dtype_vlen(i){if((i.get("class_bit_field_0")&1)!=1)return["VLEN_SEQUENCE",0,0];let t=i.get("class_bit_field_0")>>4,n=i.get("class_bit_field_1")&1;return["VLEN_STRING",t,n]}_determine_dtype_compound(i){throw"Compound type not yet implemented!"}},Am=new Map([["class_and_version","B"],["class_bit_field_0","B"],["class_bit_field_1","B"],["class_bit_field_2","B"],["size","I"]]),u5=nt(Am),d5=new Map([["offset","I"],["dimensionality","B"],["reserved_0","B"],["reserved_1","B"],["reserved_2","B"],["permutation","I"],["reserved_3","I"],["dim_size_1","I"],["dim_size_2","I"],["dim_size_3","I"],["dim_size_4","I"]]);nt(d5);var p5=0,g5=1,m5=2,b5=3,w5=4,sd=5,v5=6,_5=7,y5=8,x5=9,k5=10;function zn(i){let e=i.length;for(;--e>=0;)i[e]=0}var S5=3,C5=258,Tm=29,E5=256,A5=E5+1+Tm,Mm=30,T5=512,M5=new Array((A5+2)*2);zn(M5);var R5=new Array(Mm*2);zn(R5);var I5=new Array(T5);zn(I5);var L5=new Array(C5-S5+1);zn(L5);var N5=new Array(Tm);zn(N5);var F5=new Array(Mm);zn(F5);var D5=(i,e,t,n)=>{let s=i&65535|0,r=i>>>16&65535|0,a=0;for(;t!==0;){a=t>2e3?2e3:t,t-=a;do s=s+e[n++]|0,r=r+s|0;while(--a);s%=65521,r%=65521}return s|r<<16|0},Ch=D5,O5=()=>{let i,e=[];for(var t=0;t<256;t++){i=t;for(var n=0;n<8;n++)i=i&1?3988292384^i>>>1:i>>>1;e[t]=i}return e},B5=new Uint32Array(O5()),P5=(i,e,t,n)=>{let s=B5,r=n+t;i^=-1;for(let a=n;a<r;a++)i=i>>>8^s[(i^e[a])&255];return i^-1},ei=P5,Eh={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Ec={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},z5=(i,e)=>Object.prototype.hasOwnProperty.call(i,e),H5=function(i){let e=Array.prototype.slice.call(arguments,1);for(;e.length;){let t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(let n in t)z5(t,n)&&(i[n]=t[n])}}return i},U5=i=>{let e=0;for(let n=0,s=i.length;n<s;n++)e+=i[n].length;let t=new Uint8Array(e);for(let n=0,s=0,r=i.length;n<r;n++){let a=i[n];t.set(a,s),s+=a.length}return t},Rm={assign:H5,flattenChunks:U5},Im=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Im=!1}var Ar=new Uint8Array(256);for(let i=0;i<256;i++)Ar[i]=i>=252?6:i>=248?5:i>=240?4:i>=224?3:i>=192?2:1;Ar[254]=Ar[254]=1;var $5=i=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(i);let e,t,n,s,r,a=i.length,o=0;for(s=0;s<a;s++)t=i.charCodeAt(s),(t&64512)===55296&&s+1<a&&(n=i.charCodeAt(s+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),s++)),o+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(o),r=0,s=0;r<o;s++)t=i.charCodeAt(s),(t&64512)===55296&&s+1<a&&(n=i.charCodeAt(s+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),s++)),t<128?e[r++]=t:t<2048?(e[r++]=192|t>>>6,e[r++]=128|t&63):t<65536?(e[r++]=224|t>>>12,e[r++]=128|t>>>6&63,e[r++]=128|t&63):(e[r++]=240|t>>>18,e[r++]=128|t>>>12&63,e[r++]=128|t>>>6&63,e[r++]=128|t&63);return e},V5=(i,e)=>{if(e<65534&&i.subarray&&Im)return String.fromCharCode.apply(null,i.length===e?i:i.subarray(0,e));let t="";for(let n=0;n<e;n++)t+=String.fromCharCode(i[n]);return t},q5=(i,e)=>{let t=e||i.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(i.subarray(0,e));let n,s,r=new Array(t*2);for(s=0,n=0;n<t;){let a=i[n++];if(a<128){r[s++]=a;continue}let o=Ar[a];if(o>4){r[s++]=65533,n+=o-1;continue}for(a&=o===2?31:o===3?15:7;o>1&&n<t;)a=a<<6|i[n++]&63,o--;if(o>1){r[s++]=65533;continue}a<65536?r[s++]=a:(a-=65536,r[s++]=55296|a>>10&1023,r[s++]=56320|a&1023)}return V5(r,s)},W5=(i,e)=>{e=e||i.length,e>i.length&&(e=i.length);let t=e-1;for(;t>=0&&(i[t]&192)===128;)t--;return t<0||t===0?e:t+Ar[i[t]]>e?t:e},Ah={string2buf:$5,buf2string:q5,utf8border:W5};function j5(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var G5=j5,es=30,Z5=12,X5=function(e,t){let n,s,r,a,o,l,c,h,d,f,u,g,_,b,w,p,m,v,x,R,M,C,L,y,E=e.state;n=e.next_in,L=e.input,s=n+(e.avail_in-5),r=e.next_out,y=e.output,a=r-(t-e.avail_out),o=r+(e.avail_out-257),l=E.dmax,c=E.wsize,h=E.whave,d=E.wnext,f=E.window,u=E.hold,g=E.bits,_=E.lencode,b=E.distcode,w=(1<<E.lenbits)-1,p=(1<<E.distbits)-1;e:do{g<15&&(u+=L[n++]<<g,g+=8,u+=L[n++]<<g,g+=8),m=_[u&w];t:for(;;){if(v=m>>>24,u>>>=v,g-=v,v=m>>>16&255,v===0)y[r++]=m&65535;else if(v&16){x=m&65535,v&=15,v&&(g<v&&(u+=L[n++]<<g,g+=8),x+=u&(1<<v)-1,u>>>=v,g-=v),g<15&&(u+=L[n++]<<g,g+=8,u+=L[n++]<<g,g+=8),m=b[u&p];i:for(;;){if(v=m>>>24,u>>>=v,g-=v,v=m>>>16&255,v&16){if(R=m&65535,v&=15,g<v&&(u+=L[n++]<<g,g+=8,g<v&&(u+=L[n++]<<g,g+=8)),R+=u&(1<<v)-1,R>l){e.msg="invalid distance too far back",E.mode=es;break e}if(u>>>=v,g-=v,v=r-a,R>v){if(v=R-v,v>h&&E.sane){e.msg="invalid distance too far back",E.mode=es;break e}if(M=0,C=f,d===0){if(M+=c-v,v<x){x-=v;do y[r++]=f[M++];while(--v);M=r-R,C=y}}else if(d<v){if(M+=c+d-v,v-=d,v<x){x-=v;do y[r++]=f[M++];while(--v);if(M=0,d<x){v=d,x-=v;do y[r++]=f[M++];while(--v);M=r-R,C=y}}}else if(M+=d-v,v<x){x-=v;do y[r++]=f[M++];while(--v);M=r-R,C=y}for(;x>2;)y[r++]=C[M++],y[r++]=C[M++],y[r++]=C[M++],x-=3;x&&(y[r++]=C[M++],x>1&&(y[r++]=C[M++]))}else{M=r-R;do y[r++]=y[M++],y[r++]=y[M++],y[r++]=y[M++],x-=3;while(x>2);x&&(y[r++]=y[M++],x>1&&(y[r++]=y[M++]))}}else if(v&64){e.msg="invalid distance code",E.mode=es;break e}else{m=b[(m&65535)+(u&(1<<v)-1)];continue i}break}}else if(v&64)if(v&32){E.mode=Z5;break e}else{e.msg="invalid literal/length code",E.mode=es;break e}else{m=_[(m&65535)+(u&(1<<v)-1)];continue t}break}}while(n<s&&r<o);x=g>>3,n-=x,g-=x<<3,u&=(1<<g)-1,e.next_in=n,e.next_out=r,e.avail_in=n<s?5+(s-n):5-(n-s),e.avail_out=r<o?257+(o-r):257-(r-o),E.hold=u,E.bits=g},gn=15,ad=852,od=592,ld=0,mo=1,hd=2,Y5=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Q5=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),K5=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),J5=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),ek=(i,e,t,n,s,r,a,o)=>{let l=o.bits,c=0,h=0,d=0,f=0,u=0,g=0,_=0,b=0,w=0,p=0,m,v,x,R,M,C=null,L=0,y,E=new Uint16Array(gn+1),k=new Uint16Array(gn+1),A=null,I=0,F,X,U;for(c=0;c<=gn;c++)E[c]=0;for(h=0;h<n;h++)E[e[t+h]]++;for(u=l,f=gn;f>=1&&E[f]===0;f--);if(u>f&&(u=f),f===0)return s[r++]=1<<24|64<<16|0,s[r++]=1<<24|64<<16|0,o.bits=1,0;for(d=1;d<f&&E[d]===0;d++);for(u<d&&(u=d),b=1,c=1;c<=gn;c++)if(b<<=1,b-=E[c],b<0)return-1;if(b>0&&(i===ld||f!==1))return-1;for(k[1]=0,c=1;c<gn;c++)k[c+1]=k[c]+E[c];for(h=0;h<n;h++)e[t+h]!==0&&(a[k[e[t+h]]++]=h);if(i===ld?(C=A=a,y=19):i===mo?(C=Y5,L-=257,A=Q5,I-=257,y=256):(C=K5,A=J5,y=-1),p=0,h=0,c=d,M=r,g=u,_=0,x=-1,w=1<<u,R=w-1,i===mo&&w>ad||i===hd&&w>od)return 1;for(;;){F=c-_,a[h]<y?(X=0,U=a[h]):a[h]>y?(X=A[I+a[h]],U=C[L+a[h]]):(X=96,U=0),m=1<<c-_,v=1<<g,d=v;do v-=m,s[M+(p>>_)+v]=F<<24|X<<16|U|0;while(v!==0);for(m=1<<c-1;p&m;)m>>=1;if(m!==0?(p&=m-1,p+=m):p=0,h++,--E[c]===0){if(c===f)break;c=e[t+a[h]]}if(c>u&&(p&R)!==x){for(_===0&&(_=u),M+=d,g=c-_,b=1<<g;g+_<f&&(b-=E[g+_],!(b<=0));)g++,b<<=1;if(w+=1<<g,i===mo&&w>ad||i===hd&&w>od)return 1;x=p&R,s[x]=u<<24|g<<16|M-r|0}}return p!==0&&(s[M+p]=c-_<<24|64<<16|0),o.bits=u,0},fr=ek,tk=0,Lm=1,Nm=2,{Z_FINISH:cd,Z_BLOCK:ik,Z_TREES:ts,Z_OK:Yi,Z_STREAM_END:nk,Z_NEED_DICT:rk,Z_STREAM_ERROR:Vt,Z_DATA_ERROR:Fm,Z_MEM_ERROR:Dm,Z_BUF_ERROR:sk,Z_DEFLATED:fd}=Ec,Om=1,ud=2,dd=3,pd=4,gd=5,md=6,bd=7,wd=8,vd=9,_d=10,la=11,ci=12,bo=13,yd=14,wo=15,xd=16,kd=17,Sd=18,Cd=19,is=20,ns=21,Ed=22,Ad=23,Td=24,Md=25,Rd=26,vo=27,Id=28,Ld=29,st=30,Bm=31,ak=32,ok=852,lk=592,hk=15,ck=hk,Nd=i=>(i>>>24&255)+(i>>>8&65280)+((i&65280)<<8)+((i&255)<<24);function fk(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var Pm=i=>{if(!i||!i.state)return Vt;let e=i.state;return i.total_in=i.total_out=e.total=0,i.msg="",e.wrap&&(i.adler=e.wrap&1),e.mode=Om,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(ok),e.distcode=e.distdyn=new Int32Array(lk),e.sane=1,e.back=-1,Yi},zm=i=>{if(!i||!i.state)return Vt;let e=i.state;return e.wsize=0,e.whave=0,e.wnext=0,Pm(i)},Hm=(i,e)=>{let t;if(!i||!i.state)return Vt;let n=i.state;return e<0?(t=0,e=-e):(t=(e>>4)+1,e<48&&(e&=15)),e&&(e<8||e>15)?Vt:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=t,n.wbits=e,zm(i))},Um=(i,e)=>{if(!i)return Vt;let t=new fk;i.state=t,t.window=null;let n=Hm(i,e);return n!==Yi&&(i.state=null),n},uk=i=>Um(i,ck),Fd=!0,_o,yo,dk=i=>{if(Fd){_o=new Int32Array(512),yo=new Int32Array(32);let e=0;for(;e<144;)i.lens[e++]=8;for(;e<256;)i.lens[e++]=9;for(;e<280;)i.lens[e++]=7;for(;e<288;)i.lens[e++]=8;for(fr(Lm,i.lens,0,288,_o,0,i.work,{bits:9}),e=0;e<32;)i.lens[e++]=5;fr(Nm,i.lens,0,32,yo,0,i.work,{bits:5}),Fd=!1}i.lencode=_o,i.lenbits=9,i.distcode=yo,i.distbits=5},$m=(i,e,t,n)=>{let s,r=i.state;return r.window===null&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new Uint8Array(r.wsize)),n>=r.wsize?(r.window.set(e.subarray(t-r.wsize,t),0),r.wnext=0,r.whave=r.wsize):(s=r.wsize-r.wnext,s>n&&(s=n),r.window.set(e.subarray(t-n,t-n+s),r.wnext),n-=s,n?(r.window.set(e.subarray(t-n,t),0),r.wnext=n,r.whave=r.wsize):(r.wnext+=s,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=s))),0},pk=(i,e)=>{let t,n,s,r,a,o,l,c,h,d,f,u,g,_,b=0,w,p,m,v,x,R,M,C,L=new Uint8Array(4),y,E,k=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!i||!i.state||!i.output||!i.input&&i.avail_in!==0)return Vt;t=i.state,t.mode===ci&&(t.mode=bo),a=i.next_out,s=i.output,l=i.avail_out,r=i.next_in,n=i.input,o=i.avail_in,c=t.hold,h=t.bits,d=o,f=l,C=Yi;e:for(;;)switch(t.mode){case Om:if(t.wrap===0){t.mode=bo;break}for(;h<16;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}if(t.wrap&2&&c===35615){t.check=0,L[0]=c&255,L[1]=c>>>8&255,t.check=ei(t.check,L,2,0),c=0,h=0,t.mode=ud;break}if(t.flags=0,t.head&&(t.head.done=!1),!(t.wrap&1)||(((c&255)<<8)+(c>>8))%31){i.msg="incorrect header check",t.mode=st;break}if((c&15)!==fd){i.msg="unknown compression method",t.mode=st;break}if(c>>>=4,h-=4,M=(c&15)+8,t.wbits===0)t.wbits=M;else if(M>t.wbits){i.msg="invalid window size",t.mode=st;break}t.dmax=1<<t.wbits,i.adler=t.check=1,t.mode=c&512?_d:ci,c=0,h=0;break;case ud:for(;h<16;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}if(t.flags=c,(t.flags&255)!==fd){i.msg="unknown compression method",t.mode=st;break}if(t.flags&57344){i.msg="unknown header flags set",t.mode=st;break}t.head&&(t.head.text=c>>8&1),t.flags&512&&(L[0]=c&255,L[1]=c>>>8&255,t.check=ei(t.check,L,2,0)),c=0,h=0,t.mode=dd;case dd:for(;h<32;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}t.head&&(t.head.time=c),t.flags&512&&(L[0]=c&255,L[1]=c>>>8&255,L[2]=c>>>16&255,L[3]=c>>>24&255,t.check=ei(t.check,L,4,0)),c=0,h=0,t.mode=pd;case pd:for(;h<16;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}t.head&&(t.head.xflags=c&255,t.head.os=c>>8),t.flags&512&&(L[0]=c&255,L[1]=c>>>8&255,t.check=ei(t.check,L,2,0)),c=0,h=0,t.mode=gd;case gd:if(t.flags&1024){for(;h<16;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}t.length=c,t.head&&(t.head.extra_len=c),t.flags&512&&(L[0]=c&255,L[1]=c>>>8&255,t.check=ei(t.check,L,2,0)),c=0,h=0}else t.head&&(t.head.extra=null);t.mode=md;case md:if(t.flags&1024&&(u=t.length,u>o&&(u=o),u&&(t.head&&(M=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(n.subarray(r,r+u),M)),t.flags&512&&(t.check=ei(t.check,n,u,r)),o-=u,r+=u,t.length-=u),t.length))break e;t.length=0,t.mode=bd;case bd:if(t.flags&2048){if(o===0)break e;u=0;do M=n[r+u++],t.head&&M&&t.length<65536&&(t.head.name+=String.fromCharCode(M));while(M&&u<o);if(t.flags&512&&(t.check=ei(t.check,n,u,r)),o-=u,r+=u,M)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=wd;case wd:if(t.flags&4096){if(o===0)break e;u=0;do M=n[r+u++],t.head&&M&&t.length<65536&&(t.head.comment+=String.fromCharCode(M));while(M&&u<o);if(t.flags&512&&(t.check=ei(t.check,n,u,r)),o-=u,r+=u,M)break e}else t.head&&(t.head.comment=null);t.mode=vd;case vd:if(t.flags&512){for(;h<16;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}if(c!==(t.check&65535)){i.msg="header crc mismatch",t.mode=st;break}c=0,h=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),i.adler=t.check=0,t.mode=ci;break;case _d:for(;h<32;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}i.adler=t.check=Nd(c),c=0,h=0,t.mode=la;case la:if(t.havedict===0)return i.next_out=a,i.avail_out=l,i.next_in=r,i.avail_in=o,t.hold=c,t.bits=h,rk;i.adler=t.check=1,t.mode=ci;case ci:if(e===ik||e===ts)break e;case bo:if(t.last){c>>>=h&7,h-=h&7,t.mode=vo;break}for(;h<3;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}switch(t.last=c&1,c>>>=1,h-=1,c&3){case 0:t.mode=yd;break;case 1:if(dk(t),t.mode=is,e===ts){c>>>=2,h-=2;break e}break;case 2:t.mode=kd;break;case 3:i.msg="invalid block type",t.mode=st}c>>>=2,h-=2;break;case yd:for(c>>>=h&7,h-=h&7;h<32;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}if((c&65535)!==(c>>>16^65535)){i.msg="invalid stored block lengths",t.mode=st;break}if(t.length=c&65535,c=0,h=0,t.mode=wo,e===ts)break e;case wo:t.mode=xd;case xd:if(u=t.length,u){if(u>o&&(u=o),u>l&&(u=l),u===0)break e;s.set(n.subarray(r,r+u),a),o-=u,r+=u,l-=u,a+=u,t.length-=u;break}t.mode=ci;break;case kd:for(;h<14;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}if(t.nlen=(c&31)+257,c>>>=5,h-=5,t.ndist=(c&31)+1,c>>>=5,h-=5,t.ncode=(c&15)+4,c>>>=4,h-=4,t.nlen>286||t.ndist>30){i.msg="too many length or distance symbols",t.mode=st;break}t.have=0,t.mode=Sd;case Sd:for(;t.have<t.ncode;){for(;h<3;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}t.lens[k[t.have++]]=c&7,c>>>=3,h-=3}for(;t.have<19;)t.lens[k[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,y={bits:t.lenbits},C=fr(tk,t.lens,0,19,t.lencode,0,t.work,y),t.lenbits=y.bits,C){i.msg="invalid code lengths set",t.mode=st;break}t.have=0,t.mode=Cd;case Cd:for(;t.have<t.nlen+t.ndist;){for(;b=t.lencode[c&(1<<t.lenbits)-1],w=b>>>24,p=b>>>16&255,m=b&65535,!(w<=h);){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}if(m<16)c>>>=w,h-=w,t.lens[t.have++]=m;else{if(m===16){for(E=w+2;h<E;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}if(c>>>=w,h-=w,t.have===0){i.msg="invalid bit length repeat",t.mode=st;break}M=t.lens[t.have-1],u=3+(c&3),c>>>=2,h-=2}else if(m===17){for(E=w+3;h<E;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}c>>>=w,h-=w,M=0,u=3+(c&7),c>>>=3,h-=3}else{for(E=w+7;h<E;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}c>>>=w,h-=w,M=0,u=11+(c&127),c>>>=7,h-=7}if(t.have+u>t.nlen+t.ndist){i.msg="invalid bit length repeat",t.mode=st;break}for(;u--;)t.lens[t.have++]=M}}if(t.mode===st)break;if(t.lens[256]===0){i.msg="invalid code -- missing end-of-block",t.mode=st;break}if(t.lenbits=9,y={bits:t.lenbits},C=fr(Lm,t.lens,0,t.nlen,t.lencode,0,t.work,y),t.lenbits=y.bits,C){i.msg="invalid literal/lengths set",t.mode=st;break}if(t.distbits=6,t.distcode=t.distdyn,y={bits:t.distbits},C=fr(Nm,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,y),t.distbits=y.bits,C){i.msg="invalid distances set",t.mode=st;break}if(t.mode=is,e===ts)break e;case is:t.mode=ns;case ns:if(o>=6&&l>=258){i.next_out=a,i.avail_out=l,i.next_in=r,i.avail_in=o,t.hold=c,t.bits=h,X5(i,f),a=i.next_out,s=i.output,l=i.avail_out,r=i.next_in,n=i.input,o=i.avail_in,c=t.hold,h=t.bits,t.mode===ci&&(t.back=-1);break}for(t.back=0;b=t.lencode[c&(1<<t.lenbits)-1],w=b>>>24,p=b>>>16&255,m=b&65535,!(w<=h);){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}if(p&&!(p&240)){for(v=w,x=p,R=m;b=t.lencode[R+((c&(1<<v+x)-1)>>v)],w=b>>>24,p=b>>>16&255,m=b&65535,!(v+w<=h);){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}c>>>=v,h-=v,t.back+=v}if(c>>>=w,h-=w,t.back+=w,t.length=m,p===0){t.mode=Rd;break}if(p&32){t.back=-1,t.mode=ci;break}if(p&64){i.msg="invalid literal/length code",t.mode=st;break}t.extra=p&15,t.mode=Ed;case Ed:if(t.extra){for(E=t.extra;h<E;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}t.length+=c&(1<<t.extra)-1,c>>>=t.extra,h-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=Ad;case Ad:for(;b=t.distcode[c&(1<<t.distbits)-1],w=b>>>24,p=b>>>16&255,m=b&65535,!(w<=h);){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}if(!(p&240)){for(v=w,x=p,R=m;b=t.distcode[R+((c&(1<<v+x)-1)>>v)],w=b>>>24,p=b>>>16&255,m=b&65535,!(v+w<=h);){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}c>>>=v,h-=v,t.back+=v}if(c>>>=w,h-=w,t.back+=w,p&64){i.msg="invalid distance code",t.mode=st;break}t.offset=m,t.extra=p&15,t.mode=Td;case Td:if(t.extra){for(E=t.extra;h<E;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}t.offset+=c&(1<<t.extra)-1,c>>>=t.extra,h-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){i.msg="invalid distance too far back",t.mode=st;break}t.mode=Md;case Md:if(l===0)break e;if(u=f-l,t.offset>u){if(u=t.offset-u,u>t.whave&&t.sane){i.msg="invalid distance too far back",t.mode=st;break}u>t.wnext?(u-=t.wnext,g=t.wsize-u):g=t.wnext-u,u>t.length&&(u=t.length),_=t.window}else _=s,g=a-t.offset,u=t.length;u>l&&(u=l),l-=u,t.length-=u;do s[a++]=_[g++];while(--u);t.length===0&&(t.mode=ns);break;case Rd:if(l===0)break e;s[a++]=t.length,l--,t.mode=ns;break;case vo:if(t.wrap){for(;h<32;){if(o===0)break e;o--,c|=n[r++]<<h,h+=8}if(f-=l,i.total_out+=f,t.total+=f,f&&(i.adler=t.check=t.flags?ei(t.check,s,f,a-f):Ch(t.check,s,f,a-f)),f=l,(t.flags?c:Nd(c))!==t.check){i.msg="incorrect data check",t.mode=st;break}c=0,h=0}t.mode=Id;case Id:if(t.wrap&&t.flags){for(;h<32;){if(o===0)break e;o--,c+=n[r++]<<h,h+=8}if(c!==(t.total&4294967295)){i.msg="incorrect length check",t.mode=st;break}c=0,h=0}t.mode=Ld;case Ld:C=nk;break e;case st:C=Fm;break e;case Bm:return Dm;case ak:default:return Vt}return i.next_out=a,i.avail_out=l,i.next_in=r,i.avail_in=o,t.hold=c,t.bits=h,(t.wsize||f!==i.avail_out&&t.mode<st&&(t.mode<vo||e!==cd))&&$m(i,i.output,i.next_out,f-i.avail_out),d-=i.avail_in,f-=i.avail_out,i.total_in+=d,i.total_out+=f,t.total+=f,t.wrap&&f&&(i.adler=t.check=t.flags?ei(t.check,s,f,i.next_out-f):Ch(t.check,s,f,i.next_out-f)),i.data_type=t.bits+(t.last?64:0)+(t.mode===ci?128:0)+(t.mode===is||t.mode===wo?256:0),(d===0&&f===0||e===cd)&&C===Yi&&(C=sk),C},gk=i=>{if(!i||!i.state)return Vt;let e=i.state;return e.window&&(e.window=null),i.state=null,Yi},mk=(i,e)=>{if(!i||!i.state)return Vt;let t=i.state;return t.wrap&2?(t.head=e,e.done=!1,Yi):Vt},bk=(i,e)=>{let t=e.length,n,s,r;return!i||!i.state||(n=i.state,n.wrap!==0&&n.mode!==la)?Vt:n.mode===la&&(s=1,s=Ch(s,e,t,0),s!==n.check)?Fm:(r=$m(i,e,t,t),r?(n.mode=Bm,Dm):(n.havedict=1,Yi))},wk=zm,vk=Hm,_k=Pm,yk=uk,xk=Um,kk=pk,Sk=gk,Ck=mk,Ek=bk,Ak="pako inflate (from Nodeca project)",pi={inflateReset:wk,inflateReset2:vk,inflateResetKeep:_k,inflateInit:yk,inflateInit2:xk,inflate:kk,inflateEnd:Sk,inflateGetHeader:Ck,inflateSetDictionary:Ek,inflateInfo:Ak};function Tk(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Mk=Tk,Vm=Object.prototype.toString,{Z_NO_FLUSH:Rk,Z_FINISH:Ik,Z_OK:Tr,Z_STREAM_END:xo,Z_NEED_DICT:ko,Z_STREAM_ERROR:Lk,Z_DATA_ERROR:Dd,Z_MEM_ERROR:Nk}=Ec;function Dr(i){this.options=Rm.assign({chunkSize:1024*64,windowBits:15,to:""},i||{});let e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(i&&i.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new G5,this.strm.avail_out=0;let t=pi.inflateInit2(this.strm,e.windowBits);if(t!==Tr)throw new Error(Eh[t]);if(this.header=new Mk,pi.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Ah.string2buf(e.dictionary):Vm.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=pi.inflateSetDictionary(this.strm,e.dictionary),t!==Tr)))throw new Error(Eh[t])}Dr.prototype.push=function(i,e){let t=this.strm,n=this.options.chunkSize,s=this.options.dictionary,r,a,o;if(this.ended)return!1;for(e===~~e?a=e:a=e===!0?Ik:Rk,Vm.call(i)==="[object ArrayBuffer]"?t.input=new Uint8Array(i):t.input=i,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(n),t.next_out=0,t.avail_out=n),r=pi.inflate(t,a),r===ko&&s&&(r=pi.inflateSetDictionary(t,s),r===Tr?r=pi.inflate(t,a):r===Dd&&(r=ko));t.avail_in>0&&r===xo&&t.state.wrap>0&&i[t.next_in]!==0;)pi.inflateReset(t),r=pi.inflate(t,a);switch(r){case Lk:case Dd:case ko:case Nk:return this.onEnd(r),this.ended=!0,!1}if(o=t.avail_out,t.next_out&&(t.avail_out===0||r===xo))if(this.options.to==="string"){let l=Ah.utf8border(t.output,t.next_out),c=t.next_out-l,h=Ah.buf2string(t.output,l);t.next_out=c,t.avail_out=n-c,c&&t.output.set(t.output.subarray(l,l+c),0),this.onData(h)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(r===Tr&&o===0)){if(r===xo)return r=pi.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};Dr.prototype.onData=function(i){this.chunks.push(i)};Dr.prototype.onEnd=function(i){i===Tr&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Rm.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};function Ac(i,e){let t=new Dr(e);if(t.push(i),t.err)throw t.msg||Eh[t.err];return t.result}function Fk(i,e){return e=e||{},e.raw=!0,Ac(i,e)}var Dk=Dr,Ok=Ac,Bk=Fk,Pk=Ac,zk=Ec,Hk={Inflate:Dk,inflate:Ok,inflateRaw:Bk,ungzip:Pk,constants:zk},{Inflate:RC,inflate:Uk,inflateRaw:IC,ungzip:$k}=Hk,Vk=Uk,qk=$k,Wk=function(i,e){let t=new Uint8Array(i);return Vk(t).buffer},jk=function(i,e){let t=i.byteLength,n=new Uint8Array(t),s=Math.floor(t/e),r=new DataView(i);for(var a=0;a<e;a++)for(var o=0;o<s;o++)n[a+o*e]=r.getUint8(a*s+o);return n.buffer},Gk=function(i,e){return Zk(i),i.slice(0,-4)};function Zk(i){for(var e=i.byteLength%2!=0,t=i.byteLength-4,n=new DataView(i),s=0,r=0,a=0;a<t-1;a+=2){let c=n.getUint16(a,!0);s=(s+c)%65535,r=(r+s)%65535}if(e){let c=n.getUint8(t-1);s=(s+c)%65535,r=(r+s)%65535}var[o,l]=ye.unpack_from(">HH",i,t);if(o=o%65535,l=l%65535,s!=o||r!=l)throw'ValueError("fletcher32 checksum invalid")';return!0}var Xk=1,Yk=2,Qk=3,Od=new Map([[Xk,Wk],[Yk,jk],[Qk,Gk]]),qm=class{constructor(i,e){this.fh=i,this.offset=e,this.depth=null}async init(){this.all_nodes=new Map,await this._read_root_node(),await this._read_children()}async _read_children(){let i=this.depth;for(;i>0;){for(var e of this.all_nodes.get(i))for(var t of e.get("addresses"))this._add_node(await this._read_node(t,i-1));i--}}async _read_root_node(){let i=await this._read_node(this.offset,null);this._add_node(i),this.depth=i.get("node_level")}_add_node(i){let e=i.get("node_level");this.all_nodes.has(e)?this.all_nodes.get(e).push(i):this.all_nodes.set(e,[i])}async _read_node(i,e){let t=await this._read_node_header(i,e);return t.set("keys",[]),t.set("addresses",[]),t}async _read_node_header(i){throw"NotImplementedError: must define _read_node_header in implementation class"}},Wm=class extends qm{constructor(){super(...arguments),Xi(this,"B_LINK_NODE",new Map([["signature","4s"],["node_type","B"],["node_level","B"],["entries_used","H"],["left_sibling","Q"],["right_sibling","Q"]]))}async _read_node_header(i,e){let t=await Je(this.B_LINK_NODE,this.fh,i);if(e!=null&&t.get("node_level")!=e)throw"node level does not match";return t}},Kk=class extends Wm{constructor(i,e){super(i,e),Xi(this,"NODE_TYPE",0),this.ready=this.init()}async _read_node(i,e){let t=await this._read_node_header(i,e);i+=nt(this.B_LINK_NODE);let n=[],s=[],r=t.get("entries_used");for(var a=0;a<r;a++){let o=(await ye.unpack_from_async("<Q",this.fh,i))[0];i+=8;let l=(await ye.unpack_from_async("<Q",this.fh,i))[0];i+=8,n.push(o),s.push(l)}return n.push((await ye.unpack_from_async("<Q",this.fh,i))[0]),t.set("keys",n),t.set("addresses",s),t}symbol_table_addresses(){var i=[],e=this.all_nodes.get(0);for(var t of e)i=i.concat(t.get("addresses"));return i}},Jk=class extends Wm{constructor(i,e,t){super(i,e),Xi(this,"NODE_TYPE",1),this.dims=t,this.ready=this.init()}async _read_node(i,e){let t=await this._read_node_header(i,e);i+=nt(this.B_LINK_NODE);var n=[],s=[];let r=t.get("entries_used");for(var a=0;a<r;a++){let[o,l]=await ye.unpack_from_async("<II",this.fh,i);i+=8;let c="<"+this.dims.toFixed()+"Q",h=ye.calcsize(c),d=await ye.unpack_from_async(c,this.fh,i);i+=h;let f=(await ye.unpack_from_async("<Q",this.fh,i))[0];i+=8,n.push(new Map([["chunk_size",o],["filter_mask",l],["chunk_offset",d]])),s.push(f)}return t.set("keys",n),t.set("addresses",s),t}async construct_data_from_chunks(i,e,t,n){var s,r,a;if(t instanceof Array){let M=t[0];if(M=="REFERENCE"){if(t[1]!=8)throw"NotImplementedError('Unsupported Reference type')";t="<u8",s="getUint64",r=!1,a=8}else if(M=="VLEN_STRING"||M=="VLEN_SEQUENCE")s="getVLENStruct",r=!1,a=16;else throw"NotImplementedError('datatype not implemented')"}else[s,r,a]=gs(t);var o=e.reduce(function(M,C){return M*C},1),l=i.reduce(function(M,C){return M*C},1);let c=e.length;var h=1;i.slice().map(function(M){let C=h;return h*=M,C});var h=1,d=e.slice().reverse().map(function(M){let C=h;return h*=M,C}).reverse(),f=new Array(o);let u=l*a;for(var g of this.all_nodes.get(0)){let M=g.get("keys"),C=g.get("addresses"),L=M.length;for(var _=0;_<L;_++){let y=M[_],E=C[_];var b;if(n==null)b=await this.fh.slice(E,E+u);else{b=await this.fh.slice(E,E+y.get("chunk_size"));let k=y.get("filter_mask");b=this._filter_chunk(b,k,n,a)}for(var w=y.get("chunk_offset").slice(),p=w.slice(),m=p.map(function(){return 0}),v=new kn(b),x=0;x<l;x++){for(var R=c-1;R>=0&&m[R]>=i[R];R--)m[R]=0,p[R]=w[R],R>0&&(m[R-1]+=1,p[R-1]+=1);if(p.slice(0,-1).every(function(A,I){return A<e[I]})){let A=x*a,I=v[s](A,!r,a),F=p.slice(0,-1).reduce(function(X,U,V){return U*d[V]+X},0);f[F]=I}m[c-1]+=1,p[c-1]+=1}}}return f}_filter_chunk(i,e,t,n){let s=t.length,r=i.slice();for(var a=s-1;a>=0;a--){if(e&1<<a)continue;let o=t[a],l=o.get("filter_id"),c=o.get("client_data");if(Od.has(l))r=Od.get(l)(r,n,c);else throw'NotImplementedError("Filter with id:'+l.toFixed()+' not supported")'}return r}},jm=class extends qm{constructor(i,e){super(i,e),Xi(this,"B_TREE_HEADER",new Map([["signature","4s"],["version","B"],["node_type","B"],["node_size","I"],["record_size","H"],["depth","H"],["split_percent","B"],["merge_percent","B"],["root_address","Q"],["root_nrecords","H"],["total_nrecords","Q"]])),Xi(this,"B_LINK_NODE",new Map([["signature","4s"],["version","B"],["node_type","B"]])),this.ready=this.init()}async _read_root_node(){let i=await this._read_tree_header(this.offset);this.address_formats=this._calculate_address_formats(i),this.header=i,this.depth=i.get("depth");let e=[i.get("root_address"),i.get("root_nrecords"),i.get("total_nrecords")],t=await this._read_node(e,this.depth);this._add_node(t)}async _read_tree_header(i){return await Je(this.B_TREE_HEADER,this.fh,this.offset)}_calculate_address_formats(i){let e=i.get("node_size"),t=i.get("record_size"),n=0,s=0,r=new Map,a=i.get("depth");for(var o=0;o<=a;o++){let l="",c="",h="",d,f,u;if(o==0?(d=0,f=0,u=0):o==1?(d=8,l="<Q",f=this._required_bytes(n),c=this._int_format(f),u=0):(d=8,l="<Q",f=this._required_bytes(n),c=this._int_format(f),u=this._required_bytes(s),h=this._int_format(u)),r.set(o,[d,f,u,l,c,h]),o<a){let g=d+f+u;n=this._nrecords_max(e,t,g),s>0?s*=n:s=n}}return r}_nrecords_max(i,e,t){return Math.floor((i-10-t)/(e+t))}_required_bytes(i){return Math.ceil(Em(i)/8)}_int_format(i){return["<B","<H","<I","<Q"][i-1]}async _read_node(i,e){let[t,n,s]=i,r=this._read_node_header(t,e);t+=nt(this.B_LINK_NODE);let a=this.header.get("record_size"),o=[];for(let h=0;h<n;h++){let d=await this._parse_record(this.fh,t,a);t+=a,o.push(d)}let l=[],c=this.address_formats.get(e);if(e!=0){let[h,d,f,u,g,_]=c;for(let b=0;b<=n;b++){let w=(await ye.unpack_from_async(u,this.fh,t))[0];t+=h;let p=(await ye.unpack_from_async(g,this.fh,t))[0];t+=d;let m=p;f>0&&(m=(await ye.unpack_from_async(_,this.fh,t))[0],t+=f),l.push([w,p,m])}}return r.set("keys",o),r.set("addresses",l),r}async _read_node_header(i,e){let t=await Je(this.B_LINK_NODE,this.fh,i);return t.set("node_level",e),t}*iter_records(){for(let i of this.all_nodes.values())for(let e of i)for(let t of e.get("keys"))yield t}_parse_record(i){throw"NotImplementedError"}},eS=class extends jm{constructor(){super(...arguments),Xi(this,"NODE_TYPE",5)}async _parse_record(i,e,t){let n=(await ye.unpack_from_async("<I",i,e))[0];e+=4;let s=await i.slice(e,e+7);return new Map([["namehash",n],["heapid",s]])}},tS=class extends jm{constructor(){super(...arguments),Xi(this,"NODE_TYPE",6)}async _parse_record(i,e,t){let n=(await ye.unpack_from_async("<Q",i,e))[0];e+=8;let s=await i.slice(e,e+7);return new Map([["creationorder",n],["heapid",s]])}},iS=class{constructor(i,e){this.ready=this.init(i,e)}async init(i,e){let t=await ye.unpack_from_async("<B",i,e+8);var n;if(t==0)n=await Je(Zm,i,e),this._end_of_sblock=e+aS;else if(t==2||t==3)n=await Je(Xm,i,e),this._end_of_sblock=e+oS;else throw"unsupported superblock version: "+t.toFixed();if(n.get("format_signature")!=sS)throw"Incorrect file signature: "+n.get("format_signature");if(n.get("offset_size")!=8||n.get("length_size")!=8)throw"File uses non-64-bit addressing";this.version=n.get("superblock_version"),this._contents=n,this._root_symbol_table=null,this._fh=i}async get_offset_to_dataobjects(){if(this.version==0){var i=new Gm(this._fh,this._end_of_sblock,!0);return await i.ready,this._root_symbol_table=i,i.group_offset}else{if(this.version==2||this.version==3)return this._contents.get("root_group_address");throw"Not implemented version = "+this.version.toFixed()}}},nS=class{constructor(i,e){this.ready=this.init(i,e)}async init(i,e){let t=await Je(cS,i,e);Ke(t.get("signature")=="HEAP"),Ke(t.get("version")==0);let n=t.get("address_of_data_segment"),s=await i.slice(n,n+t.get("data_segment_size"));t.set("heap_data",s),this._contents=t,this.data=s}get_object_name(i){let t=new Uint8Array(this.data).indexOf(0,i)-i;return ye.unpack_from("<"+t.toFixed()+"s",this.data,i)[0]}},Gm=class{constructor(i,e,t=!1){this.ready=this.init(i,e,t)}async init(i,e,t){var n;if(t)n=new Map([["symbols",1]]);else{if(n=await Je(Qm,i,e),n.get("signature")!="SNOD")throw"incorrect node type";e+=hS}for(var s=[],r=n.get("symbols"),a=0;a<r;a++)s.push(await Je(Ym,i,e)),e+=lS;return t&&(this.group_offset=s[0].get("object_header_address")),this.entries=s,this._contents=n,this}assign_name(i){this.entries.forEach(function(e){let t=e.get("link_name_offset"),n=i.get_object_name(t);e.set("link_name",n)})}get_links(i){var e={};return this.entries.forEach(function(t){let n=t.get("cache_type"),s=t.get("link_name");if(n==0||n==1)e[s]=t.get("object_header_address");else if(n==2){let a=t.get("scratch"),o=new ArrayBuffer(4),l=new Uint8Array(o);for(var r=0;r<4;r++)l[r]=a.charCodeAt(r);let c=ye.unpack_from("<I",o,0)[0];e[s]=i.get_object_name(c)}}),e}},Bd=class{constructor(i,e){this.ready=this.init(i,e)}async init(i,e){let t=await Je(Km,i,e);e+=Pd;let n=t.get("collection_size")-Pd,s=await i.slice(e,e+n);this.heap_data=s,this._header=t,this._objects=null}get objects(){if(this._objects==null){this._objects=new Map;for(var i=0;i<=this.heap_data.byteLength-zd;){let e=Cm(Jm,this.heap_data,i);if(e.get("object_index")==0)break;i+=zd;let t=this.heap_data.slice(i,i+e.get("object_size"));this._objects.set(e.get("object_index"),t),i+=er(e.get("object_size"))}}return this._objects}},rS=class{constructor(i,e){this.fh=i,this.ready=this.init(e)}async init(i){let e=await Je(Hd,this.fh,i);if(i+=nt(Hd),Ke(e.get("signature")=="FRHP"),Ke(e.get("version")==0),e.get("filter_info_size")>0)throw"Filter info size not supported on FractalHeap";if(e.get("btree_address_huge_objects")==rs)e.set("btree_address_huge_objects",null);else throw"Huge objects not implemented in FractalHeap";e.get("root_block_address")==rs&&e.set("root_block_address",null);let t=e.get("log2_maximum_heap_size"),n=this._min_size_nbits(t),s=new Map([["signature","4s"],["version","B"],["heap_header_adddress","Q"],["block_offset",`${n}B`]]);this.indirect_block_header=new Map(s),this.indirect_block_header_size=nt(s),(e.get("flags")&2)==2&&s.set("checksum","I"),this.direct_block_header=s,this.direct_block_header_size=nt(s);let r=e.get("maximum_direct_block_size");this._managed_object_offset_size=this._min_size_nbits(t);let a=Math.min(r,e.get("max_managed_object_size"));this._managed_object_length_size=this._min_size_integer(a);let o=e.get("starting_block_size"),l=e.get("table_width");if(!(o>0))throw"Starting block size == 0 not implemented";let c=Number(Math.floor(Math.log2(r)));Ke(1n<<BigInt(c)==r);let h=Number(Math.floor(Math.log2(o)));Ke(1n<<BigInt(h)==o),this._max_direct_nrows=c-h+2;let d=Math.floor(Math.log2(l));Ke(1<<d==l),this._indirect_nrows_sub=d+h-1,this.header=e,this.nobjects=e.get("managed_object_count")+e.get("huge_object_count")+e.get("tiny_object_count");let f=[],u=e.get("root_block_address"),g=0;if(u!=null&&(g=e.get("indirect_current_rows_count")),g>0)for await(let p of this._iter_indirect_block(this.fh,u,g))f.push(p);else{let p=await this._read_direct_block(this.fh,u,o);f.push(p)}let _=f.reduce((p,m)=>p+m.byteLength,0),b=new Uint8Array(_),w=0;f.forEach(p=>{b.set(new Uint8Array(p),w),w+=p.byteLength}),this.managed=b.buffer}async _read_direct_block(i,e,t){let n=await i.slice(e,e+t),s=Cm(this.direct_block_header,n);return Ke(s.get("signature")=="FHDB"),n}get_data(i){let e=ye.unpack_from("<B",i,0)[0],t=e>>4&3,n=e>>6,s=1;if(t==0){Ke(n==0);let r=this._managed_object_offset_size,a=nd(r,i,s);s+=r,r=this._managed_object_length_size;let o=nd(r,i,s);return this.managed.slice(a,a+o)}else throw t==1?"tiny objectID not supported in FractalHeap":t==2?"huge objectID not supported in FractalHeap":"unknown objectID type in FractalHeap"}_min_size_integer(i){return this._min_size_nbits(Em(i))}_min_size_nbits(i){return Math.ceil(i/8)}async*_iter_indirect_block(i,e,t){let n=await Je(this.indirect_block_header,i,e);e+=this.indirect_block_header_size,Ke(n.get("signature")=="FHIB");let r=n.get("block_offset").reduce((h,d,f)=>h+(d<<f*8),0);n.set("block_offset",r);let[a,o]=this._indirect_info(t),l=[];for(let h=0;h<a;h++){let d=(await ye.unpack_from_async("<Q",i,e))[0];if(e+=8,d==rs)break;let f=this._calc_block_size(h);l.push([d,f])}let c=[];for(let h=a;h<a+o;h++){let d=(await ye.unpack_from_async("<Q",i,e))[0];if(e+=8,d==rs)break;let f=this._calc_block_size(h),u=this._iblock_nrows_from_block_size(f);c.push([d,u])}for(let[h,d]of l)yield await this._read_direct_block(i,h,d);for(let[h,d]of c)for await(let f of this._iter_indirect_block(i,h,d))yield f}_calc_block_size(i){let e=Math.floor(i/this.header.get("table_width"));return 2**Math.max(e-1,0)*this.header.get("starting_block_size")}_iblock_nrows_from_block_size(i){let e=Math.floor(Math.log2(i));return Ke(2**e==i),e-this._indirect_nrows_sub}_indirect_info(i){let e=this.header.get("table_width"),t=i*e,n=this._max_direct_nrows*e,s,r;return i<=n?(s=t,r=0):(s=n,r=t-n),[s,r]}_int_format(i){return["B","H","I","Q"][i-1]}},sS=ye.unpack_from("8s",new Uint8Array([137,72,68,70,13,10,26,10]).buffer)[0],rs=ye.unpack_from("<Q",new Uint8Array([255,255,255,255,255,255,255,255]).buffer)[0],Zm=new Map([["format_signature","8s"],["superblock_version","B"],["free_storage_version","B"],["root_group_version","B"],["reserved_0","B"],["shared_header_version","B"],["offset_size","B"],["length_size","B"],["reserved_1","B"],["group_leaf_node_k","H"],["group_internal_node_k","H"],["file_consistency_flags","L"],["base_address_lower","Q"],["free_space_address","Q"],["end_of_file_address","Q"],["driver_information_address","Q"]]),aS=nt(Zm),Xm=new Map([["format_signature","8s"],["superblock_version","B"],["offset_size","B"],["length_size","B"],["file_consistency_flags","B"],["base_address","Q"],["superblock_extension_address","Q"],["end_of_file_address","Q"],["root_group_address","Q"],["superblock_checksum","I"]]),oS=nt(Xm),Ym=new Map([["link_name_offset","Q"],["object_header_address","Q"],["cache_type","I"],["reserved","I"],["scratch","16s"]]),lS=nt(Ym),Qm=new Map([["signature","4s"],["version","B"],["reserved_0","B"],["symbols","H"]]),hS=nt(Qm),cS=new Map([["signature","4s"],["version","B"],["reserved","3s"],["data_segment_size","Q"],["offset_to_free_list","Q"],["address_of_data_segment","Q"]]),Km=new Map([["signature","4s"],["version","B"],["reserved","3s"],["collection_size","Q"]]),Pd=nt(Km),Jm=new Map([["object_index","H"],["reference_count","H"],["reserved","I"],["object_size","Q"]]),zd=nt(Jm),Hd=new Map([["signature","4s"],["version","B"],["object_index_size","H"],["filter_info_size","H"],["flags","B"],["max_managed_object_size","I"],["next_huge_object_index","Q"],["btree_address_huge_objects","Q"],["managed_freespace_size","Q"],["freespace_manager_address","Q"],["managed_space_size","Q"],["managed_alloc_size","Q"],["next_directblock_iterator_address","Q"],["managed_object_count","Q"],["huge_objects_total_size","Q"],["huge_object_count","Q"],["tiny_objects_total_size","Q"],["tiny_object_count","Q"],["table_width","H"],["starting_block_size","Q"],["maximum_direct_block_size","Q"],["log2_maximum_heap_size","H"],["indirect_starting_rows_count","H"],["root_block_address","Q"],["indirect_current_rows_count","H"]]),Th=class{constructor(i,e){this.ready=this.init(i,e)}async init(i,e){let t=(await ye.unpack_from_async("<B",i,e))[0];if(t==1)var[n,s,r]=await this._parse_v1_objects(i,e);else if(t==79)var[n,s,r]=await this._parse_v2_objects(i,e);else throw"InvalidHDF5File('unknown Data Object Header')";this.fh=i,this.msgs=n,this.msg_data=s,this.offset=e,this._global_heaps={},this._header=r,this._filter_pipeline=null,this._chunk_params_set=!1,this._chunks=null,this._chunk_dims=null,this._chunk_address=null}get dtype(){let e=this.find_msg_type(yS)[0].get("offset_to_message");return new rd(this.fh,e).dtype}get chunks(){return this._get_chunk_params().then(()=>this._chunks)}get shape(){let e=this.find_msg_type(qd)[0].get("offset_to_message");return fS(this.fh,e)}async get_filter_pipeline(){if(this._filter_pipeline!=null)return this._filter_pipeline;let i=this.find_msg_type(SS);if(!i.length)return this._filter_pipeline=null,this._filter_pipeline;var e=i[0].get("offset_to_message");let[t,n]=await ye.unpack_from_async("<BB",this.fh,e);e+=ye.calcsize("<BB");var s=[];if(t==1){await ye.unpack_from_async("<HI",this.fh,e),e+=ye.calcsize("<HI");for(var r=0;r<n;r++){let a=await Je(h0,this.fh,e);e+=vS;let o=er(a.get("name_length"),8),l="<"+o.toFixed()+"s",c=(await ye.unpack_from_async(l,this.fh,e))[0];a.set("filter_name",c),e+=o,l="<"+a.get("client_data_values").toFixed()+"I";let h=await ye.unpack_from_async(l,this.fh,e);a.set("client_data",h),e+=4*a.get("client_data_values"),a.get("client_data_values")%2&&(e+=4),s.push(a)}}else if(t==2)for(let a=0;a<n;a++){let o=new Map,l=this.fh,c=(await ye.unpack_from_async("<H",l,e))[0];e+=2,o.set("filter_id",c);let h=0;c>255&&(h=(await ye.unpack_from_async("<H",l,e))[0],e+=2);let d=(await ye.unpack_from_async("<H",l,e))[0];e+=2;let f=(d&1)>0;o.set("optional",f);let u=(await ye.unpack_from_async("<H",l,e))[0];e+=2;let g;h>0&&(g=(await ye.unpack_from_async(`${h}s`,l,e))[0],e+=h),o.set("name",g);let _=await ye.unpack_from_async(`<${u}i`,l,e);e+=4*u,o.set("client_data_values",_),s.push(o)}else throw`version ${t} is not supported`;return this._filter_pipeline=s,this._filter_pipeline}find_msg_type(i){return this.msgs.filter(function(e){return e.get("type")==i})}async get_attributes(){let i={},e=this.find_msg_type(CS);for(let t of e){let n=t.get("offset_to_message"),[s,r]=await this.unpack_attribute(n);i[s]=r}return i}async get_fillvalue(){var e=this.find_msg_type(xS)[0].get("offset_to_message"),t;let n=(await ye.unpack_from_async("<B",this.fh,e))[0];var s,r,a;if(n==1||n==2)s=await Je(o0,this.fh,e),e+=bS,t=s.get("fillvalue_defined");else if(n==3)s=await Je(l0,this.fh,e),e+=wS,t=s.get("flags")&32;else throw'InvalidHDF5File("Unknown fillvalue msg version: "'+String(n);if(t?(r=(await ye.unpack_from_async("<I",this.fh,e))[0],e+=4):r=0,r){let[o,l,c]=gs(await this.dtype);a=new kn(await this.fh.slice(e,e+c))[o](e,!l,c)}else a=0;return a}async unpack_attribute(i){let e=(await ye.unpack_from_async("<B",this.fh,i))[0];var t,n;if(e==1)t=await Je(t0,this.fh,i),Ke(t.get("version")==1),i+=uS,n=8;else if(e==3)t=await Je(i0,this.fh,i),Ke(t.get("version")==3),i+=dS,n=1;else throw"unsupported attribute message version: "+e;let s=t.get("name_size"),r=(await ye.unpack_from_async("<"+s.toFixed()+"s",this.fh,i))[0];r=r.replace(/\x00$/,""),i+=er(s,n);var a;try{a=await new rd(this.fh,i).dtype}catch{return console.warn("Attribute "+r+" type not implemented, set to null."),[r,null]}i+=er(t.get("datatype_size"),n);let o=await this.determine_data_shape(this.fh,i),l=o.reduce(function(h,d){return h*d},1);if(i+=er(t.get("dataspace_size"),n),a.datatype_class===5)c=await this.fh.slice(i,i+a.size);else{var c=await this._attr_value(a,this.fh,l,i);o.length==0&&(c=c[0])}return[r,c]}async determine_data_shape(i,e){let t=(await ye.unpack_from_async("<B",i,e))[0];var n;if(t==1)n=await Je(Tc,i,e),Ke(n.get("version")==1),e+=n0;else if(t==2)n=await Je(Mc,i,e),Ke(n.get("version")==2),e+=r0;else throw"unknown dataspace message version";let s=n.get("dimensionality");return await ye.unpack_from_async("<"+s.toFixed()+"Q",i,e)}async _attr_value(i,e,t,n){var s=new Array(t);if(i instanceof Array){let c=i[0];for(var r=0;r<t;r++)if(c=="VLEN_STRING"){let h=i[2];var[a,o]=await this._vlen_size_and_data(e,n);let d=h==0?"ascii":"utf-8",f=new TextDecoder(d);s[r]=f.decode(o),n+=16}else if(c=="REFERENCE"){var l=await ye.unpack_from_async("<Q",e,n);s[r]=l,n+=8}else if(c=="VLEN_SEQUENCE"){let h=i[1];var[a,o]=this._vlen_size_and_data(e,n);s[r]=this._attr_value(h,o,a,0),n+=16}else throw"NotImplementedError"}else{let[c,h,d]=gs(i),f=await e.slice(n,n+t*d),u=new kn(f,0),g=0;for(var r=0;r<t;r++)s[r]=u[c](g,!h,d),g+=d}return s}async _vlen_size_and_data(i,e){let t=(await ye.unpack_from_async("<I",i,e))[0],n=await Je(e0,i,e+4),s=n.get("collection_address");Ke(n.get("collection_address")<Number.MAX_SAFE_INTEGER);var r;s in this._global_heaps||(r=new Bd(this.fh,s),await r.ready,this._global_heaps[s]=r),r=this._global_heaps[s];let a=r.objects.get(n.get("object_index"));return[t,a]}async _parse_v1_objects(i,e){let t=await Je(Ud,i,e);Ke(t.get("version")==1);let n=t.get("total_header_messages");for(var s=t.get("object_header_size"),r=e+nt(Ud),a=await i.slice(r,r+s),o=[[r,s]],l=0,c=0,h=new Array(n),d=0;d<n;d++){c>=s&&([r,s]=o[++l],c=0);let g=await Je(s0,i,r+c),_=r+c+Vd;if(g.set("offset_to_message",_),g.get("type")==jd){var[f,u]=await ye.unpack_from_async("<QQ",i,_);o.push([f,u])}c+=Vd+g.get("size"),h[d]=g}return[h,a,t]}async _parse_v2_objects(i,e){var[t,n,s]=await this._parse_v2_header(i,e);e=s;for(var r=[],a=t.get("size_of_chunk_0"),o=i.slice(e,e+=a),l=[[s,a]],c=0,h=0;;){if(h>=a-Co){let _=l[++c];if(_==null)break;[s,a]=_,h=0}let u=await Je(a0,i,s+h),g=s+h+Co+n;if(u.set("offset_to_message",g),u.get("type")==jd){var[d,f]=await ye.unpack_from_async("<QQ",i,g);l.push([d+4,f-4])}h+=Co+u.get("size")+n,r.push(u)}return[r,o,t]}async _parse_v2_header(i,e){let t=await Je($d,i,e);var n;if(e+=nt($d),Ke(t.get("version")==2),t.get("flags")&4?n=2:n=0,Ke((t.get("flags")&16)==0),t.get("flags")&32){let r=await ye.unpack_from_async("<4I",i,e);e+=16,t.set("access_time",r[0]),t.set("modification_time",r[1]),t.set("change_time",r[2]),t.set("birth_time",r[3])}let s=["<B","<H","<I","<Q"][t.get("flags")&3];return t.set("size_of_chunk_0",(await ye.unpack_from_async(s,i,e))[0]),e+=ye.calcsize(s),[t,n,e]}async find_link(i){if(this._links){for(link of this._links)if(i===link[0])return link}else{let e=[];for await(let t of this.iter_links()){if(i===t[0])return t;e.push(t)}this._links=e}}async get_links(){let i=[];for await(let e of this.iter_links())i.push(e);return Object.fromEntries(i)}async*iter_links(){for(let i of this.msgs)i.get("type")==ES?yield*this._iter_links_from_symbol_tables(i):i.get("type")==kS?yield this._get_link_from_link_msg(i):i.get("type")==_S&&(yield*this._iter_link_from_link_info_msg(i))}async*_iter_links_from_symbol_tables(i){Ke(i.get("size")==16);let e=await Je(pS,this.fh,i.get("offset_to_message"));yield*this._iter_links_btree_v1(e.get("btree_address"),e.get("heap_address"))}async*_iter_links_btree_v1(i,e){let t=new Kk(this.fh,i);await t.ready;let n=new nS(this.fh,e);await n.ready;for(let s of t.symbol_table_addresses()){let r=new Gm(this.fh,s);await r.ready,r.assign_name(n),yield*Object.entries(r.get_links(n))}}async _get_link_from_link_msg(i){let e=i.get("offset_to_message");return await this._decode_link_msg(this.fh,e)[1]}async _decode_link_msg(i,e){let[t,n]=await ye.unpack_from_async("<BB",i,e);e+=2,Ke(t==1);let s=2**(n&3),r=(n&2**3)>0,a=(n&2**4)>0,o=(n&2**2)>0,l;r?(l=(await ye.unpack_from_async("<B",i,e))[0],e+=1):l=0,Ke([0,1].includes(l));let c;o&&(c=(await ye.unpack_from_async("<Q",i,e))[0],e+=8);let h=0;a&&(h=(await ye.unpack_from_async("<B",i,e))[0],e+=1);let d=h==0?"ascii":"utf-8",f=["<B","<H","<I","<Q"][n&3],u=(await ye.unpack_from_async(f,i,e))[0];e+=s;let g=new TextDecoder(d).decode(await i.slice(e,e+u));e+=u;let _;if(l==0)_=(await ye.unpack_from_async("<Q",i,e))[0];else if(l==1){let b=(await ye.unpack_from_async("<H",i,e))[0];e+=2,_=new TextDecoder(d).decode(await i.slice(e,e+b))}return[c,[g,_]]}async*_iter_link_from_link_info_msg(i){let e=i.get("offset_to_message"),t=await this._decode_link_info_msg(this.fh,e),n=t.get("heap_address"),s=t.get("name_btree_address"),r=t.get("order_btree_address");s!=null&&(yield*this._iter_links_btree_v2(s,r,n))}async*_iter_links_btree_v2(i,e,t){let n=new rS(this.fh,t);await n.ready;let s,r=e!=null;r?(s=new tS(this.fh,e),await s.ready):(s=new eS(this.fh,i),await s.ready);let a=new Map;for(let l of s.iter_records()){let c=n.get_data(l.get("heapid")),[h,d]=await this._decode_link_msg(c,0),f=r?h:d[0];a.set(f,d)}let o=Array.from(a.keys()).sort();for(let l of o)yield a.get(l)}async _decode_link_info_msg(i,e){let[t,n]=await ye.unpack_from_async("<BB",i,e);Ke(t==0),e+=2,(n&1)>0&&(e+=8);let s=(n&2)>0?mS:gS,r=await Je(s,i,e),a=new Map;for(let[o,l]of r.entries())a.set(o,l==So?null:l);return a}get is_dataset(){return this.find_msg_type(qd).length>0}async get_data(){let e=this.find_msg_type(Wd)[0].get("offset_to_message");var[t,n,s,r]=await this._get_data_message_properties(e);if(s==0)throw"Compact storage of DataObject not implemented";if(s==1)return this._get_contiguous_data(r);if(s==2)return this._get_chunked_data(e)}async _get_data_message_properties(i){let e,t,n,[s,r,a]=await ye.unpack_from_async("<BBB",this.fh,i);return s==1||s==2?(e=r,t=a,n=i,n+=ye.calcsize("<BBB"),n+=ye.calcsize("<BI"),Ke(t==1||t==2)):(s==3||s==4)&&(t=r,n=i,n+=ye.calcsize("<BB")),Ke(s>=1&&s<=4),[s,e,t,n]}async _get_contiguous_data(i){let[e]=await ye.unpack_from_async("<Q",this.fh,i),t=await this.shape,n=await this.dtype;if(e==So){let o=t.reduce(function(l,c){return l*c},1);return new Array(o)}var s=t.reduce(function(o,l){return o*l},1);if(n instanceof Array){let o=n[0];if(o=="REFERENCE"){if(n[1]!=8)throw"NotImplementedError('Unsupported Reference type')";return await this.fh.slice(e,e+s)}else if(o=="VLEN_STRING"){let c=n[2]==0?"ascii":"utf-8",h=new TextDecoder(c);for(var a=[],r=0;r<s;r++){let[f,u]=await this._vlen_size_and_data(this.fh,e);a[r]=h.decode(u),e+=16}return a}else throw"NotImplementedError('datatype not implemented')"}else if(/[<>=!@\|]?(i|u|f|S)(\d*)/.test(n)){let[o,l,c]=gs(n),h=new Array(s),d=await this.fh.slice(e,e+c*s),f=new kn(d);for(var r=0;r<s;r++)h[r]=f[o](r*c,!l,c);return h}else{if(n.datatype_class===5)return this.fh.slice(e,e+n.size);throw"not Implemented - no proper dtype defined"}}async _get_chunked_data(i){if(await this._get_chunk_params(),this._chunk_address==So)return[];var e=new Jk(this.fh,this._chunk_address,this._chunk_dims);await e.ready;let t=await this.dtype,n=await this.shape,s=await this.chunks,r=await this.get_filter_pipeline(),a=await e.construct_data_from_chunks(s,n,t,r);if(t instanceof Array&&/^VLEN/.test(t[0])){let c=t[0];for(var o=0;o<a.length;o++){let[h,d,f]=a[o];var l;d in this._global_heaps?l=this._global_heaps[d]:(l=new Bd(this.fh,d),await l.ready,this._global_heaps[d]=l);let u=l.objects.get(f);if(c=="VLEN_STRING"){let _=t[2]==0?"ascii":"utf-8",b=new TextDecoder(_);a[o]=b.decode(u)}}}return a}async _get_chunk_params(){if(!this._chunk_params_set){this._chunk_params_set=!0;var i=this.find_msg_type(Wd)[0],e=i.get("offset_to_message"),[t,n,s,r]=await this._get_data_message_properties(e);if(s==2){var a;if(t==1||t==2){var o=(await ye.unpack_from_async("<Q",this.fh,r))[0];a=r+ye.calcsize("<Q")}else if(t==3){var[n,o]=await ye.unpack_from_async("<BQ",this.fh,r);a=r+ye.calcsize("<BQ")}Ke(t>=1&&t<=3);var l="<"+(n-1).toFixed()+"I",c=await ye.unpack_from_async(l,this.fh,a);this._chunks=c,this._chunk_dims=n,this._chunk_address=o}}}};async function fS(i,e){let t=(await ye.unpack_from_async("<B",i,e))[0];var n;if(t==1)n=await Je(Tc,i,e),Ke(n.get("version")==1),e+=n0;else if(t==2)n=await Je(Mc,i,e),Ke(n.get("version")==2),e+=r0;else throw"InvalidHDF5File('unknown dataspace message version')";let s=n.get("dimensionality");return(await ye.unpack_from_async("<"+(s*2).toFixed()+"I",i,e)).filter(function(a,o){return o%2==0})}var So=ye.unpack_from("<Q",new Uint8Array([255,255,255,255,255,255,255,255]).buffer),e0=new Map([["collection_address","Q"],["object_index","I"]]);nt(e0);var t0=new Map([["version","B"],["reserved","B"],["name_size","H"],["datatype_size","H"],["dataspace_size","H"]]),uS=nt(t0),i0=new Map([["version","B"],["flags","B"],["name_size","H"],["datatype_size","H"],["dataspace_size","H"],["character_set_encoding","B"]]),dS=nt(i0),Ud=new Map([["version","B"],["reserved","B"],["total_header_messages","H"],["object_reference_count","I"],["object_header_size","I"],["padding","I"]]),$d=new Map([["signature","4s"],["version","B"],["flags","B"]]),Tc=new Map([["version","B"],["dimensionality","B"],["flags","B"],["reserved_0","B"],["reserved_1","I"]]),n0=nt(Tc),Mc=new Map([["version","B"],["dimensionality","B"],["flags","B"],["type","B"]]),r0=nt(Mc),s0=new Map([["type","H"],["size","H"],["flags","B"],["reserved","3s"]]),Vd=nt(s0),a0=new Map([["type","B"],["size","H"],["flags","B"]]),Co=nt(a0),pS=new Map([["btree_address","Q"],["heap_address","Q"]]),gS=new Map([["heap_address","Q"],["name_btree_address","Q"]]),mS=new Map([["heap_address","Q"],["name_btree_address","Q"],["order_btree_address","Q"]]),o0=new Map([["version","B"],["space_allocation_time","B"],["fillvalue_write_time","B"],["fillvalue_defined","B"]]),bS=nt(o0),l0=new Map([["version","B"],["flags","B"]]),wS=nt(l0),h0=new Map([["filter_id","H"],["name_length","H"],["flags","H"],["client_data_values","H"]]),vS=nt(h0),qd=1,_S=2,yS=3,xS=5,kS=6,Wd=8,SS=11,CS=12,jd=16,ES=17,Mh=class{constructor(i,e){e==null?(this.parent=this,this.file=this):(this.parent=e,this.file=e.file),this.name=i}async init(i){let e=this.file.index;e&&this.name in e?this._links=e[this.name]:this._links=await i.get_links(),this._dataobjects=i,this._attrs=null,this._keys=null}get keys(){return this._keys==null&&(this._keys=Object.keys(this._links)),this._keys.slice()}get values(){return this.keys.map(i=>this.get(i))}length(){return this.keys.length}_dereference(i){if(!i)throw"cannot deference null reference";let e=this.file._get_object_by_address(i);if(e==null)throw"reference not found in file";return e}async get(i){if(typeof i=="number")return this._dereference(i);var e=Gd(i);if(e=="/")return this.file;if(e==".")return this;if(/^\//.test(e))return this.file.get(e.slice(1));if(MS(e)!="")var[t,n]=e.split(/\/(.*)/);else var t=e,n=".";if(!(t in this._links))throw t+" not found in group";var s=Gd(this.name+"/"+t);let r=this._links[t];if(typeof r=="string")try{return this.get(r)}catch{return null}var a=new Th(this.file._fh,r);if(await a.ready,a.is_dataset){if(n!=".")throw s+" is a dataset, not a group";return new TS(s,a,this)}else{var o=new Mh(s,this);return await o.init(a),o.get(n)}}visit(i){return this.visititems((e,t)=>i(e))}visititems(i){var e=this.name.length;/\/$/.test(this.name)||(e+=1);for(var t=this.values.slice();t;){let n=t.shift();t.length==1&&console.log(n);let s=n.name.slice(e),r=i(s,n);if(r!=null)return r;n instanceof Mh&&(t=t.concat(n.values))}return null}get attrs(){return this._attrs==null&&(this._attrs=this._dataobjects.get_attributes()),this._attrs}},AS=class extends Mh{constructor(i,e,t){super("/",null),this.ready=this.init(i,e,t)}async init(i,e,t){var n=new iS(i,0);await n.ready;var s=await n.get_offset_to_dataobjects(),r=new Th(i,s);if(await r.ready,this.parent=this,this.file=this,this.name="/",this._dataobjects=r,this._attrs=null,this._keys=null,this._fh=i,this.filename=e||"",this.mode="r",this.userblock_size=0,t&&t.index)this.index=t.index;else{let a;if(t&&t.indexOffset)a=t.indexOffset;else{let o=await this.attrs;if(o.hasOwnProperty("_index_offset"))a=o._index_offset;else{let l=this.indexName||"_index",c=await r.find_link(l);c&&(a=c[1])}}if(a)try{let o=new Th(i,a);await o.ready;let l=await o.get_data(),c=qk(l),h=new TextDecoder().decode(c);this.index=JSON.parse(h)}catch(o){console.error(`Error loading index by offset ${o}`)}}this.index&&this.name in this.index?this._links=this.index[this.name]:this._links=await r.get_links()}_get_object_by_address(i){return this._dataobjects.offset==i?this:this.visititems(e=>{e._dataobjects.offset==i})}},TS=class extends Array{constructor(i,e,t){super(),this.parent=t,this.file=t.file,this.name=i,this._dataobjects=e,this._attrs=null,this._astype=null}get value(){var i=this._dataobjects.get_data();return this._astype==null?this.getValue(i):i.astype(this._astype)}get shape(){return this._dataobjects.shape}get attrs(){return this._dataobjects.get_attributes()}get dtype(){return this._dataobjects.dtype}get fillvalue(){return this._dataobjects.get_fillvalue()}async to_array(){let i=await this.value,e=await this.shape;return RS(i,e)}async getValue(i){let e=await this.dtype;return(typeof e=="string"||e instanceof String)&&e.startsWith("S")?(await i).map(t=>{let n=t.indexOf("\0");return n>=0?t.substring(0,n):t}):i}};function MS(i){let e="/",t=i.lastIndexOf(e)+1,n=i.slice(0,t),s=new RegExp("^"+e+"+$"),r=new RegExp(e+"$");return n&&!s.test(n)&&(n=n.replace(r,"")),n}function Gd(i){return i.replace(/\/(\/)+/g,"/")}function RS(i,e){let t=i.length,n=e.reduce((a,o)=>a*o,1);t!==n&&console.warn(`shape product: ${n} does not match length of flattened array: ${t}`);let s=i,r=e.slice(1).reverse();for(let a of r){let o=[],{length:l}=s,c=0;for(;c<l;)o.push(s.slice(c,c+=a));s=o}return s}async function IS(i){i.url&&DS(i.url)&&(i.file=i.url,i.url=void 0);let e=i.url!==void 0,t=i.reader?i.reader:NS(i),n=i.fetchSize||2e3,s=i.maxSize||2e5;e&&(t=new Sh({file:t,fetchSize:n,maxSize:s}));let r=new Rh(t),a=await LS(i),o=i.indexOffset,l=FS(i),c=new AS(r,l,{index:a,indexOffset:o});return await c.ready,c}async function LS(i){let e;if(i.indexReader)e=i.indexReader;else{if(i.index)return i.index;i.indexURL?e=new aa({url:i.indexURL}):i.indexPath?e=new NodeLocalFile({path:i.indexPath}):i.indexFile&&(e=new oa({file:i.indexFile}))}if(e){let t=await e.read(),n=new TextDecoder().decode(t);return JSON.parse(n)}else return}function NS(i){if(i.url)return new aa(i);if(i.path)return new NodeLocalFile(i);if(i.file)return new oa(i.file);throw Error("One of 'url', 'path (node only)', or 'file (browser only)' must be specified")}function FS(i){if(i.url)return Zd(i.url);if(i.path)return Zd(i.path);if(i.file)return i.file.name}var Rh=class{constructor(e){this.fileReader=e}async slice(e,t){return this.fileReader.read(e,t-e)}};function Zd(i){let e=i.lastIndexOf("/");return e>0?i.substring(e+1):i}function DS(i){return typeof i.slice=="function"&&typeof i.arrayBuffer=="function"}var Ih=class{constructor(e,t=1e5){this.h5_file=e,this.bin_size=t,this.h5_obj=void 0}async fetch(){return this.h5_obj||(this.h5_obj=await IS({url:this.h5_file,fetchSize:1e6,maxSize:2e8})),this.h5_obj}async get_keys(){return(await this.fetch()).keys}async get_rd_signal(e=this.bin_size){let t=await this.fetch(),n=t.keys,s=new Lh(n),r=s.get_rd_bins(),a=s.get_snp_bins();this.available_bins=[...new Set(r,a)],this.available_bins.includes(e)||(e=this.available_bins.at(-1));let o=await t.get("rd_chromosomes");await o.dtype;let l=await o.value,c="",h=await this.rd_stat(t,n,e);var d=[],f=[],u=[],g=[],_=[],b=[];for(let x of l){var w=`his_rd_p_${x}_${e}${c}`;let R=await this.get_chr_signal(t,n,x,e,w,h);d=d.concat(R);var p=`his_rd_p_${x}_${e}_GC`;let M=await this.get_chr_signal(t,n,x,e,p,h);f=f.concat(M);let C=`his_rd_p_${x}_${e}_partition_GC_merge`,L=await this.get_chr_signal(t,n,x,e,C,h);u=u.concat(L);let y=await this.rd_call_combined(t,n,x,e,h);g=g.concat(y);let E=`snp_likelihood_${x}_${e}_mask`,k=await this.get_baf_signals(t,n,x,e,E);_=_.concat(k[0]),b=b.concat(k[1])}this.callers=[],g.length!=0&&this.callers.push("ReadDepth"),g.length!=0&&this.callers.push("2D");var m={},v={RD_Raw:d,RD_Raw_gc_coor:f,ReadDepth:u,"2D":g,BAF1:_,BAF2:b};return m[e]=v,m}decode_segments(e){let t=4294967295,n=[],s=[];for(let r of e)r==t?(n.push(s),s=[]):s.push(r);return n}async rd_call_combined(e,t,n,s,r){let a=[],o,l=`his_rd_p_${n}_${s}_partition_GC_mosaic_segments_2d`;if(t.includes(l)){let d=await(await e.get(l)).value;o=this.decode_segments(d)}let c=`his_rd_p_${n}_${s}_partition_GC_mosaic_call_2d`;if(t.includes(c)){let d=await(await e.get(c)).to_array();o.forEach((f,u)=>{f.forEach((g,_)=>{a.push({chr:n,start:g*s,end:(g+1)*s,value:d[0][u]/r[4]*2})})})}return a}async rd_stat(e,t,n){let s=`rd_stat_${n}_auto`,r;return t.includes(s)&&(r=await(await e.get(s)).value),r}async get_chr_signal(e,t,n,s,r,a){let o=[];return t.includes(r)&&(await(await e.get(r)).value).forEach((h,d)=>{o.push({chr:n,start:d*s,end:(d+1)*s,value:h/a[4]*2})}),o}async get_baf_signals(e,t,n,s,r){let a=[],o=[];return t.includes(r)&&(await(await e.get(r)).to_array()).forEach((h,d)=>{let f=Math.max(...h),u=h.indexOf(f),g=Math.max(u/200,1-u/200);a.push({chr:n,start:d*s,end:(d+1)*s,value:-2*g}),g!=.5&&o.push({chr:n,start:d*s,end:(d+1)*s,value:-2*(1-g)})}),[a,o]}async get_baf_signals_v2(e,t,n,s,r){let a=[],o=[];return t.includes(r)&&(await(await e.get(r)).to_array()).forEach((h,d)=>{isNaN(h)||(a.push({chr:n,start:d*s,end:(d+1)*s,value:-2*(.5-h)}),h!=.5&&o.push({chr:n,start:d*s,end:(d+1)*s,value:-2*(.5+h)}))}),console.log(n,a,o),[a,o]}},Lh=class{constructor(e){this.signals=e}get_rd_bins(){let e=[];return this.signals.forEach(n=>{let s=n.match(/^his_rd_p_(.*)_(\d+)$/);s&&e.push({chr:s[1],bin_size:s[2]})}),[...new Set(e.map(n=>Number(n.bin_size)))]}get_snp_bins(){let e=[];return this.signals.forEach(n=>{let s=n.match(/^snp_likelihood_(.*)_(\d+)_mask$/);s&&e.push({chr:s[1],bin_size:s[2]})}),[...new Set(e.map(n=>Number(n.bin_size)))]}},Nh=class{constructor(e){this.allBins=e}getValues(){return Object.values(this.allBins).reduce((t,n)=>t.concat(n.filter(s=>s.binScore>0).map(s=>s.binScore)),[])}getMean(e){return e.reduce(function(t,n){return t+n})/e.length}fit_data(){let e=this.getValues();return c0(e)}histogram(e,t){let n=t[1]-t[0],s=[];e.forEach((a,o)=>{t.forEach((l,c)=>{if(s[l]||(s[l]={count:0}),l<=a&&a<l+n)return s[l].count++,!1})});let r=[];return s.forEach((a,o)=>{r.push(a.count)}),r}};function OS(i,e,t){return Array(Math.ceil((e-i)/t)).fill(i).map((s,r)=>s+r*t)}function BS(i){if(i.length<4)return i;let e,t,n,s,r,a;return e=i.slice().sort((o,l)=>o-l),e.length/4%1===0?(t=1/2*(e[e.length/4]+e[e.length/4+1]),n=1/2*(e[e.length*(3/4)]+e[e.length*(3/4)+1])):(t=e[Math.floor(e.length/4+1)],n=e[Math.ceil(e.length*(3/4)+1)]),s=n-t,r=n+s*1.5,a=t-s*1.5,e.filter(o=>o>=a&&o<=r)}function c0(i){let e=BS(i),t=e.length,n=e.reduce((r,a)=>r+a)/t,s=Math.sqrt(e.map(r=>Math.pow(r-n,2)).reduce((r,a)=>r+a)/t);return[n,s]}function PS(i,e,t){if(typeof t>"u"&&(t=Math.max(Math.round(e-i)+1,1)),t<2)return t===1?[i]:[];var n=Array(t);t--;for(let s=t;s>=0;s--)n[s]=(s*e+(t-s)*i)/t;return n}var ti={range_function:OS,getDistParams:c0,linspace:PS,GetFit:Nh};function Rc(i,e){return isNaN(i)||isNaN(e)||e<=0?NaN:i===0?.5:1/2+1/2*(Xd(1/2*e,1/2,1)-Xd(1/2*e,1/2,e/(e+i*i)))*Math.sign(i)}function Xd(i,e,t){if(t==0)return 0;if(t==1)return 1;{let n=Eo(i+e)-Eo(i)-Eo(e)+i*Math.log(t)+e*Math.log(1-t);return t<(i+1)/(i+e+2)?Math.exp(n)*Yd(i,e,t)/i:1-Math.exp(n)*Yd(e,i,1-t)/e}}function Yd(i,e,t,n=1e3){let s=3e-7,r=1,a=1,o=1,l=i+e,c=i+1,h=i-1,d=1-l*t/c;for(let f=0;f<=n;f++){let u=parseFloat(f+1),g=u+u,_=u*(e-u)*t/((h+g)*(i+g)),b=r+_*a,w=d+_*o;_=-(i+u)*(l+u)*t/((c+g)*(i+g));let p=b+_*r,m=w+_*d,v=r;if(a=b/m,o=w/m,r=p/m,d=1,Math.abs(r-v)<s*Math.abs(r))return r}}function f0(i){return i==0||i==1?1:i*f0(i-1)}function u0(i){let e;var t=[75122.633153,80916.6278952,36308.2951477,8687.24529705,1168.92649479,83.8676043424,2.50662827511],n=0,s=1;if(i==0)e=1e99;else if(i%1==0)e=f0(i-1);else{for(let r=0;r<t.length;r++)n=n+t[r]*Math.pow(i,r),s=s*(i+r);e=n*Math.pow(i+5.5,i+.5)*Math.exp(-(i+5.5))/s}return e}function Eo(i){return Math.log(u0(i))}function zS(i,e,t,n){t==0&&(t=1);var s=(i-e)/t*Math.sqrt(n),r=1-Rc(Math.abs(s),n-1);return r}function HS(i,e,t,n,s,r){e==0&&(e=1),s==0&&(s=1);var a=(i-n)/Math.sqrt(e**2/t+s**2/r),o=(e**2/t+s**2/r)**2*(t-1)*(r-1)/(e**4*(r-1)/t**2+s**4*(t-1)/r**2),l=1-Rc(Math.abs(a),parseInt(o+.5));return l}var Ic={TdistributionCDF:Rc,gamma:u0,t_test_1_sample:zS,t_test_2_samples:HS},Fh=class{constructor(e,t){this.wigFeatures=e,this.binSize=t}get_fit(){var e=new ti.GetFit(this.wigFeatures),[t,n]=e.fit_data();return{globalMean:t,globalStd:n}}async call_2d(e=null,t=null,n="both",s=.1,r=0,a=10,o=0){let l=this.get_fit();this.globalMean=l.globalMean,this.globalStd=l.globalStd;let c=e??.05*this.binSize/3e9,h=t??parseInt(this.binSize/1e4),d=[],f=[],u=[],g=[],_=[],b=[];for(let[M,C]of Object.entries(this.wigFeatures)){let L=[],y=[],E=[];C.forEach((U,V)=>{U.hets_count>4&&U.dp_count>h&&(L.push([V]),y.push(U.binScore),E.push(U.likelihood_score),delete U.likelihood_score)});let k=[];for(let U=1;U<y.length;U++)k.push(Math.abs(y[U]-y[U-1]));let A=[0];for(let U=1;U<k.length;U++)A.push(Math.min(k[U-1],k[U]));A.push(0);let I=y.map((U,V)=>Math.sqrt(Math.sqrt(U)**2+this.globalStd**2+Math.pow(A[V]/2,2))),F=[];for(let U=0;U<L.length-1;U++){let V=0;try{V=Xn(E[U],E[U+1])}catch{console.log("Overlap failed: ",U,E[U],L[U+1],E[U+1])}let q=Zn(y[U],I[U],y[U+1],I[U+1]);F.push(q*V)}for(;F.length>0;){F=F.filter(H=>typeof H=="number");let U=Qd(F);if(isNaN(U)&&console.log("NaN value",F),U<c)break;let V=F.indexOf(U),q=Jd(y[V],I[V],y[V+1],I[V+1]),S,P;try{S=E[V].map((H,D)=>H*E[V+1][D]),P=S.reduce((H,D)=>H+D)}catch{console.log(E),console.log("max_overlap:",U,V,F.length),console.log("likelihood: ",V,E[V],E[V+1]),console.log("nlh: ",P)}if(y[V]=q.nl,I[V]=q.ne,E[V]=S.map(function(H){return H/P}),L[V].push(...L[V+1]),y.splice(V+1,1),I.splice(V+1,1),L.splice(V+1,1),E.splice(V+1,1),F.splice(V,1),V<F.length){let D=Zn(y[V],I[V],y[V+1],I[V+1])*Xn(E[V],E[V+1]);F[V]=D}if(V>0){let H=Zn(y[V-1],I[V-1],y[V],I[V])*Xn(E[V-1],E[V]);F[V-1]=H}}let X=-1;for(;;){F=[];for(let S=0;S<y.length;S++)for(let P=S;P<y.length;P++)L[P][0]-L[S].at(-1)<s*(L[S].length+L[P].length)&&F.push(Zn(y[S],I[S],y[P],I[P])*Xn(E[S],E[P]));if(F.length==0)break;let U=Qd(F);if(U<c)break;let V=0,q=1;for(;V<L.length-1;){let S=Zn(y[V],I[V],y[q],I[q])*Xn(E[V],E[q]);if(L[q][0]-L[V].at(-1)<s*(L[V].length+L[q].length)&&S==U){let P=Jd(y[V],I[V],y[V+1],I[V+1]);y[V]=P.nl,I[V]=P.ne;let H=E[V].map((O,W)=>O*E[V+1][W]),D=H.reduce((O,W)=>O+W);E[V]=H.map(function(O){return O/D}),L[V].push(...L[V+1]),L[V]=L[V].sort((O,W)=>O-W),y.splice(q,1),I.splice(q,1),L.splice(q,1),E.splice(q,1),q>=L.length&&(V+=1,q=V+1)}else q+=1,q>=L.length&&(V+=1,q=V+1)}if(X==L.length)break;X=L.length}L.forEach((U,V)=>{let q=US(E[V]);U.length>1&&(U.forEach((S,P)=>{f.push(C[S]),q.mean<=r&&d.push(C[S]),C[S].segment_score=y[V]}),u.push(y[V]),g.push(I[V]),_.push(E[V]))})}let w=parseInt(1e3*(1-o));w==0&&(w=1);let p=ti.linspace(o,1,w),m={},v={};for(let M=10;M>-1;M--)for(let C=0;C<M/2+1;C++){let L=M-C,y=p.map((I,F)=>1-I+I*M/2),E=M/2,k,A;M>0?(k=.5-C/(C+L),A=p.map((I,F)=>.5-(1-I+I*C)/(2-2*I+(C+L)*I))):(k=0,A=p.map((I,F)=>0*I));for(let I=0;I<u.length;I++){let F=Kd(E*this.globalMean,1,u[I],g[I])*ep(_[I],.5+k);I in v?v[I].push([M,C,L,F,1]):v[I]=[M,C,L,F,1];let X=0,U=0,V=0;y.forEach((q,S)=>{if(!isNaN(A[S])){let P=Kd(q*this.globalMean,1,u[I],g[I])*ep(_[I],.5+A[S]);X+=P,P>U&&(U=P,V=p[S])}}),I in m?m[I].push([M,C,L,X/p.length,V]):m[I]=[M,C,L,X/p.length,V]}for(let I=0;I<u.length;I++)if(n=="germline")m[I].sort((F,X)=>F[3]-X[3]);else if(m[I].sort((F,X)=>F[3]-X[3]),n=="both"&&(v[I].sort((F,X)=>F[3]-X[3]),v[I][0][3]>m[I][0][3])){let F=m[I].filter(X=>X[0]!=v[I][0][0]&&X[1]<=v[I][0][1]);m[I]=[v[I][0]].push(...F)}for(let I=0;I<u.length;I++)m[I][0][0]>2,m[I][0][0]<2,u[I]/this.globalMean,Ic.t_test_1_sample(this.globalMean,u[I],g[I],b[I])}var x=this.formatDataStructure(this.wigFeatures,"binScore",this.globalMean),R=this.formatDataStructure(this.wigFeatures,"segment_score",this.globalMean);return{binScore:x,segment_score:R}}formatDataStructure(e,t,n=1){let s=[];for(let[r,a]of Object.entries(e))a.forEach(o=>{var l={...o};n!=1&&(l.value=o[t]/n*2),s.push(l)});return s}formatDataStructure_BAF(e,t=2){let n=[],s=[];for(let[r,a]of Object.entries(this.wigFeatures))a.forEach(o=>{var l={...o},c={...o};let h=o[e];h!=.5&&(c.value=-2*(1-h),s.push(c)),l.value=-2*h,n.push(l)});return[n,s]}};function Qd(i){return i.reduce(function(e,t){return e>t?e:t})}function Kd(i,e,t,n){return e*Math.exp(-1*(i-t)**2/(2*n**2))/Math.sqrt(2*Math.PI)/n}function Zn(i,e,t,n){return Math.exp(-1*(i-t)**2/(e**2+n**2))}function Xn(i,e){let t;try{t=i.reduce((n,s,r)=>n+Math.min(s,e[r]))}catch{return console.log("Failed to find likelihood overlap: ",i,e),0}return t}function Jd(i,e,t,n){return e==0&&n==0?{nl:.5*(i+t),ne:0}:{nl:(i*n*n+t*e*e)/(e*e+n*n),ne:Math.sqrt(e*e*n*n/(e*e+n*n))}}function ep(i,e){let t=parseInt(e*(i.length-1)),n=e*(i.length-1)-t;return t<i.length-1?i[t]*(1-n)+i[t+1]*n:i[t]}function US(i){let e=i.length,t=Math.max(...i),n=i.indexOf(t);n>Math.floor(e/2)&&(n=e-1-n);let s=(e/2-n)/(e+1),r=Math.floor((e/2+n)/2),a=e-1-r,o=i.slice(r,a+1).reduce((l,c)=>l+c,0)/i.reduce((l,c)=>l+c,0);return n===Math.floor(e/2)&&(o=1),{mean:s,p:o}}var $S={CombinedCaller:Fh};function tp(i){for(var e=1,t=1,n=i*1,s=1;s<50;s++)e*=s,t*=-1,n+=t*Math.pow(i,2*s+1)/(e*(2*s+1));return 2*n/Math.sqrt(3.14159265358979)}function Yn(i,e,t,n,s){var r=new Et(t.slice(n,s));r.std==0&&(e>0?r.std=e*r.mean/i:r.std=1);var a=Dh(i,r.mean,r.std,s-n)/(s-n);return a}function VS(i,e,t,n,s){var r=new Et(t.slice(n,s));if(r.mean<i){var a=(r.max-r.mean)/(e*Math.sqrt(2));return Math.pow(.5*(1+tp(a)),s-n)}var a=(r.min-r.mean)/(e*Math.sqrt(2));return Math.pow(.5*(1-tp(a)),s-n)}function ip(i,e,t,n,s,r,a=1e3){for(var o=Yn(i,e,t,n,s),l=0,c=!1;o>r&!c&l<a;){c=!0,l+=1;var[h,d,f,u]=[1e10,1e10,1e10,1e10];if(n>0&&(h=Yn(i,e,t,n-1,s)),s-n>2)var d=Yn(i,e,t,n+1,s),f=Yn(i,e,t,n,s-1);if(s<t.length)var u=Yn(i,e,t,n,s+1);Math.min[u]<o&&(c=!1,h==Math.min[u]&&(n-=1,o=h),elif(d==Math.min[u]),n+=1,o=d,elif(f==Math.min[u]),s-=1,o=f,elif(u==Math.min[u]),s+=1,o=u)}return o<=r?s:0}var Et=class{constructor(e){this.data=e,this.mean=e.reduce((t,n)=>t+n)/e.length,this.std=Math.sqrt(e.reduce((t,n)=>(n-this.mean)**2)/e.length)}};function Dh(i,e,t,n){t==0&&(t=1);var s=(i-e)/t*Math.sqrt(n),r=1-Ic.TdistributionCDF(Math.abs(s),n-1);return r}function ss(i,e,t,n,s,r){e==0&&(e=1),s==0&&(s=1);var a=(i-n)/Math.sqrt(e**2/t+s**2/r),o=(e**2/t+s**2/r)**2*(t-1)*(r-1)/(e**4*(r-1)/t**2+s**4*(t-1)/r**2),l=1-Ic.TdistributionCDF(Math.abs(a),parseInt(o+.5));return l}var Oh=class{constructor(e,t,n){this.rd=e,this.mean=t,this.std=n,this.bin_bands=[2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128]}get_rd_signal_bandwidth(e){var t=[];return e.forEach((n,s)=>{var r=0;n>this.mean/4?r=this.mean/(this.std**2*n):r=4/this.std**2,t.push(r)}),t}meanShiftCaller(e=3){var t={};return Object.entries(this.rd).forEach(([n,s])=>{var r=new Array(s.length).fill(!1),a=new Array(s.length);for(let o=0;o<s.length;o++)r[o]||(a[o]=s[o]);this.bin_bands.forEach((o,l)=>{var c=r.map((D,O)=>!D),h=[];Object.entries(s).forEach(([D,O])=>{h.push(O.binScore)});var d=[0],f=0;for(let D=0;D<r.length;D++)r[D]?f>0&&(d.push(d[d.length-1]+f-1),f=0):f+=1;d.shift();for(let D=0;D<e;D++){var u=this.get_rd_signal_bandwidth(h),g=new Array(h.length).fill(0);for(let W=0;W<h.length;W++)for(let j=W-3*o;j<=W+3*o+1;j++)if(!(j<0||j>=h.length)&&!(Math.abs(W-j)>=h.length)){var _=(j-W)*Math.exp(-.5*(j-W)**2/o**2)*Math.exp(-.5*(h[W]-h[j])**2*u[W]);g[W]+=_}for(var x=new Array,b=0;b<g.length-1;b++)g[b]<0&g[b+1]>=0&&x.push(b);x.push(g.length-1),x=x.concat(d).sort((W,j)=>W-j),x=Array.from(new Set(x));for(var w=0,b=0;b<x.length;b++){var p=h.slice(w,x[b]+1),m=p.reduce((j,G)=>j+G)/p.length;h.fill(m,w,x[b]+1),w=x[b]+1}}for(var b=0,v=0;b<a.length;b++)c[b]&&(a[b]=h[v],v++);for(var x=new Array,b=0;b<a.length-1;b++){var R=Math.abs(a[b+1]-a[b]);R>.01&&x.push(b+1)}x.unshift(0),x.push(a.length),r=new Array(this.rd.length).fill(!1);for(var b=1;b<x.length;b++){var M=[x[b-1],x[b]],C=[x[b-1],x[b-1]];if(b>1)C[0]=x[b-2];else continue;var L=[x[b],x[b]];if(b<x.length-1)L[1]=x[b+1];else continue;var y=M[1]-M[0],E=C[1]-C[0],k=L[1]-L[0];if(y<=1)continue;var A=new Et(a.slice(M[0],M[1]));if(k<=15||E<=15||y<=15){var I=1.8*Math.sqrt(a[C[0]]/this.mean)*this.std;if(Math.abs(a[C[0]]-a[M[0]])<I||(I=1.8*Math.sqrt(a[L[0]]/this.mean)*this.std,Math.abs(a[L[0]]-a[M[0]])<I))continue}else{var F=a.slice(C[0],C[1]),X=new Et(F),U=a.slice(L[0],L[1]),V=new Et(U),q=ss(A.mean,A.std,A.data.length,X.mean,X.std,X.data.length);if(q>.01/genome_size*bin_size*(y+E))continue;var S=ss(A.mean,A.std,A.data.length,V.mean,V.std,V.data.length);if(S>.01/genome_size*bin_size*(y+k))continue}var P=Dh(this.mean,A.mean,A.std,A.data.length);if(P>.05)continue;let O=h.slice(M[0],M[1]);var H=new Et(O);r.fill(!0,M[0],M[1]),a.fill(H.mean,M[0],M[1])}}),t[n]=a}),t}call_mean_shift(e=3){for(var s=new Array(this.rd.length).fill(!1),r=new Array(this.rd.length),a=0;a<this.rd.length;a++)s[a]||(r[a]=this.rd[a]);return this.bin_bands.forEach((o,l)=>{var c=s.map((O,W)=>!O),h=[];c.forEach((O,W)=>{O&&h.push(this.rd[W])});for(var d=[0],f=0,u=0;u<s.length;u++)s[u]?f>0&&(d.push(d[d.length-1]+f-1),f=0):f+=1;d.shift();for(var g=0;g<e;g++){for(var _=this.get_rd_signal_bandwidth(h),b=new Array(h.length).fill(0),u=0;u<h.length;u++)for(var w=u-3*o;w<=u+3*o+1;w++)if(!(w<0||w>=h.length)&&!(Math.abs(u-w)>=h.length)){var p=(w-u)*Math.exp(-.5*(w-u)**2/o**2)*Math.exp(-.5*(h[u]-h[w])**2*_[u]);b[u]+=p}for(var R=new Array,u=0;u<b.length-1;u++)b[u]<0&b[u+1]>=0&&R.push(u);R.push(b.length-1),R=R.concat(d).sort((W,j)=>W-j),R=Array.from(new Set(R));for(var m=0,u=0;u<R.length;u++){var v=h.slice(m,R[u]+1),x=v.reduce((j,G)=>j+G)/v.length;h.fill(x,m,R[u]+1),m=R[u]+1}}for(var u=0,w=0;u<r.length;u++)c[u]&&(r[u]=h[w],w++);for(var R=new Array,u=0;u<r.length-1;u++){var M=Math.abs(r[u+1]-r[u]);M>.01&&R.push(u+1)}R.unshift(0),R.push(r.length),s=new Array(this.rd.length).fill(!1);for(var u=1;u<R.length;u++){var C=[R[u-1],R[u]],L=[R[u-1],R[u-1]];if(u>1)L[0]=R[u-2];else continue;var y=[R[u],R[u]];if(u<R.length-1)y[1]=R[u+1];else continue;var E=C[1]-C[0],k=L[1]-L[0],A=y[1]-y[0];if(!(E<=1)){var I=new Et(r.slice(C[0],C[1]));if(A<=15||k<=15||E<=15){var F=1.8*Math.sqrt(r[L[0]]/this.mean)*this.std;if(Math.abs(r[L[0]]-r[C[0]])<F||(F=1.8*Math.sqrt(r[y[0]]/this.mean)*this.std,Math.abs(r[y[0]]-r[C[0]])<F))continue}else{var X=r.slice(L[0],L[1]),U=new Et(X),V=r.slice(y[0],y[1]),q=new Et(V),S=ss(I.mean,I.std,I.data.length,U.mean,U.std,U.data.length);if(S>.01/2871e6*1e3*(E+k))continue;var P=ss(I.mean,I.std,I.data.length,q.mean,q.std,q.data.length);if(P>.01/2871e6*1e3*(E+A))continue}var H=Dh(this.mean,I.mean,I.std,I.data.length);if(!(H>.05)){var D=new Et(this.rd.slice(C[0],C[1]));s.fill(!0,C[0],C[1]),r.fill(D.mean,C[0],C[1])}}}}),r}cnv_calling(e=1e5){var t=.25,t=t*this.mean,n=this.mean-t,s=this.mean+t,r=2971e6,a=this.meanShiftCaller(),o={},l=[];return Object.entries(a).forEach(([c,h])=>{for(var d=!1;!d;){d=!0;var f=new Array(1).fill(0);for(let I=0;I<h.length-1;I++){var u=Math.abs(h[I+1]-h[I]);u>.01&&f.push(I+1)}f.push(h.length);for(let I=0;I<f.length-2;I++){var g=Math.abs(h[f[I]]-h[f[I+1]]);if(g<t){var _=g+1,b=g+1;if(I>0&&(_=Math.abs(h[f[I]]-h[f[I-1]])),I<f.length-3&&(b=Math.abs(a[f[I+1]]-h[f[I+2]])),g<_&&g<b){d=!1;var w=new Et(h.slice(f[I],f[I+2]));h.fill(w.mean,f[I],f[I+2]),f.splice(I+1,I+1)}}}}var p=[];Object.entries(this.rd[c]).forEach(([I,F])=>{p.push(F.binScore)});for(var m=new Array(h.length).fill(""),v=0,x=.05*e/r;v<h.length;){for(var R=v,M=v;v<h.length&h[v]<n;)v+=1;var C=v;if(C>M+1){var L=ip(this.mean,this.std,p,M,C,x);if(L){var M,C=L;m.fill("D",M,C)}}for(M=v;v<h.length&h[v]>s;)v+=1;C=v,C>M+1&&(L=ip(this.mean,this.std,p,M,C,x),L&&(C=L,m.fill("A",M,C))),v==R&&(v+=1)}for(v=0;v<h.length;){for(;v<h.length&m[v]!="";)v+=1;for(M=v;v<h.length&h[v]<n;)v+=1;C=v,C>M+1&&(VS(this.mean,this.std,p,M,C)<.05/r&&m.fill(["d"]*(C-M),M,C),v-=1),v+=1}v=0;var y;v<h.length&&(y=m[v]),M=0;for(var E=[...p];v<h.length;){for(;m[v]==y&&(v+=1,!(v>=m.length)););if(v>M){var k=new Et(E.slice(M,v));E.fill(k.mean,M,v)}v<h.length&&(y=m[v]),M=v}for(o[c]=E,v=0;v<h.length;){if(y=m[v],y==""){v+=1;continue}for(M=v;v<h.length&y==m[v];)v+=1;var A=new Et(E.slice(M,v));let I=A.mean/this.mean,F;y=="D"?F="deletion":F="duplication";let X={chr:c,start:e*M+1,end:e*v,size:e*(v-M+1),value:I*2,event_type:F};l.push(X)}}),[o,l]}},qS={Partition:Oh},Bh=class{constructor(e,t){this.allVariants=e,this.rowBinSize=1e4,this.binSize=t,this.binFactor=t/this.rowBinSize}async computeDepthFeatures(){let e=Object.keys(this.allVariants),t=[];for(let n of e){let s=this.allVariants[n];if(s.length===0)continue;let r=s[0],a=0,o=0,l=r.start=r.start%this.binSize,c=l+this.binSize,h=0;for(let d of s){let f=d.start+1;h=Math.max(Math.floor((d.start-1)/this.binSize),0),f>c&&(o>0&&t.push({chr:n,start:l,end:c,value:a,bin:h,count:o}),a=0,l=d.start-d.start%this.binSize,c=l+this.binSize);let u=d.calls[9].info.DP;u&&(a+=Number.parseInt(u),o++)}o>0&&t.push({chr:n,start:l,end:c,value:a,bin:h,count:o})}return t}async computeReadDepth(){let e=Object.keys(this.allVariants);var t={};for(let l of e){let c=this.allVariants[l];var n;if(c.length!==0)for(let h of c){n=Math.max(Math.floor(h.start/this.rowBinSize),0),t[l]||(t[l]=[]),t[l][n]||(t[l][n]={chr:l,start:n*this.rowBinSize,end:(n+1)*this.rowBinSize,value:0,sum_score:0,count:0});let d=h.calls[9].info.DP;d&&(t[l][n].sum_score+=Number.parseInt(d),t[l][n].count++)}}var s={};for(let l of e){s[l]||(s[l]=[]);for(let c=0;c<t[l].length/this.binFactor;c++){let h=c;s[l][c]||(s[l][c]={chr:l,binScore:0,start:h*this.binSize,end:(h+1)*this.binSize});for(var r=c*10;r<10*c+10;r++)if(t[l][r]){var a=parseInt(t[l][r].sum_score/t[l][r].count)*100;s[l][c].binScore+=a}}}var o=this.readDepthMeanshift(s);return o}readDepthMeanshift(e){var t=new ti.GetFit(e),[n,s]=t.fit_data(),r=new qS.Partition(e,n,s),a=r.meanShiftCaller(),o=r.cnv_calling();Object.entries(e).forEach(([d,f])=>{f.forEach((u,g)=>{u.partition_level=parseInt(a[d][g]),u.partition_call=parseInt(o[0][d][g])})});var l=this.formatDataStructure(e,"binScore",n),c=this.formatDataStructure(e,"partition_level",n),h=this.formatDataStructure(e,"partition_call",n);return[l,c,h,o[1]]}formatDataStructure(e,t,n=1){let s=[];for(let[r,a]of Object.entries(e))a.forEach(o=>{var l={...o};n!=1&&(l.value=o[t]/n*2),s.push(l)});return s}async computeBAF_v2(){let e=Object.keys(this.allVariants),t={},n=[],s=[];for(let o of e){let l=this.allVariants[o];if(l.length===0)continue;var r;for(let h of l){if(r=Math.max(Math.floor(h.start/this.binSize),0),t[o]||(t[o]=[]),!t[o][r]){if(r>0){let b=r-1;if(t[o][b]){let w=this.get_max_min_score(t[o][b]);if(w.value!=.5){let p=Object.assign({},w);p.value=-2*(1-w.value),s.push(p)}w.value=-2*w.value,t[o][b]=w,n.push(t[o][b])}}t[o][r]={chr:o,start:r*this.binSize,end:(r+1)*this.binSize,value:0,count:0,likelihood_score:[],min_score:0}}let d=h.calls[9],f=d.genotype,u=d.info.AD.split(","),g=u[0],_=u[1];if(f[0]==0&&f[1]==1||f[0]==1&&f[1]==0){if(t[o][r].likelihood_score.length==0)t[o][r].likelihood_score=ti.linspace(0,1,100).map((b,w)=>as(g,_,b));else{var a=0;t[o][r].likelihood_score=ti.linspace(0,1,100).map((b,w)=>{var p=t[o][r].likelihood_score[w]*as(g,_,b);return a=a+p,p}),t[o][r].likelihood_score=ti.linspace(0,1,100).map((b,w)=>t[o][r].likelihood_score[w]/a)}t[o][r].count++}}let c=this.get_max_min_score(t[o][r]);if(c.value!=.5){let h=Object.assign({},c);h.value=-2*(1-c.value),s.push(h)}c.value=-2*c.value,t[o][r]=c,n.push(t[o][r])}return[n,s]}format_BAF_likelihood(e){let t=[];for(let[n,s]of Object.entries(e))s.forEach(r=>{var a={...r};r.value!=.5&&(a.value=1-r.value,t.push(a))});return t}get_max_min_score(e){if(e.likelihood_score.length>0){let t=Math.max(...e.likelihood_score),n=e.likelihood_score.indexOf(t);e.value=Math.max(n/100,1-n/100),e.min_score=Math.min(n/100,1-n/100)}else e.score=0;return e}async getAllbins(){let e=await this.computeDepthFeatures();return new ti.GetFit(e).fit_data(),e}async read_rd_baf(e="ReadDepth"){let t=Object.keys(this.allVariants);var n={};for(let l of t){let c=this.allVariants[l];var s;if(c.length!==0)for(let h of c){s=Math.max(Math.floor(h.start/this.rowBinSize),0),n[l]||(n[l]=[]),n[l][s]||(n[l][s]={chr:l,start:s*this.rowBinSize,end:(s+1)*this.rowBinSize,dp_sum_score:0,dp_count:0,hets_count:0,hets:[]});let d=h.calls[9],f=d.info.DP;f&&(n[l][s].dp_sum_score+=Number.parseInt(f),n[l][s].dp_count++);let u=d.info.AD.split(","),g=d.genotype;if(g[0]==0&&g[1]==1||g[0]==1&&g[1]==0){n[l][s].hets_count++;let _=parseInt(u[0]),b=parseInt(u[1]);n[l][s].hets.push({ref:_,alt:b})}}}var r=this.adjust_bin_size(n),a;if(e=="ReadDepth"){a=this.readDepthMeanshift(r);var o=this.formatDataStructure_BAF(r,"max_likelihood")}else if(e=="2D"){let l=new $S.CombinedCaller(r,this.binSize),c=await l.call_2d();a=[c.binScore,[],c.segment_score];var o=l.formatDataStructure_BAF("max_likelihood")}return[a,o]}formatDataStructure_BAF(e,t,n=2){let s=[],r=[];for(let[a,o]of Object.entries(e))o.forEach(l=>{delete l.likelihood_score;var c={...l},h={...l};let d=l[t];d!=.5&&(h.value=-2*(1-d),r.push(h)),c.value=-2*d,s.push(c)});return[s,r]}adjust_bin_size(e){let t=Object.keys(this.allVariants);var n={};for(let a of t){n[a]||(n[a]=[]);for(let o=0;o<e[a].length/this.binFactor;o++){let l=o;n[a][o]||(n[a][o]={chr:a,start:l*this.binSize,end:(l+1)*this.binSize,dp_count:0,hets_count:0,binScore:0,likelihood_score:[]});for(var s=o*10;s<10*o+10;s++)if(e[a][s]){var r=parseInt(e[a][s].dp_sum_score/e[a][s].dp_count)*100;n[a][o].binScore+=r,n[a][o].dp_count+=e[a][s].dp_count,n[a][o].hets_count+=e[a][s].hets_count,e[a][s].hets.length!=0&&e[a][s].hets.forEach((h,d)=>{if(n[a][o].likelihood_score.length==0)n[a][o].likelihood_score=ti.linspace(0,1,100).map((u,g)=>as(h.ref,h.alt,u));else{var f=0;n[a][o].likelihood_score=ti.linspace(0,1,100).map((u,g)=>{var _=n[a][o].likelihood_score[g]*as(h.ref,h.alt,u);return f+=_,_}),n[a][o].likelihood_score=ti.linspace(0,1,100).map((u,g)=>n[a][o].likelihood_score[g]/f)}})}let c=this.get_max_min_score(n[a][o]);n[a][o].max_likelihood=c.value}}return n}};function as(i,e,t,n=!0){return t**i*(1-t)**e+t**e*(1-t)**i}var WS=250,Ph=class extends kt{constructor(e,t){super(e,t),this.featureType="numeric",this.paintAxis=Bn,e.max||(this.defaultScale=!0,this.autoscale=!1),this.height=e.height!==void 0?e.height:WS}async init(e){this.type="cnvpytor",this.graphType=e.graphType||"points",this.bin_size=e.bin_size||1e5,this.signal_name=e.signal_name||"rd_snp",this.cnv_caller=e.cnv_caller||"2D",this.colors=e.colors||["gray","black","green","blue"],super.init(e)}get supportsWholeGenome(){return!0}get_signals(){let e=[];return this.signal_name=="rd_snp"?e=["RD_Raw","RD_Raw_gc_coor",this.cnv_caller,"BAF1","BAF2"]:this.signal_name=="rd"?e=["RD_Raw","RD_Raw_gc_coor",this.cnv_caller]:this.signal_name=="snp"?e=["BAF1","BAF2"]:this.signal_name=="cnh"&&(e=[this.cnv_caller]),e}get_signal_colors(){return[{singal_name:"RD_Raw",color:this.colors[0]},{singal_name:"RD_Raw_gc_coor",color:this.colors[1]},{singal_name:"ReadDepth",color:this.colors[2]},{singal_name:"2D",color:this.colors[2]},{singal_name:"BAF1",color:this.colors[3]},{singal_name:"BAF2",color:this.colors[3]}]}async postInit(){if(this.config.format=="vcf"){this.featureSource=Bt(this.config,this.browser.genome),this.header=await this.getHeader();var e=this.featureSource.reader.features.reduce(function(o,l){return o[l.chr]=o[l.chr]||[],o[l.chr].push(l),o},Object.create(null));let n=new Bh(e,this.bin_size),s,r;this.wigFeatures_obj={},this.wigFeatures_obj[this.bin_size]={};let a;this.config.cnv_caller=="2D"?(a=await n.read_rd_baf("2D"),s=a[0],r=a[1],this.wigFeatures_obj[this.bin_size]["2D"]=s[2],this.available_callers=["2D"]):(a=await n.read_rd_baf(),s=a[0],r=a[1],this.wigFeatures_obj[this.bin_size].ReadDepth=s[2],this.available_callers=["ReadDepth"]),this.wigFeatures_obj[this.bin_size].RD_Raw=s[0],this.wigFeatures_obj[this.bin_size].RD_Raw_gc_coor=s[1],this.wigFeatures_obj[this.bin_size].BAF1=r[0],this.wigFeatures_obj[this.bin_size].BAF2=r[1],this.available_bins=[this.bin_size],this.set_available_callers()}else this.cnvpytor_obj=new Ih(this.config.url,this.bin_size),this.wigFeatures_obj=await this.cnvpytor_obj.get_rd_signal(this.bin_size),this.available_bins=this.cnvpytor_obj.available_bins,this.available_callers=this.cnvpytor_obj.callers,this.set_available_callers();this.tracks=[];let t=[];this.signals=this.get_signals(),this.signal_colors=this.get_signal_colors();for(let n in this.wigFeatures_obj)for(let[s,r]of Object.entries(this.wigFeatures_obj[n]))if(this.signals.includes(s)){let a={};a.type="wig",a.isMergedTrack=!0,a.features=r,a.name=s,a.color=this.signal_colors.filter(l=>l.singal_name===s).map(l=>l.color);let o=await this.browser.createTrack(a);o?(o.autoscale=!1,this.tracks.push(o)):console.warn("Could not create track "+a),typeof o.postInit=="function"&&t.push(o.postInit())}this.flipAxis=this.config.flipAxis?this.config.flipAxis:!1,this.logScale=this.config.logScale?this.config.logScale:!1,this.autoscale=this.config.autoscale,this.autoscale||(this.dataRange={min:this.config.min||0,max:this.config.max});for(let n of this.tracks)n.autoscale=!1,n.dataRange=this.dataRange;return Promise.all(t)}set_available_callers(){this.available_callers.includes(this.cnv_caller)||(this.available_callers.length>0?this.cnv_caller=this.available_callers[0]:this.cnv_caller=null)}async getHeader(){if(!this.header){if(typeof this.featureSource.getHeader=="function"){let e=await this.featureSource.getHeader();e&&(this.callSets=e.callSets||[]),this.header=e}this.sampleNames=this.callSets?this.callSets.map(e=>e.name):[]}return this.header}get height(){return this._height}set height(e){if(this._height=e,this.tracks)for(let t of this.tracks)t.height=e,t.config.height=e}menuItemList(){let e=[];this.flipAxis!==void 0&&e.push({label:"Flip y-axis",click:()=>{this.flipAxis=!this.flipAxis,this.trackView.repaintViews()}}),e=e.concat(Xt.numericDataMenuItems(this.trackView)),e.push("<hr/>"),e.push("Bin Sizes");for(let n of this.available_bins){let s=ot(n,n===this.bin_size);e.push({object:pe(s),click:async()=>{this.bin_size=n,await this.recreate_tracks(n),this.clearCachedFeatures(),this.trackView.updateViews(),this.trackView.repaintViews()}})}e.push("<hr/>"),e.push("Signal Type");let t={rd_snp:"RD and BAF Likelihood",rd:"RD Signal",snp:"BAF Likelihood"};for(let n in t){let s=ot(t[n],n===this.signal_name);e.push({object:pe(s),click:async()=>{this.signal_name=n,await this.recreate_tracks(this.bin_size),this.clearCachedFeatures(),this.trackView.updateViews(),this.trackView.repaintViews()}})}e.push("<hr/>"),e.push("CNV caller");for(let n of this.available_callers){let s=ot(n,n===this.cnv_caller);e.push({object:pe(s),click:async()=>{this.cnv_caller=n,await this.recreate_tracks(this.bin_size),this.clearCachedFeatures(),this.trackView.updateViews(),this.trackView.repaintViews()}})}return e}async recreate_tracks(e){this.tracks=[];let t=[];e in this.wigFeatures_obj||(this.wigFeatures_obj={...this.wigFeatures_obj,...await this.cnvpytor_obj.get_rd_signal(e)}),this.signals=this.get_signals(),this.signal_colors=this.get_signal_colors();for(let[n,s]of Object.entries(this.wigFeatures_obj[e]))if(this.signals.includes(n)){let r={};r.type="wig",r.isMergedTrack=!0,r.features=s,r.name=n,r.color=this.signal_colors.filter(o=>o.singal_name===n).map(o=>o.color);let a=await this.browser.createTrack(r);a?(a.autoscale=!1,this.tracks.push(a)):console.warn("Could not create track "+r),typeof a.postInit=="function"&&t.push(a.postInit())}this.flipAxis=this.config.flipAxis?this.config.flipAxis:!1,this.logScale=this.config.logScale?this.config.logScale:!1,this.autoscale=this.config.autoscale,this.autoscale||(this.dataRange={min:this.config.min||0,max:this.config.max});for(let n of this.tracks)n.autoscale=!1,n.dataRange=this.dataRange;return Promise.all(t)}async getFeatures(e,t,n,s){if(this.tracks){let r=this.tracks.map(a=>a.getFeatures(e,t,n,s));return Promise.all(r)}else return}getScaleFactor(e,t,n,s){return s?n/(Math.log10(t+1)-(e<=0?0:Math.log10(e+1))):n/(t-e)}computeYPixelValue(e,t){return(this.flipAxis?e-this.dataRange.min:this.dataRange.max-e)*t}computeYPixelValueInLogScale(e,t){let n=this.dataRange.max,s=this.dataRange.min;return n<=0?0:(s<=-1&&(s=0),s=s<=0?0:Math.log10(s+1),n=Math.log10(n+1),e=Math.log10(e+1),(this.flipAxis?e-s:n-e)*t)}draw(e){let t=e.features;if(!t)return;if(this.defaultScale&&(this.signal_name=="rd_snp"?this.dataRange={min:this.config.min||this.dataRange.min||-2,max:this.config.max||this.dataRange.max||6}:this.signal_name=="rd"?this.dataRange={min:this.config.min||this.dataRange.min||0,max:this.config.max||this.dataRange.max||6}:this.signal_name=="snp"&&(this.dataRange={min:this.config.min||this.dataRange.min||-2,max:this.config.max||this.dataRange.max||0})),this.autoscale&&(this.dataRange=jS(e.referenceFrame.chr,t)),this.tracks)for(let r=0,a=this.tracks.length;r<a;r++){let o=Object.assign({},e);o.features=t[r],this.tracks[r].dataRange=this.dataRange,this.tracks[r].flipAxis=this.flipAxis,this.tracks[r].logScale=this.logScale,this.graphType&&(this.tracks[r].graphType=this.graphType),this.tracks[r].draw(o)}let n=this.getScaleFactor(this.dataRange.min,this.dataRange.max,e.pixelHeight,this.logScale),s=r=>this.logScale?this.computeYPixelValueInLogScale(r,n):this.computeYPixelValue(r,n);if(this.config.hasOwnProperty("guideLines")){for(let r of this.config.guideLines)if(r.hasOwnProperty("color")&&r.hasOwnProperty("y")&&r.hasOwnProperty("dotted")){let a=s(r.y),o={strokeStyle:r.color,strokeWidth:1};r.dotted?he.dashedLine(e.context,0,a,e.pixelWidth,a,5,o):he.strokeLine(e.context,0,a,e.pixelWidth,a,o)}}}popupData(e,t){let n=t||e.viewport.cachedFeatures;if(n&&n.length===this.tracks.length){let s=[];for(let r=0;r<this.tracks.length;r++){r>0&&s.push("<hr/>"),s.push(`<div style=background-color:rgb(245,245,245);border-bottom-style:dashed;border-bottom-width:1px;padding-bottom:5px;padding-top:10px;font-weight:bold;font-size:larger >${this.tracks[r].name}</div>`);let a=this.tracks[r].popupData(e,n[r]);s.push(...a)}return s}}};function jS(i,e){let t=0,n=-Number.MAX_VALUE;for(let s of e)for(let r of s)typeof r.value<"u"&&!Number.isNaN(r.value)&&(t=Math.min(t,r.value),n=Math.max(n,r.value));return{min:t,max:n}}var Mr=new Map([["ideogram",(i,e)=>new sa(i,e)],["sequence",(i,e)=>new Fs(i,e)],["feature",(i,e)=>new ia(i,e)],["seg",(i,e)=>new cr(i,e)],["mut",(i,e)=>new cr(i,e)],["maf",(i,e)=>new cr(i,e)],["wig",(i,e)=>new uh(i,e)],["merged",(i,e)=>new gh(i,e)],["alignment",(i,e)=>new sh(i,e)],["interaction",(i,e)=>new ra(i,e)],["interact",(i,e)=>new ra(i,e)],["variant",(i,e)=>new bh(i,e)],["eqtl",(i,e)=>new wh(i,e)],["gwas",(i,e)=>new vh(i,e)],["arc",(i,e)=>new yh(i,e)],["gcnv",(i,e)=>new _h(i,e)],["junction",(i,e)=>new kh(i,e)],["blat",(i,e)=>new rh(i,e)],["cnvpytor",(i,e)=>new Ph(i,e)]]),np=function(i,e){Mr.set(i,e)},GS=function(i,e,t){let n;switch(i){case"annotation":case"genes":case"fusionjuncspan":case"snp":n="feature";break;case"seg":case"maf":case"mut":n="seg";break;case"junctions":case"splicejunctions":n="junction";break;default:n=i}return Mr.has(n)?Mr.get(n)(e,t):void 0},rp={tracks:Mr,addTrack:np,trackFunctions:Mr,addTrackCreatorFunction:np,getTrack:GS},zh=class{constructor(e,t){let s=new DOMParser().parseFromString(e,"text/xml");this.processRootNode(s,t);let r=s.getElementsByTagName("Resource"),a=s.getElementsByTagName("Track"),o=a&&a.length>0,l=[];this.tracks=l;let c=new Map;Array.from(r).forEach(function(h,d){var f={url:h.getAttribute("path"),indexURL:h.getAttribute("index"),order:d};c.set(f.url,f),o||l.push(f)}),o&&Array.from(a).forEach(function(h){let d=h.getElementsByTagName("Track");if(d&&d.length>0){let f={type:"merged",tracks:[]};Ao(h,f),l.push(f),Array.from(d).forEach(function(u){u.processed=!0;let g=u.getAttribute("id"),_=c.get(g);_&&(f.tracks.push(_),Ao(u,_),_.autoscale=!1,f.height=_.height)})}else if(!h.processed){let f=h.getAttribute("id"),u=c.get(f);u&&(l.push(u),Ao(h,u))}})}processRootNode(e,t){let n=e.getElementsByTagName("Session");!n||n.length;let s=n.item(0),r=s.getAttribute("genome"),a=s.getAttribute("locus"),o=s.getAttribute("ucscID");t&&t.hasOwnProperty(r)?this.genome=r:(this.reference={fastaURL:r},o&&(this.reference.id=o)),a&&(this.locus=a)}};function Ao(i,e){e.name=i.getAttribute("name");let t=i.getAttribute("color");t&&(e.color="rgb("+t+")");let n=i.getAttribute("altColor");t&&(e.altColor="rgb("+n+")");let s=i.getAttribute("height");s&&(e.height=parseInt(s));let r=i.getAttribute("autoScale");r&&(e.autoscale=r==="true");let a=i.getAttribute("autoscaleGroup");a&&(e.autoscaleGroup=a);let o=i.getAttribute("windowFunction");o&&(e.windowFunction=o);let l=i.getAttribute("visibilityWindow")||i.getAttribute("featureVisibilityWindow");l&&(e.visibilityWindow=l);let c=i.getAttribute("indexed");c&&(e.indexed=c==="true");let h=i.getAttribute("normalize");h&&(e.normalize=h==="true");let d=i.getElementsByTagName("DataRange");if(d.length>0){let f=d.item(0);e.min=Number(f.getAttribute("minimum")),e.max=Number(f.getAttribute("maximum")),e.logScale=f.getAttribute("type")==="LOG"}}var ZS=Ji,Hh=class{constructor(){this.attributes={},this.plinkLoaded=!1}async loadPlinkFile(e,t){t||(t={});var n=Oe(t);let s=await Ce.loadString(e,n);var r=ZS(s);for(let o of r){var a=o.split(" ");this.attributes[a[1]]={familyId:a[0],fatherId:a[2],motherId:a[3],sex:a[4],phenotype:a[5]}}return this.plinkLoaded=!0,this}getAttributes(e){return this.attributes[e]}getAttributeNames(){return this.hasAttributes()?Object.keys(this.attributes[Object.keys(this.attributes)[0]]):[]}hasAttributes(){return Object.keys(this.attributes).length>0}};function XS(i,e){return new Hh().loadPlinkFile(i,e)}var ha=class{constructor(e,t){this.geneColors={},this.gene=null,this.snp=null,this.genesCount=0,e&&(this.gene=e.toUpperCase(),this.geneColors[this.gene]=Ge[this.genesCount++]),t&&(this.snp=t.toUpperCase())}addGene(e){this.geneColors[e.toUpperCase()]||(this.geneColors[e.toUpperCase()]=Ge[this.genesCount++])}colorForGene(e){return this.geneColors[e.toUpperCase()]}},Ge=[];Ge.push("rgb(228,26,28)");Ge.push("rgb(55,126,184)");Ge.push("rgb(77,175,74)");Ge.push("rgb(166,86,40)");Ge.push("rgb(152,78,163)");Ge.push("rgb(255,127,0)");Ge.push("rgb(247,129,191)");Ge.push("rgb(153,153,153)");Ge.push("rgb(255,255,51)");Ge.push("rgb(102, 194, 165");Ge.push("rgb(252, 141, 98");Ge.push("rgb(141, 160, 203");Ge.push("rgb(231, 138, 195");Ge.push("rgb(166, 216, 84");Ge.push("rgb(255, 217, 47");Ge.push("rgb(229, 196, 148");Ge.push("rgb(179, 179, 179");Ge.push("rgb( 141, 211, 199");Ge.push("rgb(255, 255, 179");Ge.push("rgb(190, 186, 218");Ge.push("rgb(251, 128, 114");Ge.push("rgb(128, 177, 211");Ge.push("rgb(253, 180, 98");Ge.push("rgb(179, 222, 105");Ge.push("rgb(252, 205, 229");Ge.push("rgb(217, 217, 217");Ge.push("rgb(188, 128, 189");Ge.push("rgb(204, 235, 197");Ge.push("rgb(255, 237, 111");var ca=class{constructor(e,t,n,s,r){this.genome=e,this.chr=t,this.start=n,this.end=s,this.bpPerPixel=r,this.id=de.guid()}extend(e){let t=Math.min(e.start,this.start),n=Math.max(e.end,this.end),s=(n-t)/(this.end-this.start);this.start=t,this.end=n,this.bpPerPixel*=s}calculateEnd(e){return this.start+this.bpPerPixel*e}calculateBPP(e,t){return(e-this.start)/t}set(e){this.chr=e.chr,this.start=e.start,this.bpPerPixel=e.bpPerPixel}toPixels(e){return e/this.bpPerPixel}toBP(e){return this.bpPerPixel*e}shiftPixels(e,t,n){let s=this.start,r=e*this.bpPerPixel;return this.start+=r,n&&this.clampStart(t),this.end=this.start+t*this.bpPerPixel,s!==this.start}clampStart(e){let t=this.genome.getChromosome(this.chr).bpStart||0;if(this.start=Math.max(t,this.start),e){let{bpLength:n}=this.genome.getChromosome(this.chr),s=n-e*this.bpPerPixel;this.start>s&&(this.start=s)}}async zoomWithScaleFactor(e,t,n,s){let r=s===void 0?this.start+this.toBP(n/2):s,{start:a,bpPerPixel:o}=this.start,{bpLength:l}=this.getChromosome(),c=t<1?e.minimumBases()/n:l/n;t<1?this.bpPerPixel=Math.max(this.bpPerPixel*t,c):this.bpPerPixel=Math.min(this.bpPerPixel*t,c);let h=this.bpPerPixel*n;this.start=r-.5*h,this.clampStart(n),this.end=this.start+h,(a!==this.start||o!==this.bpPerPixel)&&await e.updateViews(!0)}getChromosome(){return this.genome.getChromosome(this.chr)}getMultiLocusLabelBPLengthOnly(e){let t="&nbsp",n=Math.floor(this.start)+1,s=Math.round(this.start+this.bpPerPixel*e);return`${t}${this.chr}${t}${nl(s-n)}${t}`}getMultiLocusLabelLocusOnly(e){let t="&nbsp",{chr:n,start:s,end:r}=this.getPresentationLocusComponents(e);return`${t}${n}:${s}-${r}${t}`}getMultiLocusLabel(e){let t="&nbsp",{chr:n,start:s,end:r}=this.getPresentationLocusComponents(e),a=Math.floor(this.start)+1,o=Math.round(this.start+this.bpPerPixel*e);return`${t}${n}:${s}-${r}${t}${t}(${nl(o-a)})${t}`}getPresentationLocusComponents(e){if(this.chr==="all")return{chr:this.chr};{let t=De(Math.floor(this.start)+1),n=De(Math.round(this.start+this.bpPerPixel*e));return{chr:this.chr,start:t,end:n}}}getLocusString(){if(this.chr==="all")return"all";{let e=De(Math.floor(this.start)+1),t=De(Math.round(this.end));return`${this.chr}:${e}-${t}`}}description(e){console.log(` ${e||""} referenceFrame - ${this.chr} bpp ${this.bpPerPixel.toFixed(3)} start ${De(Math.round(this.start))} end ${De(Math.round(this.end))} `)}};function YS(i,e,t,n,s,r){return i.map(a=>{if(t&&a.gene&&(a.start=Math.max(0,a.start-t),a.end+=t),!r){let l=e.getChromosome(a.chr);Bg(l.bpLength,a,n)}let o=new ca(e,a.chr,a.start,a.end,(a.end-a.start)/s);return o.locusSearchString=a.locusSearchString,(a.gene||a.snp)&&(o.selection=new ha(a.gene,a.snp)),o})}var QS={timeout:5e3,type:"plain",url:"https://igv.org/genomes/locus.php?genome=$GENOME$&name=$FEATURE$",coords:0,chromosomeField:"chromosome",startField:"start",endField:"end",geneField:"gene",snpField:"snp"};async function KS(i,e){if(e===void 0||e.trim()==="")return;(e&&e.trim().toLowerCase()==="all"||e==="*")&&(e="all");let t=e.split(" "),n=i.searchConfig||QS,s=[],r=async a=>{let o=JS(i,a);if(!o){let l=i.genome.featureDB.get(a.toUpperCase());l&&(o={chr:l.chr,start:l.start,end:l.end,gene:l.name,locusSearchString:e})}if(!o&&i.config&&i.config.search!==!1)try{o=await eC(i,a,n)}catch(l){throw console.error(l),Error("Search service currently unavailable.")}return o};for(let a of t){let o=await r(a);o&&(o.locusSearchString=a,s.push(o))}if(s.length===0){let a=await r(e);a&&(a.locusSearchString=e,s.push(a))}return s.length===0?void 0:s}function JS(i,e){let t=e.split("	");if(t.length>=3)try{let r=i.genome.getChromosomeName(t[0]),a=parseInt(t[1].replace(/,/g,""),10)-1,o=parseInt(t[2].replace(/,/g,""),10);if(!isNaN(a)&&!isNaN(o))return{chr:r,start:a,end:o}}catch{}let n=e.split(":"),s=n[0];if(s==="all"&&i.genome.getChromosome(s))return{chr:s,start:0,end:i.genome.getChromosome(s).bpLength};if(i.genome.getChromosome(s)===void 0)return;{let a={chr:i.genome.getChromosomeName(s),start:0,end:i.genome.getChromosome(s).bpLength};if(n.length>1){let o=n[1].split("-");if(o.length>2)if(n[1].startsWith("-")){let c=n[1].indexOf("-",1);if(c>0){let h=n[1].substring(0,c),d=n[1].substring(c+1);o=[h,d]}}else return;let l;if(l=o[0].replace(/,/g,""),isNaN(l))return;if(a.start=parseInt(l,10)-1,a.end=a.start+1,o.length===1&&(a.start-=20,a.end+=20),o.length===2){if(l=o[1].replace(/,/g,""),isNaN(l))return;if(a.end=parseInt(l,10),a.start<0&&!i.isSoftclipped()){let c=-a.start;a.start+=c,a.end+=c}}}return a}}async function eC(i,e,t){let n=t.url.replace("$FEATURE$",e.toUpperCase());n.indexOf("$GENOME$")>-1&&(n=n.replace("$GENOME$",i.genome.id?i.genome.id:"hg19"));let s=t.timeout?{timeout:t.timeout}:void 0,r=await Ce.loadString(n,s),a=tC(i,r,t);return a&&(a.locusSearchString=e),a}function tC(i,e,t){let n;if(t.type==="plain"?n=iC(i,e):n=JSON.parse(e),t.resultsField&&(n=n[t.resultsField]),!(!n||n.length===0)){let s=t.chromosomeField||"chromosome",r=t.startField||"start",a=t.endField||"end",o=t.coords||1,l;Array.isArray(n)?l=n[0]:l=n,l.hasOwnProperty(s)&&l.hasOwnProperty(r)||console.error("Search service results must include chromosome and start fields: "+l);let c=l[s],h=i.genome.getChromosome(c);if(!h)return;let d=h.name,f=l[r]-o,u=l[a];u===void 0&&(u=f+1);let g={chr:d,start:f,end:u},_=l.type?l.type:"gene";return t.geneField&&_==="gene"&&(g.gene=l[t.geneField]),t.snpField&&_==="snp"&&(g.snp=l[t.snpField]),g}}function iC(i,e){let t=[],n=[];return Ji(e).forEach(function(r){r===""||t.push(r)}),t.forEach(function(r){var a=r.split("	"),o,l,c,h;a.length>=3&&(l=a[1].split(":"),c=l[1].split("-"),o=a[2].trim(),h={gene:a[0],chromosome:i.genome.getChromosomeName(l[0].trim()),start:parseInt(c[0].replace(/,/g,"")),end:parseInt(c[1].replace(/,/g,"")),type:o==="gtex"?"snp":"gene"},n.push(h))}),n}var Uh=class{constructor(e){this.browser=e}navbarDidResize(e){this.updateNavbar(this.createResponsiveClassSchedule(e))}updateNavbar(e){this.browser.$toggle_button_container.removeClass(),this.browser.$toggle_button_container.addClass(e.$toggle_button_container),pe(this.browser.zoomWidget.zoomContainer).removeClass(),pe(this.browser.zoomWidget.zoomContainer).addClass(e.zoomContainer)}createResponsiveClassSchedule(e){let t={},n=this.browser.isMultiLocusWholeGenomeView()||this.browser.referenceFrameList&&mt.isWholeGenomeView(this.browser.referenceFrameList[0].chr);return n?this.browser.windowSizePanel.hide():this.browser.windowSizePanel.show(),e>990?(t.$toggle_button_container="igv-navbar-toggle-button-container",t.zoomContainer="igv-zoom-widget"):e>860?(t.$toggle_button_container="igv-navbar-toggle-button-container",t.zoomContainer="igv-zoom-widget-900"):e>540?(t.$toggle_button_container="igv-navbar-toggle-button-container-750",t.zoomContainer="igv-zoom-widget-900"):(t.$toggle_button_container="igv-navbar-toggle-button-container-750",t.zoomContainer="igv-zoom-widget-900",this.browser.windowSizePanel.hide()),n&&(t.zoomContainer="igv-zoom-widget-hidden"),t}},Sa=function(i,e){this.container=de.div({class:"igv-chromosome-select-widget-container"}),e.appendChild(this.container),this.select=document.createElement("select"),this.select.setAttribute("name","chromosome-select-widget"),this.container.appendChild(this.select),this.select.addEventListener("change",()=>{this.select.blur(),this.select.value!==""&&i.search(this.select.value)}),this.showAllChromosomes=i.config.showAllChromosomes!==!1};Sa.prototype.show=function(){this.container.style.display="flex"};Sa.prototype.hide=function(){this.container.style.display="none"};Sa.prototype.update=function(i){let e=this.showAllChromosomes?i.chromosomeNames.slice():i.wgChromosomeNames.slice();i.showWholeGenomeView()&&(e.unshift("all"),e.unshift("")),this.select.innerHTML="";for(let t of e){let n=document.createElement("option");n.setAttribute("value",t),n.innerText=t,this.select.appendChild(n)}};var $h=class{constructor(e,t){this.container=de.div({class:"igv-windowsize-panel-container"}),e.appendChild(this.container),t.on("locuschange",n=>{this.updatePanel(n)}),this.browser=t}show(){this.container.style.display="block"}hide(){this.container.style.display="none"}updatePanel(e){let t=this.browser.calculateViewportWidth(this.browser.referenceFrameList.length);this.container.innerText=e.length===1?nl(Math.round(t*e[0].bpPerPixel)):""}},Vh=class{constructor(e,t){this.browser=t,this.columnContainer=e,this.horizontalGuide=de.div({class:"igv-cursor-guide-horizontal"}),e.appendChild(this.horizontalGuide),this.verticalGuide=de.div({class:"igv-cursor-guide-vertical"}),e.appendChild(this.verticalGuide),this.addMouseHandler(t),this.setVisibility(t.config.showCursorGuide)}addMouseHandler(e){this.boundMouseMoveHandler=t.bind(this),this.columnContainer.addEventListener("mousemove",this.boundMouseMoveHandler);function t(n){let{x:s,y:r}=de.translateMouseCoordinates(n,this.columnContainer);this.horizontalGuide.style.top=`${r}px`;let a=document.elementFromPoint(n.clientX,n.clientY),o=nC(a,"igv-viewport");if(o&&e.getRulerTrackView()){this.verticalGuide.style.left=`${s}px`;let l=e.root.querySelectorAll(".igv-column"),c,h=o.parentElement;for(let u=0;u<l.length;u++)c===void 0&&h===l[u]&&(c=u);let f=e.getRulerTrackView().viewports[c].mouseMove(n);if(f){let{start:u,bp:g,end:_}=f,b=(g-u)/(_-u);this.customMouseHandler&&this.customMouseHandler({start:u,bp:g,end:_,interpolant:b})}}}}removeMouseHandler(){this.columnContainer.removeEventListener("mousemove",this.boundMouseMoveHandler)}setVisibility(e){e===!0?this.show():this.hide()}show(){this.verticalGuide.style.display="block",this.horizontalGuide.style.display="block"}hide(){if(this.verticalGuide.style.display="none",this.horizontalGuide.style.display="none",this.browser.getRulerTrackView())for(let e of this.browser.getRulerTrackView().viewports)e.$tooltip.hide()}};function nC(i,e){for(;i.parentElement;){if(i.parentElement.classList.contains(e))return i.parentElement;i=i.parentElement}}var qh=class{constructor(e,t){this.browser=e,this.button=de.div({class:"igv-navbar-button"}),t.appendChild(this.button),this.button.textContent="cursor guide",this.button.addEventListener("click",()=>{e.cursorGuideVisible=!e.cursorGuideVisible,e.setCursorGuideVisibility(e.cursorGuideVisible),this.setButtonState(e.cursorGuideVisible)}),this.setButtonState(e.cursorGuideVisible),e.config.showCursorTrackingGuideButton?this.show():this.hide()}setButtonState(e){e===!0?this.button.classList.add("igv-navbar-button-clicked"):this.button.classList.remove("igv-navbar-button-clicked")}show(){this.button.style.display="block",this.setButtonState(this.browser.cursorGuideVisible)}hide(){this.button.style.display="none"}},Wh=class{constructor(e,t){this.browser=e,this.button=de.div({class:"igv-navbar-button"}),t.appendChild(this.button),this.button.textContent="center line",this.button.addEventListener("click",()=>{e.isCenterLineVisible=!e.isCenterLineVisible,e.setCenterLineVisibility(e.isCenterLineVisible),this.setButtonState(e.isCenterLineVisible)}),this.setButtonState(e.isCenterLineVisible),e.config.showCenterGuideButton?this.show():this.hide()}setButtonState(e){e===!0?this.button.classList.add("igv-navbar-button-clicked"):this.button.classList.remove("igv-navbar-button-clicked")}show(){this.isVisible=!0,this.button.style.display="block",this.setButtonState(this.browser.isCenterLineVisible)}hide(){this.isVisible=!1,this.button.style.display="none"}},jh=class{constructor(e,t){this.button=de.div({class:"igv-navbar-button"}),e.appendChild(this.button),this.button.textContent="track labels",this.button.addEventListener("click",()=>{t.trackLabelsVisible=!t.trackLabelsVisible,this.setState(t.trackLabelsVisible),t.setTrackLabelVisibility(t.trackLabelsVisible)}),this.browser=t,this.setVisibility(t.config.showTrackLabelButton),this.setState(t.trackLabelsVisible)}setVisibility(e){e===!0?this.show():this.hide()}setState(e){e===!0?this.button.classList.add("igv-navbar-button-clicked"):this.button.classList.remove("igv-navbar-button-clicked")}show(){this.button.style.display="block",this.setState(this.browser.trackLabelsVisible)}hide(){this.button.style.display="none"}},Gh=class{constructor(e,t){this.button=de.div({class:"igv-navbar-button"}),e.appendChild(this.button),this.button.innerText="Sample Names",this.setState(t.showSampleNames),this.setVisibility(t.showSampleNameButton),this.button.addEventListener("click",()=>{t.showSampleNames=!t.showSampleNames,this.setState(t.showSampleNames);for(let{sampleNameViewport:n}of t.trackViews)t.showSampleNames===!1?n.hide():n.show();t.layoutChange()})}setVisibility(e){e===!0?this.show():this.hide()}setState(e){e===!0?this.button.classList.add("igv-navbar-button-clicked"):this.button.classList.remove("igv-navbar-button-clicked")}hide(){this.button.style.display="none"}show(){this.button.style.display="block"}},rC=0,Zh=23,sp=0,Ti=function(i,e){this.browser=i,this.zoomContainer=de.div({class:"igv-zoom-widget"}),e.appendChild(this.zoomContainer),this.zoomOutButton=de.div(),this.zoomContainer.appendChild(this.zoomOutButton),this.zoomOutButton.appendChild(Ui.createIcon("minus-circle")),this.zoomOutButton.addEventListener("click",()=>{i.zoomOut()});let t=de.div();this.zoomContainer.appendChild(t),this.slider=document.createElement("input"),this.slider.type="range",this.slider.min=`${rC}`,this.slider.max=`${Zh}`,t.appendChild(this.slider),this.slider.addEventListener("change",n=>{n.preventDefault(),n.stopPropagation();let s=i.referenceFrameList[0],{bpLength:r}=s.genome.getChromosome(s.chr),{end:a,start:o}=s,l=a-o,c=Math.pow(2,n.target.valueAsNumber),h=r/c;i.zoomWithScaleFactor(h/l)}),this.zoomInButton=de.div(),this.zoomContainer.appendChild(this.zoomInButton),this.zoomInButton.appendChild(Ui.createIcon("plus-circle")),this.zoomInButton.addEventListener("click",()=>{i.zoomIn()}),i.on("locuschange",n=>{this.browser.isMultiLocusMode()?this.disable():(this.enable(),this.update(n))})};Ti.prototype.update=function(i){let e=i[0],{bpLength:t}=e.genome.getChromosome(e.chr),{start:n,end:s}=e;Zh=Math.ceil(Math.log2(t/this.browser.minimumBases())),this.slider.max=`${Zh}`;let r=t/(s-n);sp=Math.log2(r),this.slider.value=`${Math.round(sp)}`};Ti.prototype.enable=function(){this.slider.disabled=!1};Ti.prototype.disable=function(){this.slider.disabled=!0};Ti.prototype.hide=function(){this.zoomContainer.style.display="none"};Ti.prototype.show=function(){this.zoomContainer.style.display="block"};Ti.prototype.hideSlider=function(){this.slider.style.display="none"};Ti.prototype.showSlider=function(){this.slider.style.display="block"};var sC=function(i,e){let t=de.div({class:"igv-navbar-button"});i.append(t),t.textContent="Save SVG",t.addEventListener("click",()=>e.saveSVGtoFile({}))},To={createColumns:(i,e)=>{for(let t=0;t<e;t++)t===0||i.appendChild(de.div({class:"igv-column-shim"})),Li(i,"igv-column")},removeColumnAtIndex:(i,e)=>{let t=i===0?e.nextElementSibling:e.previousElementSibling;e.remove(),t.remove()},insertAfter:i=>{let e=de.div({class:"igv-column-shim"});ru(e,i);let t=de.div({class:"igv-column"});return ru(t,e),t},insertBefore:(i,e)=>{for(let t=0;t<e;t++){let n=de.div({class:"igv-column"});if(nu(n,i),e>1&&t>0){let s=de.div({class:"igv-column-shim"});nu(s,n)}}},indexOfColumn:(i,e)=>{let t=i.querySelectorAll(".igv-column");for(let n=0;n<t.length;n++)if(t[n]===e)return n}},Xh=class{constructor(e,t,n){this.browser=e,this.referenceFrame=t,this.column=n,this.container=de.div({class:"igv-center-line"}),n.appendChild(this.container),e.isCenterLineVisible?this.show():this.hide()}repaint(){if(this.referenceFrame)if(1/this.referenceFrame.bpPerPixel>1){let t=Math.floor(this.referenceFrame.toPixels(1));this.container.style.width=`${t}px`,this.container.classList.remove("igv-center-line-thin"),this.container.classList.add("igv-center-line-wide")}else this.container.style.width="1px",this.container.classList.remove("igv-center-line-wide"),this.container.classList.add("igv-center-line-thin")}show(){this.isVisible=!0,this.container.style.display="block",this.repaint()}hide(){this.isVisible=!1,this.container.style.display="none"}resize(){this.repaint()}},ap=De,Yh=class{constructor(e){this.browser=e,this.height=40,this.name="",this.id="ruler",this.disableButtons=!0,this.ignoreTrackMenu=!0,this.order=Number.MIN_SAFE_INTEGER*.01,this.removable=!1,this.type="ruler"}async getFeatures(e,t,n){return[]}computePixelHeight(e){return this.height}draw({context:e,referenceFrame:t,pixelWidth:n,pixelHeight:s,bpPerPixel:r,bpStart:a}){mt.isWholeGenomeView(t.chr)?this.drawWholeGenome({context:e,pixelWidth:n,pixelHeight:s,bpPerPixel:r}):this.doDraw({context:e,referenceFrame:t,pixelWidth:n,pixelHeight:s,bpStart:a})}drawWholeGenome({context:e,pixelWidth:t,pixelHeight:n,bpPerPixel:s}){e.save(),he.fillRect(e,0,0,t,n,{fillStyle:"white"});for(let r of this.browser.genome.wgChromosomeNames){let a=this.browser.genome.getCumulativeOffset(r),o=this.browser.genome.getChromosome(r).bpLength,l=Math.round(a/s),c=Math.round(o/s);this.renderChromosomeRect(e,l,0,c,n,r)}e.restore()}doDraw({context:e,referenceFrame:t,pixelWidth:n,pixelHeight:s,bpStart:r}){e.clearRect(0,0,n,s);let a=6,o=2,l=Math.floor(t.toBP(n)),c=aC(l,e.isSVG),h=Math.floor(r/c.majorTick)-1,{tickDelta:d,labelLength:f}=oC(e,t,r,h,c);this.browser.referenceFrameList.indexOf(t);let u,g,_=d,b=.25*f;do{g=Math.floor(h*c.majorTick);let w=`${De(Math.floor(g/c.unitMultiplier))} ${c.majorUnit}`;u=Math.round(t.toPixels(g-1-r+.5));let p=Math.round(u-e.measureText(w).width/2);p>0&&b+f<=_&&(he.fillText(e,w,p,this.height-a/.75),_=0),u>0&&he.strokeLine(e,u,this.height-a,u,this.height-o),g=Math.floor((1+h)*c.majorTick);let v=(Math.round(t.toPixels(g-1-r+.5))-u)/2,x=u+v;x>0&&he.strokeLine(e,x,this.height-a,x,this.height-o),++h,_+=d}while(u<n);he.strokeLine(e,0,this.height-o,n,this.height-o)}renderChromosomeRect(e,t,n,s,r,a){e.textAlign="center",e.textBaseline="middle",e.font="12px sans-serif",he.strokeLine(e,t+s,n,t+s,n+r,{strokeStyle:Ve.greyScale(191)});let o=a.startsWith("chr")?a.substring(3):a;s>e.measureText(o).width&&he.fillText(e,o,t+s/2,n+r/2,{fillStyle:Ve.greyScale(68)})}get supportsWholeGenome(){return!0}dispose(){}};function aC(i,e){if(i<10)return new fa(1,"bp",1);let t=Math.floor(Math.log10(i)),n="bp",s=1;t>9?(n="gb",s=1e9):t>6?(n="mb",s=1e6):t>3&&(n="kb",s=1e3);let r=Math.pow(10,t-1),a=i/r,o=3*25,l=Math.pow(10,t-1),c=Math.pow(10,t)/2,h=a<o&&e!==!0?l:c;return new fa(h,n,s)}function oC(i,e,t,n,s){let r=c(e,l(1+n,s),t)-c(e,l(n,s),t),a=`${De(Math.floor(l(n,s)/s.unitMultiplier))} ${s.majorUnit}`,o=Math.floor(i.measureText(a).width);return{tickDelta:r,labelLength:o};function l(h,d){return Math.floor(h*d.majorTick)}function c(h,d,f){return Math.round(h.toPixels(d-1-f+.5))}}var fa=class{constructor(e,t,n){this.majorTick=e,this.minorTick=e/10,this.majorUnit=t,this.unitMultiplier=n}description(e){console.log((e||"")+" tick "+ap(this.majorTick)+" label width "+ap(this.labelWidthBP)+" multiplier "+this.unitMultiplier)}},Or=function(i,e){this.button=de.div({class:"igv-navbar-button"}),i.appendChild(this.button),this.button.textContent="circular view",this.button.addEventListener("click",()=>{e.circularViewVisible=!e.circularViewVisible}),this.browser=e,this.setVisibility(e.config.showCircularViewButton),this.setState(e.circularViewVisible)};Or.prototype.setVisibility=function(i){i===!0?this.show():this.hide()};Or.prototype.setState=function(i){i===!0?this.button.classList.add("igv-navbar-button-clicked"):this.button.classList.remove("igv-navbar-button-clicked")};Or.prototype.show=function(){this.button.style.display="block",this.setState(this.browser.circularViewVisible)};Or.prototype.hide=function(){this.button.style.display="none"};var lC=function(i,e,t){let n=de.div({class:"igv-navbar-button"});i.append(n),n.textContent=t.label,n.addEventListener("click",()=>t.callback(e))},ua=class{constructor(e,t,n,s,r){this.browser=e,this.roiMenu=t,this.roiTable=n,this.top=s,this.roiSets=r||[],this.boundLocusChangeHandler=hC.bind(this),e.on("locuschange",this.boundLocusChangeHandler)}async initialize(){this.roiSets.length>0&&(this.browser.showROITableButton=!0,this.browser.roiTableControl.setVisibility(this.browser.showROITableButton));let e=this.roiSets.map(n=>this.renderROISet({browser:this.browser,pixelTop:this.top,roiSet:n}));e.length>0&&await Promise.all(e);let t=await this.getTableRecords();this.roiTable.renderTable(t)}async loadROI(e,t){let n=Array.isArray(e)?e:[e];for(let s of n)this.roiSets.push(new Er(s,t));await this.initialize()}clearROIs(){this.roiTable.clearTable();let e=this.browser.columnContainer.querySelectorAll(".igv-roi-region");for(let t of e)t.remove();for(let t of this.roiSets)t.dispose();this.roiSets=[]}async getTableRecords(){let e=[];for(let t of this.roiSets){let n=t.isUserDefined?"":t.name||"",s=await t.getAllFeatures();for(let r of Object.keys(s))for(let a of s[r])e.push({setName:n,feature:a})}return e}presentTable(){this.roiTable.present()}async repaintTable(){let e=await this.getTableRecords();this.roiTable.renderTable(e)}dismissTable(){this.roiTable.dismiss()}async updateUserDefinedROISet(e){let t=await this.getUserDefinedROISet();t===void 0&&(t=this.initializeUserDefinedROISet()),t.addFeature(e),this.browser.showROITableButton===!1&&this.setROITableButtonVisibility(!0),await this.renderROISet({browser:this.browser,pixelTop:this.top,roiSet:t});let n=await this.getTableRecords();this.roiTable.renderTable(n)}setROITableButtonVisibility(e){this.browser.showROITableButton=e,this.browser.roiTableControl.setVisibility(this.browser.showROITableButton)}async renderAllROISets(){for(let e of this.roiSets)await this.renderROISet({browser:this.browser,pixelTop:this.top,roiSet:e})}async renderROISet({browser:e,pixelTop:t,roiSet:n}){let s=e.columnContainer.querySelectorAll(".igv-column");for(let r=0;r<s.length;r++){let{chr:a,start:o,end:l,bpPerPixel:c}=e.referenceFrameList[r],h=s[r].querySelectorAll(".igv-roi-region");for(let f of h){let u=f.dataset.region,{chr:g,start:_,end:b}=Qh(u);(g!==a||b<o||_>l)&&f.remove()}let d=await n.getFeatures(a,o,l);if(d)for(let f of d){let u=d0(a,f.start,f.end),{x:g,width:_}=gm(Math.max(o,f.start),Math.min(l,f.end),o,c),b=s[r].querySelector(op(u));if(b)b.style.left=`${g}px`,b.style.width=`${_}px`;else{let w=this.createRegionElement(e.columnContainer,t,g,_,n,u,f.name);s[r].appendChild(w)}}}}createRegionElement(e,t,n,s,r,a,o){let l=de.div({class:"igv-roi-region"});l.style.top=`${t}px`,l.style.left=`${n}px`,l.style.width=`${s}px`,l.style.backgroundColor=r.color,l.dataset.region=a;let c=de.div();return l.appendChild(c),c.style.backgroundColor=r.headerColor,r.isUserDefined===!0?c.addEventListener("click",h=>{h.preventDefault(),h.stopPropagation();let{x:d,y:f}=de.translateMouseCoordinates(h,e);this.roiMenu.present(d,f,this,e,l)}):o?c.addEventListener("click",h=>{h.preventDefault(),h.stopPropagation(),this.popover&&this.popover.dispose(),this.popover=new dr(e,r.name),this.popover.presentContentWithEvent(h,o)}):c.style.pointerEvents="none",l}renderSVGContext(e,{deltaX:t,deltaY:n}){for(let s of document.querySelectorAll(".igv-roi-region")){let{x:r,y:a,width:o,height:l}=s.getBoundingClientRect();e.fillStyle=s.style.backgroundColor,e.fillRect(r+t,a+n,o,l);let c=s.querySelector("div"),{x:h,y:d,width:f,height:u}=c.getBoundingClientRect();e.fillStyle=c.style.backgroundColor,e.fillRect(h+t,d+n,f,u)}}async getUserDefinedROISet(){return this.roiSets.find(e=>e.isUserDefined===!0)}initializeUserDefinedROISet(){let e={isUserDefined:!0,features:[]},t=new Er(e,this.browser.genome);return this.roiSets.push(t),t}async deleteUserDefinedRegionWithKey(e,t){t.querySelectorAll(op(e)).forEach(a=>a.remove());let n=await this.findUserDefinedRegionWithKey(e),s=await this.getUserDefinedROISet();s&&s.removeFeature(n),(await this.getTableRecords()).length===0&&(this.browser.roiTableControl.buttonHandler(!1),this.setROITableButtonVisibility(!1))}async findUserDefinedRegionWithKey(e){let{chr:t,start:n,end:s}=Qh(e),r=await this.getUserDefinedROISet();if(r){let a=await r.getFeatures(t,n,s);for(let o of a)if(o.chr===t&&o.start>=n&&o.end<=s)return o}}toJSON(){return this.roiSets.map(e=>e.toJSON())}dispose(){this.browser.off("locuschange",this.boundLocusChangeHandler);let e=this.browser.columnContainer.querySelectorAll(".igv-roi-region");for(let t of e)t.remove();this.roiMenu&&this.roiMenu.dispose(),this.roiTable&&this.roiTable.dispose();for(let t of this.roiSets)t.dispose();for(let t of Object.keys(this))this[t]=void 0}};function hC(){this.renderAllROISets()}function d0(i,e,t){return`${i}-${e}-${t}`}function op(i){return`[data-region="${i}"]`}function Qh(i){let[e,t,n]=i.split("-");return t=parseInt(t),n=parseInt(n),{chr:e,start:t,end:n,locus:`${e}:${t}-${n}`,bedRecord:`${e}	${t}	${n}`}}var Ni=class extends na{constructor(e){let t=Object.assign({width:"512px"},e);super(t)}tableRowDOM(e){let t=de.div({class:"igv-roi-table-row"}),{setName:n,feature:s}=e;t.dataset.region=d0(s.chr,s.start,s.end);let r=[s.chr,De(s.start),De(s.end),s.name||"",n];this.columnFormat.length===4&&(r=r.slice(0,4));for(let a=0;a<r.length;a++){let o=de.div();t.appendChild(o),o.style.width=this.columnFormat[a].width,o.innerText=r[a]}return this.tableRowDOMHelper(t),t}renderTable(e){if(Array.from(this.tableRowContainer.querySelectorAll(".igv-roi-table-row")).forEach(t=>t.remove()),e.length>0){let t=e.sort((n,s)=>n.feature.chr.localeCompare(s.feature.chr)||n.feature.start-s.feature.start||n.feature.end-s.feature.end);for(let n of t){let s=this.tableRowDOM(n);this.tableRowContainer.appendChild(s)}}}dispose(){document.removeEventListener("click",this.boundGotoButtonHandler),this.browser.roiTableControl.buttonHandler(!1),super.dispose()}static getColumnFormatConfiguration(e){return e===!0?[{label:"Chr",width:"20%"},{label:"Start",width:"15%"},{label:"End",width:"15%"},{label:"Description",width:"30%"},{label:"ROI Set",width:"20%"}]:[{label:"Chr",width:"25%"},{label:"Start",width:"20%"},{label:"End",width:"20%"},{label:"Description",width:"35%"}]}static gotoButtonHandler(e){e.stopPropagation();let t=this.tableDOM.querySelectorAll(".igv-roi-table-row-selected"),n=[];for(let s of t){let{locus:r}=Qh(s.dataset.region);n.push(r)}for(let s of this.tableDOM.querySelectorAll(".igv-roi-table-row"))s.classList.remove("igv-roi-table-row-selected");this.setTableRowSelectionState(!1),n.length>0&&this.browser.search(n.join(" "))}},Kh=class{constructor(e,t){this.browser=e,this.container=de.div({class:"igv-roi-menu-next-gen"}),t.appendChild(this.container);let n=de.div();this.container.appendChild(n),sc.attachDialogCloseHandlerWithParent(n,()=>this.container.style.display="none"),this.body=de.div(),this.container.appendChild(this.body),this.container.style.display="none"}async present(e,t,n,s,r){lp(this.body);let a=await this.browser.roiManager.findUserDefinedRegionWithKey(r.dataset.region),o=de.div();this.body.appendChild(o);let l="Description",c=a.name||l;o.innerText=c,o.setAttribute("title",c),l===c?o.classList.add("igv-roi-placeholder"):o.classList.remove("igv-roi-placeholder");let h=de.div();this.body.appendChild(h),h.innerText="Set Description",h.addEventListener("click",f=>{f.stopPropagation(),this.container.style.display="none";let u=()=>{let _=this.browser.inputDialog.value||"";a.name=_.trim(),this.container.style.display="none",this.browser.roiManager.repaintTable()},g={label:"Description",value:a.name||"",callback:u};this.browser.inputDialog.present(g,f)});let d=de.div();this.body.appendChild(d),d.innerText="Delete Region",d.addEventListener("click",f=>{f.stopPropagation(),this.container.style.display="none",this.browser.roiManager.deleteUserDefinedRegionWithKey(r.dataset.region,this.browser.columnContainer)}),this.container.style.left=`${e}px`,this.container.style.top=`${t}px`,this.container.style.display="flex"}async __present(e,t,n,s,r){lp(this.container);let a=await this.browser.roiManager.findUserDefinedRegionWithKey(r.dataset.region),o;o=de.div({class:"igv-roi-menu-row-edit-description"}),this.container.appendChild(o),o.addEventListener("click",d=>{d.stopPropagation()});let l="description-input",c=document.createElement("label");o.appendChild(c),c.setAttribute("for",l),c.innerText="Description:";let h=document.createElement("input");o.appendChild(h),h.setAttribute("type","text"),h.setAttribute("name",l),h.setAttribute("placeholder",""),h.value=a.name||"",h.addEventListener("change",async d=>{d.stopPropagation();let f=await this.browser.roiManager.findUserDefinedRegionWithKey(r.dataset.region);f.name=h.value,h.blur(),this.container.style.display="none",await this.browser.roiManager.repaintTable()}),o=de.div({class:"igv-roi-menu-row"}),o.innerText="Delete region",this.container.appendChild(o),o.addEventListener("click",d=>{d.stopPropagation(),this.container.style.display="none",this.browser.roiManager.deleteUserDefinedRegionWithKey(r.dataset.region,this.browser.columnContainer)}),this.container.style.left=`${e}px`,this.container.style.top=`${t}px`,this.container.style.display="flex",s.addEventListener("click",d=>{d.stopPropagation(),this.container.style.display="none"})}dispose(){this.container.innerHTML=""}};function lp(i){for(;i.firstChild;)i.removeChild(i.firstChild)}var Jh=class{constructor(e,t){this.name=e.name,this.featureSource=e.featureSource||Bt(e,t),this.color=e.color||yc}async getFeatures(e,t,n){return this.featureSource.getFeatures({chr:e,start:t,end:n})}draw(e){let{context:t,bpPerPixel:n,bpStart:s,pixelTop:r,pixelHeight:a,pixelWidth:o,features:l}=e;if(!l)return;let c=s+o*n+1;for(let{start:h,end:d}of l){if(d<s)continue;if(h>c)break;let{x:f,width:u}=gm(h,d,s,n);he.fillRect(t,f,r,u,a,{fillStyle:this.color})}}},ec=class{constructor(e,t){this.browser=t,this.button=de.div({class:"igv-navbar-button"}),e.appendChild(this.button),this.button.textContent="ROI Table",this.button.addEventListener("click",()=>{this.buttonHandler(!t.roiTableVisible)}),this.browser=t,this.setVisibility(t.showROITableButton),this.setState(t.roiTableVisible)}buttonHandler(e){this.browser.roiTableVisible=e,this.setState(this.browser.roiTableVisible),this.browser.setROITableVisibility(this.browser.roiTableVisible)}setVisibility(e){e===!0?this.show():this.hide()}setState(e){e===!0?this.button.classList.add("igv-navbar-button-clicked"):this.button.classList.remove("igv-navbar-button-clicked")}show(){this.button.style.display="block",this.setState(this.browser.roiTableVisible)}hide(){this.button.style.display="none"}},hp=14,cp=12,fp=28,cC=5,up=200,da=class i{constructor(e,t){this.config=e,this.guid=de.guid(),this.namespace=".browser_"+this.guid,this.parent=t,this.root=de.div({class:"igv-container"}),t.appendChild(this.root),this.alert=new tl(this.root),this.columnContainer=de.div({class:"igv-column-container"}),this.root.appendChild(this.columnContainer),this.menuPopup=new Pn(this.columnContainer),this.initialize(e),this.trackViews=[],this.constants={dragThreshold:3,scrollThreshold:5,defaultColor:"rgb(0,0,150)",doubleClickDelay:e.doubleClickDelay||500},this.eventHandlers={},this.addMouseHandlers(),this.setControls(e)}initialize(e){e.gtex&&(Cc.gtexLoaded=!0),this.flanking=e.flanking,this.crossDomainProxy=e.crossDomainProxy,this.formats=e.formats,this.trackDefaults=e.trackDefaults,this.nucleotideColors=e.nucleotideColors||jg;for(let t of Object.keys(this.nucleotideColors))this.nucleotideColors[t.toLowerCase()]=this.nucleotideColors[t];this.trackLabelsVisible=e.showTrackLabels,this.roiTableVisible=e.showROITable,this.showROITableButton=e.showROITableButton,this.isCenterLineVisible=e.showCenterGuide,this.cursorGuideVisible=e.showCursorGuide,this.showSampleNames=e.showSampleNames,this.showSampleNameButton=e.showSampleNameButton,this.sampleNameViewportWidth=e.sampleNameViewportWidth||up,e.search&&(this.searchConfig={type:"json",url:e.search.url,coords:e.search.coords===void 0?1:e.search.coords,chromosomeField:e.search.chromosomeField||"chromosome",startField:e.search.startField||"start",endField:e.search.endField||"end",geneField:e.search.geneField||"gene",snpField:e.search.snpField||"snp",resultsField:e.search.resultsField})}setControls(e){let t=this.createStandardControls(e);t.insertBefore(pe(this.columnContainer)),this.$navigation=t,e.showControls===!1&&t.hide()}createStandardControls(e){this.navbarManager=new Uh(this);let t=pe("<div>",{class:"igv-navbar"});this.$navigation=t;let n=pe("<div>",{class:"igv-navbar-left-container"});t.append(n);let s=pe("<div>",{class:"igv-logo"});n.append(s);let r=uC();r.css("width","34px"),r.css("height","32px"),s.append(r),this.$current_genome=pe("<div>",{class:"igv-current-genome"}),n.append(this.$current_genome),this.$current_genome.text("");let a=pe("<div>",{class:"igv-navbar-genomic-location"});n.append(a),this.chromosomeSelectWidget=new Sa(this,a.get(0)),e.showChromosomeWidget===void 0&&(e.showChromosomeWidget=!0),e.showChromosomeWidget===!0?this.chromosomeSelectWidget.show():this.chromosomeSelectWidget.hide();let o=pe("<div>",{class:"igv-locus-size-group"});a.append(o);let l=pe("<div>",{class:"igv-search-container"});o.append(l),this.$searchInput=pe("<input>",{class:"igv-search-input",type:"text",placeholder:"Locus Search"}),l.append(this.$searchInput),this.$searchInput.change(()=>this.doSearch(this.$searchInput.val()));let c=de.div({class:"igv-search-icon-container"});l.append(pe(c)),c.appendChild(Ui.createIcon("search")),c.addEventListener("click",()=>this.doSearch(this.$searchInput.val())),this.windowSizePanel=new $h(o.get(0),this);let h=pe("<div>",{class:"igv-navbar-right-container"});t.append(h);let d=pe('<div class="igv-navbar-toggle-button-container">');if(h.append(d),this.$toggle_button_container=d,this.cursorGuide=new Vh(this.columnContainer,this),this.cursorGuideButton=new qh(this,d.get(0)),this.centerLineButton=new Wh(this,d.get(0)),this.setTrackLabelVisibility(e.showTrackLabels),this.trackLabelControl=new jh(d.get(0),this),this.roiTableControl=new ec(d.get(0),this),this.sampleNameControl=new Gh(d.get(0),this),e.showSVGButton===!0&&(this.svgSaveControl=new sC(d.get(0),this)),e.customButtons)for(let f of e.customButtons)new lC(d.get(0),this,f);return this.zoomWidget=new Ti(this,h.get(0)),e.showNavigation===!1&&this.$navigation.hide(),this.inputDialog=new Oo(this.root),this.inputDialog.container.id=`igv-input-dialog-${de.guid()}`,this.dataRangeDialog=new Ss(this,pe(this.root)),this.dataRangeDialog.$container.get(0).id=`igv-data-range-dialog-${de.guid()}`,this.genericColorPicker=new ks({parent:this.columnContainer,width:432}),this.genericColorPicker.container.id=`igv-track-color-picker-${de.guid()}`,t}getSampleNameViewportWidth(){return this.showSampleNames===!1?0:this.sampleNameViewportWidth}isMultiLocusMode(){return this.referenceFrameList&&this.referenceFrameList.length>1}addTrackToFactory(e,t){rp.addTrack(e,t)}isMultiLocusWholeGenomeView(){if(this.referenceFrameList===void 0||this.referenceFrameList.length===1)return!1;for(let e of this.referenceFrameList)if(e.chr.toLowerCase()==="all")return!0;return!1}currentLoci(){let e=t=>`${t.chr}:${t.start+1}-${t.end}`;return this.referenceFrameList===void 0||this.referenceFrameList.length===0?"":this.referenceFrameList.length===1?e(this.referenceFrameList[0]):this.referenceFrameList.map(t=>e(t))}toSVG(){let{y:e,width:t,height:n}=this.columnContainer.getBoundingClientRect(),s=8e3,r={width:t,height:s,backdropColor:"white",multiLocusGap:0,viewbox:{x:0,y:0,width:t,height:s}},a=new Os(r),o={deltaX:0,deltaY:-e};for(let l of this.trackViews)l.renderSVGContext(a,o);return this.roiManager.renderSVGContext(a,o),a.setHeight(n),a.getSerializedSvg(!0)}renderSVG(e){let t=this.toSVG();return e.empty(),e.append(t),t}saveSVGtoFile(e){let t=this.toSVG();e.$container&&(e.$container.empty(),e.$container.append(t));let n=e.filename||"igvjs.svg",s=URL.createObjectURL(new Blob([t],{type:"application/octet-stream"}));zo(n,s)}async loadSession(e){this.roiSets=[];let t;return e.url||e.file?t=await n(e):t=e,this.loadSessionObject(t);async function n(s){let r=s.url||s.file;if(s.url&&(s.url.startsWith("blob:")||s.url.startsWith("data:"))){let a=i.uncompressSession(s.url);return JSON.parse(a)}else{let a=s.filename;if(a||(a=s.url?await il(s.url):s.file.name),a.endsWith(".xml")){let o=mt.KNOWN_GENOMES,l=await Ce.loadString(r);return new zh(l,o)}else return a.endsWith(".json")?Ce.loadJson(r):void 0}}}async loadSessionObject(e){this.cleanHouseForSession(),this.showSampleNames=e.showSampleNames||!1,this.sampleNameControl.setState(this.showSampleNames===!0),e.sampleNameViewportWidth&&(this.sampleNameViewportWidth=e.sampleNameViewportWidth),Li(this.columnContainer,"igv-axis-column"),Li(this.columnContainer,"igv-sample-name-column"),Li(this.columnContainer,"igv-scrollbar-column"),Li(this.columnContainer,"igv-track-drag-column"),Li(this.columnContainer,"igv-gear-menu-column");let t=e.reference||e.genome;if(!t){console.warn("No genome or reference object specified");return}let n=await mt.expandReference(this.alert,t);await this.loadReference(n,e.locus),this.centerLineList=this.createCenterLineList(this.columnContainer);let s=0;if(e.showIdeogram!==!1){let d=new sa(this);d.id="ideogram";let f=new hr(this,this.columnContainer,d),{$viewport:u}=f.viewports[0];s=r_(u.get(0)),this.trackViews.push(f)}if(e.showRuler!==!1&&this.trackViews.push(new hr(this,this.columnContainer,new Yh(this))),e.gtexSelections)for(let d of this.referenceFrameList)for(let f of Object.keys(e.gtexSelections)){let u=e.gtexSelections[f].gene,g=e.gtexSelections[f].snp;d.selection=new ha(u,g)}this.roiManager&&this.roiManager.dispose();let r=new Kh(this,this.columnContainer),a={browser:this,parent:this.columnContainer,headerTitle:"Regions of Interest",dismissHandler:()=>this.roiTableControl.buttonHandler(!1),gotoButtonHandler:Ni.gotoButtonHandler};if(e.roi){let d=e.roi.map(g=>new Er(g,this.genome)),f=d.filter(({name:g})=>g!==void 0&&g.length>0);a.columnFormat=Ni.getColumnFormatConfiguration(f.length>0);let u=new Ni(a);this.roiManager=new ua(this,r,u,s,d)}else{a.columnFormat=Ni.getColumnFormatConfiguration(!1);let d=new Ni(a);this.roiManager=new ua(this,r,d,s,void 0)}await this.roiManager.initialize();let o=n.tracks||[],l=e.tracks?o.concat(e.tracks):o;l.filter(d=>d.type==="sequence"&&!d.url&&!d.fastaURL).length===0&&l.push({type:"sequence",order:Ns});let h=1;for(let d of l)d.order===void 0&&(d.order=h++);await this.loadTrackList(l);for(let d of this.trackViews.filter(f=>f.track.type==="ruler"||f.track.type==="ideogram"))d.updateViews();this.updateUIWithReferenceFrameList()}createCenterLineList(e){let t=e.querySelectorAll(".igv-center-line");for(let r=0;r<t.length;r++)t[r].remove();let n=[],s=e.querySelectorAll(".igv-column");for(let r=0;r<s.length;r++)n.push(new Xh(this,this.referenceFrameList[r],s[r]));return n}async loadReference(e,t){let n=await mt.loadGenome(e),s=this.genome===void 0||this.genome.id!==n.id;this.genome=n,this.updateNavbarDOMWithGenome(n),s&&this.removeAllTracks();let r=fC(t,n);if(!await this.search(r,!0)&&(console.log("Initial locus not found: "+r),r=n.getHomeChromosomeName(),!await this.search(r,!0)))throw new Error("Cannot set initial locus");s&&this.circularView&&this.circularView.setAssembly({name:this.genome.id,id:this.genome.id,chromosomes:qu(this.genome)})}cleanHouseForSession(){for(let t of this.trackViews)t.removeDOMFromColumnContainer();this.columnContainer.querySelectorAll(".igv-axis-column, .igv-column-shim, .igv-column, .igv-sample-name-column, .igv-scrollbar-column, .igv-track-drag-column, .igv-gear-menu-column").forEach(t=>t.remove()),this.trackViews=[],this.circularView&&this.circularView.clearChords()}updateNavbarDOMWithGenome(e){let t=e.id&&e.id.length<10?e.id:"";this.$current_genome.text(t),this.$current_genome.attr("title",e.id||""),this.chromosomeSelectWidget.update(e)}async loadGenome(e){let t=await mt.expandReference(this.alert,e);await this.loadReference(t,void 0);let n=t.tracks||[];return n.filter(r=>r.type==="sequence").length===0&&n.push({type:"sequence",order:Ns}),await this.loadTrackList(n),await this.updateViews(),this.genome}updateUIWithReferenceFrameList(){let e=this.referenceFrameList;this.updateLocusSearchWidget();let t=this.isMultiLocusWholeGenomeView()||mt.isWholeGenomeView(e[0].chr);this.navbarManager.navbarDidResize(this.$navigation.width(),t),Ro(this.trackViews,this.trackLabelsVisible),this.setCenterLineAndCenterLineButtonVisibility(!mt.isWholeGenomeView(e[0].chr))}setTrackLabelVisibility(e){Ro(this.trackViews,e)}setROITableVisibility(e){e===!0?this.roiManager.presentTable():this.roiManager.dismissTable()}setCursorGuideVisibility(e){e?this.cursorGuide.show():this.cursorGuide.hide()}setCustomCursorGuideMouseHandler(e){this.cursorGuide.customMouseHandler=e}setCenterLineVisibility(e){for(let t of this.centerLineList)e===!0?(t.show(),t.repaint()):t.hide()}setCenterLineAndCenterLineButtonVisibility(e){for(let n of this.centerLineList)e&&n.isVisible?n.show():n.container.style.display="none";e&&this.centerLineButton.isVisible?this.centerLineButton.show():this.centerLineButton.button.style.display="none"}async loadTrackList(e){let t=[];for(let r of e)t.push(this._loadTrack(r));let n=await Promise.all(t);return this.trackViews.filter(function(r){return r.track.autoscaleGroup}).length>0&&this.updateViews(),n}async loadTrack(e){let t=this._loadTrack(e);return e.autoscaleGroup&&(await t,this.updateViews()),t}async _loadTrack(e){yt(e)&&(e=JSON.parse(e));try{let t=await this.createTrack(e);if(t===void 0)return;t.order===void 0&&(t.order=this.trackViews.length);let n=new hr(this,this.columnContainer,t);if(this.trackViews.push(n),Ro(this.trackViews,this.trackLabelsVisible),this.reorderTracks(),this.fireEvent("trackorderchanged",[this.getTrackOrder()]),typeof t.postInit=="function")try{n.startSpinner(),await t.postInit()}finally{n.stopSpinner()}return t.autoscaleGroup||(e.sync?await n.updateViews():n.updateViews()),typeof t.hasSamples=="function"&&t.hasSamples()&&this.config.showSampleNameButton!==!1&&this.sampleNameControl.show(),t}catch(t){let n={401:"Access unauthorized",403:"Access forbidden",404:"Not found"};console.error(t);let s=t.message||t.error||t.toString();n.hasOwnProperty(s)&&(s=n[s]),s+=": "+e.url,this.alert.present(new Error(s),void 0)}}async loadROI(e){await this.roiManager.loadROI(e,this.genome)}clearROIs(){this.roiManager.clearROIs()}async getUserDefinedROIs(){if(this.roiManager){let e=await this.roiManager.getUserDefinedROISet();if(e===void 0)return[];let t=await e.getAllFeatures(),n=[];for(let s of Object.values(t))n.push(...s);return n}else return[]}getRulerTrackView(){let e=this.trackViews.filter(({track:t})=>t.id==="ruler");return e.length>0?e[0]:void 0}async createTrack(e){let t=await Ub(e.url||e.fastaURL);if(yt(t)&&(t=t.trim()),t)if(e.format)e.format=e.format.toLowerCase();else if(e.fastaURL)e.format="fasta";else{let r=e.filename;r||(r=await il(t));let a=wc(r);a==="tsv"?e.format=await Vg(e):a?e.format=a:e.sourceType==="htsget"&&await Cr.inferFormat(e)}let n=e.type?e.type.toLowerCase():void 0;if(!n){if(n=$g(e),n==="bedtype"){let r=Bt(e,this.genome);e._featureSource=r;let a=await r.trackType();a?n=a:n="annotation"}e.type=n}if(this.trackDefaults&&n){let r=this.trackDefaults[n];if(r)for(let a in r)r.hasOwnProperty(a)&&e[a]===void 0&&(e[a]=r[a])}let s=rp.getTrack(n,e,this);if(s===void 0)this.alert.present(new Error(`Error creating track.  Could not determine track type for file: ${e.url||e}`),void 0);else return e.roi&&e.roi.length>0&&(s.roiSets=e.roi.map(r=>new Jh(r,this.genome))),s}reorderTracks(){this.trackViews.sort(function(t,n){let s=o=>o.track.id==="ideogram"?1:o.track.id==="ruler"?2:3,r=s(t),a=s(n);if(r===a){let o=t.track.order||0,l=n.track.order||0;return o-l}else return r-a});for(let{axis:t,viewports:n,sampleNameViewport:s,outerScroll:r,dragHandle:a,gearContainer:o}of this.trackViews){t.remove();for(let{$viewport:l}of n)l.detach();s.viewport.remove(),r.remove(),a.remove(),o.remove()}let e=this.columnContainer.querySelectorAll(".igv-column");for(let{axis:t,viewports:n,sampleNameViewport:s,outerScroll:r,dragHandle:a,gearContainer:o}of this.trackViews){this.columnContainer.querySelector(".igv-axis-column").appendChild(t);for(let l=0;l<e.length;l++){let{$viewport:c}=n[l];e[l].appendChild(c.get(0))}this.columnContainer.querySelector(".igv-sample-name-column").appendChild(s.viewport),this.columnContainer.querySelector(".igv-scrollbar-column").appendChild(r),this.columnContainer.querySelector(".igv-track-drag-column").appendChild(a),this.columnContainer.querySelector(".igv-gear-menu-column").appendChild(o)}}getTrackOrder(){return this.trackViews.filter(e=>e.track&&e.track.name).map(e=>e.track.name)}removeTrackByName(e){let t=this.trackViews.slice();for(let n of t)e===n.track.name&&this.removeTrack(n.track)}removeTrack(e){for(let t of this.trackViews)if(e===t.track){this._removeTrack(t.track);break}}_removeTrack(e){e.disposed||(this.trackViews.splice(this.trackViews.indexOf(e.trackView),1),this.fireEvent("trackremoved",[e]),this.fireEvent("trackorderchanged",[this.getTrackOrder()]),e.trackView&&e.trackView.dispose())}removeAllTracks(){let e=[];for(let t of this.trackViews)t.track.id!=="ruler"&&t.track.id!=="ideogram"?(this.fireEvent("trackremoved",[t.track]),t.dispose()):e.push(t);this.trackViews=e}findTracks(e,t){let n=typeof e=="function"?s=>e(s.track):s=>t===s.track[e];return this.trackViews.filter(n).map(s=>s.track)}setTrackHeight(e){this.trackHeight=e,this.trackViews.forEach(function(t){t.setTrackHeight(e)})}async visibilityChange(){this.layoutChange()}async layoutChange(){if(this.referenceFrameList.find(t=>t.bpPerPixel<0)){let t=this.calculateViewportWidth(this.referenceFrameList.length);for(let n of this.referenceFrameList)n.bpPerPixel=(n.end-n.start)/t}if(this.referenceFrameList){let t=this.isMultiLocusWholeGenomeView()||mt.isWholeGenomeView(this.referenceFrameList[0].chr);this.navbarManager.navbarDidResize(this.$navigation.width(),t)}Mo.call(this),await this.updateViews()}async updateViews(){let e=this.trackViews;this.updateLocusSearchWidget();for(let r of this.centerLineList)r.repaint();if(this.dragObject)for(let r of e)await r.updateViews();else{let r={},a=[];for(let o of e){let l=o.track.autoscaleGroup;if(l){var t=r[l];t||(t=[],r[l]=t),t.push(o)}else a.push(o)}if(Object.entries(r).length>0){let o=Object.keys(r);for(let l of o){let c=r[l],h=[];for(let u of c)h.push(u.getInViewFeatures());let d=await Promise.all(h);var n=[],s;for(let u of d)n=n.concat(u);s=mc(n);let f=[];for(let u of c)u.track.dataRange=s,u.track.autoscale=!1,f.push(u.updateViews());await Promise.all(f)}}await Promise.all(a.map(o=>o.updateViews()))}}repaintViews(){for(let e of this.trackViews)e.repaintViews()}updateLocusSearchWidget(){if(!this.referenceFrameList)return;let e=this.referenceFrameList,t=this.calculateViewportWidth(this.referenceFrameList.length);for(let s of e)s.end=s.start+s.bpPerPixel*t;this.chromosomeSelectWidget.select.value=e.length===1?this.referenceFrameList[0].chr:"";let n=this.referenceFrameList.map(s=>s.getLocusString()).join(" ");this.$searchInput.val(n),this.fireEvent("locuschange",[this.referenceFrameList])}calculateViewportWidth(e){let{width:t}=this.columnContainer.getBoundingClientRect(),n=this.getSampleNameViewportWidth();return t-=go+n+hp+cp+fp,t-=cC*(e-1),Math.floor(t/e)}getCenterLineXOffset(){let{width:e}=this.columnContainer.getBoundingClientRect();return e-=go+this.getSampleNameViewportWidth()+hp+cp+fp,Math.floor(e/2+go)}minimumBases(){return this.config.minimumBases}zoomIn(){this.zoomWithScaleFactor(.5)}zoomOut(){this.zoomWithScaleFactor(2)}async zoomWithScaleFactor(e,t,n){if(!this.referenceFrameList)return;let s=this.calculateViewportWidth(this.referenceFrameList.length),r=n?[n]:this.referenceFrameList;for(let a of r)a.zoomWithScaleFactor(this,e,s,t)}async addMultiLocusPanel(e,t,n,s){if(!this.referenceFrameList)return;let r=this.calculateViewportWidth(1+this.referenceFrameList.length),a=this.calculateViewportWidth(this.referenceFrameList.length)/this.calculateViewportWidth(1+this.referenceFrameList.length);for(let u of this.referenceFrameList)u.bpPerPixel*=a;let o=(n-t)/r,l=new ca(this.genome,e,t,n,o),c=s?this.referenceFrameList.indexOf(s):this.referenceFrameList.length-1,h=1+c,{$viewport:d}=this.trackViews[0].viewports[c],f=To.insertAfter(d.get(0).parentElement);if(h===this.referenceFrameList.length){this.referenceFrameList.push(l);for(let u of this.trackViews){let g=ch(u,f,l);u.viewports.push(g)}}else{this.referenceFrameList.splice(h,0,l);for(let u of this.trackViews){let g=ch(u,f,l);u.viewports.splice(h,0,g)}}this.centerLineList=this.createCenterLineList(this.columnContainer),Mo.call(this),await this.updateViews(!0)}async removeMultiLocusPanel(e){let t=this.referenceFrameList.indexOf(e),{$viewport:n}=this.trackViews[0].viewports[t];To.removeColumnAtIndex(t,n.parent().get(0));for(let{viewports:r}of this.trackViews)r[t].dispose(),r.splice(t,1);if(this.referenceFrameList.splice(t,1),this.referenceFrameList.length===1&&this.getRulerTrackView())for(let r of this.getRulerTrackView().viewports)r.dismissLocusLabel();let s=this.calculateViewportWidth(1+this.referenceFrameList.length)/this.calculateViewportWidth(this.referenceFrameList.length);await this.rescaleForMultiLocus(s)}async gotoMultilocusPanel(e){let t=this.referenceFrameList.indexOf(e);this.columnContainer.querySelectorAll(".igv-column").forEach((s,r)=>{r===t||s.remove()}),this.columnContainer.querySelectorAll(".igv-column-shim").forEach(s=>s.remove());for(let s of this.trackViews){let r=s.viewports[t];s.viewports.filter((a,o)=>o!==t).forEach(a=>a.dispose()),s.viewports=[r]}let n=this.calculateViewportWidth(1);e.bpPerPixel=(e.end-e.start)/n,this.referenceFrameList=[e],this.trackViews.forEach(({viewports:s})=>s.forEach(r=>r.setWidth(n))),this.centerLineList=this.createCenterLineList(this.columnContainer),this.updateUIWithReferenceFrameList(),await this.updateViews(!0)}async rescaleForMultiLocus(e){let t=this.calculateViewportWidth(this.referenceFrameList.length);for(let n of this.referenceFrameList)n.bpPerPixel*=e;for(let{viewports:n}of this.trackViews)for(let s of n)s.setWidth(t);this.centerLineList=this.createCenterLineList(this.columnContainer),this.updateUIWithReferenceFrameList(),await this.updateViews()}async goto(e,t,n){await this.search(e+":"+t+"-"+n)}async doSearch(e,t){let n=await this.search(e,t);return n||this.alert.present(new Error(`Unrecognized locus: <b> ${e} </b>`)),n}async search(e,t){let n=await KS(this,e);if(n&&n.length>0){this.referenceFrameList=YS(n,this.genome,this.flanking,this.minimumBases(),this.calculateViewportWidth(n.length),this.isSoftclipped());for(let s of this.trackViews)s.removeDOMFromColumnContainer();this.columnContainer.querySelectorAll(".igv-column-shim, .igv-column").forEach(s=>s.remove()),To.insertBefore(this.columnContainer.querySelector(".igv-sample-name-column"),this.referenceFrameList.length),this.centerLineList=this.createCenterLineList(this.columnContainer);for(let s of this.trackViews)s.addDOMToColumnContainer(this,this.columnContainer,this.referenceFrameList);return this.updateUIWithReferenceFrameList(),t||await this.updateViews(),!0}else return!1}async loadSampleInformation(e){var t=e;Ei(e)&&(t=e.name);var n=t.substr(t.lastIndexOf(".")+1);n==="fam"&&(this.sampleInformation=await XS(e))}on(e,t){this.eventHandlers[e]||(this.eventHandlers[e]=[]),this.eventHandlers[e].push(t)}un(e,t){this.off(e,t)}off(e,t){if(!e)this.eventHandlers={};else if(!t)this.eventHandlers[e]=[];else{let n=this.eventHandlers[e];if(!n||n.length===0)console.warn("No handlers to remove for event: "+e);else{let s=n.indexOf(t);s!==-1&&this.eventHandlers[e].splice(s,1)}}}fireEvent(e,t,n){let s=this.eventHandlers[e];if(s===void 0||s.length===0)return;let r=n||window;return s.map(function(o){return o.apply(r,t)})[0]}dispose(){this.removeMouseHandlers();for(let e of this.trackViews)e.dispose()}toJSON(){let e={version:Bs()};if(this.showSampleNames!==void 0&&(e.showSampleNames=this.showSampleNames),this.sampleNameViewportWidth!==up&&(e.sampleNameViewportWidth=this.sampleNameViewportWidth),e.reference=this.genome.toJSON(),e.reference.fastaURL instanceof File)throw new Error(`Error. Sessions cannot include local file references ${e.reference.fastaURL.name}.`);if(e.reference.indexURL instanceof File)throw new Error(`Error. Sessions cannot include local file references ${e.reference.indexURL.name}.`);let t=[],n={},s=!1,r=this.trackViews[0];for(let{referenceFrame:l}of r.viewports){let c=l.getLocusString();if(t.push(c),l.selection){let h={gene:l.selection.gene,snp:l.selection.snp};n[c]=h,s=!0}}e.locus=t.length===1?t[0]:t,s&&(e.gtexSelections=n),e.roi=this.roiManager.toJSON();let a=[],o=[];for(let{track:l}of this.trackViews)try{let c;typeof l.getState=="function"?c=l.getState():c=l.config,c&&(c.browser&&delete c.browser,c.order=l.order,a.push(c))}catch(c){console.error(`Track: ${l.name}: ${c}`),o.push(`Track: ${l.name}: ${c}`)}if(o.length>0){let l=1,c="Errors encountered saving session: </br>";for(let h of o)c+=` (${l++}) ${h.toString()} <br/>`;throw Error(c)}return e.tracks=a,e}compressedSession(){let e=JSON.stringify(this.toJSON());return Iv(e)}sessionURL(){let e=window.location.href.slice(),t=e.indexOf("?");return(t>0?e.substring(0,t):e)+"?sessionURL=blob:"+this.compressedSession()}mouseDownOnViewport(e,t){var n;n=de.pageCoordinates(e),this.vpMouseDown={viewport:t,lastMouseX:n.x,mouseDownX:n.x,lastMouseY:n.y,mouseDownY:n.y,referenceFrame:t.referenceFrame}}cancelTrackPan(){let e=this.dragObject;this.dragObject=void 0,this.isScrolling=!1,this.vpMouseDown=void 0,e&&e.viewport.referenceFrame.start!==e.start&&(this.updateViews(),this.fireEvent("trackdragend"))}isTrackPanning(){return this.dragObject}isSoftclipped(){return this.trackViews.find(t=>t.track.showSoftClips===!0)!==void 0}startTrackDrag(e){this.dragTrack=e}updateTrackDrag(e){if(e&&this.dragTrack){let t=this.dragTrack,n=this.trackViews.indexOf(e),s=this.trackViews.indexOf(t),r=this.trackViews;r[n]=t,r[s]=e;let a=this.trackViews[n].track.order;this.trackViews[s].track.order=a;let o=r.length,l=a;if(n<s)for(let c=n+1;c<o;c++){let h=r[c].track;if(h.order<=l)h.order=Math.min(Number.MAX_SAFE_INTEGER,l+1),l=h.order;else break}else for(let c=n-1;c>0;c--){let h=r[c].track;if(h.order>=l)h.order=Math.max(-Number.MAX_SAFE_INTEGER,l-1),l=h.order;else break}this.reorderTracks()}}endTrackDrag(){this.dragTrack?(this.dragTrack=void 0,this.fireEvent("trackorderchanged",[this.getTrackOrder()])):this.dragTrack=void 0}addMouseHandlers(){this.addWindowResizeHandler(),this.addRootMouseUpHandler(),this.addRootMouseLeaveHandler(),this.addColumnContainerEventHandlers()}removeMouseHandlers(){this.removeWindowResizeHandler(),this.removeRootMouseUpHandler(),this.removeRootMouseLeaveHandler(),this.removeColumnContainerEventHandlers()}addWindowResizeHandler(){this.boundWindowResizeHandler=Mo.bind(this),window.addEventListener("resize",this.boundWindowResizeHandler)}removeWindowResizeHandler(){window.removeEventListener("resize",this.boundWindowResizeHandler)}addRootMouseUpHandler(){this.boundRootMouseUpHandler=Qn.bind(this),this.root.addEventListener("mouseup",this.boundRootMouseUpHandler)}removeRootMouseUpHandler(){this.root.removeEventListener("mouseup",this.boundRootMouseUpHandler)}addRootMouseLeaveHandler(){this.boundRootMouseLeaveHandler=Qn.bind(this),this.root.addEventListener("mouseleave",this.boundRootMouseLeaveHandler)}removeRootMouseLeaveHandler(){this.root.removeEventListener("mouseleave",this.boundRootMouseLeaveHandler)}addColumnContainerEventHandlers(){this.boundColumnContainerMouseMoveHandler=dp.bind(this),this.boundColumnContainerTouchMoveHandler=dp.bind(this),this.boundColumnContainerMouseLeaveHandler=Qn.bind(this),this.boundColumnContainerMouseUpHandler=Qn.bind(this),this.boundColumnContainerTouchEndHandler=Qn.bind(this),this.columnContainer.addEventListener("mousemove",this.boundColumnContainerMouseMoveHandler),this.columnContainer.addEventListener("touchmove",this.boundColumnContainerTouchMoveHandler),this.columnContainer.addEventListener("mouseleave",this.boundColumnContainerMouseLeaveHandler),this.columnContainer.addEventListener("mouseup",this.boundColumnContainerMouseUpHandler),this.columnContainer.addEventListener("touchend",this.boundColumnContainerTouchEndHandler)}removeColumnContainerEventHandlers(){this.columnContainer.removeEventListener("mousemove",this.boundColumnContainerMouseMoveHandler),this.columnContainer.removeEventListener("touchmove",this.boundColumnContainerTouchMoveHandler),this.columnContainer.removeEventListener("mouseleave",this.boundColumnContainerMouseLeaveHandler),this.columnContainer.removeEventListener("mouseup",this.boundColumnContainerMouseUpHandler),this.columnContainer.removeEventListener("touchend",this.boundColumnContainerTouchEndHandler)}static uncompressSession(e){let t;if(e.indexOf("/gzip;base64")>0){t=tn(e);let n="";for(let s of t)n+=String.fromCharCode(s);return n}else{let n=e.substring(5);return Lv(n)}}createCircularView(e,t){return t=t===!0,this.circularView=fx(e,this),this.circularViewControl=new Or(this.$toggle_button_container.get(0),this),this.circularView.setAssembly({name:this.genome.id,id:this.genome.id,chromosomes:qu(this.genome)}),this.circularViewVisible=t,this.circularView}get circularViewVisible(){return this.circularView!==void 0&&this.circularView.visible}set circularViewVisible(e){this.circularView&&(this.circularView.visible=e,this.circularViewControl.setState(e))}};async function Mo(){if(!this.referenceFrameList)return;let i=this.calculateViewportWidth(this.referenceFrameList.length);for(let e of this.referenceFrameList){let t=this.referenceFrameList.indexOf(e),{chr:n,genome:s}=e,{bpLength:r}=s.getChromosome(e.chr),a=e.toBP(i);mt.isWholeGenomeView(n)||a>r?e.bpPerPixel=r/i:e.end=e.start+e.toBP(i);for(let{viewports:o}of this.trackViews)o[t].setWidth(i)}this.updateUIWithReferenceFrameList(),await this.updateViews(!0)}function dp(i){i.preventDefault();let{x:e,y:t}=de.pageCoordinates(i);if(this.vpMouseDown){let{viewport:n,referenceFrame:s}=this.vpMouseDown,r=Math.abs(e-this.vpMouseDown.mouseDownX)>Math.abs(t-this.vpMouseDown.mouseDownY);if(!this.dragObject&&!this.isScrolling){if(r)this.vpMouseDown.mouseDownX&&Math.abs(e-this.vpMouseDown.mouseDownX)>this.constants.dragThreshold&&(this.dragObject={viewport:n,start:s.start});else if(this.vpMouseDown.mouseDownY&&Math.abs(t-this.vpMouseDown.mouseDownY)>this.constants.scrollThreshold){this.isScrolling=!0;let a=n.$viewport.height(),o=n.trackView.maxViewportContentHeight();this.vpMouseDown.r=a/o}}if(this.dragObject){let a=!this.isSoftclipped(),o=this.vpMouseDown.lastMouseX-e;s.shiftPixels(o,n.$viewport.width(),a)&&this.updateViews(),this.fireEvent("trackdrag")}if(this.isScrolling){let a=this.vpMouseDown.r*(this.vpMouseDown.lastMouseY-t);n.trackView.moveScroller(a)}this.vpMouseDown.lastMouseX=e,this.vpMouseDown.lastMouseY=t}}function Qn(i){this.cancelTrackPan(),this.endTrackDrag()}function fC(i,e){return i?Array.isArray(i)?i.join(" "):i:e.getHomeChromosomeName()}function uC(){return pe('<svg width="690px" height="324px" viewBox="0 0 690 324" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>IGV</title><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="IGV" fill="#666666"><polygon id="Path" points="379.54574 8.00169252 455.581247 8.00169252 515.564813 188.87244 532.884012 253.529506 537.108207 253.529506 554.849825 188.87244 614.833392 8.00169252 689.60164 8.00169252 582.729511 320.722144 486.840288 320.722144"></polygon><path d="M261.482414,323.793286 C207.975678,323.793286 168.339046,310.552102 142.571329,284.069337 C116.803612,257.586572 103.919946,217.158702 103.919946,162.784513 C103.919946,108.410325 117.437235,67.8415913 144.472217,41.0770945 C171.507199,14.3125977 212.903894,0.930550071 268.663545,0.930550071 C283.025879,0.930550071 298.232828,1.84616386 314.284849,3.6774189 C330.33687,5.50867394 344.839793,7.97378798 357.794056,11.072835 L357.794056,68.968378 C339.48912,65.869331 323.578145,63.5450806 310.060654,61.9955571 C296.543163,60.4460336 284.574731,59.6712835 274.154998,59.6712835 C255.850062,59.6712835 240.502308,61.4320792 228.111274,64.9537236 C215.720241,68.4753679 205.793482,74.2507779 198.330701,82.2801269 C190.867919,90.309476 185.587729,100.87425 182.48997,113.974767 C179.392212,127.075284 177.843356,143.345037 177.843356,162.784513 C177.843356,181.942258 179.251407,198.000716 182.067551,210.960367 C184.883695,223.920018 189.671068,234.41436 196.429813,242.443709 C203.188559,250.473058 212.059279,256.178037 223.042241,259.558815 C234.025202,262.939594 247.683295,264.629958 264.01693,264.629958 C268.241146,264.629958 273.098922,264.489094 278.590403,264.207362 C284.081883,263.925631 289.643684,263.50304 295.275972,262.939577 L295.275972,159.826347 L361.595831,159.826347 L361.595831,308.579859 C344.698967,313.087564 327.239137,316.750019 309.215815,319.567334 C291.192494,322.38465 275.281519,323.793286 261.482414,323.793286 L261.482414,323.793286 L261.482414,323.793286 Z" id="Path"></path>;<polygon id="Path" points="0.81355666 5.00169252 73.0472883 5.00169252 73.0472883 317.722144 0.81355666 317.722144"></polygon></g> </g> </svg>')}function Ro(i,e){for(let{viewports:t}of i)for(let n of t)n.$trackLabel&&(t.indexOf(n)===0&&e===!0?n.$trackLabel.show():n.$trackLabel.hide())}var Rn=[];async function dC(i,e){e===void 0&&(e={}),mt.KNOWN_GENOMES||await mt.initializeGenomes(e),bC(e),e.queryParametersSupported&&wC(e),e.apiKey&&Ce.setApiKey(e.apiKey),e.oauthToken&&Ce.setOauthToken(e.oauthToken),e.clientId&&!nn()&&await Pv({clientId:e.clientId,apiKey:e.apiKey,scope:"https://www.googleapis.com/auth/userinfo.profile"});let t=new da(e,i);return Rn.push(t),e.sessionURL?await t.loadSession({url:e.sessionURL}):await t.loadSessionObject(e),t.navbarManager.navbarDidResize(t.$navigation.width()),t}function pC(i){i.dispose(),i.root.remove(),Rn=Rn.filter(e=>e!==i)}function gC(){for(let i of Rn)i.dispose(),i.root.remove();Rn=[]}async function mC(){for(let i of Rn)await i.visibilityChange()}function bC(i){i.minimumBases===void 0&&(i.minimumBases=40),i.showIdeogram===void 0&&(i.showIdeogram=!0),i.showCircularView===void 0&&(i.showCircularView=!1),i.showCircularViewButton===void 0&&(i.showCircularViewButton=!1),i.showTrackLabelButton===void 0&&(i.showTrackLabelButton=!0),i.showTrackLabels===void 0&&(i.showTrackLabels=!0),i.showROITableButton===void 0&&(i.showROITableButton=!1),i.showROITable===void 0&&(i.showROITable=!1),i.showCursorTrackingGuideButton===void 0&&(i.showCursorTrackingGuideButton=!0),i.showCursorGuide===void 0&&(i.showCursorGuide=i.showCursorTrackingGuide||!1),i.showCenterGuideButton===void 0&&(i.showCenterGuideButton=!0),i.showCenterGuide===void 0&&(i.showCenterGuide=!1),i.showSampleNames===void 0&&(i.showSampleNames=!1),i.showSVGButton===void 0&&(i.showSVGButton=!0),i.showControls===void 0&&(i.showControls=!0),i.showNavigation===void 0&&(i.showNavigation=!0),i.showRuler===void 0&&(i.showRuler=!0),i.flanking===void 0&&(i.flanking=1e3),i.pairsSupported===void 0&&(i.pairsSupported=!0),i.tracks||(i.tracks=[])}function wC(i){var e,t,n,s,r,a,o,l,c,h;l=window.location.href,a={},e=l.indexOf("?"),t=l.lastIndexOf("#");let d,f,u;if(e>=0)for(t<0&&(t=l.length),n=e+1;n<t;)s=l.indexOf("&",n),s<0&&(s=t),r=l.substring(n,s),o=r.split("=",2),o.length===2?(c=o[0],h=decodeURIComponent(o[1]),c==="file"?d=h.split(","):c==="index"?f=h.split(","):c==="name"?u=h.split(","):c==="genome"&&(h.startsWith("https://")||h.startsWith("http://"))&&!h.endsWith(".json")?i.reference={fastaURL:h,indexURL:h+".fai"}:i[c]=h,n=s+1):n++;if(d){i.tracks||(i.tracks=[]);for(let g=0;g<d.length;g++){if(d[g].endsWith(".xml")||d[g].endsWith(".json")){i.sessionURL=d[g];break}let _={url:d[g]};f&&f.length>g&&(_.indexURL=f[g]),u&&u.length>g&&(_.name=u[g]),i.tracks.push(_)}}return a}async function vC(i,e){return await da.prototype.createTrack.call(e,i)}function _C(){var i=`.igv-navbar {
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: space-between;
  align-items: center;
  box-sizing: border-box;
  width: 100%;
  color: #444;
  font-size: 12px;
  font-family: "Open Sans", sans-serif;
  font-weight: 400;
  line-height: 32px;
  padding-left: 8px;
  padding-right: 8px;
  margin-top: 2px;
  margin-bottom: 6px;
  height: 32px;
  border-style: solid;
  border-radius: 3px;
  border-width: thin;
  border-color: #bfbfbf;
  background-color: #f3f3f3;
}
.igv-navbar .igv-navbar-left-container {
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: space-between;
  align-items: center;
  height: 32px;
  line-height: 32px;
}
.igv-navbar .igv-navbar-left-container .igv-logo {
  width: 34px;
  height: 32px;
  margin-right: 8px;
}
.igv-navbar .igv-navbar-left-container .igv-current-genome {
  height: 32px;
  margin-left: 4px;
  margin-right: 4px;
  user-select: none;
  line-height: 32px;
  vertical-align: middle;
  text-align: center;
}
.igv-navbar .igv-navbar-left-container .igv-navbar-genomic-location {
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: space-between;
  align-items: center;
  height: 100%;
}
.igv-navbar .igv-navbar-left-container .igv-navbar-genomic-location .igv-chromosome-select-widget-container {
  display: flex;
  flex-flow: column;
  flex-wrap: nowrap;
  justify-content: space-around;
  align-items: center;
  height: 100%;
  width: 125px;
  margin-right: 4px;
}
.igv-navbar .igv-navbar-left-container .igv-navbar-genomic-location .igv-chromosome-select-widget-container select {
  display: block;
  cursor: pointer;
  width: 100px;
  height: 75%;
  outline: none;
  font-size: 12px;
  font-family: "Open Sans", sans-serif;
  font-weight: 400;
}
.igv-navbar .igv-navbar-left-container .igv-navbar-genomic-location .igv-locus-size-group {
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: space-between;
  align-items: center;
  margin-left: 8px;
  height: 22px;
}
.igv-navbar .igv-navbar-left-container .igv-navbar-genomic-location .igv-locus-size-group .igv-search-container {
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: center;
  width: 210px;
  height: 22px;
  line-height: 22px;
}
.igv-navbar .igv-navbar-left-container .igv-navbar-genomic-location .igv-locus-size-group .igv-search-container input.igv-search-input {
  cursor: text;
  width: 85%;
  height: 22px;
  line-height: 22px;
  font-size: 12px;
  font-family: "Open Sans", sans-serif;
  font-weight: 400;
  text-align: left;
  padding-left: 8px;
  margin-right: 8px;
  outline: none;
  border-style: solid;
  border-radius: 3px;
  border-width: thin;
  border-color: #bfbfbf;
  background-color: white;
}
.igv-navbar .igv-navbar-left-container .igv-navbar-genomic-location .igv-locus-size-group .igv-search-container .igv-search-icon-container {
  cursor: pointer;
  height: 16px;
  width: 16px;
}
.igv-navbar .igv-navbar-left-container .igv-navbar-genomic-location .igv-locus-size-group .igv-windowsize-panel-container {
  margin-left: 4px;
  user-select: none;
}
.igv-navbar .igv-navbar-right-container {
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: space-between;
  align-items: center;
  height: 32px;
  line-height: 32px;
}
.igv-navbar .igv-navbar-right-container .igv-navbar-toggle-button-container {
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: space-between;
  align-items: center;
  height: 100%;
}
.igv-navbar .igv-navbar-right-container .igv-navbar-toggle-button-container div {
  margin-left: 0;
  margin-right: 4px;
}
.igv-navbar .igv-navbar-right-container .igv-navbar-toggle-button-container div:last-child {
  margin-left: 0;
  margin-right: 0;
}
.igv-navbar .igv-navbar-right-container .igv-navbar-toggle-button-container-750 {
  display: none;
}
.igv-navbar .igv-navbar-right-container .igv-zoom-widget {
  color: #737373;
  font-size: 18px;
  height: 32px;
  line-height: 32px;
  margin-left: 8px;
  user-select: none;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: flex-end;
  align-items: center;
}
.igv-navbar .igv-navbar-right-container .igv-zoom-widget div {
  cursor: pointer;
  margin-left: unset;
  margin-right: unset;
}
.igv-navbar .igv-navbar-right-container .igv-zoom-widget div:first-child {
  height: 24px;
  width: 24px;
  margin-left: unset;
  margin-right: 8px;
}
.igv-navbar .igv-navbar-right-container .igv-zoom-widget div:last-child {
  height: 24px;
  width: 24px;
  margin-left: 8px;
  margin-right: unset;
}
.igv-navbar .igv-navbar-right-container .igv-zoom-widget div:nth-child(even) {
  display: block;
  height: fit-content;
}
.igv-navbar .igv-navbar-right-container .igv-zoom-widget input {
  display: block;
  width: 125px;
}
.igv-navbar .igv-navbar-right-container .igv-zoom-widget svg {
  display: block;
}
.igv-navbar .igv-navbar-right-container .igv-zoom-widget-900 {
  color: #737373;
  font-size: 18px;
  height: 32px;
  line-height: 32px;
  margin-left: 8px;
  user-select: none;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: flex-end;
  align-items: center;
}
.igv-navbar .igv-navbar-right-container .igv-zoom-widget-900 div {
  cursor: pointer;
  margin-left: unset;
  margin-right: unset;
}
.igv-navbar .igv-navbar-right-container .igv-zoom-widget-900 div:first-child {
  height: 24px;
  width: 24px;
  margin-left: unset;
  margin-right: 8px;
}
.igv-navbar .igv-navbar-right-container .igv-zoom-widget-900 div:last-child {
  height: 24px;
  width: 24px;
  margin-left: 8px;
  margin-right: unset;
}
.igv-navbar .igv-navbar-right-container .igv-zoom-widget-900 div:nth-child(even) {
  width: 0;
  height: 0;
  display: none;
}
.igv-navbar .igv-navbar-right-container .igv-zoom-widget-900 input {
  width: 0;
  height: 0;
  display: none;
}
.igv-navbar .igv-navbar-right-container .igv-zoom-widget-900 svg {
  display: block;
}
.igv-navbar .igv-navbar-right-container .igv-zoom-widget-hidden {
  display: none;
}

.igv-navbar-button {
  display: block;
  box-sizing: unset;
  padding-left: 6px;
  padding-right: 6px;
  height: 18px;
  text-transform: capitalize;
  user-select: none;
  line-height: 18px;
  text-align: center;
  vertical-align: middle;
  font-family: "Open Sans", sans-serif;
  font-size: 11px;
  font-weight: 200;
  color: #737373;
  background-color: #f3f3f3;
  border-color: #737373;
  border-style: solid;
  border-width: thin;
  border-radius: 6px;
}

.igv-navbar-button-clicked {
  color: white;
  background-color: #737373;
}

.igv-navbar-button:hover {
  cursor: pointer;
}

.igv-zoom-in-notice-container {
  z-index: 1024;
  position: absolute;
  top: 8px;
  left: 50%;
  transform: translate(-50%, 0%);
  display: flex;
  flex-direction: row;
  flex-wrap: nowrap;
  justify-content: center;
  align-items: center;
  background-color: white;
}
.igv-zoom-in-notice-container > div {
  padding-left: 4px;
  padding-right: 4px;
  padding-top: 2px;
  padding-bottom: 2px;
  width: 100%;
  height: 100%;
  font-family: "Open Sans", sans-serif;
  font-size: 14px;
  font-weight: 400;
  color: #3f3f3f;
}

.igv-zoom-in-notice {
  position: absolute;
  top: 10px;
  left: 50%;
}
.igv-zoom-in-notice div {
  position: relative;
  left: -50%;
  font-family: "Open Sans", sans-serif;
  font-size: medium;
  font-weight: 400;
  color: #3f3f3f;
  background-color: rgba(255, 255, 255, 0.51);
  z-index: 64;
}

.igv-container-spinner {
  position: absolute;
  top: 90%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 1024;
  width: 24px;
  height: 24px;
  pointer-events: none;
  color: #737373;
}

.igv-multi-locus-close-button {
  position: absolute;
  top: 2px;
  right: 0;
  padding-left: 2px;
  padding-right: 2px;
  width: 12px;
  height: 12px;
  color: #666666;
  background-color: white;
  z-index: 1000;
}
.igv-multi-locus-close-button > svg {
  vertical-align: top;
}

.igv-multi-locus-close-button:hover {
  cursor: pointer;
  color: #434343;
}

.igv-multi-locus-ruler-label {
  z-index: 64;
  position: absolute;
  top: 2px;
  left: 0;
  width: 100%;
  height: 12px;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: center;
  align-items: center;
}
.igv-multi-locus-ruler-label > div {
  font-family: "Open Sans", sans-serif;
  font-size: 12px;
  color: rgb(16, 16, 16);
  background-color: white;
}
.igv-multi-locus-ruler-label > div {
  cursor: pointer;
}

.igv-multi-locus-ruler-label-square-dot {
  z-index: 64;
  position: absolute;
  left: 50%;
  top: 5%;
  transform: translate(-50%, 0%);
  background-color: white;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: center;
}
.igv-multi-locus-ruler-label-square-dot > div:first-child {
  width: 14px;
  height: 14px;
}
.igv-multi-locus-ruler-label-square-dot > div:last-child {
  margin-left: 16px;
  font-family: "Open Sans", sans-serif;
  font-size: 14px;
  font-weight: 400;
  color: rgb(16, 16, 16);
}

.igv-ruler-sweeper {
  display: none;
  pointer-events: none;
  position: absolute;
  top: 26px;
  bottom: 0;
  left: 0;
  width: 0;
  z-index: 99999;
  background-color: rgba(68, 134, 247, 0.25);
}

.igv-ruler-tooltip {
  pointer-events: none;
  z-index: 128;
  position: absolute;
  top: 0;
  left: 0;
  width: 1px;
  height: 32px;
  background-color: transparent;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: center;
}
.igv-ruler-tooltip > div {
  pointer-events: none;
  width: 128px;
  height: auto;
  padding: 1px;
  color: #373737;
  font-size: 10px;
  font-family: "Open Sans", sans-serif;
  font-weight: 400;
  background-color: white;
  border-style: solid;
  border-width: thin;
  border-color: #373737;
}

.igv-track-label {
  position: absolute;
  left: 8px;
  top: 8px;
  width: auto;
  height: auto;
  max-width: 50%;
  padding-left: 4px;
  padding-right: 4px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  font-family: "Open Sans", sans-serif;
  font-size: small;
  font-weight: 400;
  text-align: center;
  user-select: none;
  -moz-user-select: none;
  -webkit-user-select: none;
  border-color: #444;
  border-radius: 2px;
  border-style: solid;
  border-width: thin;
  background-color: white;
  z-index: 128;
  cursor: pointer;
}

.igv-track-label:hover,
.igv-track-label:focus,
.igv-track-label:active {
  background-color: #e8e8e8;
}

.igv-track-label-popup-shim {
  padding-left: 8px;
  padding-right: 8px;
  padding-top: 4px;
}

.igv-center-line {
  display: none;
  pointer-events: none;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  z-index: 8;
  user-select: none;
  -moz-user-select: none;
  -webkit-user-select: none;
  border-left-style: dashed;
  border-left-width: thin;
  border-right-style: dashed;
  border-right-width: thin;
}

.igv-center-line-wide {
  background-color: rgba(0, 0, 0, 0);
  border-left-color: rgba(127, 127, 127, 0.51);
  border-right-color: rgba(127, 127, 127, 0.51);
}

.igv-center-line-thin {
  background-color: rgba(0, 0, 0, 0);
  border-left-color: rgba(127, 127, 127, 0.51);
  border-right-color: rgba(0, 0, 0, 0);
}

.igv-cursor-guide-horizontal {
  display: none;
  pointer-events: none;
  user-select: none;
  -moz-user-select: none;
  -webkit-user-select: none;
  position: absolute;
  left: 0;
  right: 0;
  top: 50%;
  height: 1px;
  z-index: 1;
  margin-left: 50px;
  margin-right: 54px;
  border-top-style: dotted;
  border-top-width: thin;
  border-top-color: rgba(127, 127, 127, 0.76);
}

.igv-cursor-guide-vertical {
  pointer-events: none;
  user-select: none;
  -moz-user-select: none;
  -webkit-user-select: none;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 50%;
  width: 1px;
  z-index: 1;
  border-left-style: dotted;
  border-left-width: thin;
  border-left-color: rgba(127, 127, 127, 0.76);
  display: none;
}

.igv-user-feedback {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 512px;
  height: 360px;
  z-index: 2048;
  background-color: white;
  border-color: #a2a2a2;
  border-style: solid;
  border-width: thin;
  font-family: "Open Sans", sans-serif;
  font-size: medium;
  font-weight: 400;
  color: #444;
  display: flex;
  flex-direction: column;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: center;
}
.igv-user-feedback div:first-child {
  position: relative;
  height: 24px;
  width: 100%;
  background-color: white;
  border-bottom-color: #a2a2a2;
  border-bottom-style: solid;
  border-bottom-width: thin;
}
.igv-user-feedback div:first-child div {
  position: absolute;
  top: 2px;
  width: 16px;
  height: 16px;
  background-color: transparent;
}
.igv-user-feedback div:first-child div:first-child {
  left: 8px;
}
.igv-user-feedback div:first-child div:last-child {
  cursor: pointer;
  right: 8px;
}
.igv-user-feedback div:last-child {
  width: 100%;
  height: calc(100% - 24px);
  border-width: 0;
}
.igv-user-feedback div:last-child div {
  width: auto;
  height: auto;
  margin: 8px;
}

.igv-generic-dialog-container {
  position: absolute;
  top: 0;
  left: 0;
  width: 300px;
  height: 200px;
  border-color: #7F7F7F;
  border-radius: 4px;
  border-style: solid;
  border-width: thin;
  font-family: "Open Sans", sans-serif;
  font-size: medium;
  font-weight: 400;
  z-index: 2048;
  background-color: white;
  display: flex;
  flex-flow: column;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: center;
}
.igv-generic-dialog-container .igv-generic-dialog-header {
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: flex-end;
  align-items: center;
  width: 100%;
  height: 24px;
  cursor: move;
  border-top-left-radius: 4px;
  border-top-right-radius: 4px;
  border-bottom-color: #7F7F7F;
  border-bottom-style: solid;
  border-bottom-width: thin;
  background-color: #eee;
}
.igv-generic-dialog-container .igv-generic-dialog-header div {
  margin-right: 4px;
  margin-bottom: 2px;
  height: 12px;
  width: 12px;
  color: #7F7F7F;
}
.igv-generic-dialog-container .igv-generic-dialog-header div:hover {
  cursor: pointer;
  color: #444;
}
.igv-generic-dialog-container .igv-generic-dialog-one-liner {
  color: #373737;
  width: 95%;
  height: 24px;
  line-height: 24px;
  text-align: left;
  margin-top: 8px;
  padding-left: 8px;
  overflow-wrap: break-word;
  background-color: white;
}
.igv-generic-dialog-container .igv-generic-dialog-label-input {
  margin-top: 8px;
  width: 95%;
  height: 24px;
  color: #373737;
  line-height: 24px;
  padding-left: 8px;
  background-color: white;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: center;
}
.igv-generic-dialog-container .igv-generic-dialog-label-input div {
  width: 30%;
  height: 100%;
  font-size: 16px;
  text-align: right;
  padding-right: 8px;
  background-color: white;
}
.igv-generic-dialog-container .igv-generic-dialog-label-input input {
  display: block;
  height: 100%;
  width: 100%;
  padding-left: 4px;
  font-family: "Open Sans", sans-serif;
  font-weight: 400;
  color: #373737;
  text-align: left;
  outline: none;
  border-style: solid;
  border-width: thin;
  border-color: #7F7F7F;
  background-color: white;
}
.igv-generic-dialog-container .igv-generic-dialog-label-input input {
  width: 50%;
  font-size: 16px;
}
.igv-generic-dialog-container .igv-generic-dialog-input {
  margin-top: 8px;
  width: calc(100% - 16px);
  height: 24px;
  color: #373737;
  line-height: 24px;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: space-around;
  align-items: center;
}
.igv-generic-dialog-container .igv-generic-dialog-input input {
  display: block;
  height: 100%;
  width: 100%;
  padding-left: 4px;
  font-family: "Open Sans", sans-serif;
  font-weight: 400;
  color: #373737;
  text-align: left;
  outline: none;
  border-style: solid;
  border-width: thin;
  border-color: #7F7F7F;
  background-color: white;
}
.igv-generic-dialog-container .igv-generic-dialog-input input {
  font-size: 16px;
}
.igv-generic-dialog-container .igv-generic-dialog-ok-cancel {
  width: 100%;
  height: 28px;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: space-around;
  align-items: center;
}
.igv-generic-dialog-container .igv-generic-dialog-ok-cancel div {
  margin-top: 32px;
  color: white;
  font-family: "Open Sans", sans-serif;
  font-size: 14px;
  font-weight: 400;
  width: 75px;
  height: 28px;
  line-height: 28px;
  text-align: center;
  border-color: transparent;
  border-style: solid;
  border-width: thin;
  border-radius: 2px;
}
.igv-generic-dialog-container .igv-generic-dialog-ok-cancel div:first-child {
  margin-left: 32px;
  margin-right: 0;
  background-color: #5ea4e0;
}
.igv-generic-dialog-container .igv-generic-dialog-ok-cancel div:last-child {
  margin-left: 0;
  margin-right: 32px;
  background-color: #c4c4c4;
}
.igv-generic-dialog-container .igv-generic-dialog-ok-cancel div:first-child:hover {
  cursor: pointer;
  background-color: #3b5c7f;
}
.igv-generic-dialog-container .igv-generic-dialog-ok-cancel div:last-child:hover {
  cursor: pointer;
  background-color: #7f7f7f;
}
.igv-generic-dialog-container .igv-generic-dialog-ok {
  width: 100%;
  height: 36px;
  margin-top: 32px;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: space-around;
  align-items: center;
}
.igv-generic-dialog-container .igv-generic-dialog-ok div {
  width: 98px;
  height: 36px;
  line-height: 36px;
  text-align: center;
  color: white;
  font-family: "Open Sans", sans-serif;
  font-size: medium;
  font-weight: 400;
  border-color: white;
  border-style: solid;
  border-width: thin;
  border-radius: 4px;
  background-color: #2B81AF;
}
.igv-generic-dialog-container .igv-generic-dialog-ok div:hover {
  cursor: pointer;
  background-color: #25597f;
}

.igv-generic-container {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 2048;
  background-color: white;
  cursor: pointer;
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  justify-content: flex-start;
  align-items: center;
}
.igv-generic-container div:first-child {
  cursor: move;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: flex-end;
  align-items: center;
  height: 24px;
  width: 100%;
  background-color: #dddddd;
}
.igv-generic-container div:first-child i {
  display: block;
  color: #5f5f5f;
  cursor: pointer;
  width: 14px;
  height: 14px;
  margin-right: 8px;
  margin-bottom: 4px;
}

.igv-menu-popup {
  position: absolute;
  top: 0;
  left: 0;
  width: max-content;
  z-index: 4096;
  cursor: pointer;
  font-family: "Open Sans", sans-serif;
  font-size: small;
  font-weight: 400;
  color: #4b4b4b;
  background: white;
  border-radius: 4px;
  border-color: #7F7F7F;
  border-style: solid;
  border-width: thin;
  display: flex;
  flex-flow: column;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: flex-end;
  text-align: left;
}
.igv-menu-popup > div:not(:first-child) {
  width: 100%;
}
.igv-menu-popup > div:not(:first-child) > div {
  background: white;
}
.igv-menu-popup > div:not(:first-child) > div.context-menu {
  padding-left: 4px;
  padding-right: 4px;
}
.igv-menu-popup > div:not(:first-child) > div:last-child {
  border-bottom-left-radius: 4px;
  border-bottom-right-radius: 4px;
  border-bottom-color: transparent;
  border-bottom-style: solid;
  border-bottom-width: thin;
}
.igv-menu-popup > div:not(:first-child) > div:hover {
  background: #efefef;
}

.igv-menu-popup-shim {
  padding-left: 8px;
  padding-right: 8px;
  padding-bottom: 1px;
  padding-top: 1px;
}

.igv-menu-popup-header {
  position: relative;
  width: 100%;
  height: 24px;
  cursor: move;
  border-top-color: transparent;
  border-top-left-radius: 4px;
  border-top-right-radius: 4px;
  border-bottom-color: #7F7F7F;
  border-bottom-style: solid;
  border-bottom-width: thin;
  background-color: #eee;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: flex-end;
  align-items: center;
}
.igv-menu-popup-header div {
  margin-right: 4px;
  height: 12px;
  width: 12px;
  color: #7F7F7F;
}
.igv-menu-popup-header div:hover {
  cursor: pointer;
  color: #444;
}

.igv-menu-popup-check-container {
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: center;
  width: 100%;
  height: 20px;
  margin-right: 4px;
  background-color: transparent;
}
.igv-menu-popup-check-container div {
  padding-top: 2px;
  padding-left: 8px;
}
.igv-menu-popup-check-container div:first-child {
  position: relative;
  width: 12px;
  height: 12px;
}
.igv-menu-popup-check-container div:first-child svg {
  position: absolute;
  width: 12px;
  height: 12px;
}

.igv-user-feedback {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 512px;
  height: 360px;
  z-index: 2048;
  background-color: white;
  border-color: #a2a2a2;
  border-style: solid;
  border-width: thin;
  font-family: "Open Sans", sans-serif;
  font-size: medium;
  font-weight: 400;
  color: #444;
  display: flex;
  flex-direction: column;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: center;
}
.igv-user-feedback div:first-child {
  position: relative;
  height: 24px;
  width: 100%;
  background-color: white;
  border-bottom-color: #a2a2a2;
  border-bottom-style: solid;
  border-bottom-width: thin;
}
.igv-user-feedback div:first-child div {
  position: absolute;
  top: 2px;
  width: 16px;
  height: 16px;
  background-color: transparent;
}
.igv-user-feedback div:first-child div:first-child {
  left: 8px;
}
.igv-user-feedback div:first-child div:last-child {
  cursor: pointer;
  right: 8px;
}
.igv-user-feedback div:last-child {
  width: 100%;
  height: calc(100% - 24px);
  border-width: 0;
}
.igv-user-feedback div:last-child div {
  width: auto;
  height: auto;
  margin: 8px;
}

.igv-loading-spinner-container {
  z-index: 1024;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 32px;
  height: 32px;
  display: flex;
  flex-direction: row;
  flex-wrap: nowrap;
  justify-content: center;
  align-items: center;
}
.igv-loading-spinner-container > div {
  box-sizing: border-box;
  width: 100%;
  height: 100%;
  border-radius: 50%;
  border: 4px solid rgba(128, 128, 128, 0.5);
  border-top-color: rgb(255, 255, 255);
  animation: spin 1s ease-in-out infinite;
  -webkit-animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
  to {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
@-webkit-keyframes spin {
  to {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
.igv-roi-menu-next-gen {
  position: absolute;
  z-index: 512;
  font-family: "Open Sans", sans-serif;
  font-size: small;
  font-weight: 400;
  color: #4b4b4b;
  background-color: white;
  width: 192px;
  border-radius: 4px;
  border-color: #7F7F7F;
  border-style: solid;
  border-width: thin;
  display: flex;
  flex-direction: column;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: stretch;
}
.igv-roi-menu-next-gen > div:first-child {
  height: 24px;
  border-top-color: transparent;
  border-top-left-radius: 4px;
  border-top-right-radius: 4px;
  border-bottom-color: #7F7F7F;
  border-bottom-style: solid;
  border-bottom-width: thin;
  background-color: #eee;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: flex-end;
  align-items: center;
}
.igv-roi-menu-next-gen > div:first-child > div {
  margin-right: 4px;
  height: 12px;
  width: 12px;
  color: #7F7F7F;
}
.igv-roi-menu-next-gen > div:first-child > div:hover {
  cursor: pointer;
  color: #444;
}
.igv-roi-menu-next-gen > div:last-child {
  background-color: white;
  border-bottom-left-radius: 4px;
  border-bottom-right-radius: 4px;
  border-bottom-color: transparent;
  border-bottom-style: solid;
  border-bottom-width: 0;
  display: flex;
  flex-direction: column;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: stretch;
  text-align: start;
  vertical-align: middle;
}
.igv-roi-menu-next-gen > div:last-child > div {
  height: 24px;
  padding-left: 4px;
  border-bottom-style: solid;
  border-bottom-width: thin;
  border-bottom-color: #7f7f7f;
}
.igv-roi-menu-next-gen > div:last-child > div:not(:first-child):hover {
  background-color: rgba(127, 127, 127, 0.1);
}
.igv-roi-menu-next-gen > div:last-child div:first-child {
  font-style: italic;
  text-align: center;
  padding-right: 4px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.igv-roi-menu-next-gen > div:last-child > div:last-child {
  border-bottom-width: 0;
  border-bottom-color: transparent;
}

.igv-roi-placeholder {
  font-style: normal;
  color: rgba(75, 75, 75, 0.6);
}

.igv-roi-table {
  position: absolute;
  z-index: 1024;
  width: min-content;
  max-width: 1600px;
  border-color: #7f7f7f;
  border-radius: 4px;
  border-style: solid;
  border-width: thin;
  font-family: "Open Sans", sans-serif;
  font-size: 12px;
  font-weight: 400;
  background-color: white;
  display: flex;
  flex-flow: column;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: stretch;
  cursor: default;
}
.igv-roi-table > div {
  height: 24px;
  font-size: 14px;
  text-align: start;
  vertical-align: middle;
  line-height: 24px;
}
.igv-roi-table > div:first-child {
  border-color: transparent;
  border-top-left-radius: 4px;
  border-top-right-radius: 4px;
  border-top-width: 0;
  border-bottom-color: #7f7f7f;
  border-bottom-style: solid;
  border-bottom-width: thin;
  background-color: #eee;
  cursor: move;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: space-between;
  align-items: center;
}
.igv-roi-table > div:first-child > div:first-child {
  text-align: center;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
  margin-left: 4px;
  margin-right: 4px;
  width: calc(100% - 4px - 12px);
}
.igv-roi-table > div:first-child > div:last-child {
  margin-right: 4px;
  margin-bottom: 2px;
  height: 12px;
  width: 12px;
  color: #7f7f7f;
}
.igv-roi-table > div:first-child > div:last-child > svg {
  display: block;
}
.igv-roi-table > div:first-child > div:last-child:hover {
  cursor: pointer;
  color: #444;
}
.igv-roi-table > .igv-roi-table-description {
  padding: 4px;
  margin-left: 4px;
  word-break: break-all;
  overflow-y: auto;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  background-color: transparent;
}
.igv-roi-table > .igv-roi-table-goto-explainer {
  margin-top: 5px;
  margin-left: 4px;
  color: #7F7F7F;
  font-style: italic;
  height: 24px;
  border-top: solid lightgray;
  background-color: transparent;
}
.igv-roi-table > .igv-roi-table-column-titles {
  height: 24px;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: stretch;
  align-items: stretch;
  padding-right: 16px;
  background-color: white;
  border-top-color: #7f7f7f;
  border-top-style: solid;
  border-top-width: thin;
  border-bottom-color: #7f7f7f;
  border-bottom-style: solid;
  border-bottom-width: thin;
}
.igv-roi-table > .igv-roi-table-column-titles > div {
  font-size: 14px;
  vertical-align: middle;
  line-height: 24px;
  text-align: left;
  margin-left: 4px;
  height: 24px;
  overflow: hidden;
  text-overflow: ellipsis;
  border-right-color: #7f7f7f;
  border-right-style: solid;
  border-right-width: thin;
}
.igv-roi-table > .igv-roi-table-column-titles > div:last-child {
  border-right: unset;
}
.igv-roi-table > .igv-roi-table-row-container {
  overflow: auto;
  resize: both;
  max-width: 1600px;
  height: 360px;
  background-color: transparent;
  display: flex;
  flex-flow: column;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: stretch;
}
.igv-roi-table > .igv-roi-table-row-container > .igv-roi-table-row {
  height: 24px;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: stretch;
  align-items: stretch;
}
.igv-roi-table > .igv-roi-table-row-container > .igv-roi-table-row > div {
  font-size: 14px;
  vertical-align: middle;
  line-height: 24px;
  text-align: left;
  margin-left: 4px;
  height: 24px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  border-right-color: transparent;
  border-right-style: solid;
  border-right-width: thin;
}
.igv-roi-table > .igv-roi-table-row-container > .igv-roi-table-row > div:last-child {
  border-right: unset;
}
.igv-roi-table > .igv-roi-table-row-container > .igv-roi-table-row-hover {
  background-color: rgba(0, 0, 0, 0.04);
}
.igv-roi-table > div:last-child {
  height: 32px;
  line-height: 32px;
  border-top-color: #7f7f7f;
  border-top-style: solid;
  border-top-width: thin;
  border-bottom-color: transparent;
  border-bottom-left-radius: 4px;
  border-bottom-right-radius: 4px;
  border-bottom-width: 0;
  background-color: #eee;
  display: flex;
  flex-flow: row;
  flex-wrap: nowrap;
  justify-content: space-around;
  align-items: center;
}

.igv-roi-table-row-selected {
  background-color: rgba(0, 0, 0, 0.125);
}

.igv-roi-table-button {
  cursor: pointer;
  height: 20px;
  user-select: none;
  line-height: 20px;
  text-align: center;
  vertical-align: middle;
  font-family: "Open Sans", sans-serif;
  font-size: 13px;
  font-weight: 400;
  color: black;
  padding-left: 6px;
  padding-right: 6px;
  background-color: rgb(239, 239, 239);
  border-color: black;
  border-style: solid;
  border-width: thin;
  border-radius: 3px;
}

.igv-roi-table-button:hover {
  font-weight: 400;
  background-color: rgba(0, 0, 0, 0.13);
}

.igv-roi-region {
  z-index: 64;
  position: absolute;
  top: 0;
  bottom: 0;
  pointer-events: none;
  overflow: visible;
  margin-top: 44px;
  display: flex;
  flex-direction: column;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: stretch;
}
.igv-roi-region > div {
  position: relative;
  width: 100%;
  height: 8px;
  pointer-events: auto;
}

.igv-roi-menu {
  position: absolute;
  z-index: 1024;
  width: 144px;
  border-color: #7f7f7f;
  border-radius: 4px;
  border-style: solid;
  border-width: thin;
  font-family: "Open Sans", sans-serif;
  background-color: white;
  display: flex;
  flex-flow: column;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: stretch;
}
.igv-roi-menu > div:not(:last-child) {
  border-bottom-color: rgba(128, 128, 128, 0.5);
  border-bottom-style: solid;
  border-bottom-width: thin;
}
.igv-roi-menu > div:first-child {
  border-top-left-radius: 4px;
  border-top-right-radius: 4px;
  border-top-color: transparent;
  border-top-style: solid;
  border-top-width: 0;
}
.igv-roi-menu > div:last-child {
  border-bottom-left-radius: 4px;
  border-bottom-right-radius: 4px;
  border-bottom-color: transparent;
  border-bottom-style: solid;
  border-bottom-width: 0;
}

.igv-roi-menu-row {
  height: 24px;
  padding-left: 8px;
  font-size: small;
  text-align: start;
  vertical-align: middle;
  line-height: 24px;
  background-color: white;
}

.igv-roi-menu-row-edit-description {
  width: -webkit-fill-available;
  font-size: small;
  text-align: start;
  vertical-align: middle;
  background-color: white;
  padding-left: 4px;
  padding-right: 4px;
  padding-bottom: 4px;
  display: flex;
  flex-direction: column;
  flex-wrap: nowrap;
  justify-content: stretch;
  align-items: stretch;
}
.igv-roi-menu-row-edit-description > label {
  margin-left: 2px;
  margin-bottom: 0;
  display: block;
  width: -webkit-fill-available;
}
.igv-roi-menu-row-edit-description > input {
  display: block;
  margin-left: 2px;
  margin-right: 2px;
  margin-bottom: 1px;
  width: -webkit-fill-available;
}

.igv-container {
  position: relative;
  display: flex;
  flex-direction: column;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: flex-start;
  padding-top: 4px;
  user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
}

.igv-viewport {
  position: relative;
  margin-top: 5px;
  line-height: 1;
  overflow-x: hidden;
  overflow-y: hidden;
}

.igv-viewport-content {
  position: relative;
  width: 100%;
}
.igv-viewport-content > canvas {
  position: relative;
  display: block;
}

.igv-column-container {
  position: relative;
  display: flex;
  flex-direction: row;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: stretch;
  width: 100%;
}

.igv-column-shim {
  width: 1px;
  margin-left: 2px;
  margin-right: 2px;
  background-color: #545453;
}

.igv-column {
  position: relative;
  position: relative;
  display: flex;
  flex-direction: column;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: flex-start;
  box-sizing: border-box;
  height: 100%;
}

.igv-axis-column {
  position: relative;
  display: flex;
  flex-direction: column;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: flex-start;
  box-sizing: border-box;
  height: 100%;
  width: 50px;
}
.igv-axis-column > div {
  margin-top: 5px;
  width: 100%;
}

.igv-sample-name-column {
  position: relative;
  display: flex;
  flex-direction: column;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: flex-start;
  box-sizing: border-box;
  height: 100%;
}

.igv-scrollbar-column {
  position: relative;
  display: flex;
  flex-direction: column;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: flex-start;
  box-sizing: border-box;
  height: 100%;
  width: 14px;
}
.igv-scrollbar-column > div {
  position: relative;
  margin-top: 5px;
  width: 14px;
}
.igv-scrollbar-column > div > div {
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 2px;
  width: 8px;
  border-width: 1px;
  border-style: solid;
  border-color: #c4c4c4;
  border-top-left-radius: 4px;
  border-top-right-radius: 4px;
  border-bottom-left-radius: 4px;
  border-bottom-right-radius: 4px;
}
.igv-scrollbar-column > div > div:hover {
  background-color: #c4c4c4;
}

.igv-track-drag-column {
  position: relative;
  display: flex;
  flex-direction: column;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: flex-start;
  box-sizing: border-box;
  height: 100%;
  width: 12px;
  background-color: white;
}
.igv-track-drag-column > .igv-track-drag-handle {
  z-index: 512;
  position: relative;
  cursor: pointer;
  margin-top: 5px;
  width: 100%;
  border-style: solid;
  border-width: 0;
  border-top-right-radius: 6px;
  border-bottom-right-radius: 6px;
  background-color: #c4c4c4;
}
.igv-track-drag-column .igv-track-drag-handle-hover {
  background-color: #787878;
}
.igv-track-drag-column > .igv-track-drag-shim {
  position: relative;
  margin-top: 5px;
  width: 100%;
  border-style: solid;
  border-width: 0;
}

.igv-gear-menu-column {
  position: relative;
  display: flex;
  flex-direction: column;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: flex-start;
  box-sizing: border-box;
  height: 100%;
  width: 28px;
}
.igv-gear-menu-column > div {
  display: flex;
  flex-direction: column;
  flex-wrap: nowrap;
  justify-content: flex-start;
  align-items: center;
  margin-top: 5px;
  width: 100%;
  background: white;
}
.igv-gear-menu-column > div > div {
  position: relative;
  margin-top: 4px;
  width: 16px;
  height: 16px;
  color: #7F7F7F;
}
.igv-gear-menu-column > div > div:hover {
  cursor: pointer;
  color: #444;
}

/*# sourceMappingURL=dom.css.map */
`,e=document.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=i,document.head.append(e)}var yC=Ce.setApiKey;_C();function xC(i){return Ce.setOauthToken(i)}function kC(i,e){return Ce.setOauthToken(i,e)}var SC=Ce.oauth,LC={TrackUtils:l_,IGVGraphics:he,MenuUtils:Xt,DataRangeDialog:Ss,createTrack:vC,createBrowser:dC,removeBrowser:pC,removeAllBrowsers:gC,visibilityChange:mC,setGoogleOauthToken:xC,setOauthToken:kC,oauth:SC,version:Bs,setApiKey:yC,registerFileFormats:qg};export{LC as default};
/*! Bundled license information:

igv/dist/igv.esm.js:
  (*!
   * jQuery JavaScript Library v3.3.1 -ajax,-ajax/jsonp,-ajax/load,-ajax/parseXML,-ajax/script,-ajax/var/location,-ajax/var/nonce,-ajax/var/rquery,-ajax/xhr,-manipulation/_evalUrl,-event/ajax,-effects,-effects/Tween,-effects/animatedSelector
   * https://jquery.com/
   *
   * Includes Sizzle.js
   * https://sizzlejs.com/
   *
   * Copyright JS Foundation and other contributors
   * Released under the MIT license
   * https://jquery.org/license
   *
   * Date: 2018-01-20T17:24Z
   *)
  (*! @license DOMPurify 3.0.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.0.5/LICENSE *)
  (*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) *)
  (*!
   * is-number <https://github.com/jonschlinkert/is-number>
   *
   * Copyright (c) 2014-present, Jon Schlinkert.
   * Released under the MIT License.
   *)
  (*!!
   *  Canvas 2 Svg v1.0.19
   *  A low level canvas to SVG converter. Uses a mock canvas context to build an SVG document.
   *
   *  Licensed under the MIT license:
   *  http://www.opensource.org/licenses/mit-license.php
   *
   *  Author:
   *  Kerry Liu
   *
   *  Copyright (c) 2014 Gliffy Inc.
   *)
  (*! For license information please see cram-bundle.js.LICENSE.txt *)
  (*!
   * vanilla-picker v2.12.1
   * https://vanilla-picker.js.org
   *
   * Copyright 2017-2021 Andreas Borgen (https://github.com/Sphinxxxx), Adam Brooks (https://github.com/dissimulate)
   * Released under the ISC license.
   *)
  (*! pako 2.0.4 https://github.com/nodeca/pako @license (MIT AND Zlib) *)
*/
//# sourceMappingURL=igv.mjs.map